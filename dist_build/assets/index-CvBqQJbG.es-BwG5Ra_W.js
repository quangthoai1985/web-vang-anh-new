function A(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?y(e.position):"start"in e||"end"in e?y(e):"line"in e||"column"in e?g(e):""}function g(e){return w(e&&e.line)+":"+w(e&&e.column)}function y(e){return g(e&&e.start)+"-"+g(e&&e.end)}function w(e){return e&&typeof e=="number"?e:1}class c extends Error{constructor(t,i,o){super(),typeof i=="string"&&(o=i,i=void 0);let s="",n={},r=!1;if(i&&("line"in i&&"column"in i?n={place:i}:"start"in i&&"end"in i?n={place:i}:"type"in i?n={ancestors:[i],place:i.position}:n={...i}),typeof t=="string"?s=t:!n.cause&&t&&(r=!0,s=t.message,n.cause=t),!n.ruleId&&!n.source&&typeof o=="string"){const f=o.indexOf(":");f===-1?n.ruleId=o:(n.source=o.slice(0,f),n.ruleId=o.slice(f+1))}if(!n.place&&n.ancestors&&n.ancestors){const f=n.ancestors[n.ancestors.length-1];f&&(n.place=f.position)}const l=n.place&&"start"in n.place?n.place.start:n.place;this.ancestors=n.ancestors||void 0,this.cause=n.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file="",this.message=s,this.line=l?l.line:void 0,this.name=A(n.place)||"1:1",this.place=n.place||void 0,this.reason=this.message,this.ruleId=n.ruleId||void 0,this.source=n.source||void 0,this.stack=r&&n.cause&&typeof n.cause.stack=="string"?n.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}c.prototype.file="";c.prototype.name="";c.prototype.reason="";c.prototype.message="";c.prototype.stack="";c.prototype.column=void 0;c.prototype.line=void 0;c.prototype.ancestors=void 0;c.prototype.cause=void 0;c.prototype.fatal=void 0;c.prototype.place=void 0;c.prototype.ruleId=void 0;c.prototype.source=void 0;const d={basename:E,dirname:x,extname:v,join:I,sep:"/"};function E(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');h(e);let i=0,o=-1,s=e.length,n;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(n){i=s+1;break}}else o<0&&(n=!0,o=s+1);return o<0?"":e.slice(i,o)}if(t===e)return"";let r=-1,l=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(n){i=s+1;break}}else r<0&&(n=!0,r=s+1),l>-1&&(e.codePointAt(s)===t.codePointAt(l--)?l<0&&(o=s):(l=-1,o=r));return i===o?o=r:o<0&&(o=e.length),e.slice(i,o)}function x(e){if(h(e),e.length===0)return".";let t=-1,i=e.length,o;for(;--i;)if(e.codePointAt(i)===47){if(o){t=i;break}}else o||(o=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function v(e){h(e);let t=e.length,i=-1,o=0,s=-1,n=0,r;for(;t--;){const l=e.codePointAt(t);if(l===47){if(r){o=t+1;break}continue}i<0&&(r=!0,i=t+1),l===46?s<0?s=t:n!==1&&(n=1):s>-1&&(n=-1)}return s<0||i<0||n===0||n===1&&s===i-1&&s===o+1?"":e.slice(s,i)}function I(...e){let t=-1,i;for(;++t<e.length;)h(e[t]),e[t]&&(i=i===void 0?e[t]:i+"/"+e[t]);return i===void 0?".":L(i)}function L(e){h(e);const t=e.codePointAt(0)===47;let i=R(e,!t);return i.length===0&&!t&&(i="."),i.length>0&&e.codePointAt(e.length-1)===47&&(i+="/"),t?"/"+i:i}function R(e,t){let i="",o=0,s=-1,n=0,r=-1,l,f;for(;++r<=e.length;){if(r<e.length)l=e.codePointAt(r);else{if(l===47)break;l=47}if(l===47){if(!(s===r-1||n===1))if(s!==r-1&&n===2){if(i.length<2||o!==2||i.codePointAt(i.length-1)!==46||i.codePointAt(i.length-2)!==46){if(i.length>2){if(f=i.lastIndexOf("/"),f!==i.length-1){f<0?(i="",o=0):(i=i.slice(0,f),o=i.length-1-i.lastIndexOf("/")),s=r,n=0;continue}}else if(i.length>0){i="",o=0,s=r,n=0;continue}}t&&(i=i.length>0?i+"/..":"..",o=2)}else i.length>0?i+="/"+e.slice(s+1,r):i=e.slice(s+1,r),o=r-s-1;s=r,n=0}else l===46&&n>-1?n++:n=-1}return i}function h(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const S={cwd:_};function _(){return"/"}function p(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function T(e){if(typeof e=="string")e=new URL(e);else if(!p(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return j(e)}function j(e){if(e.hostname!==""){const o=new TypeError('File URL host must be "localhost" or empty on darwin');throw o.code="ERR_INVALID_FILE_URL_HOST",o}const t=e.pathname;let i=-1;for(;++i<t.length;)if(t.codePointAt(i)===37&&t.codePointAt(i+1)===50){const o=t.codePointAt(i+2);if(o===70||o===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const a=["history","path","basename","stem","extname","dirname"];class N{constructor(t){let i;t?p(t)?i={path:t}:typeof t=="string"||k(t)?i={value:t}:i=t:i={},this.cwd="cwd"in i?"":S.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let o=-1;for(;++o<a.length;){const n=a[o];n in i&&i[n]!==void 0&&i[n]!==null&&(this[n]=n==="history"?[...i[n]]:i[n])}let s;for(s in i)a.includes(s)||(this[s]=i[s])}get basename(){return typeof this.path=="string"?d.basename(this.path):void 0}set basename(t){m(t,"basename"),u(t,"basename"),this.path=d.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?d.dirname(this.path):void 0}set dirname(t){b(this.basename,"dirname"),this.path=d.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?d.extname(this.path):void 0}set extname(t){if(u(t,"extname"),b(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=d.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){p(t)&&(t=T(t)),m(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?d.basename(this.path,this.extname):void 0}set stem(t){m(t,"stem"),u(t,"stem"),this.path=d.join(this.dirname||"",t+(this.extname||""))}fail(t,i,o){const s=this.message(t,i,o);throw s.fatal=!0,s}info(t,i,o){const s=this.message(t,i,o);return s.fatal=void 0,s}message(t,i,o){const s=new c(t,i,o);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function u(e,t){if(e&&e.includes(d.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+d.sep+"`")}function m(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function b(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function k(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}export{N as V,c as a};
