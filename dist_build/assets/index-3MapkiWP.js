(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(o){if(o.ep)return;o.ep=!0;const u=t(o);fetch(o.href,u)}})();function P_(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Op={exports:{}},Xc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ev;function sE(){if(Ev)return Xc;Ev=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,o,u){var d=null;if(u!==void 0&&(d=""+u),o.key!==void 0&&(d=""+o.key),"key"in o){u={};for(var p in o)p!=="key"&&(u[p]=o[p])}else u=o;return o=u.ref,{$$typeof:s,type:a,key:d,ref:o!==void 0?o:null,props:u}}return Xc.Fragment=e,Xc.jsx=t,Xc.jsxs=t,Xc}var Sv;function rE(){return Sv||(Sv=1,Op.exports=sE()),Op.exports}var i=rE(),Mp={exports:{}},Je={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cv;function aE(){if(Cv)return Je;Cv=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),N=Symbol.iterator;function R(V){return V===null||typeof V!="object"?null:(V=N&&V[N]||V["@@iterator"],typeof V=="function"?V:null)}var D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q=Object.assign,L={};function W(V,oe,de){this.props=V,this.context=oe,this.refs=L,this.updater=de||D}W.prototype.isReactComponent={},W.prototype.setState=function(V,oe){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,oe,"setState")},W.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function re(){}re.prototype=W.prototype;function $(V,oe,de){this.props=V,this.context=oe,this.refs=L,this.updater=de||D}var z=$.prototype=new re;z.constructor=$,q(z,W.prototype),z.isPureReactComponent=!0;var he=Array.isArray;function _e(){}var S={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function k(V,oe,de){var ye=de.ref;return{$$typeof:s,type:V,key:oe,ref:ye!==void 0?ye:null,props:de}}function M(V,oe){return k(V.type,oe,V.props)}function I(V){return typeof V=="object"&&V!==null&&V.$$typeof===s}function O(V){var oe={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(de){return oe[de]})}var E=/\/+/g;function ve(V,oe){return typeof V=="object"&&V!==null&&V.key!=null?O(""+V.key):oe.toString(36)}function Te(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(_e,_e):(V.status="pending",V.then(function(oe){V.status==="pending"&&(V.status="fulfilled",V.value=oe)},function(oe){V.status==="pending"&&(V.status="rejected",V.reason=oe)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function X(V,oe,de,ye,Y){var be=typeof V;(be==="undefined"||be==="boolean")&&(V=null);var B=!1;if(V===null)B=!0;else switch(be){case"bigint":case"string":case"number":B=!0;break;case"object":switch(V.$$typeof){case s:case e:B=!0;break;case b:return B=V._init,X(B(V._payload),oe,de,ye,Y)}}if(B)return Y=Y(V),B=ye===""?"."+ve(V,0):ye,he(Y)?(de="",B!=null&&(de=B.replace(E,"$&/")+"/"),X(Y,oe,de,"",function(Ee){return Ee})):Y!=null&&(I(Y)&&(Y=M(Y,de+(Y.key==null||V&&V.key===Y.key?"":(""+Y.key).replace(E,"$&/")+"/")+B)),oe.push(Y)),1;B=0;var ce=ye===""?".":ye+":";if(he(V))for(var K=0;K<V.length;K++)ye=V[K],be=ce+ve(ye,K),B+=X(ye,oe,de,be,Y);else if(K=R(V),typeof K=="function")for(V=K.call(V),K=0;!(ye=V.next()).done;)ye=ye.value,be=ce+ve(ye,K++),B+=X(ye,oe,de,be,Y);else if(be==="object"){if(typeof V.then=="function")return X(Te(V),oe,de,ye,Y);throw oe=String(V),Error("Objects are not valid as a React child (found: "+(oe==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":oe)+"). If you meant to render a collection of children, use an array instead.")}return B}function Z(V,oe,de){if(V==null)return V;var ye=[],Y=0;return X(V,ye,"","",function(be){return oe.call(de,be,Y++)}),ye}function Se(V){if(V._status===-1){var oe=V._result;oe=oe(),oe.then(function(de){(V._status===0||V._status===-1)&&(V._status=1,V._result=de)},function(de){(V._status===0||V._status===-1)&&(V._status=2,V._result=de)}),V._status===-1&&(V._status=0,V._result=oe)}if(V._status===1)return V._result.default;throw V._result}var Be=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var oe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(oe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},Pe={map:Z,forEach:function(V,oe,de){Z(V,function(){oe.apply(this,arguments)},de)},count:function(V){var oe=0;return Z(V,function(){oe++}),oe},toArray:function(V){return Z(V,function(oe){return oe})||[]},only:function(V){if(!I(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Je.Activity=w,Je.Children=Pe,Je.Component=W,Je.Fragment=t,Je.Profiler=o,Je.PureComponent=$,Je.StrictMode=a,Je.Suspense=x,Je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,Je.__COMPILER_RUNTIME={__proto__:null,c:function(V){return S.H.useMemoCache(V)}},Je.cache=function(V){return function(){return V.apply(null,arguments)}},Je.cacheSignal=function(){return null},Je.cloneElement=function(V,oe,de){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var ye=q({},V.props),Y=V.key;if(oe!=null)for(be in oe.key!==void 0&&(Y=""+oe.key),oe)!C.call(oe,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&oe.ref===void 0||(ye[be]=oe[be]);var be=arguments.length-2;if(be===1)ye.children=de;else if(1<be){for(var B=Array(be),ce=0;ce<be;ce++)B[ce]=arguments[ce+2];ye.children=B}return k(V.type,Y,ye)},Je.createContext=function(V){return V={$$typeof:d,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:u,_context:V},V},Je.createElement=function(V,oe,de){var ye,Y={},be=null;if(oe!=null)for(ye in oe.key!==void 0&&(be=""+oe.key),oe)C.call(oe,ye)&&ye!=="key"&&ye!=="__self"&&ye!=="__source"&&(Y[ye]=oe[ye]);var B=arguments.length-2;if(B===1)Y.children=de;else if(1<B){for(var ce=Array(B),K=0;K<B;K++)ce[K]=arguments[K+2];Y.children=ce}if(V&&V.defaultProps)for(ye in B=V.defaultProps,B)Y[ye]===void 0&&(Y[ye]=B[ye]);return k(V,be,Y)},Je.createRef=function(){return{current:null}},Je.forwardRef=function(V){return{$$typeof:p,render:V}},Je.isValidElement=I,Je.lazy=function(V){return{$$typeof:b,_payload:{_status:-1,_result:V},_init:Se}},Je.memo=function(V,oe){return{$$typeof:g,type:V,compare:oe===void 0?null:oe}},Je.startTransition=function(V){var oe=S.T,de={};S.T=de;try{var ye=V(),Y=S.S;Y!==null&&Y(de,ye),typeof ye=="object"&&ye!==null&&typeof ye.then=="function"&&ye.then(_e,Be)}catch(be){Be(be)}finally{oe!==null&&de.types!==null&&(oe.types=de.types),S.T=oe}},Je.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},Je.use=function(V){return S.H.use(V)},Je.useActionState=function(V,oe,de){return S.H.useActionState(V,oe,de)},Je.useCallback=function(V,oe){return S.H.useCallback(V,oe)},Je.useContext=function(V){return S.H.useContext(V)},Je.useDebugValue=function(){},Je.useDeferredValue=function(V,oe){return S.H.useDeferredValue(V,oe)},Je.useEffect=function(V,oe){return S.H.useEffect(V,oe)},Je.useEffectEvent=function(V){return S.H.useEffectEvent(V)},Je.useId=function(){return S.H.useId()},Je.useImperativeHandle=function(V,oe,de){return S.H.useImperativeHandle(V,oe,de)},Je.useInsertionEffect=function(V,oe){return S.H.useInsertionEffect(V,oe)},Je.useLayoutEffect=function(V,oe){return S.H.useLayoutEffect(V,oe)},Je.useMemo=function(V,oe){return S.H.useMemo(V,oe)},Je.useOptimistic=function(V,oe){return S.H.useOptimistic(V,oe)},Je.useReducer=function(V,oe,de){return S.H.useReducer(V,oe,de)},Je.useRef=function(V){return S.H.useRef(V)},Je.useState=function(V){return S.H.useState(V)},Je.useSyncExternalStore=function(V,oe,de){return S.H.useSyncExternalStore(V,oe,de)},Je.useTransition=function(){return S.H.useTransition()},Je.version="19.2.0",Je}var Av;function Qg(){return Av||(Av=1,Mp.exports=aE()),Mp.exports}var T=Qg();const vi=P_(T);var Vp={exports:{}},Wc={},Pp={exports:{}},Lp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rv;function iE(){return Rv||(Rv=1,(function(s){function e(X,Z){var Se=X.length;X.push(Z);e:for(;0<Se;){var Be=Se-1>>>1,Pe=X[Be];if(0<o(Pe,Z))X[Be]=Z,X[Se]=Pe,Se=Be;else break e}}function t(X){return X.length===0?null:X[0]}function a(X){if(X.length===0)return null;var Z=X[0],Se=X.pop();if(Se!==Z){X[0]=Se;e:for(var Be=0,Pe=X.length,V=Pe>>>1;Be<V;){var oe=2*(Be+1)-1,de=X[oe],ye=oe+1,Y=X[ye];if(0>o(de,Se))ye<Pe&&0>o(Y,de)?(X[Be]=Y,X[ye]=Se,Be=ye):(X[Be]=de,X[oe]=Se,Be=oe);else if(ye<Pe&&0>o(Y,Se))X[Be]=Y,X[ye]=Se,Be=ye;else break e}}return Z}function o(X,Z){var Se=X.sortIndex-Z.sortIndex;return Se!==0?Se:X.id-Z.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();s.unstable_now=function(){return d.now()-p}}var x=[],g=[],b=1,w=null,N=3,R=!1,D=!1,q=!1,L=!1,W=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;function z(X){for(var Z=t(g);Z!==null;){if(Z.callback===null)a(g);else if(Z.startTime<=X)a(g),Z.sortIndex=Z.expirationTime,e(x,Z);else break;Z=t(g)}}function he(X){if(q=!1,z(X),!D)if(t(x)!==null)D=!0,_e||(_e=!0,O());else{var Z=t(g);Z!==null&&Te(he,Z.startTime-X)}}var _e=!1,S=-1,C=5,k=-1;function M(){return L?!0:!(s.unstable_now()-k<C)}function I(){if(L=!1,_e){var X=s.unstable_now();k=X;var Z=!0;try{e:{D=!1,q&&(q=!1,re(S),S=-1),R=!0;var Se=N;try{t:{for(z(X),w=t(x);w!==null&&!(w.expirationTime>X&&M());){var Be=w.callback;if(typeof Be=="function"){w.callback=null,N=w.priorityLevel;var Pe=Be(w.expirationTime<=X);if(X=s.unstable_now(),typeof Pe=="function"){w.callback=Pe,z(X),Z=!0;break t}w===t(x)&&a(x),z(X)}else a(x);w=t(x)}if(w!==null)Z=!0;else{var V=t(g);V!==null&&Te(he,V.startTime-X),Z=!1}}break e}finally{w=null,N=Se,R=!1}Z=void 0}}finally{Z?O():_e=!1}}}var O;if(typeof $=="function")O=function(){$(I)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,ve=E.port2;E.port1.onmessage=I,O=function(){ve.postMessage(null)}}else O=function(){W(I,0)};function Te(X,Z){S=W(function(){X(s.unstable_now())},Z)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(X){X.callback=null},s.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<X?Math.floor(1e3/X):5},s.unstable_getCurrentPriorityLevel=function(){return N},s.unstable_next=function(X){switch(N){case 1:case 2:case 3:var Z=3;break;default:Z=N}var Se=N;N=Z;try{return X()}finally{N=Se}},s.unstable_requestPaint=function(){L=!0},s.unstable_runWithPriority=function(X,Z){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var Se=N;N=X;try{return Z()}finally{N=Se}},s.unstable_scheduleCallback=function(X,Z,Se){var Be=s.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?Be+Se:Be):Se=Be,X){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=Se+Pe,X={id:b++,callback:Z,priorityLevel:X,startTime:Se,expirationTime:Pe,sortIndex:-1},Se>Be?(X.sortIndex=Se,e(g,X),t(x)===null&&X===t(g)&&(q?(re(S),S=-1):q=!0,Te(he,Se-Be))):(X.sortIndex=Pe,e(x,X),D||R||(D=!0,_e||(_e=!0,O()))),X},s.unstable_shouldYield=M,s.unstable_wrapCallback=function(X){var Z=N;return function(){var Se=N;N=Z;try{return X.apply(this,arguments)}finally{N=Se}}}})(Lp)),Lp}var kv;function lE(){return kv||(kv=1,Pp.exports=iE()),Pp.exports}var Up={exports:{}},qn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iv;function oE(){if(Iv)return qn;Iv=1;var s=Qg();function e(x){var g="https://react.dev/errors/"+x;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+x+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function u(x,g,b){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:w==null?null:""+w,children:x,containerInfo:g,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(x,g){if(x==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return qn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,qn.createPortal=function(x,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return u(x,g,null,b)},qn.flushSync=function(x){var g=d.T,b=a.p;try{if(d.T=null,a.p=2,x)return x()}finally{d.T=g,a.p=b,a.d.f()}},qn.preconnect=function(x,g){typeof x=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,a.d.C(x,g))},qn.prefetchDNS=function(x){typeof x=="string"&&a.d.D(x)},qn.preinit=function(x,g){if(typeof x=="string"&&g&&typeof g.as=="string"){var b=g.as,w=p(b,g.crossOrigin),N=typeof g.integrity=="string"?g.integrity:void 0,R=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?a.d.S(x,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:w,integrity:N,fetchPriority:R}):b==="script"&&a.d.X(x,{crossOrigin:w,integrity:N,fetchPriority:R,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},qn.preinitModule=function(x,g){if(typeof x=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=p(g.as,g.crossOrigin);a.d.M(x,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&a.d.M(x)},qn.preload=function(x,g){if(typeof x=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,w=p(b,g.crossOrigin);a.d.L(x,b,{crossOrigin:w,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},qn.preloadModule=function(x,g){if(typeof x=="string")if(g){var b=p(g.as,g.crossOrigin);a.d.m(x,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else a.d.m(x)},qn.requestFormReset=function(x){a.d.r(x)},qn.unstable_batchedUpdates=function(x,g){return x(g)},qn.useFormState=function(x,g,b){return d.H.useFormState(x,g,b)},qn.useFormStatus=function(){return d.H.useHostTransitionStatus()},qn.version="19.2.0",qn}var Dv;function cE(){if(Dv)return Up.exports;Dv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Up.exports=oE(),Up.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ov;function uE(){if(Ov)return Wc;Ov=1;var s=lE(),e=Qg(),t=cE();function a(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,l=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(l=r.return),n=r.return;while(n)}return r.tag===3?l:null}function d(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function p(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function x(n){if(u(n)!==n)throw Error(a(188))}function g(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(a(188));return r!==n?null:n}for(var l=n,c=r;;){var f=l.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){l=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===l)return x(f),n;if(m===c)return x(f),r;m=m.sibling}throw Error(a(188))}if(l.return!==c.return)l=f,c=m;else{for(var v=!1,j=f.child;j;){if(j===l){v=!0,l=f,c=m;break}if(j===c){v=!0,c=f,l=m;break}j=j.sibling}if(!v){for(j=m.child;j;){if(j===l){v=!0,l=m,c=f;break}if(j===c){v=!0,c=m,l=f;break}j=j.sibling}if(!v)throw Error(a(189))}}if(l.alternate!==c)throw Error(a(190))}if(l.tag!==3)throw Error(a(188));return l.stateNode.current===l?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var w=Object.assign,N=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),D=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),re=Symbol.for("react.consumer"),$=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),_e=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function O(n){return n===null||typeof n!="object"?null:(n=I&&n[I]||n["@@iterator"],typeof n=="function"?n:null)}var E=Symbol.for("react.client.reference");function ve(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===E?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case q:return"Fragment";case W:return"Profiler";case L:return"StrictMode";case he:return"Suspense";case _e:return"SuspenseList";case k:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case D:return"Portal";case $:return n.displayName||"Context";case re:return(n._context.displayName||"Context")+".Consumer";case z:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case S:return r=n.displayName||null,r!==null?r:ve(n.type)||"Memo";case C:r=n._payload,n=n._init;try{return ve(n(r))}catch{}}return null}var Te=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Se={pending:!1,data:null,method:null,action:null},Be=[],Pe=-1;function V(n){return{current:n}}function oe(n){0>Pe||(n.current=Be[Pe],Be[Pe]=null,Pe--)}function de(n,r){Pe++,Be[Pe]=n.current,n.current=r}var ye=V(null),Y=V(null),be=V(null),B=V(null);function ce(n,r){switch(de(be,r),de(Y,n),de(ye,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?Qb(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=Qb(r),n=Xb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}oe(ye),de(ye,n)}function K(){oe(ye),oe(Y),oe(be)}function Ee(n){n.memoizedState!==null&&de(B,n);var r=ye.current,l=Xb(r,n.type);r!==l&&(de(Y,n),de(ye,l))}function F(n){Y.current===n&&(oe(ye),oe(Y)),B.current===n&&(oe(B),Kc._currentValue=Se)}var je,le;function ke(n){if(je===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);je=r&&r[1]||"",le=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+je+n+le}var Me=!1;function Xe(n,r){if(!n||Me)return"";Me=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ge=function(){throw Error()};if(Object.defineProperty(ge.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ge,[])}catch(ie){var se=ie}Reflect.construct(n,[],ge)}else{try{ge.call()}catch(ie){se=ie}n.call(ge.prototype)}}else{try{throw Error()}catch(ie){se=ie}(ge=n())&&typeof ge.catch=="function"&&ge.catch(function(){})}}catch(ie){if(ie&&se&&typeof ie.stack=="string")return[ie.stack,se.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),v=m[0],j=m[1];if(v&&j){var P=v.split(`
`),te=j.split(`
`);for(f=c=0;c<P.length&&!P[c].includes("DetermineComponentFrameRoot");)c++;for(;f<te.length&&!te[f].includes("DetermineComponentFrameRoot");)f++;if(c===P.length||f===te.length)for(c=P.length-1,f=te.length-1;1<=c&&0<=f&&P[c]!==te[f];)f--;for(;1<=c&&0<=f;c--,f--)if(P[c]!==te[f]){if(c!==1||f!==1)do if(c--,f--,0>f||P[c]!==te[f]){var ue=`
`+P[c].replace(" at new "," at ");return n.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",n.displayName)),ue}while(1<=c&&0<=f);break}}}finally{Me=!1,Error.prepareStackTrace=l}return(l=n?n.displayName||n.name:"")?ke(l):""}function nt(n,r){switch(n.tag){case 26:case 27:case 5:return ke(n.type);case 16:return ke("Lazy");case 13:return n.child!==r&&r!==null?ke("Suspense Fallback"):ke("Suspense");case 19:return ke("SuspenseList");case 0:case 15:return Xe(n.type,!1);case 11:return Xe(n.type.render,!1);case 1:return Xe(n.type,!0);case 31:return ke("Activity");default:return""}}function xt(n){try{var r="",l=null;do r+=nt(n,l),l=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var jt=Object.prototype.hasOwnProperty,zt=s.unstable_scheduleCallback,ws=s.unstable_cancelCallback,ir=s.unstable_shouldYield,In=s.unstable_requestPaint,Bt=s.unstable_now,_s=s.unstable_getCurrentPriorityLevel,Ns=s.unstable_ImmediatePriority,Bs=s.unstable_UserBlockingPriority,Bn=s.unstable_NormalPriority,gt=s.unstable_LowPriority,Qe=s.unstable_IdlePriority,Ct=s.log,Zt=s.unstable_setDisableYieldValue,Dt=null,vt=null;function Xt(n){if(typeof Ct=="function"&&Zt(n),vt&&typeof vt.setStrictMode=="function")try{vt.setStrictMode(Dt,n)}catch{}}var wt=Math.clz32?Math.clz32:Ts,an=Math.log,as=Math.LN2;function Ts(n){return n>>>=0,n===0?32:31-(an(n)/as|0)|0}var Tn=256,js=262144,At=4194304;function Hn(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function is(n,r,l){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,v=n.pingedLanes;n=n.warmLanes;var j=c&134217727;return j!==0?(c=j&~m,c!==0?f=Hn(c):(v&=j,v!==0?f=Hn(v):l||(l=j&~n,l!==0&&(f=Hn(l))))):(j=c&~m,j!==0?f=Hn(j):v!==0?f=Hn(v):l||(l=c&~n,l!==0&&(f=Hn(l)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,l=r&-r,m>=l||m===32&&(l&4194048)!==0)?r:f}function Wn(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function Hi(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ba(){var n=At;return At<<=1,(At&62914560)===0&&(At=4194304),n}function Fn(n){for(var r=[],l=0;31>l;l++)r.push(n);return r}function ne(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function pe(n,r,l,c,f,m){var v=n.pendingLanes;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=l,n.entangledLanes&=l,n.errorRecoveryDisabledLanes&=l,n.shellSuspendCounter=0;var j=n.entanglements,P=n.expirationTimes,te=n.hiddenUpdates;for(l=v&~l;0<l;){var ue=31-wt(l),ge=1<<ue;j[ue]=0,P[ue]=-1;var se=te[ue];if(se!==null)for(te[ue]=null,ue=0;ue<se.length;ue++){var ie=se[ue];ie!==null&&(ie.lane&=-536870913)}l&=~ge}c!==0&&Ce(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(v&~r))}function Ce(n,r,l){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-wt(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|l&261930}function U(n,r){var l=n.entangledLanes|=r;for(n=n.entanglements;l;){var c=31-wt(l),f=1<<c;f&r|n[c]&r&&(n[c]|=r),l&=~f}}function Q(n,r){var l=r&-r;return l=(l&42)!==0?1:we(l),(l&(n.suspendedLanes|r))!==0?0:l}function we(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Ne(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ue(){var n=Z.p;return n!==0?n:(n=window.event,n===void 0?32:bv(n.type))}function Le(n,r){var l=Z.p;try{return Z.p=n,r()}finally{Z.p=l}}var Ke=Math.random().toString(36).slice(2),tt="__reactFiber$"+Ke,it="__reactProps$"+Ke,$t="__reactContainer$"+Ke,ln="__reactEvents$"+Ke,Kt="__reactListeners$"+Ke,Jn="__reactHandles$"+Ke,sa="__reactResources$"+Ke,Cn="__reactMarker$"+Ke;function kl(n){delete n[tt],delete n[it],delete n[ln],delete n[Kt],delete n[Jn]}function Er(n){var r=n[tt];if(r)return r;for(var l=n.parentNode;l;){if(r=l[$t]||l[tt]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(n=sv(n);n!==null;){if(l=n[tt])return l;n=sv(n)}return r}n=l,l=n.parentNode}return null}function Hs(n){if(n=n[tt]||n[$t]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function Es(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(a(33))}function Sr(n){var r=n[sa];return r||(r=n[sa]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function pn(n){n[Cn]=!0}var Zo=new Set,ec={};function Cr(n,r){Ar(n,r),Ar(n+"Capture",r)}function Ar(n,r){for(ec[n]=r,n=0;n<r.length;n++)Zo.add(r[n])}var tc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),nc={},sc={};function Qu(n){return jt.call(sc,n)?!0:jt.call(nc,n)?!1:tc.test(n)?sc[n]=!0:(nc[n]=!0,!1)}function Il(n,r,l){if(Qu(r))if(l===null)n.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+l)}}function Ss(n,r,l){if(l===null)n.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+l)}}function gn(n,r,l,c){if(c===null)n.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttributeNS(r,l,""+c)}}function An(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ha(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function rc(n,r,l){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(v){l=""+v,m.call(this,v)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return l},setValue:function(v){l=""+v},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Rt(n){if(!n._valueTracker){var r=Ha(n)?"checked":"value";n._valueTracker=rc(n,r,""+n[r])}}function Fi(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var l=r.getValue(),c="";return n&&(c=Ha(n)?n.checked?"true":"false":n.value),n=c,n!==l?(r.setValue(n),!0):!1}function Rr(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var qi=/[\n"\\]/g;function ls(n){return n.replace(qi,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Dl(n,r,l,c,f,m,v,j){n.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?n.type=v:n.removeAttribute("type"),r!=null?v==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+An(r)):n.value!==""+An(r)&&(n.value=""+An(r)):v!=="submit"&&v!=="reset"||n.removeAttribute("value"),r!=null?ac(n,v,An(r)):l!=null?ac(n,v,An(l)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?n.name=""+An(j):n.removeAttribute("name")}function Xu(n,r,l,c,f,m,v,j){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||l!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){Rt(n);return}l=l!=null?""+An(l):"",r=r!=null?""+An(r):l,j||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=j?n.checked:!!c,n.defaultChecked=!!c,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(n.name=v),Rt(n)}function ac(n,r,l){r==="number"&&Rr(n.ownerDocument)===n||n.defaultValue===""+l||(n.defaultValue=""+l)}function Fa(n,r,l,c){if(n=n.options,r){r={};for(var f=0;f<l.length;f++)r["$"+l[f]]=!0;for(l=0;l<n.length;l++)f=r.hasOwnProperty("$"+n[l].value),n[l].selected!==f&&(n[l].selected=f),f&&c&&(n[l].defaultSelected=!0)}else{for(l=""+An(l),r=null,f=0;f<n.length;f++){if(n[f].value===l){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function Wu(n,r,l){if(r!=null&&(r=""+An(r),r!==n.value&&(n.value=r),l==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=l!=null?""+An(l):""}function qa(n,r,l,c){if(r==null){if(c!=null){if(l!=null)throw Error(a(92));if(Te(c)){if(1<c.length)throw Error(a(93));c=c[0]}l=c}l==null&&(l=""),r=l}l=An(r),n.defaultValue=l,c=n.textContent,c===l&&c!==""&&c!==null&&(n.value=c),Rt(n)}function os(n,r){if(r){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=r;return}}n.textContent=r}var Ju=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ic(n,r,l){var c=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,l):typeof l!="number"||l===0||Ju.has(r)?r==="float"?n.cssFloat=l:n[r]=(""+l).trim():n[r]=l+"px"}function lc(n,r,l){if(r!=null&&typeof r!="object")throw Error(a(62));if(n=n.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&l[f]!==c&&ic(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&ic(n,m,r[m])}function Ol(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$a=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ml(n){return $a.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function lr(){}var oc=null;function Fs(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ka=null,kr=null;function $i(n){var r=Hs(n);if(r&&(n=r.stateNode)){var l=n[it]||null;e:switch(n=r.stateNode,r.type){case"input":if(Dl(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+ls(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var c=l[r];if(c!==n&&c.form===n.form){var f=c[it]||null;if(!f)throw Error(a(90));Dl(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<l.length;r++)c=l[r],c.form===n.form&&Fi(c)}break e;case"textarea":Wu(n,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&Fa(n,!!l.multiple,r,!1)}}}var Vl=!1;function Ga(n,r,l){if(Vl)return n(r,l);Vl=!0;try{var c=n(r);return c}finally{if(Vl=!1,(Ka!==null||kr!==null)&&(Kd(),Ka&&(r=Ka,n=kr,kr=Ka=null,$i(r),n)))for(r=0;r<n.length;r++)$i(n[r])}}function or(n,r){var l=n.stateNode;if(l===null)return null;var c=l[it]||null;if(c===null)return null;l=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(a(231,r,typeof l));return l}var qs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ki=!1;if(qs)try{var Ot={};Object.defineProperty(Ot,"passive",{get:function(){Ki=!0}}),window.addEventListener("test",Ot,Ot),window.removeEventListener("test",Ot,Ot)}catch{Ki=!1}var Ir=null,cc=null,Gi=null;function uc(){if(Gi)return Gi;var n,r=cc,l=r.length,c,f="value"in Ir?Ir.value:Ir.textContent,m=f.length;for(n=0;n<l&&r[n]===f[n];n++);var v=l-n;for(c=1;c<=v&&r[l-c]===f[m-c];c++);return Gi=f.slice(n,1<c?1-c:void 0)}function Yi(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function ra(){return!0}function cr(){return!1}function Dn(n){function r(l,c,f,m,v){this._reactName=l,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var j in n)n.hasOwnProperty(j)&&(l=n[j],this[j]=l?l(m):m[j]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?ra:cr,this.isPropagationStopped=cr,this}return w(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ra)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ra)},persist:function(){},isPersistent:ra}),r}var aa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dr=Dn(aa),Ya=w({},aa,{view:0,detail:0}),dc=Dn(Ya),Qa,Pl,Or,Ll=w({},Ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xa,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Or&&(Or&&n.type==="mousemove"?(Qa=n.screenX-Or.screenX,Pl=n.screenY-Or.screenY):Pl=Qa=0,Or=n),Qa)},movementY:function(n){return"movementY"in n?n.movementY:Pl}}),hc=Dn(Ll),Qi=w({},Ll,{dataTransfer:0}),ed=Dn(Qi),td=w({},Ya,{relatedTarget:0}),Xi=Dn(td),fc=w({},aa,{animationName:0,elapsedTime:0,pseudoElement:0}),nd=Dn(fc),Ul=w({},aa,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),sd=Dn(Ul),rd=w({},aa,{data:0}),Mr=Dn(rd),ad={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},id={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ld={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function od(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=ld[n])?!!r[n]:!1}function Xa(){return od}var Zn=w({},Ya,{key:function(n){if(n.key){var r=ad[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Yi(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?id[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xa,charCode:function(n){return n.type==="keypress"?Yi(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Yi(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),cd=Dn(Zn),ud=w({},Ll,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ia=Dn(ud),h=w({},Ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xa}),y=Dn(h),_=w({},aa,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=Dn(_),J=w({},Ll,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ae=Dn(J),Re=w({},aa,{newState:0,oldState:0}),st=Dn(Re),on=[9,13,27,32],_t=qs&&"CompositionEvent"in window,Gt=null;qs&&"documentMode"in document&&(Gt=document.documentMode);var $s=qs&&"TextEvent"in window&&!Gt,Vr=qs&&(!_t||Gt&&8<Gt&&11>=Gt),ur=" ",dr=!1;function Wi(n,r){switch(n){case"keyup":return on.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zl(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Bl=!1;function ST(n,r){switch(n){case"compositionend":return zl(r);case"keypress":return r.which!==32?null:(dr=!0,ur);case"textInput":return n=r.data,n===ur&&dr?null:n;default:return null}}function CT(n,r){if(Bl)return n==="compositionend"||!_t&&Wi(n,r)?(n=uc(),Gi=cc=Ir=null,Bl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Vr&&r.locale!=="ko"?null:r.data;default:return null}}var AT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ix(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!AT[n.type]:r==="textarea"}function lx(n,r,l,c){Ka?kr?kr.push(c):kr=[c]:Ka=c,r=Zd(r,"onChange"),0<r.length&&(l=new Dr("onChange","change",null,l,c),n.push({event:l,listeners:r}))}var mc=null,pc=null;function RT(n){Fb(n,0)}function dd(n){var r=Es(n);if(Fi(r))return n}function ox(n,r){if(n==="change")return r}var cx=!1;if(qs){var Bf;if(qs){var Hf="oninput"in document;if(!Hf){var ux=document.createElement("div");ux.setAttribute("oninput","return;"),Hf=typeof ux.oninput=="function"}Bf=Hf}else Bf=!1;cx=Bf&&(!document.documentMode||9<document.documentMode)}function dx(){mc&&(mc.detachEvent("onpropertychange",hx),pc=mc=null)}function hx(n){if(n.propertyName==="value"&&dd(pc)){var r=[];lx(r,pc,n,Fs(n)),Ga(RT,r)}}function kT(n,r,l){n==="focusin"?(dx(),mc=r,pc=l,mc.attachEvent("onpropertychange",hx)):n==="focusout"&&dx()}function IT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return dd(pc)}function DT(n,r){if(n==="click")return dd(r)}function OT(n,r){if(n==="input"||n==="change")return dd(r)}function MT(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Cs=typeof Object.is=="function"?Object.is:MT;function gc(n,r){if(Cs(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var l=Object.keys(n),c=Object.keys(r);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var f=l[c];if(!jt.call(r,f)||!Cs(n[f],r[f]))return!1}return!0}function fx(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function mx(n,r){var l=fx(n);n=0;for(var c;l;){if(l.nodeType===3){if(c=n+l.textContent.length,n<=r&&c>=r)return{node:l,offset:r-n};n=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=fx(l)}}function px(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?px(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function gx(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=Rr(n.document);r instanceof n.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)n=r.contentWindow;else break;r=Rr(n.document)}return r}function Ff(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var VT=qs&&"documentMode"in document&&11>=document.documentMode,Hl=null,qf=null,xc=null,$f=!1;function xx(n,r,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;$f||Hl==null||Hl!==Rr(c)||(c=Hl,"selectionStart"in c&&Ff(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),xc&&gc(xc,c)||(xc=c,c=Zd(qf,"onSelect"),0<c.length&&(r=new Dr("onSelect","select",null,r,l),n.push({event:r,listeners:c}),r.target=Hl)))}function Ji(n,r){var l={};return l[n.toLowerCase()]=r.toLowerCase(),l["Webkit"+n]="webkit"+r,l["Moz"+n]="moz"+r,l}var Fl={animationend:Ji("Animation","AnimationEnd"),animationiteration:Ji("Animation","AnimationIteration"),animationstart:Ji("Animation","AnimationStart"),transitionrun:Ji("Transition","TransitionRun"),transitionstart:Ji("Transition","TransitionStart"),transitioncancel:Ji("Transition","TransitionCancel"),transitionend:Ji("Transition","TransitionEnd")},Kf={},yx={};qs&&(yx=document.createElement("div").style,"AnimationEvent"in window||(delete Fl.animationend.animation,delete Fl.animationiteration.animation,delete Fl.animationstart.animation),"TransitionEvent"in window||delete Fl.transitionend.transition);function Zi(n){if(Kf[n])return Kf[n];if(!Fl[n])return n;var r=Fl[n],l;for(l in r)if(r.hasOwnProperty(l)&&l in yx)return Kf[n]=r[l];return n}var bx=Zi("animationend"),vx=Zi("animationiteration"),wx=Zi("animationstart"),PT=Zi("transitionrun"),LT=Zi("transitionstart"),UT=Zi("transitioncancel"),_x=Zi("transitionend"),Nx=new Map,Gf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Gf.push("scrollEnd");function hr(n,r){Nx.set(n,r),Cr(r,[n])}var hd=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Ks=[],ql=0,Yf=0;function fd(){for(var n=ql,r=Yf=ql=0;r<n;){var l=Ks[r];Ks[r++]=null;var c=Ks[r];Ks[r++]=null;var f=Ks[r];Ks[r++]=null;var m=Ks[r];if(Ks[r++]=null,c!==null&&f!==null){var v=c.pending;v===null?f.next=f:(f.next=v.next,v.next=f),c.pending=f}m!==0&&Tx(l,f,m)}}function md(n,r,l,c){Ks[ql++]=n,Ks[ql++]=r,Ks[ql++]=l,Ks[ql++]=c,Yf|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Qf(n,r,l,c){return md(n,r,l,c),pd(n)}function el(n,r){return md(n,null,null,r),pd(n)}function Tx(n,r,l){n.lanes|=l;var c=n.alternate;c!==null&&(c.lanes|=l);for(var f=!1,m=n.return;m!==null;)m.childLanes|=l,c=m.alternate,c!==null&&(c.childLanes|=l),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-wt(l),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=l|536870912),m):null}function pd(n){if(50<Uc)throw Uc=0,rp=null,Error(a(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var $l={};function zT(n,r,l,c){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function As(n,r,l,c){return new zT(n,r,l,c)}function Xf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function la(n,r){var l=n.alternate;return l===null?(l=As(n.tag,r,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=r,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&65011712,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,r=n.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l.refCleanup=n.refCleanup,l}function jx(n,r){n.flags&=65011714;var l=n.alternate;return l===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,r=l.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function gd(n,r,l,c,f,m){var v=0;if(c=n,typeof n=="function")Xf(n)&&(v=1);else if(typeof n=="string")v=$j(n,l,ye.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case k:return n=As(31,l,r,f),n.elementType=k,n.lanes=m,n;case q:return tl(l.children,f,m,r);case L:v=8,f|=24;break;case W:return n=As(12,l,r,f|2),n.elementType=W,n.lanes=m,n;case he:return n=As(13,l,r,f),n.elementType=he,n.lanes=m,n;case _e:return n=As(19,l,r,f),n.elementType=_e,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case $:v=10;break e;case re:v=9;break e;case z:v=11;break e;case S:v=14;break e;case C:v=16,c=null;break e}v=29,l=Error(a(130,n===null?"null":typeof n,"")),c=null}return r=As(v,l,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function tl(n,r,l,c){return n=As(7,n,c,r),n.lanes=l,n}function Wf(n,r,l){return n=As(6,n,null,r),n.lanes=l,n}function Ex(n){var r=As(18,null,null,0);return r.stateNode=n,r}function Jf(n,r,l){return r=As(4,n.children!==null?n.children:[],n.key,r),r.lanes=l,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var Sx=new WeakMap;function Gs(n,r){if(typeof n=="object"&&n!==null){var l=Sx.get(n);return l!==void 0?l:(r={value:n,source:r,stack:xt(r)},Sx.set(n,r),r)}return{value:n,source:r,stack:xt(r)}}var Kl=[],Gl=0,xd=null,yc=0,Ys=[],Qs=0,Wa=null,Pr=1,Lr="";function oa(n,r){Kl[Gl++]=yc,Kl[Gl++]=xd,xd=n,yc=r}function Cx(n,r,l){Ys[Qs++]=Pr,Ys[Qs++]=Lr,Ys[Qs++]=Wa,Wa=n;var c=Pr;n=Lr;var f=32-wt(c)-1;c&=~(1<<f),l+=1;var m=32-wt(r)+f;if(30<m){var v=f-f%5;m=(c&(1<<v)-1).toString(32),c>>=v,f-=v,Pr=1<<32-wt(r)+f|l<<f|c,Lr=m+n}else Pr=1<<m|l<<f|c,Lr=n}function Zf(n){n.return!==null&&(oa(n,1),Cx(n,1,0))}function em(n){for(;n===xd;)xd=Kl[--Gl],Kl[Gl]=null,yc=Kl[--Gl],Kl[Gl]=null;for(;n===Wa;)Wa=Ys[--Qs],Ys[Qs]=null,Lr=Ys[--Qs],Ys[Qs]=null,Pr=Ys[--Qs],Ys[Qs]=null}function Ax(n,r){Ys[Qs++]=Pr,Ys[Qs++]=Lr,Ys[Qs++]=Wa,Pr=r.id,Lr=r.overflow,Wa=n}var On=null,Ht=null,mt=!1,Ja=null,Xs=!1,tm=Error(a(519));function Za(n){var r=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bc(Gs(r,n)),tm}function Rx(n){var r=n.stateNode,l=n.type,c=n.memoizedProps;switch(r[tt]=n,r[it]=c,l){case"dialog":ot("cancel",r),ot("close",r);break;case"iframe":case"object":case"embed":ot("load",r);break;case"video":case"audio":for(l=0;l<Bc.length;l++)ot(Bc[l],r);break;case"source":ot("error",r);break;case"img":case"image":case"link":ot("error",r),ot("load",r);break;case"details":ot("toggle",r);break;case"input":ot("invalid",r),Xu(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ot("invalid",r);break;case"textarea":ot("invalid",r),qa(r,c.value,c.defaultValue,c.children)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||c.suppressHydrationWarning===!0||Gb(r.textContent,l)?(c.popover!=null&&(ot("beforetoggle",r),ot("toggle",r)),c.onScroll!=null&&ot("scroll",r),c.onScrollEnd!=null&&ot("scrollend",r),c.onClick!=null&&(r.onclick=lr),r=!0):r=!1,r||Za(n,!0)}function kx(n){for(On=n.return;On;)switch(On.tag){case 5:case 31:case 13:Xs=!1;return;case 27:case 3:Xs=!0;return;default:On=On.return}}function Yl(n){if(n!==On)return!1;if(!mt)return kx(n),mt=!0,!1;var r=n.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=n.type,l=!(l!=="form"&&l!=="button")||bp(n.type,n.memoizedProps)),l=!l),l&&Ht&&Za(n),kx(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Ht=nv(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Ht=nv(n)}else r===27?(r=Ht,fi(n.type)?(n=Tp,Tp=null,Ht=n):Ht=r):Ht=On?Js(n.stateNode.nextSibling):null;return!0}function nl(){Ht=On=null,mt=!1}function nm(){var n=Ja;return n!==null&&(hs===null?hs=n:hs.push.apply(hs,n),Ja=null),n}function bc(n){Ja===null?Ja=[n]:Ja.push(n)}var sm=V(null),sl=null,ca=null;function ei(n,r,l){de(sm,r._currentValue),r._currentValue=l}function ua(n){n._currentValue=sm.current,oe(sm)}function rm(n,r,l){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===l)break;n=n.return}}function am(n,r,l,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var v=f.child;m=m.firstContext;e:for(;m!==null;){var j=m;m=f;for(var P=0;P<r.length;P++)if(j.context===r[P]){m.lanes|=l,j=m.alternate,j!==null&&(j.lanes|=l),rm(m.return,l,n),c||(v=null);break e}m=j.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(a(341));v.lanes|=l,m=v.alternate,m!==null&&(m.lanes|=l),rm(v,l,n),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===n){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function Ql(n,r,l,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(a(387));if(v=v.memoizedProps,v!==null){var j=f.type;Cs(f.pendingProps.value,v.value)||(n!==null?n.push(j):n=[j])}}else if(f===B.current){if(v=f.alternate,v===null)throw Error(a(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Kc):n=[Kc])}f=f.return}n!==null&&am(r,n,l,c),r.flags|=262144}function yd(n){for(n=n.firstContext;n!==null;){if(!Cs(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function rl(n){sl=n,ca=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Mn(n){return Ix(sl,n)}function bd(n,r){return sl===null&&rl(n),Ix(n,r)}function Ix(n,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},ca===null){if(n===null)throw Error(a(308));ca=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else ca=ca.next=r;return l}var BT=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(l,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(l){return l()})}},HT=s.unstable_scheduleCallback,FT=s.unstable_NormalPriority,xn={$$typeof:$,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function im(){return{controller:new BT,data:new Map,refCount:0}}function vc(n){n.refCount--,n.refCount===0&&HT(FT,function(){n.controller.abort()})}var wc=null,lm=0,Xl=0,Wl=null;function qT(n,r){if(wc===null){var l=wc=[];lm=0,Xl=up(),Wl={status:"pending",value:void 0,then:function(c){l.push(c)}}}return lm++,r.then(Dx,Dx),r}function Dx(){if(--lm===0&&wc!==null){Wl!==null&&(Wl.status="fulfilled");var n=wc;wc=null,Xl=0,Wl=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function $T(n,r){var l=[],c={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<l.length;f++)(0,l[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),c}var Ox=X.S;X.S=function(n,r){xb=Bt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&qT(n,r),Ox!==null&&Ox(n,r)};var al=V(null);function om(){var n=al.current;return n!==null?n:Lt.pooledCache}function vd(n,r){r===null?de(al,al.current):de(al,r.pool)}function Mx(){var n=om();return n===null?null:{parent:xn._currentValue,pool:n}}var Jl=Error(a(460)),cm=Error(a(474)),wd=Error(a(542)),_d={then:function(){}};function Vx(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Px(n,r,l){switch(l=n[l],l===void 0?n.push(r):l!==r&&(r.then(lr,lr),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,Ux(n),n;default:if(typeof r.status=="string")r.then(lr,lr);else{if(n=Lt,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,Ux(n),n}throw ll=r,Jl}}function il(n){try{var r=n._init;return r(n._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(ll=l,Jl):l}}var ll=null;function Lx(){if(ll===null)throw Error(a(459));var n=ll;return ll=null,n}function Ux(n){if(n===Jl||n===wd)throw Error(a(483))}var Zl=null,_c=0;function Nd(n){var r=_c;return _c+=1,Zl===null&&(Zl=[]),Px(Zl,n,r)}function Nc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function Td(n,r){throw r.$$typeof===N?Error(a(525)):(n=Object.prototype.toString.call(r),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function zx(n){function r(G,H){if(n){var ee=G.deletions;ee===null?(G.deletions=[H],G.flags|=16):ee.push(H)}}function l(G,H){if(!n)return null;for(;H!==null;)r(G,H),H=H.sibling;return null}function c(G){for(var H=new Map;G!==null;)G.key!==null?H.set(G.key,G):H.set(G.index,G),G=G.sibling;return H}function f(G,H){return G=la(G,H),G.index=0,G.sibling=null,G}function m(G,H,ee){return G.index=ee,n?(ee=G.alternate,ee!==null?(ee=ee.index,ee<H?(G.flags|=67108866,H):ee):(G.flags|=67108866,H)):(G.flags|=1048576,H)}function v(G){return n&&G.alternate===null&&(G.flags|=67108866),G}function j(G,H,ee,fe){return H===null||H.tag!==6?(H=Wf(ee,G.mode,fe),H.return=G,H):(H=f(H,ee),H.return=G,H)}function P(G,H,ee,fe){var He=ee.type;return He===q?ue(G,H,ee.props.children,fe,ee.key):H!==null&&(H.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===C&&il(He)===H.type)?(H=f(H,ee.props),Nc(H,ee),H.return=G,H):(H=gd(ee.type,ee.key,ee.props,null,G.mode,fe),Nc(H,ee),H.return=G,H)}function te(G,H,ee,fe){return H===null||H.tag!==4||H.stateNode.containerInfo!==ee.containerInfo||H.stateNode.implementation!==ee.implementation?(H=Jf(ee,G.mode,fe),H.return=G,H):(H=f(H,ee.children||[]),H.return=G,H)}function ue(G,H,ee,fe,He){return H===null||H.tag!==7?(H=tl(ee,G.mode,fe,He),H.return=G,H):(H=f(H,ee),H.return=G,H)}function ge(G,H,ee){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Wf(""+H,G.mode,ee),H.return=G,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case R:return ee=gd(H.type,H.key,H.props,null,G.mode,ee),Nc(ee,H),ee.return=G,ee;case D:return H=Jf(H,G.mode,ee),H.return=G,H;case C:return H=il(H),ge(G,H,ee)}if(Te(H)||O(H))return H=tl(H,G.mode,ee,null),H.return=G,H;if(typeof H.then=="function")return ge(G,Nd(H),ee);if(H.$$typeof===$)return ge(G,bd(G,H),ee);Td(G,H)}return null}function se(G,H,ee,fe){var He=H!==null?H.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return He!==null?null:j(G,H,""+ee,fe);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case R:return ee.key===He?P(G,H,ee,fe):null;case D:return ee.key===He?te(G,H,ee,fe):null;case C:return ee=il(ee),se(G,H,ee,fe)}if(Te(ee)||O(ee))return He!==null?null:ue(G,H,ee,fe,null);if(typeof ee.then=="function")return se(G,H,Nd(ee),fe);if(ee.$$typeof===$)return se(G,H,bd(G,ee),fe);Td(G,ee)}return null}function ie(G,H,ee,fe,He){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return G=G.get(ee)||null,j(H,G,""+fe,He);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case R:return G=G.get(fe.key===null?ee:fe.key)||null,P(H,G,fe,He);case D:return G=G.get(fe.key===null?ee:fe.key)||null,te(H,G,fe,He);case C:return fe=il(fe),ie(G,H,ee,fe,He)}if(Te(fe)||O(fe))return G=G.get(ee)||null,ue(H,G,fe,He,null);if(typeof fe.then=="function")return ie(G,H,ee,Nd(fe),He);if(fe.$$typeof===$)return ie(G,H,ee,bd(H,fe),He);Td(H,fe)}return null}function Ve(G,H,ee,fe){for(var He=null,yt=null,ze=H,at=H=0,ut=null;ze!==null&&at<ee.length;at++){ze.index>at?(ut=ze,ze=null):ut=ze.sibling;var bt=se(G,ze,ee[at],fe);if(bt===null){ze===null&&(ze=ut);break}n&&ze&&bt.alternate===null&&r(G,ze),H=m(bt,H,at),yt===null?He=bt:yt.sibling=bt,yt=bt,ze=ut}if(at===ee.length)return l(G,ze),mt&&oa(G,at),He;if(ze===null){for(;at<ee.length;at++)ze=ge(G,ee[at],fe),ze!==null&&(H=m(ze,H,at),yt===null?He=ze:yt.sibling=ze,yt=ze);return mt&&oa(G,at),He}for(ze=c(ze);at<ee.length;at++)ut=ie(ze,G,at,ee[at],fe),ut!==null&&(n&&ut.alternate!==null&&ze.delete(ut.key===null?at:ut.key),H=m(ut,H,at),yt===null?He=ut:yt.sibling=ut,yt=ut);return n&&ze.forEach(function(yi){return r(G,yi)}),mt&&oa(G,at),He}function $e(G,H,ee,fe){if(ee==null)throw Error(a(151));for(var He=null,yt=null,ze=H,at=H=0,ut=null,bt=ee.next();ze!==null&&!bt.done;at++,bt=ee.next()){ze.index>at?(ut=ze,ze=null):ut=ze.sibling;var yi=se(G,ze,bt.value,fe);if(yi===null){ze===null&&(ze=ut);break}n&&ze&&yi.alternate===null&&r(G,ze),H=m(yi,H,at),yt===null?He=yi:yt.sibling=yi,yt=yi,ze=ut}if(bt.done)return l(G,ze),mt&&oa(G,at),He;if(ze===null){for(;!bt.done;at++,bt=ee.next())bt=ge(G,bt.value,fe),bt!==null&&(H=m(bt,H,at),yt===null?He=bt:yt.sibling=bt,yt=bt);return mt&&oa(G,at),He}for(ze=c(ze);!bt.done;at++,bt=ee.next())bt=ie(ze,G,at,bt.value,fe),bt!==null&&(n&&bt.alternate!==null&&ze.delete(bt.key===null?at:bt.key),H=m(bt,H,at),yt===null?He=bt:yt.sibling=bt,yt=bt);return n&&ze.forEach(function(nE){return r(G,nE)}),mt&&oa(G,at),He}function Pt(G,H,ee,fe){if(typeof ee=="object"&&ee!==null&&ee.type===q&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case R:e:{for(var He=ee.key;H!==null;){if(H.key===He){if(He=ee.type,He===q){if(H.tag===7){l(G,H.sibling),fe=f(H,ee.props.children),fe.return=G,G=fe;break e}}else if(H.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===C&&il(He)===H.type){l(G,H.sibling),fe=f(H,ee.props),Nc(fe,ee),fe.return=G,G=fe;break e}l(G,H);break}else r(G,H);H=H.sibling}ee.type===q?(fe=tl(ee.props.children,G.mode,fe,ee.key),fe.return=G,G=fe):(fe=gd(ee.type,ee.key,ee.props,null,G.mode,fe),Nc(fe,ee),fe.return=G,G=fe)}return v(G);case D:e:{for(He=ee.key;H!==null;){if(H.key===He)if(H.tag===4&&H.stateNode.containerInfo===ee.containerInfo&&H.stateNode.implementation===ee.implementation){l(G,H.sibling),fe=f(H,ee.children||[]),fe.return=G,G=fe;break e}else{l(G,H);break}else r(G,H);H=H.sibling}fe=Jf(ee,G.mode,fe),fe.return=G,G=fe}return v(G);case C:return ee=il(ee),Pt(G,H,ee,fe)}if(Te(ee))return Ve(G,H,ee,fe);if(O(ee)){if(He=O(ee),typeof He!="function")throw Error(a(150));return ee=He.call(ee),$e(G,H,ee,fe)}if(typeof ee.then=="function")return Pt(G,H,Nd(ee),fe);if(ee.$$typeof===$)return Pt(G,H,bd(G,ee),fe);Td(G,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,H!==null&&H.tag===6?(l(G,H.sibling),fe=f(H,ee),fe.return=G,G=fe):(l(G,H),fe=Wf(ee,G.mode,fe),fe.return=G,G=fe),v(G)):l(G,H)}return function(G,H,ee,fe){try{_c=0;var He=Pt(G,H,ee,fe);return Zl=null,He}catch(ze){if(ze===Jl||ze===wd)throw ze;var yt=As(29,ze,null,G.mode);return yt.lanes=fe,yt.return=G,yt}finally{}}}var ol=zx(!0),Bx=zx(!1),ti=!1;function um(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function dm(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function ni(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function si(n,r,l){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(Nt&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=pd(n),Tx(n,null,l),r}return md(n,c,r,l),pd(n)}function Tc(n,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,l|=c,r.lanes=l,U(n,l)}}function hm(n,r){var l=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var f=null,m=null;if(l=l.firstBaseUpdate,l!==null){do{var v={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};m===null?f=m=v:m=m.next=v,l=l.next}while(l!==null);m===null?f=m=r:m=m.next=r}else f=m=r;l={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=r:n.next=r,l.lastBaseUpdate=r}var fm=!1;function jc(){if(fm){var n=Wl;if(n!==null)throw n}}function Ec(n,r,l,c){fm=!1;var f=n.updateQueue;ti=!1;var m=f.firstBaseUpdate,v=f.lastBaseUpdate,j=f.shared.pending;if(j!==null){f.shared.pending=null;var P=j,te=P.next;P.next=null,v===null?m=te:v.next=te,v=P;var ue=n.alternate;ue!==null&&(ue=ue.updateQueue,j=ue.lastBaseUpdate,j!==v&&(j===null?ue.firstBaseUpdate=te:j.next=te,ue.lastBaseUpdate=P))}if(m!==null){var ge=f.baseState;v=0,ue=te=P=null,j=m;do{var se=j.lane&-536870913,ie=se!==j.lane;if(ie?(ct&se)===se:(c&se)===se){se!==0&&se===Xl&&(fm=!0),ue!==null&&(ue=ue.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var Ve=n,$e=j;se=r;var Pt=l;switch($e.tag){case 1:if(Ve=$e.payload,typeof Ve=="function"){ge=Ve.call(Pt,ge,se);break e}ge=Ve;break e;case 3:Ve.flags=Ve.flags&-65537|128;case 0:if(Ve=$e.payload,se=typeof Ve=="function"?Ve.call(Pt,ge,se):Ve,se==null)break e;ge=w({},ge,se);break e;case 2:ti=!0}}se=j.callback,se!==null&&(n.flags|=64,ie&&(n.flags|=8192),ie=f.callbacks,ie===null?f.callbacks=[se]:ie.push(se))}else ie={lane:se,tag:j.tag,payload:j.payload,callback:j.callback,next:null},ue===null?(te=ue=ie,P=ge):ue=ue.next=ie,v|=se;if(j=j.next,j===null){if(j=f.shared.pending,j===null)break;ie=j,j=ie.next,ie.next=null,f.lastBaseUpdate=ie,f.shared.pending=null}}while(!0);ue===null&&(P=ge),f.baseState=P,f.firstBaseUpdate=te,f.lastBaseUpdate=ue,m===null&&(f.shared.lanes=0),oi|=v,n.lanes=v,n.memoizedState=ge}}function Hx(n,r){if(typeof n!="function")throw Error(a(191,n));n.call(r)}function Fx(n,r){var l=n.callbacks;if(l!==null)for(n.callbacks=null,n=0;n<l.length;n++)Hx(l[n],r)}var eo=V(null),jd=V(0);function qx(n,r){n=ba,de(jd,n),de(eo,r),ba=n|r.baseLanes}function mm(){de(jd,ba),de(eo,eo.current)}function pm(){ba=jd.current,oe(eo),oe(jd)}var Rs=V(null),Ws=null;function ri(n){var r=n.alternate;de(cn,cn.current&1),de(Rs,n),Ws===null&&(r===null||eo.current!==null||r.memoizedState!==null)&&(Ws=n)}function gm(n){de(cn,cn.current),de(Rs,n),Ws===null&&(Ws=n)}function $x(n){n.tag===22?(de(cn,cn.current),de(Rs,n),Ws===null&&(Ws=n)):ai()}function ai(){de(cn,cn.current),de(Rs,Rs.current)}function ks(n){oe(Rs),Ws===n&&(Ws=null),oe(cn)}var cn=V(0);function Ed(n){for(var r=n;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||_p(l)||Np(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var da=0,rt=null,Mt=null,yn=null,Sd=!1,to=!1,cl=!1,Cd=0,Sc=0,no=null,KT=0;function en(){throw Error(a(321))}function xm(n,r){if(r===null)return!1;for(var l=0;l<r.length&&l<n.length;l++)if(!Cs(n[l],r[l]))return!1;return!0}function ym(n,r,l,c,f,m){return da=m,rt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,X.H=n===null||n.memoizedState===null?Cy:Dm,cl=!1,m=l(c,f),cl=!1,to&&(m=Gx(r,l,c,f)),Kx(n),m}function Kx(n){X.H=Rc;var r=Mt!==null&&Mt.next!==null;if(da=0,yn=Mt=rt=null,Sd=!1,Sc=0,no=null,r)throw Error(a(300));n===null||bn||(n=n.dependencies,n!==null&&yd(n)&&(bn=!0))}function Gx(n,r,l,c){rt=n;var f=0;do{if(to&&(no=null),Sc=0,to=!1,25<=f)throw Error(a(301));if(f+=1,yn=Mt=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}X.H=Ay,m=r(l,c)}while(to);return m}function GT(){var n=X.H,r=n.useState()[0];return r=typeof r.then=="function"?Cc(r):r,n=n.useState()[0],(Mt!==null?Mt.memoizedState:null)!==n&&(rt.flags|=1024),r}function bm(){var n=Cd!==0;return Cd=0,n}function vm(n,r,l){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~l}function wm(n){if(Sd){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}Sd=!1}da=0,yn=Mt=rt=null,to=!1,Sc=Cd=0,no=null}function es(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yn===null?rt.memoizedState=yn=n:yn=yn.next=n,yn}function un(){if(Mt===null){var n=rt.alternate;n=n!==null?n.memoizedState:null}else n=Mt.next;var r=yn===null?rt.memoizedState:yn.next;if(r!==null)yn=r,Mt=n;else{if(n===null)throw rt.alternate===null?Error(a(467)):Error(a(310));Mt=n,n={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},yn===null?rt.memoizedState=yn=n:yn=yn.next=n}return yn}function Ad(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cc(n){var r=Sc;return Sc+=1,no===null&&(no=[]),n=Px(no,n,r),r=rt,(yn===null?r.memoizedState:yn.next)===null&&(r=r.alternate,X.H=r===null||r.memoizedState===null?Cy:Dm),n}function Rd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Cc(n);if(n.$$typeof===$)return Mn(n)}throw Error(a(438,String(n)))}function _m(n){var r=null,l=rt.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var c=rt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=Ad(),rt.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(n),c=0;c<n;c++)l[c]=M;return r.index++,l}function ha(n,r){return typeof r=="function"?r(n):r}function kd(n){var r=un();return Nm(r,Mt,n)}function Nm(n,r,l){var c=n.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=l;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var v=f.next;f.next=m.next,m.next=v}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var j=v=null,P=null,te=r,ue=!1;do{var ge=te.lane&-536870913;if(ge!==te.lane?(ct&ge)===ge:(da&ge)===ge){var se=te.revertLane;if(se===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),ge===Xl&&(ue=!0);else if((da&se)===se){te=te.next,se===Xl&&(ue=!0);continue}else ge={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},P===null?(j=P=ge,v=m):P=P.next=ge,rt.lanes|=se,oi|=se;ge=te.action,cl&&l(m,ge),m=te.hasEagerState?te.eagerState:l(m,ge)}else se={lane:ge,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},P===null?(j=P=se,v=m):P=P.next=se,rt.lanes|=ge,oi|=ge;te=te.next}while(te!==null&&te!==r);if(P===null?v=m:P.next=j,!Cs(m,n.memoizedState)&&(bn=!0,ue&&(l=Wl,l!==null)))throw l;n.memoizedState=m,n.baseState=v,n.baseQueue=P,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function Tm(n){var r=un(),l=r.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=n;var c=l.dispatch,f=l.pending,m=r.memoizedState;if(f!==null){l.pending=null;var v=f=f.next;do m=n(m,v.action),v=v.next;while(v!==f);Cs(m,r.memoizedState)||(bn=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),l.lastRenderedState=m}return[m,c]}function Yx(n,r,l){var c=rt,f=un(),m=mt;if(m){if(l===void 0)throw Error(a(407));l=l()}else l=r();var v=!Cs((Mt||f).memoizedState,l);if(v&&(f.memoizedState=l,bn=!0),f=f.queue,Sm(Wx.bind(null,c,f,n),[n]),f.getSnapshot!==r||v||yn!==null&&yn.memoizedState.tag&1){if(c.flags|=2048,so(9,{destroy:void 0},Xx.bind(null,c,f,l,r),null),Lt===null)throw Error(a(349));m||(da&127)!==0||Qx(c,r,l)}return l}function Qx(n,r,l){n.flags|=16384,n={getSnapshot:r,value:l},r=rt.updateQueue,r===null?(r=Ad(),rt.updateQueue=r,r.stores=[n]):(l=r.stores,l===null?r.stores=[n]:l.push(n))}function Xx(n,r,l,c){r.value=l,r.getSnapshot=c,Jx(r)&&Zx(n)}function Wx(n,r,l){return l(function(){Jx(r)&&Zx(n)})}function Jx(n){var r=n.getSnapshot;n=n.value;try{var l=r();return!Cs(n,l)}catch{return!0}}function Zx(n){var r=el(n,2);r!==null&&fs(r,n,2)}function jm(n){var r=es();if(typeof n=="function"){var l=n;if(n=l(),cl){Xt(!0);try{l()}finally{Xt(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:n},r}function ey(n,r,l,c){return n.baseState=l,Nm(n,Mt,typeof c=="function"?c:ha)}function YT(n,r,l,c,f){if(Od(n))throw Error(a(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){m.listeners.push(v)}};X.T!==null?l(!0):m.isTransition=!1,c(m),l=r.pending,l===null?(m.next=r.pending=m,ty(r,m)):(m.next=l.next,r.pending=l.next=m)}}function ty(n,r){var l=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=X.T,v={};X.T=v;try{var j=l(f,c),P=X.S;P!==null&&P(v,j),ny(n,r,j)}catch(te){Em(n,r,te)}finally{m!==null&&v.types!==null&&(m.types=v.types),X.T=m}}else try{m=l(f,c),ny(n,r,m)}catch(te){Em(n,r,te)}}function ny(n,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){sy(n,r,c)},function(c){return Em(n,r,c)}):sy(n,r,l)}function sy(n,r,l){r.status="fulfilled",r.value=l,ry(r),n.state=l,r=n.pending,r!==null&&(l=r.next,l===r?n.pending=null:(l=l.next,r.next=l,ty(n,l)))}function Em(n,r,l){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=l,ry(r),r=r.next;while(r!==c)}n.action=null}function ry(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function ay(n,r){return r}function iy(n,r){if(mt){var l=Lt.formState;if(l!==null){e:{var c=rt;if(mt){if(Ht){t:{for(var f=Ht,m=Xs;f.nodeType!==8;){if(!m){f=null;break t}if(f=Js(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Ht=Js(f.nextSibling),c=f.data==="F!";break e}}Za(c)}c=!1}c&&(r=l[0])}}return l=es(),l.memoizedState=l.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ay,lastRenderedState:r},l.queue=c,l=jy.bind(null,rt,c),c.dispatch=l,c=jm(!1),m=Im.bind(null,rt,!1,c.queue),c=es(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,l=YT.bind(null,rt,f,m,l),f.dispatch=l,c.memoizedState=n,[r,l,!1]}function ly(n){var r=un();return oy(r,Mt,n)}function oy(n,r,l){if(r=Nm(n,r,ay)[0],n=kd(ha)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Cc(r)}catch(v){throw v===Jl?wd:v}else c=r;r=un();var f=r.queue,m=f.dispatch;return l!==r.memoizedState&&(rt.flags|=2048,so(9,{destroy:void 0},QT.bind(null,f,l),null)),[c,m,n]}function QT(n,r){n.action=r}function cy(n){var r=un(),l=Mt;if(l!==null)return oy(r,l,n);un(),r=r.memoizedState,l=un();var c=l.queue.dispatch;return l.memoizedState=n,[r,c,!1]}function so(n,r,l,c){return n={tag:n,create:l,deps:c,inst:r,next:null},r=rt.updateQueue,r===null&&(r=Ad(),rt.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=n.next=n:(c=l.next,l.next=n,n.next=c,r.lastEffect=n),n}function uy(){return un().memoizedState}function Id(n,r,l,c){var f=es();rt.flags|=n,f.memoizedState=so(1|r,{destroy:void 0},l,c===void 0?null:c)}function Dd(n,r,l,c){var f=un();c=c===void 0?null:c;var m=f.memoizedState.inst;Mt!==null&&c!==null&&xm(c,Mt.memoizedState.deps)?f.memoizedState=so(r,m,l,c):(rt.flags|=n,f.memoizedState=so(1|r,m,l,c))}function dy(n,r){Id(8390656,8,n,r)}function Sm(n,r){Dd(2048,8,n,r)}function XT(n){rt.flags|=4;var r=rt.updateQueue;if(r===null)r=Ad(),rt.updateQueue=r,r.events=[n];else{var l=r.events;l===null?r.events=[n]:l.push(n)}}function hy(n){var r=un().memoizedState;return XT({ref:r,nextImpl:n}),function(){if((Nt&2)!==0)throw Error(a(440));return r.impl.apply(void 0,arguments)}}function fy(n,r){return Dd(4,2,n,r)}function my(n,r){return Dd(4,4,n,r)}function py(n,r){if(typeof r=="function"){n=n();var l=r(n);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function gy(n,r,l){l=l!=null?l.concat([n]):null,Dd(4,4,py.bind(null,r,n),l)}function Cm(){}function xy(n,r){var l=un();r=r===void 0?null:r;var c=l.memoizedState;return r!==null&&xm(r,c[1])?c[0]:(l.memoizedState=[n,r],n)}function yy(n,r){var l=un();r=r===void 0?null:r;var c=l.memoizedState;if(r!==null&&xm(r,c[1]))return c[0];if(c=n(),cl){Xt(!0);try{n()}finally{Xt(!1)}}return l.memoizedState=[c,r],c}function Am(n,r,l){return l===void 0||(da&1073741824)!==0&&(ct&261930)===0?n.memoizedState=r:(n.memoizedState=l,n=bb(),rt.lanes|=n,oi|=n,l)}function by(n,r,l,c){return Cs(l,r)?l:eo.current!==null?(n=Am(n,l,c),Cs(n,r)||(bn=!0),n):(da&42)===0||(da&1073741824)!==0&&(ct&261930)===0?(bn=!0,n.memoizedState=l):(n=bb(),rt.lanes|=n,oi|=n,r)}function vy(n,r,l,c,f){var m=Z.p;Z.p=m!==0&&8>m?m:8;var v=X.T,j={};X.T=j,Im(n,!1,r,l);try{var P=f(),te=X.S;if(te!==null&&te(j,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var ue=$T(P,c);Ac(n,r,ue,Os(n))}else Ac(n,r,c,Os(n))}catch(ge){Ac(n,r,{then:function(){},status:"rejected",reason:ge},Os())}finally{Z.p=m,v!==null&&j.types!==null&&(v.types=j.types),X.T=v}}function WT(){}function Rm(n,r,l,c){if(n.tag!==5)throw Error(a(476));var f=wy(n).queue;vy(n,f,r,Se,l===null?WT:function(){return _y(n),l(c)})}function wy(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:Se,baseState:Se,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:Se},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:l},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function _y(n){var r=wy(n);r.next===null&&(r=n.alternate.memoizedState),Ac(n,r.next.queue,{},Os())}function km(){return Mn(Kc)}function Ny(){return un().memoizedState}function Ty(){return un().memoizedState}function JT(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var l=Os();n=ni(l);var c=si(r,n,l);c!==null&&(fs(c,r,l),Tc(c,r,l)),r={cache:im()},n.payload=r;return}r=r.return}}function ZT(n,r,l){var c=Os();l={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Od(n)?Ey(r,l):(l=Qf(n,r,l,c),l!==null&&(fs(l,n,c),Sy(l,r,c)))}function jy(n,r,l){var c=Os();Ac(n,r,l,c)}function Ac(n,r,l,c){var f={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Od(n))Ey(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var v=r.lastRenderedState,j=m(v,l);if(f.hasEagerState=!0,f.eagerState=j,Cs(j,v))return md(n,r,f,0),Lt===null&&fd(),!1}catch{}finally{}if(l=Qf(n,r,f,c),l!==null)return fs(l,n,c),Sy(l,r,c),!0}return!1}function Im(n,r,l,c){if(c={lane:2,revertLane:up(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Od(n)){if(r)throw Error(a(479))}else r=Qf(n,l,c,2),r!==null&&fs(r,n,2)}function Od(n){var r=n.alternate;return n===rt||r!==null&&r===rt}function Ey(n,r){to=Sd=!0;var l=n.pending;l===null?r.next=r:(r.next=l.next,l.next=r),n.pending=r}function Sy(n,r,l){if((l&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,l|=c,r.lanes=l,U(n,l)}}var Rc={readContext:Mn,use:Rd,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useLayoutEffect:en,useInsertionEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useSyncExternalStore:en,useId:en,useHostTransitionStatus:en,useFormState:en,useActionState:en,useOptimistic:en,useMemoCache:en,useCacheRefresh:en};Rc.useEffectEvent=en;var Cy={readContext:Mn,use:Rd,useCallback:function(n,r){return es().memoizedState=[n,r===void 0?null:r],n},useContext:Mn,useEffect:dy,useImperativeHandle:function(n,r,l){l=l!=null?l.concat([n]):null,Id(4194308,4,py.bind(null,r,n),l)},useLayoutEffect:function(n,r){return Id(4194308,4,n,r)},useInsertionEffect:function(n,r){Id(4,2,n,r)},useMemo:function(n,r){var l=es();r=r===void 0?null:r;var c=n();if(cl){Xt(!0);try{n()}finally{Xt(!1)}}return l.memoizedState=[c,r],c},useReducer:function(n,r,l){var c=es();if(l!==void 0){var f=l(r);if(cl){Xt(!0);try{l(r)}finally{Xt(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=ZT.bind(null,rt,n),[c.memoizedState,n]},useRef:function(n){var r=es();return n={current:n},r.memoizedState=n},useState:function(n){n=jm(n);var r=n.queue,l=jy.bind(null,rt,r);return r.dispatch=l,[n.memoizedState,l]},useDebugValue:Cm,useDeferredValue:function(n,r){var l=es();return Am(l,n,r)},useTransition:function(){var n=jm(!1);return n=vy.bind(null,rt,n.queue,!0,!1),es().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,l){var c=rt,f=es();if(mt){if(l===void 0)throw Error(a(407));l=l()}else{if(l=r(),Lt===null)throw Error(a(349));(ct&127)!==0||Qx(c,r,l)}f.memoizedState=l;var m={value:l,getSnapshot:r};return f.queue=m,dy(Wx.bind(null,c,m,n),[n]),c.flags|=2048,so(9,{destroy:void 0},Xx.bind(null,c,m,l,r),null),l},useId:function(){var n=es(),r=Lt.identifierPrefix;if(mt){var l=Lr,c=Pr;l=(c&~(1<<32-wt(c)-1)).toString(32)+l,r="_"+r+"R_"+l,l=Cd++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=KT++,r="_"+r+"r_"+l.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:km,useFormState:iy,useActionState:iy,useOptimistic:function(n){var r=es();r.memoizedState=r.baseState=n;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=Im.bind(null,rt,!0,l),l.dispatch=r,[n,r]},useMemoCache:_m,useCacheRefresh:function(){return es().memoizedState=JT.bind(null,rt)},useEffectEvent:function(n){var r=es(),l={impl:n};return r.memoizedState=l,function(){if((Nt&2)!==0)throw Error(a(440));return l.impl.apply(void 0,arguments)}}},Dm={readContext:Mn,use:Rd,useCallback:xy,useContext:Mn,useEffect:Sm,useImperativeHandle:gy,useInsertionEffect:fy,useLayoutEffect:my,useMemo:yy,useReducer:kd,useRef:uy,useState:function(){return kd(ha)},useDebugValue:Cm,useDeferredValue:function(n,r){var l=un();return by(l,Mt.memoizedState,n,r)},useTransition:function(){var n=kd(ha)[0],r=un().memoizedState;return[typeof n=="boolean"?n:Cc(n),r]},useSyncExternalStore:Yx,useId:Ny,useHostTransitionStatus:km,useFormState:ly,useActionState:ly,useOptimistic:function(n,r){var l=un();return ey(l,Mt,n,r)},useMemoCache:_m,useCacheRefresh:Ty};Dm.useEffectEvent=hy;var Ay={readContext:Mn,use:Rd,useCallback:xy,useContext:Mn,useEffect:Sm,useImperativeHandle:gy,useInsertionEffect:fy,useLayoutEffect:my,useMemo:yy,useReducer:Tm,useRef:uy,useState:function(){return Tm(ha)},useDebugValue:Cm,useDeferredValue:function(n,r){var l=un();return Mt===null?Am(l,n,r):by(l,Mt.memoizedState,n,r)},useTransition:function(){var n=Tm(ha)[0],r=un().memoizedState;return[typeof n=="boolean"?n:Cc(n),r]},useSyncExternalStore:Yx,useId:Ny,useHostTransitionStatus:km,useFormState:cy,useActionState:cy,useOptimistic:function(n,r){var l=un();return Mt!==null?ey(l,Mt,n,r):(l.baseState=n,[n,l.queue.dispatch])},useMemoCache:_m,useCacheRefresh:Ty};Ay.useEffectEvent=hy;function Om(n,r,l,c){r=n.memoizedState,l=l(c,r),l=l==null?r:w({},r,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Mm={enqueueSetState:function(n,r,l){n=n._reactInternals;var c=Os(),f=ni(c);f.payload=r,l!=null&&(f.callback=l),r=si(n,f,c),r!==null&&(fs(r,n,c),Tc(r,n,c))},enqueueReplaceState:function(n,r,l){n=n._reactInternals;var c=Os(),f=ni(c);f.tag=1,f.payload=r,l!=null&&(f.callback=l),r=si(n,f,c),r!==null&&(fs(r,n,c),Tc(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var l=Os(),c=ni(l);c.tag=2,r!=null&&(c.callback=r),r=si(n,c,l),r!==null&&(fs(r,n,l),Tc(r,n,l))}};function Ry(n,r,l,c,f,m,v){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,v):r.prototype&&r.prototype.isPureReactComponent?!gc(l,c)||!gc(f,m):!0}function ky(n,r,l,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,c),r.state!==n&&Mm.enqueueReplaceState(r,r.state,null)}function ul(n,r){var l=r;if("ref"in r){l={};for(var c in r)c!=="ref"&&(l[c]=r[c])}if(n=n.defaultProps){l===r&&(l=w({},l));for(var f in n)l[f]===void 0&&(l[f]=n[f])}return l}function Iy(n){hd(n)}function Dy(n){console.error(n)}function Oy(n){hd(n)}function Md(n,r){try{var l=n.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function My(n,r,l){try{var c=n.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Vm(n,r,l){return l=ni(l),l.tag=3,l.payload={element:null},l.callback=function(){Md(n,r)},l}function Vy(n){return n=ni(n),n.tag=3,n}function Py(n,r,l,c){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){My(r,l,c)}}var v=l.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(n.callback=function(){My(r,l,c),typeof f!="function"&&(ci===null?ci=new Set([this]):ci.add(this));var j=c.stack;this.componentDidCatch(c.value,{componentStack:j!==null?j:""})})}function ej(n,r,l,c,f){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=l.alternate,r!==null&&Ql(r,l,f,!0),l=Rs.current,l!==null){switch(l.tag){case 31:case 13:return Ws===null?Gd():l.alternate===null&&tn===0&&(tn=3),l.flags&=-257,l.flags|=65536,l.lanes=f,c===_d?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([c]):r.add(c),lp(n,c,f)),!1;case 22:return l.flags|=65536,c===_d?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([c]):l.add(c)),lp(n,c,f)),!1}throw Error(a(435,l.tag))}return lp(n,c,f),Gd(),!1}if(mt)return r=Rs.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==tm&&(n=Error(a(422),{cause:c}),bc(Gs(n,l)))):(c!==tm&&(r=Error(a(423),{cause:c}),bc(Gs(r,l))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Gs(c,l),f=Vm(n.stateNode,c,f),hm(n,f),tn!==4&&(tn=2)),!1;var m=Error(a(520),{cause:c});if(m=Gs(m,l),Lc===null?Lc=[m]:Lc.push(m),tn!==4&&(tn=2),r===null)return!0;c=Gs(c,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,n=f&-f,l.lanes|=n,n=Vm(l.stateNode,c,n),hm(l,n),!1;case 1:if(r=l.type,m=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(ci===null||!ci.has(m))))return l.flags|=65536,f&=-f,l.lanes|=f,f=Vy(f),Py(f,n,l,c),hm(l,f),!1}l=l.return}while(l!==null);return!1}var Pm=Error(a(461)),bn=!1;function Vn(n,r,l,c){r.child=n===null?Bx(r,null,l,c):ol(r,n.child,l,c)}function Ly(n,r,l,c,f){l=l.render;var m=r.ref;if("ref"in c){var v={};for(var j in c)j!=="ref"&&(v[j]=c[j])}else v=c;return rl(r),c=ym(n,r,l,v,m,f),j=bm(),n!==null&&!bn?(vm(n,r,f),fa(n,r,f)):(mt&&j&&Zf(r),r.flags|=1,Vn(n,r,c,f),r.child)}function Uy(n,r,l,c,f){if(n===null){var m=l.type;return typeof m=="function"&&!Xf(m)&&m.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=m,zy(n,r,m,c,f)):(n=gd(l.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!$m(n,f)){var v=m.memoizedProps;if(l=l.compare,l=l!==null?l:gc,l(v,c)&&n.ref===r.ref)return fa(n,r,f)}return r.flags|=1,n=la(m,c),n.ref=r.ref,n.return=r,r.child=n}function zy(n,r,l,c,f){if(n!==null){var m=n.memoizedProps;if(gc(m,c)&&n.ref===r.ref)if(bn=!1,r.pendingProps=c=m,$m(n,f))(n.flags&131072)!==0&&(bn=!0);else return r.lanes=n.lanes,fa(n,r,f)}return Lm(n,r,l,c,f)}function By(n,r,l,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|l:l,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return Hy(n,r,m,l,c)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&vd(r,m!==null?m.cachePool:null),m!==null?qx(r,m):mm(),$x(r);else return c=r.lanes=536870912,Hy(n,r,m!==null?m.baseLanes|l:l,l,c)}else m!==null?(vd(r,m.cachePool),qx(r,m),ai(),r.memoizedState=null):(n!==null&&vd(r,null),mm(),ai());return Vn(n,r,f,l),r.child}function kc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Hy(n,r,l,c,f){var m=om();return m=m===null?null:{parent:xn._currentValue,pool:m},r.memoizedState={baseLanes:l,cachePool:m},n!==null&&vd(r,null),mm(),$x(r),n!==null&&Ql(n,r,c,!0),r.childLanes=f,null}function Vd(n,r){return r=Ld({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function Fy(n,r,l){return ol(r,n.child,null,l),n=Vd(r,r.pendingProps),n.flags|=2,ks(r),r.memoizedState=null,n}function tj(n,r,l){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(mt){if(c.mode==="hidden")return n=Vd(r,c),r.lanes=536870912,kc(null,n);if(gm(r),(n=Ht)?(n=tv(n,Xs),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Wa!==null?{id:Pr,overflow:Lr}:null,retryLane:536870912,hydrationErrors:null},l=Ex(n),l.return=r,r.child=l,On=r,Ht=null)):n=null,n===null)throw Za(r);return r.lanes=536870912,null}return Vd(r,c)}var m=n.memoizedState;if(m!==null){var v=m.dehydrated;if(gm(r),f)if(r.flags&256)r.flags&=-257,r=Fy(n,r,l);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(a(558));else if(bn||Ql(n,r,l,!1),f=(l&n.childLanes)!==0,bn||f){if(c=Lt,c!==null&&(v=Q(c,l),v!==0&&v!==m.retryLane))throw m.retryLane=v,el(n,v),fs(c,n,v),Pm;Gd(),r=Fy(n,r,l)}else n=m.treeContext,Ht=Js(v.nextSibling),On=r,mt=!0,Ja=null,Xs=!1,n!==null&&Ax(r,n),r=Vd(r,c),r.flags|=4096;return r}return n=la(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Pd(n,r){var l=r.ref;if(l===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(a(284));(n===null||n.ref!==l)&&(r.flags|=4194816)}}function Lm(n,r,l,c,f){return rl(r),l=ym(n,r,l,c,void 0,f),c=bm(),n!==null&&!bn?(vm(n,r,f),fa(n,r,f)):(mt&&c&&Zf(r),r.flags|=1,Vn(n,r,l,f),r.child)}function qy(n,r,l,c,f,m){return rl(r),r.updateQueue=null,l=Gx(r,c,l,f),Kx(n),c=bm(),n!==null&&!bn?(vm(n,r,m),fa(n,r,m)):(mt&&c&&Zf(r),r.flags|=1,Vn(n,r,l,m),r.child)}function $y(n,r,l,c,f){if(rl(r),r.stateNode===null){var m=$l,v=l.contextType;typeof v=="object"&&v!==null&&(m=Mn(v)),m=new l(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Mm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},um(r),v=l.contextType,m.context=typeof v=="object"&&v!==null?Mn(v):$l,m.state=r.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(Om(r,l,v,c),m.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(v=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),v!==m.state&&Mm.enqueueReplaceState(m,m.state,null),Ec(r,c,m,f),jc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var j=r.memoizedProps,P=ul(l,j);m.props=P;var te=m.context,ue=l.contextType;v=$l,typeof ue=="object"&&ue!==null&&(v=Mn(ue));var ge=l.getDerivedStateFromProps;ue=typeof ge=="function"||typeof m.getSnapshotBeforeUpdate=="function",j=r.pendingProps!==j,ue||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(j||te!==v)&&ky(r,m,c,v),ti=!1;var se=r.memoizedState;m.state=se,Ec(r,c,m,f),jc(),te=r.memoizedState,j||se!==te||ti?(typeof ge=="function"&&(Om(r,l,ge,c),te=r.memoizedState),(P=ti||Ry(r,l,P,c,se,te,v))?(ue||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=te),m.props=c,m.state=te,m.context=v,c=P):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,dm(n,r),v=r.memoizedProps,ue=ul(l,v),m.props=ue,ge=r.pendingProps,se=m.context,te=l.contextType,P=$l,typeof te=="object"&&te!==null&&(P=Mn(te)),j=l.getDerivedStateFromProps,(te=typeof j=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==ge||se!==P)&&ky(r,m,c,P),ti=!1,se=r.memoizedState,m.state=se,Ec(r,c,m,f),jc();var ie=r.memoizedState;v!==ge||se!==ie||ti||n!==null&&n.dependencies!==null&&yd(n.dependencies)?(typeof j=="function"&&(Om(r,l,j,c),ie=r.memoizedState),(ue=ti||Ry(r,l,ue,c,se,ie,P)||n!==null&&n.dependencies!==null&&yd(n.dependencies))?(te||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,ie,P),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,ie,P)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===n.memoizedProps&&se===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&se===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=ie),m.props=c,m.state=ie,m.context=P,c=ue):(typeof m.componentDidUpdate!="function"||v===n.memoizedProps&&se===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&se===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,Pd(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=ol(r,n.child,null,f),r.child=ol(r,null,l,f)):Vn(n,r,l,f),r.memoizedState=m.state,n=r.child):n=fa(n,r,f),n}function Ky(n,r,l,c){return nl(),r.flags|=256,Vn(n,r,l,c),r.child}var Um={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function zm(n){return{baseLanes:n,cachePool:Mx()}}function Bm(n,r,l){return n=n!==null?n.childLanes&~l:0,r&&(n|=Ds),n}function Gy(n,r,l){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,v;if((v=m)||(v=n!==null&&n.memoizedState===null?!1:(cn.current&2)!==0),v&&(f=!0,r.flags&=-129),v=(r.flags&32)!==0,r.flags&=-33,n===null){if(mt){if(f?ri(r):ai(),(n=Ht)?(n=tv(n,Xs),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Wa!==null?{id:Pr,overflow:Lr}:null,retryLane:536870912,hydrationErrors:null},l=Ex(n),l.return=r,r.child=l,On=r,Ht=null)):n=null,n===null)throw Za(r);return Np(n)?r.lanes=32:r.lanes=536870912,null}var j=c.children;return c=c.fallback,f?(ai(),f=r.mode,j=Ld({mode:"hidden",children:j},f),c=tl(c,f,l,null),j.return=r,c.return=r,j.sibling=c,r.child=j,c=r.child,c.memoizedState=zm(l),c.childLanes=Bm(n,v,l),r.memoizedState=Um,kc(null,c)):(ri(r),Hm(r,j))}var P=n.memoizedState;if(P!==null&&(j=P.dehydrated,j!==null)){if(m)r.flags&256?(ri(r),r.flags&=-257,r=Fm(n,r,l)):r.memoizedState!==null?(ai(),r.child=n.child,r.flags|=128,r=null):(ai(),j=c.fallback,f=r.mode,c=Ld({mode:"visible",children:c.children},f),j=tl(j,f,l,null),j.flags|=2,c.return=r,j.return=r,c.sibling=j,r.child=c,ol(r,n.child,null,l),c=r.child,c.memoizedState=zm(l),c.childLanes=Bm(n,v,l),r.memoizedState=Um,r=kc(null,c));else if(ri(r),Np(j)){if(v=j.nextSibling&&j.nextSibling.dataset,v)var te=v.dgst;v=te,c=Error(a(419)),c.stack="",c.digest=v,bc({value:c,source:null,stack:null}),r=Fm(n,r,l)}else if(bn||Ql(n,r,l,!1),v=(l&n.childLanes)!==0,bn||v){if(v=Lt,v!==null&&(c=Q(v,l),c!==0&&c!==P.retryLane))throw P.retryLane=c,el(n,c),fs(v,n,c),Pm;_p(j)||Gd(),r=Fm(n,r,l)}else _p(j)?(r.flags|=192,r.child=n.child,r=null):(n=P.treeContext,Ht=Js(j.nextSibling),On=r,mt=!0,Ja=null,Xs=!1,n!==null&&Ax(r,n),r=Hm(r,c.children),r.flags|=4096);return r}return f?(ai(),j=c.fallback,f=r.mode,P=n.child,te=P.sibling,c=la(P,{mode:"hidden",children:c.children}),c.subtreeFlags=P.subtreeFlags&65011712,te!==null?j=la(te,j):(j=tl(j,f,l,null),j.flags|=2),j.return=r,c.return=r,c.sibling=j,r.child=c,kc(null,c),c=r.child,j=n.child.memoizedState,j===null?j=zm(l):(f=j.cachePool,f!==null?(P=xn._currentValue,f=f.parent!==P?{parent:P,pool:P}:f):f=Mx(),j={baseLanes:j.baseLanes|l,cachePool:f}),c.memoizedState=j,c.childLanes=Bm(n,v,l),r.memoizedState=Um,kc(n.child,c)):(ri(r),l=n.child,n=l.sibling,l=la(l,{mode:"visible",children:c.children}),l.return=r,l.sibling=null,n!==null&&(v=r.deletions,v===null?(r.deletions=[n],r.flags|=16):v.push(n)),r.child=l,r.memoizedState=null,l)}function Hm(n,r){return r=Ld({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Ld(n,r){return n=As(22,n,null,r),n.lanes=0,n}function Fm(n,r,l){return ol(r,n.child,null,l),n=Hm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function Yy(n,r,l){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),rm(n.return,r,l)}function qm(n,r,l,c,f,m){var v=n.memoizedState;v===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:f,treeForkCount:m}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=l,v.tailMode=f,v.treeForkCount=m)}function Qy(n,r,l){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var v=cn.current,j=(v&2)!==0;if(j?(v=v&1|2,r.flags|=128):v&=1,de(cn,v),Vn(n,r,c,l),c=mt?yc:0,!j&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Yy(n,l,r);else if(n.tag===19)Yy(n,l,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(l=r.child,f=null;l!==null;)n=l.alternate,n!==null&&Ed(n)===null&&(f=l),l=l.sibling;l=f,l===null?(f=r.child,r.child=null):(f=l.sibling,l.sibling=null),qm(r,!1,f,l,m,c);break;case"backwards":case"unstable_legacy-backwards":for(l=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&Ed(n)===null){r.child=f;break}n=f.sibling,f.sibling=l,l=f,f=n}qm(r,!0,l,null,m,c);break;case"together":qm(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function fa(n,r,l){if(n!==null&&(r.dependencies=n.dependencies),oi|=r.lanes,(l&r.childLanes)===0)if(n!==null){if(Ql(n,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(a(153));if(r.child!==null){for(n=r.child,l=la(n,n.pendingProps),r.child=l,l.return=r;n.sibling!==null;)n=n.sibling,l=l.sibling=la(n,n.pendingProps),l.return=r;l.sibling=null}return r.child}function $m(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&yd(n)))}function nj(n,r,l){switch(r.tag){case 3:ce(r,r.stateNode.containerInfo),ei(r,xn,n.memoizedState.cache),nl();break;case 27:case 5:Ee(r);break;case 4:ce(r,r.stateNode.containerInfo);break;case 10:ei(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,gm(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(ri(r),r.flags|=128,null):(l&r.child.childLanes)!==0?Gy(n,r,l):(ri(r),n=fa(n,r,l),n!==null?n.sibling:null);ri(r);break;case 19:var f=(n.flags&128)!==0;if(c=(l&r.childLanes)!==0,c||(Ql(n,r,l,!1),c=(l&r.childLanes)!==0),f){if(c)return Qy(n,r,l);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),de(cn,cn.current),c)break;return null;case 22:return r.lanes=0,By(n,r,l,r.pendingProps);case 24:ei(r,xn,n.memoizedState.cache)}return fa(n,r,l)}function Xy(n,r,l){if(n!==null)if(n.memoizedProps!==r.pendingProps)bn=!0;else{if(!$m(n,l)&&(r.flags&128)===0)return bn=!1,nj(n,r,l);bn=(n.flags&131072)!==0}else bn=!1,mt&&(r.flags&1048576)!==0&&Cx(r,yc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=il(r.elementType),r.type=n,typeof n=="function")Xf(n)?(c=ul(n,c),r.tag=1,r=$y(null,r,n,c,l)):(r.tag=0,r=Lm(null,r,n,c,l));else{if(n!=null){var f=n.$$typeof;if(f===z){r.tag=11,r=Ly(null,r,n,c,l);break e}else if(f===S){r.tag=14,r=Uy(null,r,n,c,l);break e}}throw r=ve(n)||n,Error(a(306,r,""))}}return r;case 0:return Lm(n,r,r.type,r.pendingProps,l);case 1:return c=r.type,f=ul(c,r.pendingProps),$y(n,r,c,f,l);case 3:e:{if(ce(r,r.stateNode.containerInfo),n===null)throw Error(a(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,dm(n,r),Ec(r,c,null,l);var v=r.memoizedState;if(c=v.cache,ei(r,xn,c),c!==m.cache&&am(r,[xn],l,!0),jc(),c=v.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:v.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=Ky(n,r,c,l);break e}else if(c!==f){f=Gs(Error(a(424)),r),bc(f),r=Ky(n,r,c,l);break e}else{switch(n=r.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Ht=Js(n.firstChild),On=r,mt=!0,Ja=null,Xs=!0,l=Bx(r,null,c,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(nl(),c===f){r=fa(n,r,l);break e}Vn(n,r,c,l)}r=r.child}return r;case 26:return Pd(n,r),n===null?(l=lv(r.type,null,r.pendingProps,null))?r.memoizedState=l:mt||(l=r.type,n=r.pendingProps,c=eh(be.current).createElement(l),c[tt]=r,c[it]=n,Pn(c,l,n),pn(c),r.stateNode=c):r.memoizedState=lv(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Ee(r),n===null&&mt&&(c=r.stateNode=rv(r.type,r.pendingProps,be.current),On=r,Xs=!0,f=Ht,fi(r.type)?(Tp=f,Ht=Js(c.firstChild)):Ht=f),Vn(n,r,r.pendingProps.children,l),Pd(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&mt&&((f=c=Ht)&&(c=Ij(c,r.type,r.pendingProps,Xs),c!==null?(r.stateNode=c,On=r,Ht=Js(c.firstChild),Xs=!1,f=!0):f=!1),f||Za(r)),Ee(r),f=r.type,m=r.pendingProps,v=n!==null?n.memoizedProps:null,c=m.children,bp(f,m)?c=null:v!==null&&bp(f,v)&&(r.flags|=32),r.memoizedState!==null&&(f=ym(n,r,GT,null,null,l),Kc._currentValue=f),Pd(n,r),Vn(n,r,c,l),r.child;case 6:return n===null&&mt&&((n=l=Ht)&&(l=Dj(l,r.pendingProps,Xs),l!==null?(r.stateNode=l,On=r,Ht=null,n=!0):n=!1),n||Za(r)),null;case 13:return Gy(n,r,l);case 4:return ce(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=ol(r,null,c,l):Vn(n,r,c,l),r.child;case 11:return Ly(n,r,r.type,r.pendingProps,l);case 7:return Vn(n,r,r.pendingProps,l),r.child;case 8:return Vn(n,r,r.pendingProps.children,l),r.child;case 12:return Vn(n,r,r.pendingProps.children,l),r.child;case 10:return c=r.pendingProps,ei(r,r.type,c.value),Vn(n,r,c.children,l),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,rl(r),f=Mn(f),c=c(f),r.flags|=1,Vn(n,r,c,l),r.child;case 14:return Uy(n,r,r.type,r.pendingProps,l);case 15:return zy(n,r,r.type,r.pendingProps,l);case 19:return Qy(n,r,l);case 31:return tj(n,r,l);case 22:return By(n,r,l,r.pendingProps);case 24:return rl(r),c=Mn(xn),n===null?(f=om(),f===null&&(f=Lt,m=im(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=l),f=m),r.memoizedState={parent:c,cache:f},um(r),ei(r,xn,f)):((n.lanes&l)!==0&&(dm(n,r),Ec(r,null,null,l),jc()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),ei(r,xn,c)):(c=m.cache,ei(r,xn,c),c!==f.cache&&am(r,[xn],l,!0))),Vn(n,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(a(156,r.tag))}function ma(n){n.flags|=4}function Km(n,r,l,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(Nb())n.flags|=8192;else throw ll=_d,cm}else n.flags&=-16777217}function Wy(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!hv(r))if(Nb())n.flags|=8192;else throw ll=_d,cm}function Ud(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?Ba():536870912,n.lanes|=r,lo|=r)}function Ic(n,r){if(!mt)switch(n.tailMode){case"hidden":r=n.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Ft(n){var r=n.alternate!==null&&n.alternate.child===n.child,l=0,c=0;if(r)for(var f=n.child;f!==null;)l|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)l|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=l,r}function sj(n,r,l){var c=r.pendingProps;switch(em(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(r),null;case 1:return Ft(r),null;case 3:return l=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),ua(xn),K(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&(Yl(r)?ma(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,nm())),Ft(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(ma(r),m!==null?(Ft(r),Wy(r,m)):(Ft(r),Km(r,f,null,c,l))):m?m!==n.memoizedState?(ma(r),Ft(r),Wy(r,m)):(Ft(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&ma(r),Ft(r),Km(r,f,n,c,l)),null;case 27:if(F(r),l=be.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&ma(r);else{if(!c){if(r.stateNode===null)throw Error(a(166));return Ft(r),null}n=ye.current,Yl(r)?Rx(r):(n=rv(f,c,l),r.stateNode=n,ma(r))}return Ft(r),null;case 5:if(F(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&ma(r);else{if(!c){if(r.stateNode===null)throw Error(a(166));return Ft(r),null}if(m=ye.current,Yl(r))Rx(r);else{var v=eh(be.current);switch(m){case 1:m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=v.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?v.createElement("select",{is:c.is}):v.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?v.createElement(f,{is:c.is}):v.createElement(f)}}m[tt]=r,m[it]=c;e:for(v=r.child;v!==null;){if(v.tag===5||v.tag===6)m.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===r)break e;for(;v.sibling===null;){if(v.return===null||v.return===r)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}r.stateNode=m;e:switch(Pn(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ma(r)}}return Ft(r),Km(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,l),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&ma(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(a(166));if(n=be.current,Yl(r)){if(n=r.stateNode,l=r.memoizedProps,c=null,f=On,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[tt]=r,n=!!(n.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||Gb(n.nodeValue,l)),n||Za(r,!0)}else n=eh(n).createTextNode(c),n[tt]=r,r.stateNode=n}return Ft(r),null;case 31:if(l=r.memoizedState,n===null||n.memoizedState!==null){if(c=Yl(r),l!==null){if(n===null){if(!c)throw Error(a(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[tt]=r}else nl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ft(r),n=!1}else l=nm(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=l),n=!0;if(!n)return r.flags&256?(ks(r),r):(ks(r),null);if((r.flags&128)!==0)throw Error(a(558))}return Ft(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=Yl(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(a(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[tt]=r}else nl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ft(r),f=!1}else f=nm(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(ks(r),r):(ks(r),null)}return ks(r),(r.flags&128)!==0?(r.lanes=l,r):(l=c!==null,n=n!==null&&n.memoizedState!==null,l&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),l!==n&&l&&(r.child.flags|=8192),Ud(r,r.updateQueue),Ft(r),null);case 4:return K(),n===null&&mp(r.stateNode.containerInfo),Ft(r),null;case 10:return ua(r.type),Ft(r),null;case 19:if(oe(cn),c=r.memoizedState,c===null)return Ft(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)Ic(c,!1);else{if(tn!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=Ed(n),m!==null){for(r.flags|=128,Ic(c,!1),n=m.updateQueue,r.updateQueue=n,Ud(r,n),r.subtreeFlags=0,n=l,l=r.child;l!==null;)jx(l,n),l=l.sibling;return de(cn,cn.current&1|2),mt&&oa(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&Bt()>qd&&(r.flags|=128,f=!0,Ic(c,!1),r.lanes=4194304)}else{if(!f)if(n=Ed(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,Ud(r,n),Ic(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!mt)return Ft(r),null}else 2*Bt()-c.renderingStartTime>qd&&l!==536870912&&(r.flags|=128,f=!0,Ic(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=Bt(),n.sibling=null,l=cn.current,de(cn,f?l&1|2:l&1),mt&&oa(r,c.treeForkCount),n):(Ft(r),null);case 22:case 23:return ks(r),pm(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(l&536870912)!==0&&(r.flags&128)===0&&(Ft(r),r.subtreeFlags&6&&(r.flags|=8192)):Ft(r),l=r.updateQueue,l!==null&&Ud(r,l.retryQueue),l=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==l&&(r.flags|=2048),n!==null&&oe(al),null;case 24:return l=null,n!==null&&(l=n.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),ua(xn),Ft(r),null;case 25:return null;case 30:return null}throw Error(a(156,r.tag))}function rj(n,r){switch(em(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return ua(xn),K(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return F(r),null;case 31:if(r.memoizedState!==null){if(ks(r),r.alternate===null)throw Error(a(340));nl()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(ks(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(a(340));nl()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return oe(cn),null;case 4:return K(),null;case 10:return ua(r.type),null;case 22:case 23:return ks(r),pm(),n!==null&&oe(al),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return ua(xn),null;case 25:return null;default:return null}}function Jy(n,r){switch(em(r),r.tag){case 3:ua(xn),K();break;case 26:case 27:case 5:F(r);break;case 4:K();break;case 31:r.memoizedState!==null&&ks(r);break;case 13:ks(r);break;case 19:oe(cn);break;case 10:ua(r.type);break;case 22:case 23:ks(r),pm(),n!==null&&oe(al);break;case 24:ua(xn)}}function Dc(n,r){try{var l=r.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var f=c.next;l=f;do{if((l.tag&n)===n){c=void 0;var m=l.create,v=l.inst;c=m(),v.destroy=c}l=l.next}while(l!==f)}}catch(j){It(r,r.return,j)}}function ii(n,r,l){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var v=c.inst,j=v.destroy;if(j!==void 0){v.destroy=void 0,f=r;var P=l,te=j;try{te()}catch(ue){It(f,P,ue)}}}c=c.next}while(c!==m)}}catch(ue){It(r,r.return,ue)}}function Zy(n){var r=n.updateQueue;if(r!==null){var l=n.stateNode;try{Fx(r,l)}catch(c){It(n,n.return,c)}}}function eb(n,r,l){l.props=ul(n.type,n.memoizedProps),l.state=n.memoizedState;try{l.componentWillUnmount()}catch(c){It(n,r,c)}}function Oc(n,r){try{var l=n.ref;if(l!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof l=="function"?n.refCleanup=l(c):l.current=c}}catch(f){It(n,r,f)}}function Ur(n,r){var l=n.ref,c=n.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(f){It(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){It(n,r,f)}else l.current=null}function tb(n){var r=n.type,l=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(f){It(n,n.return,f)}}function Gm(n,r,l){try{var c=n.stateNode;Ej(c,n.type,l,r),c[it]=r}catch(f){It(n,n.return,f)}}function nb(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&fi(n.type)||n.tag===4}function Ym(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||nb(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&fi(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Qm(n,r,l){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(n,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(n),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=lr));else if(c!==4&&(c===27&&fi(n.type)&&(l=n.stateNode,r=null),n=n.child,n!==null))for(Qm(n,r,l),n=n.sibling;n!==null;)Qm(n,r,l),n=n.sibling}function zd(n,r,l){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?l.insertBefore(n,r):l.appendChild(n);else if(c!==4&&(c===27&&fi(n.type)&&(l=n.stateNode),n=n.child,n!==null))for(zd(n,r,l),n=n.sibling;n!==null;)zd(n,r,l),n=n.sibling}function sb(n){var r=n.stateNode,l=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Pn(r,c,l),r[tt]=n,r[it]=l}catch(m){It(n,n.return,m)}}var pa=!1,vn=!1,Xm=!1,rb=typeof WeakSet=="function"?WeakSet:Set,Rn=null;function aj(n,r){if(n=n.containerInfo,xp=lh,n=gx(n),Ff(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{l.nodeType,m.nodeType}catch{l=null;break e}var v=0,j=-1,P=-1,te=0,ue=0,ge=n,se=null;t:for(;;){for(var ie;ge!==l||f!==0&&ge.nodeType!==3||(j=v+f),ge!==m||c!==0&&ge.nodeType!==3||(P=v+c),ge.nodeType===3&&(v+=ge.nodeValue.length),(ie=ge.firstChild)!==null;)se=ge,ge=ie;for(;;){if(ge===n)break t;if(se===l&&++te===f&&(j=v),se===m&&++ue===c&&(P=v),(ie=ge.nextSibling)!==null)break;ge=se,se=ge.parentNode}ge=ie}l=j===-1||P===-1?null:{start:j,end:P}}else l=null}l=l||{start:0,end:0}}else l=null;for(yp={focusedElem:n,selectionRange:l},lh=!1,Rn=r;Rn!==null;)if(r=Rn,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Rn=n;else for(;Rn!==null;){switch(r=Rn,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(l=0;l<n.length;l++)f=n[l],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,l=r,f=m.memoizedProps,m=m.memoizedState,c=l.stateNode;try{var Ve=ul(l.type,f);n=c.getSnapshotBeforeUpdate(Ve,m),c.__reactInternalSnapshotBeforeUpdate=n}catch($e){It(l,l.return,$e)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,l=n.nodeType,l===9)wp(n);else if(l===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":wp(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=r.sibling,n!==null){n.return=r.return,Rn=n;break}Rn=r.return}}function ab(n,r,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:xa(n,l),c&4&&Dc(5,l);break;case 1:if(xa(n,l),c&4)if(n=l.stateNode,r===null)try{n.componentDidMount()}catch(v){It(l,l.return,v)}else{var f=ul(l.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(v){It(l,l.return,v)}}c&64&&Zy(l),c&512&&Oc(l,l.return);break;case 3:if(xa(n,l),c&64&&(n=l.updateQueue,n!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Fx(n,r)}catch(v){It(l,l.return,v)}}break;case 27:r===null&&c&4&&sb(l);case 26:case 5:xa(n,l),r===null&&c&4&&tb(l),c&512&&Oc(l,l.return);break;case 12:xa(n,l);break;case 31:xa(n,l),c&4&&ob(n,l);break;case 13:xa(n,l),c&4&&cb(n,l),c&64&&(n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(l=mj.bind(null,l),Oj(n,l))));break;case 22:if(c=l.memoizedState!==null||pa,!c){r=r!==null&&r.memoizedState!==null||vn,f=pa;var m=vn;pa=c,(vn=r)&&!m?ya(n,l,(l.subtreeFlags&8772)!==0):xa(n,l),pa=f,vn=m}break;case 30:break;default:xa(n,l)}}function ib(n){var r=n.alternate;r!==null&&(n.alternate=null,ib(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&kl(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Yt=null,cs=!1;function ga(n,r,l){for(l=l.child;l!==null;)lb(n,r,l),l=l.sibling}function lb(n,r,l){if(vt&&typeof vt.onCommitFiberUnmount=="function")try{vt.onCommitFiberUnmount(Dt,l)}catch{}switch(l.tag){case 26:vn||Ur(l,r),ga(n,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:vn||Ur(l,r);var c=Yt,f=cs;fi(l.type)&&(Yt=l.stateNode,cs=!1),ga(n,r,l),Fc(l.stateNode),Yt=c,cs=f;break;case 5:vn||Ur(l,r);case 6:if(c=Yt,f=cs,Yt=null,ga(n,r,l),Yt=c,cs=f,Yt!==null)if(cs)try{(Yt.nodeType===9?Yt.body:Yt.nodeName==="HTML"?Yt.ownerDocument.body:Yt).removeChild(l.stateNode)}catch(m){It(l,r,m)}else try{Yt.removeChild(l.stateNode)}catch(m){It(l,r,m)}break;case 18:Yt!==null&&(cs?(n=Yt,Zb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,l.stateNode),go(n)):Zb(Yt,l.stateNode));break;case 4:c=Yt,f=cs,Yt=l.stateNode.containerInfo,cs=!0,ga(n,r,l),Yt=c,cs=f;break;case 0:case 11:case 14:case 15:ii(2,l,r),vn||ii(4,l,r),ga(n,r,l);break;case 1:vn||(Ur(l,r),c=l.stateNode,typeof c.componentWillUnmount=="function"&&eb(l,r,c)),ga(n,r,l);break;case 21:ga(n,r,l);break;case 22:vn=(c=vn)||l.memoizedState!==null,ga(n,r,l),vn=c;break;default:ga(n,r,l)}}function ob(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{go(n)}catch(l){It(r,r.return,l)}}}function cb(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{go(n)}catch(l){It(r,r.return,l)}}function ij(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new rb),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new rb),r;default:throw Error(a(435,n.tag))}}function Bd(n,r){var l=ij(n);r.forEach(function(c){if(!l.has(c)){l.add(c);var f=pj.bind(null,n,c);c.then(f,f)}})}function us(n,r){var l=r.deletions;if(l!==null)for(var c=0;c<l.length;c++){var f=l[c],m=n,v=r,j=v;e:for(;j!==null;){switch(j.tag){case 27:if(fi(j.type)){Yt=j.stateNode,cs=!1;break e}break;case 5:Yt=j.stateNode,cs=!1;break e;case 3:case 4:Yt=j.stateNode.containerInfo,cs=!0;break e}j=j.return}if(Yt===null)throw Error(a(160));lb(m,v,f),Yt=null,cs=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)ub(r,n),r=r.sibling}var fr=null;function ub(n,r){var l=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:us(r,n),ds(n),c&4&&(ii(3,n,n.return),Dc(3,n),ii(5,n,n.return));break;case 1:us(r,n),ds(n),c&512&&(vn||l===null||Ur(l,l.return)),c&64&&pa&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(l=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var f=fr;if(us(r,n),ds(n),c&512&&(vn||l===null||Ur(l,l.return)),c&4){var m=l!==null?l.memoizedState:null;if(c=n.memoizedState,l===null)if(c===null)if(n.stateNode===null){e:{c=n.type,l=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[Cn]||m[tt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Pn(m,c,l),m[tt]=n,pn(m),c=m;break e;case"link":var v=uv("link","href",f).get(c+(l.href||""));if(v){for(var j=0;j<v.length;j++)if(m=v[j],m.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&m.getAttribute("rel")===(l.rel==null?null:l.rel)&&m.getAttribute("title")===(l.title==null?null:l.title)&&m.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){v.splice(j,1);break t}}m=f.createElement(c),Pn(m,c,l),f.head.appendChild(m);break;case"meta":if(v=uv("meta","content",f).get(c+(l.content||""))){for(j=0;j<v.length;j++)if(m=v[j],m.getAttribute("content")===(l.content==null?null:""+l.content)&&m.getAttribute("name")===(l.name==null?null:l.name)&&m.getAttribute("property")===(l.property==null?null:l.property)&&m.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&m.getAttribute("charset")===(l.charSet==null?null:l.charSet)){v.splice(j,1);break t}}m=f.createElement(c),Pn(m,c,l),f.head.appendChild(m);break;default:throw Error(a(468,c))}m[tt]=n,pn(m),c=m}n.stateNode=c}else dv(f,n.type,n.stateNode);else n.stateNode=cv(f,c,n.memoizedProps);else m!==c?(m===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):m.count--,c===null?dv(f,n.type,n.stateNode):cv(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Gm(n,n.memoizedProps,l.memoizedProps)}break;case 27:us(r,n),ds(n),c&512&&(vn||l===null||Ur(l,l.return)),l!==null&&c&4&&Gm(n,n.memoizedProps,l.memoizedProps);break;case 5:if(us(r,n),ds(n),c&512&&(vn||l===null||Ur(l,l.return)),n.flags&32){f=n.stateNode;try{os(f,"")}catch(Ve){It(n,n.return,Ve)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Gm(n,f,l!==null?l.memoizedProps:f)),c&1024&&(Xm=!0);break;case 6:if(us(r,n),ds(n),c&4){if(n.stateNode===null)throw Error(a(162));c=n.memoizedProps,l=n.stateNode;try{l.nodeValue=c}catch(Ve){It(n,n.return,Ve)}}break;case 3:if(sh=null,f=fr,fr=th(r.containerInfo),us(r,n),fr=f,ds(n),c&4&&l!==null&&l.memoizedState.isDehydrated)try{go(r.containerInfo)}catch(Ve){It(n,n.return,Ve)}Xm&&(Xm=!1,db(n));break;case 4:c=fr,fr=th(n.stateNode.containerInfo),us(r,n),ds(n),fr=c;break;case 12:us(r,n),ds(n);break;case 31:us(r,n),ds(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Bd(n,c)));break;case 13:us(r,n),ds(n),n.child.flags&8192&&n.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Fd=Bt()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Bd(n,c)));break;case 22:f=n.memoizedState!==null;var P=l!==null&&l.memoizedState!==null,te=pa,ue=vn;if(pa=te||f,vn=ue||P,us(r,n),vn=ue,pa=te,ds(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(l===null||P||pa||vn||dl(n)),l=null,r=n;;){if(r.tag===5||r.tag===26){if(l===null){P=l=r;try{if(m=P.stateNode,f)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{j=P.stateNode;var ge=P.memoizedProps.style,se=ge!=null&&ge.hasOwnProperty("display")?ge.display:null;j.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Ve){It(P,P.return,Ve)}}}else if(r.tag===6){if(l===null){P=r;try{P.stateNode.nodeValue=f?"":P.memoizedProps}catch(Ve){It(P,P.return,Ve)}}}else if(r.tag===18){if(l===null){P=r;try{var ie=P.stateNode;f?ev(ie,!0):ev(P.stateNode,!1)}catch(Ve){It(P,P.return,Ve)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,Bd(n,l))));break;case 19:us(r,n),ds(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Bd(n,c)));break;case 30:break;case 21:break;default:us(r,n),ds(n)}}function ds(n){var r=n.flags;if(r&2){try{for(var l,c=n.return;c!==null;){if(nb(c)){l=c;break}c=c.return}if(l==null)throw Error(a(160));switch(l.tag){case 27:var f=l.stateNode,m=Ym(n);zd(n,m,f);break;case 5:var v=l.stateNode;l.flags&32&&(os(v,""),l.flags&=-33);var j=Ym(n);zd(n,j,v);break;case 3:case 4:var P=l.stateNode.containerInfo,te=Ym(n);Qm(n,te,P);break;default:throw Error(a(161))}}catch(ue){It(n,n.return,ue)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function db(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;db(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function xa(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)ab(n,r.alternate,r),r=r.sibling}function dl(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:ii(4,r,r.return),dl(r);break;case 1:Ur(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&eb(r,r.return,l),dl(r);break;case 27:Fc(r.stateNode);case 26:case 5:Ur(r,r.return),dl(r);break;case 22:r.memoizedState===null&&dl(r);break;case 30:dl(r);break;default:dl(r)}n=n.sibling}}function ya(n,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,v=m.flags;switch(m.tag){case 0:case 11:case 15:ya(f,m,l),Dc(4,m);break;case 1:if(ya(f,m,l),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(te){It(c,c.return,te)}if(c=m,f=c.updateQueue,f!==null){var j=c.stateNode;try{var P=f.shared.hiddenCallbacks;if(P!==null)for(f.shared.hiddenCallbacks=null,f=0;f<P.length;f++)Hx(P[f],j)}catch(te){It(c,c.return,te)}}l&&v&64&&Zy(m),Oc(m,m.return);break;case 27:sb(m);case 26:case 5:ya(f,m,l),l&&c===null&&v&4&&tb(m),Oc(m,m.return);break;case 12:ya(f,m,l);break;case 31:ya(f,m,l),l&&v&4&&ob(f,m);break;case 13:ya(f,m,l),l&&v&4&&cb(f,m);break;case 22:m.memoizedState===null&&ya(f,m,l),Oc(m,m.return);break;case 30:break;default:ya(f,m,l)}r=r.sibling}}function Wm(n,r){var l=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==l&&(n!=null&&n.refCount++,l!=null&&vc(l))}function Jm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&vc(n))}function mr(n,r,l,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)hb(n,r,l,c),r=r.sibling}function hb(n,r,l,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:mr(n,r,l,c),f&2048&&Dc(9,r);break;case 1:mr(n,r,l,c);break;case 3:mr(n,r,l,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&vc(n)));break;case 12:if(f&2048){mr(n,r,l,c),n=r.stateNode;try{var m=r.memoizedProps,v=m.id,j=m.onPostCommit;typeof j=="function"&&j(v,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(P){It(r,r.return,P)}}else mr(n,r,l,c);break;case 31:mr(n,r,l,c);break;case 13:mr(n,r,l,c);break;case 23:break;case 22:m=r.stateNode,v=r.alternate,r.memoizedState!==null?m._visibility&2?mr(n,r,l,c):Mc(n,r):m._visibility&2?mr(n,r,l,c):(m._visibility|=2,ro(n,r,l,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Wm(v,r);break;case 24:mr(n,r,l,c),f&2048&&Jm(r.alternate,r);break;default:mr(n,r,l,c)}}function ro(n,r,l,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,v=r,j=l,P=c,te=v.flags;switch(v.tag){case 0:case 11:case 15:ro(m,v,j,P,f),Dc(8,v);break;case 23:break;case 22:var ue=v.stateNode;v.memoizedState!==null?ue._visibility&2?ro(m,v,j,P,f):Mc(m,v):(ue._visibility|=2,ro(m,v,j,P,f)),f&&te&2048&&Wm(v.alternate,v);break;case 24:ro(m,v,j,P,f),f&&te&2048&&Jm(v.alternate,v);break;default:ro(m,v,j,P,f)}r=r.sibling}}function Mc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=n,c=r,f=c.flags;switch(c.tag){case 22:Mc(l,c),f&2048&&Wm(c.alternate,c);break;case 24:Mc(l,c),f&2048&&Jm(c.alternate,c);break;default:Mc(l,c)}r=r.sibling}}var Vc=8192;function ao(n,r,l){if(n.subtreeFlags&Vc)for(n=n.child;n!==null;)fb(n,r,l),n=n.sibling}function fb(n,r,l){switch(n.tag){case 26:ao(n,r,l),n.flags&Vc&&n.memoizedState!==null&&Kj(l,fr,n.memoizedState,n.memoizedProps);break;case 5:ao(n,r,l);break;case 3:case 4:var c=fr;fr=th(n.stateNode.containerInfo),ao(n,r,l),fr=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Vc,Vc=16777216,ao(n,r,l),Vc=c):ao(n,r,l));break;default:ao(n,r,l)}}function mb(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Pc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var c=r[l];Rn=c,gb(c,n)}mb(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)pb(n),n=n.sibling}function pb(n){switch(n.tag){case 0:case 11:case 15:Pc(n),n.flags&2048&&ii(9,n,n.return);break;case 3:Pc(n);break;case 12:Pc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Hd(n)):Pc(n);break;default:Pc(n)}}function Hd(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var c=r[l];Rn=c,gb(c,n)}mb(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:ii(8,r,r.return),Hd(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,Hd(r));break;default:Hd(r)}n=n.sibling}}function gb(n,r){for(;Rn!==null;){var l=Rn;switch(l.tag){case 0:case 11:case 15:ii(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:vc(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,Rn=c;else e:for(l=n;Rn!==null;){c=Rn;var f=c.sibling,m=c.return;if(ib(c),c===l){Rn=null;break e}if(f!==null){f.return=m,Rn=f;break e}Rn=m}}}var lj={getCacheForType:function(n){var r=Mn(xn),l=r.data.get(n);return l===void 0&&(l=n(),r.data.set(n,l)),l},cacheSignal:function(){return Mn(xn).controller.signal}},oj=typeof WeakMap=="function"?WeakMap:Map,Nt=0,Lt=null,lt=null,ct=0,kt=0,Is=null,li=!1,io=!1,Zm=!1,ba=0,tn=0,oi=0,hl=0,ep=0,Ds=0,lo=0,Lc=null,hs=null,tp=!1,Fd=0,xb=0,qd=1/0,$d=null,ci=null,jn=0,ui=null,oo=null,va=0,np=0,sp=null,yb=null,Uc=0,rp=null;function Os(){return(Nt&2)!==0&&ct!==0?ct&-ct:X.T!==null?up():Ue()}function bb(){if(Ds===0)if((ct&536870912)===0||mt){var n=js;js<<=1,(js&3932160)===0&&(js=262144),Ds=n}else Ds=536870912;return n=Rs.current,n!==null&&(n.flags|=32),Ds}function fs(n,r,l){(n===Lt&&(kt===2||kt===9)||n.cancelPendingCommit!==null)&&(co(n,0),di(n,ct,Ds,!1)),ne(n,l),((Nt&2)===0||n!==Lt)&&(n===Lt&&((Nt&2)===0&&(hl|=l),tn===4&&di(n,ct,Ds,!1)),zr(n))}function vb(n,r,l){if((Nt&6)!==0)throw Error(a(327));var c=!l&&(r&127)===0&&(r&n.expiredLanes)===0||Wn(n,r),f=c?dj(n,r):ip(n,r,!0),m=c;do{if(f===0){io&&!c&&di(n,r,0,!1);break}else{if(l=n.current.alternate,m&&!cj(l)){f=ip(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var v=0;else v=n.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){r=v;e:{var j=n;f=Lc;var P=j.current.memoizedState.isDehydrated;if(P&&(co(j,v).flags|=256),v=ip(j,v,!1),v!==2){if(Zm&&!P){j.errorRecoveryDisabledLanes|=m,hl|=m,f=4;break e}m=hs,hs=f,m!==null&&(hs===null?hs=m:hs.push.apply(hs,m))}f=v}if(m=!1,f!==2)continue}}if(f===1){co(n,0),di(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(a(345));case 4:if((r&4194048)!==r)break;case 6:di(c,r,Ds,!li);break e;case 2:hs=null;break;case 3:case 5:break;default:throw Error(a(329))}if((r&62914560)===r&&(f=Fd+300-Bt(),10<f)){if(di(c,r,Ds,!li),is(c,0,!0)!==0)break e;va=r,c.timeoutHandle=Wb(wb.bind(null,c,l,hs,$d,tp,r,Ds,hl,lo,li,m,"Throttled",-0,0),f);break e}wb(c,l,hs,$d,tp,r,Ds,hl,lo,li,m,null,-0,0)}}break}while(!0);zr(n)}function wb(n,r,l,c,f,m,v,j,P,te,ue,ge,se,ie){if(n.timeoutHandle=-1,ge=r.subtreeFlags,ge&8192||(ge&16785408)===16785408){ge={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:lr},fb(r,m,ge);var Ve=(m&62914560)===m?Fd-Bt():(m&4194048)===m?xb-Bt():0;if(Ve=Gj(ge,Ve),Ve!==null){va=m,n.cancelPendingCommit=Ve(Ab.bind(null,n,r,m,l,c,f,v,j,P,ue,ge,null,se,ie)),di(n,m,v,!te);return}}Ab(n,r,m,l,c,f,v,j,P)}function cj(n){for(var r=n;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var f=l[c],m=f.getSnapshot;f=f.value;try{if(!Cs(m(),f))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function di(n,r,l,c){r&=~ep,r&=~hl,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-wt(f),v=1<<m;c[m]=-1,f&=~v}l!==0&&Ce(n,l,r)}function Kd(){return(Nt&6)===0?(zc(0),!1):!0}function ap(){if(lt!==null){if(kt===0)var n=lt.return;else n=lt,ca=sl=null,wm(n),Zl=null,_c=0,n=lt;for(;n!==null;)Jy(n.alternate,n),n=n.return;lt=null}}function co(n,r){var l=n.timeoutHandle;l!==-1&&(n.timeoutHandle=-1,Aj(l)),l=n.cancelPendingCommit,l!==null&&(n.cancelPendingCommit=null,l()),va=0,ap(),Lt=n,lt=l=la(n.current,null),ct=r,kt=0,Is=null,li=!1,io=Wn(n,r),Zm=!1,lo=Ds=ep=hl=oi=tn=0,hs=Lc=null,tp=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-wt(c),m=1<<f;r|=n[f],c&=~m}return ba=r,fd(),l}function _b(n,r){rt=null,X.H=Rc,r===Jl||r===wd?(r=Lx(),kt=3):r===cm?(r=Lx(),kt=4):kt=r===Pm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Is=r,lt===null&&(tn=1,Md(n,Gs(r,n.current)))}function Nb(){var n=Rs.current;return n===null?!0:(ct&4194048)===ct?Ws===null:(ct&62914560)===ct||(ct&536870912)!==0?n===Ws:!1}function Tb(){var n=X.H;return X.H=Rc,n===null?Rc:n}function jb(){var n=X.A;return X.A=lj,n}function Gd(){tn=4,li||(ct&4194048)!==ct&&Rs.current!==null||(io=!0),(oi&134217727)===0&&(hl&134217727)===0||Lt===null||di(Lt,ct,Ds,!1)}function ip(n,r,l){var c=Nt;Nt|=2;var f=Tb(),m=jb();(Lt!==n||ct!==r)&&($d=null,co(n,r)),r=!1;var v=tn;e:do try{if(kt!==0&&lt!==null){var j=lt,P=Is;switch(kt){case 8:ap(),v=6;break e;case 3:case 2:case 9:case 6:Rs.current===null&&(r=!0);var te=kt;if(kt=0,Is=null,uo(n,j,P,te),l&&io){v=0;break e}break;default:te=kt,kt=0,Is=null,uo(n,j,P,te)}}uj(),v=tn;break}catch(ue){_b(n,ue)}while(!0);return r&&n.shellSuspendCounter++,ca=sl=null,Nt=c,X.H=f,X.A=m,lt===null&&(Lt=null,ct=0,fd()),v}function uj(){for(;lt!==null;)Eb(lt)}function dj(n,r){var l=Nt;Nt|=2;var c=Tb(),f=jb();Lt!==n||ct!==r?($d=null,qd=Bt()+500,co(n,r)):io=Wn(n,r);e:do try{if(kt!==0&&lt!==null){r=lt;var m=Is;t:switch(kt){case 1:kt=0,Is=null,uo(n,r,m,1);break;case 2:case 9:if(Vx(m)){kt=0,Is=null,Sb(r);break}r=function(){kt!==2&&kt!==9||Lt!==n||(kt=7),zr(n)},m.then(r,r);break e;case 3:kt=7;break e;case 4:kt=5;break e;case 7:Vx(m)?(kt=0,Is=null,Sb(r)):(kt=0,Is=null,uo(n,r,m,7));break;case 5:var v=null;switch(lt.tag){case 26:v=lt.memoizedState;case 5:case 27:var j=lt;if(v?hv(v):j.stateNode.complete){kt=0,Is=null;var P=j.sibling;if(P!==null)lt=P;else{var te=j.return;te!==null?(lt=te,Yd(te)):lt=null}break t}}kt=0,Is=null,uo(n,r,m,5);break;case 6:kt=0,Is=null,uo(n,r,m,6);break;case 8:ap(),tn=6;break e;default:throw Error(a(462))}}hj();break}catch(ue){_b(n,ue)}while(!0);return ca=sl=null,X.H=c,X.A=f,Nt=l,lt!==null?0:(Lt=null,ct=0,fd(),tn)}function hj(){for(;lt!==null&&!ir();)Eb(lt)}function Eb(n){var r=Xy(n.alternate,n,ba);n.memoizedProps=n.pendingProps,r===null?Yd(n):lt=r}function Sb(n){var r=n,l=r.alternate;switch(r.tag){case 15:case 0:r=qy(l,r,r.pendingProps,r.type,void 0,ct);break;case 11:r=qy(l,r,r.pendingProps,r.type.render,r.ref,ct);break;case 5:wm(r);default:Jy(l,r),r=lt=jx(r,ba),r=Xy(l,r,ba)}n.memoizedProps=n.pendingProps,r===null?Yd(n):lt=r}function uo(n,r,l,c){ca=sl=null,wm(r),Zl=null,_c=0;var f=r.return;try{if(ej(n,f,r,l,ct)){tn=1,Md(n,Gs(l,n.current)),lt=null;return}}catch(m){if(f!==null)throw lt=f,m;tn=1,Md(n,Gs(l,n.current)),lt=null;return}r.flags&32768?(mt||c===1?n=!0:io||(ct&536870912)!==0?n=!1:(li=n=!0,(c===2||c===9||c===3||c===6)&&(c=Rs.current,c!==null&&c.tag===13&&(c.flags|=16384))),Cb(r,n)):Yd(r)}function Yd(n){var r=n;do{if((r.flags&32768)!==0){Cb(r,li);return}n=r.return;var l=sj(r.alternate,r,ba);if(l!==null){lt=l;return}if(r=r.sibling,r!==null){lt=r;return}lt=r=n}while(r!==null);tn===0&&(tn=5)}function Cb(n,r){do{var l=rj(n.alternate,n);if(l!==null){l.flags&=32767,lt=l;return}if(l=n.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(n=n.sibling,n!==null)){lt=n;return}lt=n=l}while(n!==null);tn=6,lt=null}function Ab(n,r,l,c,f,m,v,j,P){n.cancelPendingCommit=null;do Qd();while(jn!==0);if((Nt&6)!==0)throw Error(a(327));if(r!==null){if(r===n.current)throw Error(a(177));if(m=r.lanes|r.childLanes,m|=Yf,pe(n,l,m,v,j,P),n===Lt&&(lt=Lt=null,ct=0),oo=r,ui=n,va=l,np=m,sp=f,yb=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,gj(Bn,function(){return Ob(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=X.T,X.T=null,f=Z.p,Z.p=2,v=Nt,Nt|=4;try{aj(n,r,l)}finally{Nt=v,Z.p=f,X.T=c}}jn=1,Rb(),kb(),Ib()}}function Rb(){if(jn===1){jn=0;var n=ui,r=oo,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=X.T,X.T=null;var c=Z.p;Z.p=2;var f=Nt;Nt|=4;try{ub(r,n);var m=yp,v=gx(n.containerInfo),j=m.focusedElem,P=m.selectionRange;if(v!==j&&j&&j.ownerDocument&&px(j.ownerDocument.documentElement,j)){if(P!==null&&Ff(j)){var te=P.start,ue=P.end;if(ue===void 0&&(ue=te),"selectionStart"in j)j.selectionStart=te,j.selectionEnd=Math.min(ue,j.value.length);else{var ge=j.ownerDocument||document,se=ge&&ge.defaultView||window;if(se.getSelection){var ie=se.getSelection(),Ve=j.textContent.length,$e=Math.min(P.start,Ve),Pt=P.end===void 0?$e:Math.min(P.end,Ve);!ie.extend&&$e>Pt&&(v=Pt,Pt=$e,$e=v);var G=mx(j,$e),H=mx(j,Pt);if(G&&H&&(ie.rangeCount!==1||ie.anchorNode!==G.node||ie.anchorOffset!==G.offset||ie.focusNode!==H.node||ie.focusOffset!==H.offset)){var ee=ge.createRange();ee.setStart(G.node,G.offset),ie.removeAllRanges(),$e>Pt?(ie.addRange(ee),ie.extend(H.node,H.offset)):(ee.setEnd(H.node,H.offset),ie.addRange(ee))}}}}for(ge=[],ie=j;ie=ie.parentNode;)ie.nodeType===1&&ge.push({element:ie,left:ie.scrollLeft,top:ie.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<ge.length;j++){var fe=ge[j];fe.element.scrollLeft=fe.left,fe.element.scrollTop=fe.top}}lh=!!xp,yp=xp=null}finally{Nt=f,Z.p=c,X.T=l}}n.current=r,jn=2}}function kb(){if(jn===2){jn=0;var n=ui,r=oo,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=X.T,X.T=null;var c=Z.p;Z.p=2;var f=Nt;Nt|=4;try{ab(n,r.alternate,r)}finally{Nt=f,Z.p=c,X.T=l}}jn=3}}function Ib(){if(jn===4||jn===3){jn=0,In();var n=ui,r=oo,l=va,c=yb;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?jn=5:(jn=0,oo=ui=null,Db(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(ci=null),Ne(l),r=r.stateNode,vt&&typeof vt.onCommitFiberRoot=="function")try{vt.onCommitFiberRoot(Dt,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=X.T,f=Z.p,Z.p=2,X.T=null;try{for(var m=n.onRecoverableError,v=0;v<c.length;v++){var j=c[v];m(j.value,{componentStack:j.stack})}}finally{X.T=r,Z.p=f}}(va&3)!==0&&Qd(),zr(n),f=n.pendingLanes,(l&261930)!==0&&(f&42)!==0?n===rp?Uc++:(Uc=0,rp=n):Uc=0,zc(0)}}function Db(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,vc(r)))}function Qd(){return Rb(),kb(),Ib(),Ob()}function Ob(){if(jn!==5)return!1;var n=ui,r=np;np=0;var l=Ne(va),c=X.T,f=Z.p;try{Z.p=32>l?32:l,X.T=null,l=sp,sp=null;var m=ui,v=va;if(jn=0,oo=ui=null,va=0,(Nt&6)!==0)throw Error(a(331));var j=Nt;if(Nt|=4,pb(m.current),hb(m,m.current,v,l),Nt=j,zc(0,!1),vt&&typeof vt.onPostCommitFiberRoot=="function")try{vt.onPostCommitFiberRoot(Dt,m)}catch{}return!0}finally{Z.p=f,X.T=c,Db(n,r)}}function Mb(n,r,l){r=Gs(l,r),r=Vm(n.stateNode,r,2),n=si(n,r,2),n!==null&&(ne(n,2),zr(n))}function It(n,r,l){if(n.tag===3)Mb(n,n,l);else for(;r!==null;){if(r.tag===3){Mb(r,n,l);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(ci===null||!ci.has(c))){n=Gs(l,n),l=Vy(2),c=si(r,l,2),c!==null&&(Py(l,c,r,n),ne(c,2),zr(c));break}}r=r.return}}function lp(n,r,l){var c=n.pingCache;if(c===null){c=n.pingCache=new oj;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(l)||(Zm=!0,f.add(l),n=fj.bind(null,n,r,l),r.then(n,n))}function fj(n,r,l){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&l,n.warmLanes&=~l,Lt===n&&(ct&l)===l&&(tn===4||tn===3&&(ct&62914560)===ct&&300>Bt()-Fd?(Nt&2)===0&&co(n,0):ep|=l,lo===ct&&(lo=0)),zr(n)}function Vb(n,r){r===0&&(r=Ba()),n=el(n,r),n!==null&&(ne(n,r),zr(n))}function mj(n){var r=n.memoizedState,l=0;r!==null&&(l=r.retryLane),Vb(n,l)}function pj(n,r){var l=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(l=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(a(314))}c!==null&&c.delete(r),Vb(n,l)}function gj(n,r){return zt(n,r)}var Xd=null,ho=null,op=!1,Wd=!1,cp=!1,hi=0;function zr(n){n!==ho&&n.next===null&&(ho===null?Xd=ho=n:ho=ho.next=n),Wd=!0,op||(op=!0,yj())}function zc(n,r){if(!cp&&Wd){cp=!0;do for(var l=!1,c=Xd;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var v=c.suspendedLanes,j=c.pingedLanes;m=(1<<31-wt(42|n)+1)-1,m&=f&~(v&~j),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(l=!0,zb(c,m))}else m=ct,m=is(c,c===Lt?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Wn(c,m)||(l=!0,zb(c,m));c=c.next}while(l);cp=!1}}function xj(){Pb()}function Pb(){Wd=op=!1;var n=0;hi!==0&&Cj()&&(n=hi);for(var r=Bt(),l=null,c=Xd;c!==null;){var f=c.next,m=Lb(c,r);m===0?(c.next=null,l===null?Xd=f:l.next=f,f===null&&(ho=l)):(l=c,(n!==0||(m&3)!==0)&&(Wd=!0)),c=f}jn!==0&&jn!==5||zc(n),hi!==0&&(hi=0)}function Lb(n,r){for(var l=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var v=31-wt(m),j=1<<v,P=f[v];P===-1?((j&l)===0||(j&c)!==0)&&(f[v]=Hi(j,r)):P<=r&&(n.expiredLanes|=j),m&=~j}if(r=Lt,l=ct,l=is(n,n===r?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,l===0||n===r&&(kt===2||kt===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&ws(c),n.callbackNode=null,n.callbackPriority=0;if((l&3)===0||Wn(n,l)){if(r=l&-l,r===n.callbackPriority)return r;switch(c!==null&&ws(c),Ne(l)){case 2:case 8:l=Bs;break;case 32:l=Bn;break;case 268435456:l=Qe;break;default:l=Bn}return c=Ub.bind(null,n),l=zt(l,c),n.callbackPriority=r,n.callbackNode=l,r}return c!==null&&c!==null&&ws(c),n.callbackPriority=2,n.callbackNode=null,2}function Ub(n,r){if(jn!==0&&jn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var l=n.callbackNode;if(Qd()&&n.callbackNode!==l)return null;var c=ct;return c=is(n,n===Lt?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(vb(n,c,r),Lb(n,Bt()),n.callbackNode!=null&&n.callbackNode===l?Ub.bind(null,n):null)}function zb(n,r){if(Qd())return null;vb(n,r,!0)}function yj(){Rj(function(){(Nt&6)!==0?zt(Ns,xj):Pb()})}function up(){if(hi===0){var n=Xl;n===0&&(n=Tn,Tn<<=1,(Tn&261888)===0&&(Tn=256)),hi=n}return hi}function Bb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Ml(""+n)}function Hb(n,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,n.id&&l.setAttribute("form",n.id),r.parentNode.insertBefore(l,r),n=new FormData(n),l.parentNode.removeChild(l),n}function bj(n,r,l,c,f){if(r==="submit"&&l&&l.stateNode===f){var m=Bb((f[it]||null).action),v=c.submitter;v&&(r=(r=v[it]||null)?Bb(r.formAction):v.getAttribute("formAction"),r!==null&&(m=r,v=null));var j=new Dr("action","action",null,c,f);n.push({event:j,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(hi!==0){var P=v?Hb(f,v):new FormData(f);Rm(l,{pending:!0,data:P,method:f.method,action:m},null,P)}}else typeof m=="function"&&(j.preventDefault(),P=v?Hb(f,v):new FormData(f),Rm(l,{pending:!0,data:P,method:f.method,action:m},m,P))},currentTarget:f}]})}}for(var dp=0;dp<Gf.length;dp++){var hp=Gf[dp],vj=hp.toLowerCase(),wj=hp[0].toUpperCase()+hp.slice(1);hr(vj,"on"+wj)}hr(bx,"onAnimationEnd"),hr(vx,"onAnimationIteration"),hr(wx,"onAnimationStart"),hr("dblclick","onDoubleClick"),hr("focusin","onFocus"),hr("focusout","onBlur"),hr(PT,"onTransitionRun"),hr(LT,"onTransitionStart"),hr(UT,"onTransitionCancel"),hr(_x,"onTransitionEnd"),Ar("onMouseEnter",["mouseout","mouseover"]),Ar("onMouseLeave",["mouseout","mouseover"]),Ar("onPointerEnter",["pointerout","pointerover"]),Ar("onPointerLeave",["pointerout","pointerover"]),Cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Cr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_j=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bc));function Fb(n,r){r=(r&4)!==0;for(var l=0;l<n.length;l++){var c=n[l],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var v=c.length-1;0<=v;v--){var j=c[v],P=j.instance,te=j.currentTarget;if(j=j.listener,P!==m&&f.isPropagationStopped())break e;m=j,f.currentTarget=te;try{m(f)}catch(ue){hd(ue)}f.currentTarget=null,m=P}else for(v=0;v<c.length;v++){if(j=c[v],P=j.instance,te=j.currentTarget,j=j.listener,P!==m&&f.isPropagationStopped())break e;m=j,f.currentTarget=te;try{m(f)}catch(ue){hd(ue)}f.currentTarget=null,m=P}}}}function ot(n,r){var l=r[ln];l===void 0&&(l=r[ln]=new Set);var c=n+"__bubble";l.has(c)||(qb(r,n,2,!1),l.add(c))}function fp(n,r,l){var c=0;r&&(c|=4),qb(l,n,c,r)}var Jd="_reactListening"+Math.random().toString(36).slice(2);function mp(n){if(!n[Jd]){n[Jd]=!0,Zo.forEach(function(l){l!=="selectionchange"&&(_j.has(l)||fp(l,!1,n),fp(l,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Jd]||(r[Jd]=!0,fp("selectionchange",!1,r))}}function qb(n,r,l,c){switch(bv(r)){case 2:var f=Xj;break;case 8:f=Wj;break;default:f=Ap}l=f.bind(null,r,l,n),f=void 0,!Ki||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,l,{capture:!0,passive:f}):n.addEventListener(r,l,!0):f!==void 0?n.addEventListener(r,l,{passive:f}):n.addEventListener(r,l,!1)}function pp(n,r,l,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var j=c.stateNode.containerInfo;if(j===f)break;if(v===4)for(v=c.return;v!==null;){var P=v.tag;if((P===3||P===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;j!==null;){if(v=Er(j),v===null)return;if(P=v.tag,P===5||P===6||P===26||P===27){c=m=v;continue e}j=j.parentNode}}c=c.return}Ga(function(){var te=m,ue=Fs(l),ge=[];e:{var se=Nx.get(n);if(se!==void 0){var ie=Dr,Ve=n;switch(n){case"keypress":if(Yi(l)===0)break e;case"keydown":case"keyup":ie=cd;break;case"focusin":Ve="focus",ie=Xi;break;case"focusout":Ve="blur",ie=Xi;break;case"beforeblur":case"afterblur":ie=Xi;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ie=hc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ie=ed;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ie=y;break;case bx:case vx:case wx:ie=nd;break;case _x:ie=A;break;case"scroll":case"scrollend":ie=dc;break;case"wheel":ie=ae;break;case"copy":case"cut":case"paste":ie=sd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ie=ia;break;case"toggle":case"beforetoggle":ie=st}var $e=(r&4)!==0,Pt=!$e&&(n==="scroll"||n==="scrollend"),G=$e?se!==null?se+"Capture":null:se;$e=[];for(var H=te,ee;H!==null;){var fe=H;if(ee=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||ee===null||G===null||(fe=or(H,G),fe!=null&&$e.push(Hc(H,fe,ee))),Pt)break;H=H.return}0<$e.length&&(se=new ie(se,Ve,null,l,ue),ge.push({event:se,listeners:$e}))}}if((r&7)===0){e:{if(se=n==="mouseover"||n==="pointerover",ie=n==="mouseout"||n==="pointerout",se&&l!==oc&&(Ve=l.relatedTarget||l.fromElement)&&(Er(Ve)||Ve[$t]))break e;if((ie||se)&&(se=ue.window===ue?ue:(se=ue.ownerDocument)?se.defaultView||se.parentWindow:window,ie?(Ve=l.relatedTarget||l.toElement,ie=te,Ve=Ve?Er(Ve):null,Ve!==null&&(Pt=u(Ve),$e=Ve.tag,Ve!==Pt||$e!==5&&$e!==27&&$e!==6)&&(Ve=null)):(ie=null,Ve=te),ie!==Ve)){if($e=hc,fe="onMouseLeave",G="onMouseEnter",H="mouse",(n==="pointerout"||n==="pointerover")&&($e=ia,fe="onPointerLeave",G="onPointerEnter",H="pointer"),Pt=ie==null?se:Es(ie),ee=Ve==null?se:Es(Ve),se=new $e(fe,H+"leave",ie,l,ue),se.target=Pt,se.relatedTarget=ee,fe=null,Er(ue)===te&&($e=new $e(G,H+"enter",Ve,l,ue),$e.target=ee,$e.relatedTarget=Pt,fe=$e),Pt=fe,ie&&Ve)t:{for($e=Nj,G=ie,H=Ve,ee=0,fe=G;fe;fe=$e(fe))ee++;fe=0;for(var He=H;He;He=$e(He))fe++;for(;0<ee-fe;)G=$e(G),ee--;for(;0<fe-ee;)H=$e(H),fe--;for(;ee--;){if(G===H||H!==null&&G===H.alternate){$e=G;break t}G=$e(G),H=$e(H)}$e=null}else $e=null;ie!==null&&$b(ge,se,ie,$e,!1),Ve!==null&&Pt!==null&&$b(ge,Pt,Ve,$e,!0)}}e:{if(se=te?Es(te):window,ie=se.nodeName&&se.nodeName.toLowerCase(),ie==="select"||ie==="input"&&se.type==="file")var yt=ox;else if(ix(se))if(cx)yt=OT;else{yt=IT;var ze=kT}else ie=se.nodeName,!ie||ie.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?te&&Ol(te.elementType)&&(yt=ox):yt=DT;if(yt&&(yt=yt(n,te))){lx(ge,yt,l,ue);break e}ze&&ze(n,se,te),n==="focusout"&&te&&se.type==="number"&&te.memoizedProps.value!=null&&ac(se,"number",se.value)}switch(ze=te?Es(te):window,n){case"focusin":(ix(ze)||ze.contentEditable==="true")&&(Hl=ze,qf=te,xc=null);break;case"focusout":xc=qf=Hl=null;break;case"mousedown":$f=!0;break;case"contextmenu":case"mouseup":case"dragend":$f=!1,xx(ge,l,ue);break;case"selectionchange":if(VT)break;case"keydown":case"keyup":xx(ge,l,ue)}var at;if(_t)e:{switch(n){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Bl?Wi(n,l)&&(ut="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(ut="onCompositionStart");ut&&(Vr&&l.locale!=="ko"&&(Bl||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Bl&&(at=uc()):(Ir=ue,cc="value"in Ir?Ir.value:Ir.textContent,Bl=!0)),ze=Zd(te,ut),0<ze.length&&(ut=new Mr(ut,n,null,l,ue),ge.push({event:ut,listeners:ze}),at?ut.data=at:(at=zl(l),at!==null&&(ut.data=at)))),(at=$s?ST(n,l):CT(n,l))&&(ut=Zd(te,"onBeforeInput"),0<ut.length&&(ze=new Mr("onBeforeInput","beforeinput",null,l,ue),ge.push({event:ze,listeners:ut}),ze.data=at)),bj(ge,n,te,l,ue)}Fb(ge,r)})}function Hc(n,r,l){return{instance:n,listener:r,currentTarget:l}}function Zd(n,r){for(var l=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=or(n,l),f!=null&&c.unshift(Hc(n,f,m)),f=or(n,r),f!=null&&c.push(Hc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function Nj(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function $b(n,r,l,c,f){for(var m=r._reactName,v=[];l!==null&&l!==c;){var j=l,P=j.alternate,te=j.stateNode;if(j=j.tag,P!==null&&P===c)break;j!==5&&j!==26&&j!==27||te===null||(P=te,f?(te=or(l,m),te!=null&&v.unshift(Hc(l,te,P))):f||(te=or(l,m),te!=null&&v.push(Hc(l,te,P)))),l=l.return}v.length!==0&&n.push({event:r,listeners:v})}var Tj=/\r\n?/g,jj=/\u0000|\uFFFD/g;function Kb(n){return(typeof n=="string"?n:""+n).replace(Tj,`
`).replace(jj,"")}function Gb(n,r){return r=Kb(r),Kb(n)===r}function Vt(n,r,l,c,f,m){switch(l){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||os(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&os(n,""+c);break;case"className":Ss(n,"class",c);break;case"tabIndex":Ss(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Ss(n,l,c);break;case"style":lc(n,c,m);break;case"data":if(r!=="object"){Ss(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||l!=="href")){n.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(l);break}c=Ml(""+c),n.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(l==="formAction"?(r!=="input"&&Vt(n,r,"name",f.name,f,null),Vt(n,r,"formEncType",f.formEncType,f,null),Vt(n,r,"formMethod",f.formMethod,f,null),Vt(n,r,"formTarget",f.formTarget,f,null)):(Vt(n,r,"encType",f.encType,f,null),Vt(n,r,"method",f.method,f,null),Vt(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(l);break}c=Ml(""+c),n.setAttribute(l,c);break;case"onClick":c!=null&&(n.onclick=lr);break;case"onScroll":c!=null&&ot("scroll",n);break;case"onScrollEnd":c!=null&&ot("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(l=c.__html,l!=null){if(f.children!=null)throw Error(a(60));n.innerHTML=l}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}l=Ml(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,""+c):n.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,""):n.removeAttribute(l);break;case"capture":case"download":c===!0?n.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,c):n.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(l,c):n.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(l):n.setAttribute(l,c);break;case"popover":ot("beforetoggle",n),ot("toggle",n),Il(n,"popover",c);break;case"xlinkActuate":gn(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":gn(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":gn(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":gn(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":gn(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":gn(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":gn(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":gn(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":gn(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Il(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Zu.get(l)||l,Il(n,l,c))}}function gp(n,r,l,c,f,m){switch(l){case"style":lc(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(l=c.__html,l!=null){if(f.children!=null)throw Error(a(60));n.innerHTML=l}}break;case"children":typeof c=="string"?os(n,c):(typeof c=="number"||typeof c=="bigint")&&os(n,""+c);break;case"onScroll":c!=null&&ot("scroll",n);break;case"onScrollEnd":c!=null&&ot("scrollend",n);break;case"onClick":c!=null&&(n.onclick=lr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ec.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),r=l.slice(2,f?l.length-7:void 0),m=n[it]||null,m=m!=null?m[l]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(l in n?n[l]=null:n.hasAttribute(l)&&n.removeAttribute(l)),n.addEventListener(r,c,f);break e}l in n?n[l]=c:c===!0?n.setAttribute(l,""):Il(n,l,c)}}}function Pn(n,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ot("error",n),ot("load",n);var c=!1,f=!1,m;for(m in l)if(l.hasOwnProperty(m)){var v=l[m];if(v!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Vt(n,r,m,v,l,null)}}f&&Vt(n,r,"srcSet",l.srcSet,l,null),c&&Vt(n,r,"src",l.src,l,null);return;case"input":ot("invalid",n);var j=m=v=f=null,P=null,te=null;for(c in l)if(l.hasOwnProperty(c)){var ue=l[c];if(ue!=null)switch(c){case"name":f=ue;break;case"type":v=ue;break;case"checked":P=ue;break;case"defaultChecked":te=ue;break;case"value":m=ue;break;case"defaultValue":j=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(a(137,r));break;default:Vt(n,r,c,ue,l,null)}}Xu(n,m,j,P,te,v,f,!1);return;case"select":ot("invalid",n),c=v=m=null;for(f in l)if(l.hasOwnProperty(f)&&(j=l[f],j!=null))switch(f){case"value":m=j;break;case"defaultValue":v=j;break;case"multiple":c=j;default:Vt(n,r,f,j,l,null)}r=m,l=v,n.multiple=!!c,r!=null?Fa(n,!!c,r,!1):l!=null&&Fa(n,!!c,l,!0);return;case"textarea":ot("invalid",n),m=f=c=null;for(v in l)if(l.hasOwnProperty(v)&&(j=l[v],j!=null))switch(v){case"value":c=j;break;case"defaultValue":f=j;break;case"children":m=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(a(91));break;default:Vt(n,r,v,j,l,null)}qa(n,c,f,m);return;case"option":for(P in l)if(l.hasOwnProperty(P)&&(c=l[P],c!=null))switch(P){case"selected":n.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Vt(n,r,P,c,l,null)}return;case"dialog":ot("beforetoggle",n),ot("toggle",n),ot("cancel",n),ot("close",n);break;case"iframe":case"object":ot("load",n);break;case"video":case"audio":for(c=0;c<Bc.length;c++)ot(Bc[c],n);break;case"image":ot("error",n),ot("load",n);break;case"details":ot("toggle",n);break;case"embed":case"source":case"link":ot("error",n),ot("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in l)if(l.hasOwnProperty(te)&&(c=l[te],c!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Vt(n,r,te,c,l,null)}return;default:if(Ol(r)){for(ue in l)l.hasOwnProperty(ue)&&(c=l[ue],c!==void 0&&gp(n,r,ue,c,l,void 0));return}}for(j in l)l.hasOwnProperty(j)&&(c=l[j],c!=null&&Vt(n,r,j,c,l,null))}function Ej(n,r,l,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,v=null,j=null,P=null,te=null,ue=null;for(ie in l){var ge=l[ie];if(l.hasOwnProperty(ie)&&ge!=null)switch(ie){case"checked":break;case"value":break;case"defaultValue":P=ge;default:c.hasOwnProperty(ie)||Vt(n,r,ie,null,c,ge)}}for(var se in c){var ie=c[se];if(ge=l[se],c.hasOwnProperty(se)&&(ie!=null||ge!=null))switch(se){case"type":m=ie;break;case"name":f=ie;break;case"checked":te=ie;break;case"defaultChecked":ue=ie;break;case"value":v=ie;break;case"defaultValue":j=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(a(137,r));break;default:ie!==ge&&Vt(n,r,se,ie,c,ge)}}Dl(n,v,j,P,te,ue,m,f);return;case"select":ie=v=j=se=null;for(m in l)if(P=l[m],l.hasOwnProperty(m)&&P!=null)switch(m){case"value":break;case"multiple":ie=P;default:c.hasOwnProperty(m)||Vt(n,r,m,null,c,P)}for(f in c)if(m=c[f],P=l[f],c.hasOwnProperty(f)&&(m!=null||P!=null))switch(f){case"value":se=m;break;case"defaultValue":j=m;break;case"multiple":v=m;default:m!==P&&Vt(n,r,f,m,c,P)}r=j,l=v,c=ie,se!=null?Fa(n,!!l,se,!1):!!c!=!!l&&(r!=null?Fa(n,!!l,r,!0):Fa(n,!!l,l?[]:"",!1));return;case"textarea":ie=se=null;for(j in l)if(f=l[j],l.hasOwnProperty(j)&&f!=null&&!c.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:Vt(n,r,j,null,c,f)}for(v in c)if(f=c[v],m=l[v],c.hasOwnProperty(v)&&(f!=null||m!=null))switch(v){case"value":se=f;break;case"defaultValue":ie=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==m&&Vt(n,r,v,f,c,m)}Wu(n,se,ie);return;case"option":for(var Ve in l)if(se=l[Ve],l.hasOwnProperty(Ve)&&se!=null&&!c.hasOwnProperty(Ve))switch(Ve){case"selected":n.selected=!1;break;default:Vt(n,r,Ve,null,c,se)}for(P in c)if(se=c[P],ie=l[P],c.hasOwnProperty(P)&&se!==ie&&(se!=null||ie!=null))switch(P){case"selected":n.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:Vt(n,r,P,se,c,ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $e in l)se=l[$e],l.hasOwnProperty($e)&&se!=null&&!c.hasOwnProperty($e)&&Vt(n,r,$e,null,c,se);for(te in c)if(se=c[te],ie=l[te],c.hasOwnProperty(te)&&se!==ie&&(se!=null||ie!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(a(137,r));break;default:Vt(n,r,te,se,c,ie)}return;default:if(Ol(r)){for(var Pt in l)se=l[Pt],l.hasOwnProperty(Pt)&&se!==void 0&&!c.hasOwnProperty(Pt)&&gp(n,r,Pt,void 0,c,se);for(ue in c)se=c[ue],ie=l[ue],!c.hasOwnProperty(ue)||se===ie||se===void 0&&ie===void 0||gp(n,r,ue,se,c,ie);return}}for(var G in l)se=l[G],l.hasOwnProperty(G)&&se!=null&&!c.hasOwnProperty(G)&&Vt(n,r,G,null,c,se);for(ge in c)se=c[ge],ie=l[ge],!c.hasOwnProperty(ge)||se===ie||se==null&&ie==null||Vt(n,r,ge,se,c,ie)}function Yb(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Sj(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,l=performance.getEntriesByType("resource"),c=0;c<l.length;c++){var f=l[c],m=f.transferSize,v=f.initiatorType,j=f.duration;if(m&&j&&Yb(v)){for(v=0,j=f.responseEnd,c+=1;c<l.length;c++){var P=l[c],te=P.startTime;if(te>j)break;var ue=P.transferSize,ge=P.initiatorType;ue&&Yb(ge)&&(P=P.responseEnd,v+=ue*(P<j?1:(j-te)/(P-te)))}if(--c,r+=8*(m+v)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var xp=null,yp=null;function eh(n){return n.nodeType===9?n:n.ownerDocument}function Qb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Xb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function bp(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var vp=null;function Cj(){var n=window.event;return n&&n.type==="popstate"?n===vp?!1:(vp=n,!0):(vp=null,!1)}var Wb=typeof setTimeout=="function"?setTimeout:void 0,Aj=typeof clearTimeout=="function"?clearTimeout:void 0,Jb=typeof Promise=="function"?Promise:void 0,Rj=typeof queueMicrotask=="function"?queueMicrotask:typeof Jb<"u"?function(n){return Jb.resolve(null).then(n).catch(kj)}:Wb;function kj(n){setTimeout(function(){throw n})}function fi(n){return n==="head"}function Zb(n,r){var l=r,c=0;do{var f=l.nextSibling;if(n.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"||l==="/&"){if(c===0){n.removeChild(f),go(r);return}c--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")c++;else if(l==="html")Fc(n.ownerDocument.documentElement);else if(l==="head"){l=n.ownerDocument.head,Fc(l);for(var m=l.firstChild;m;){var v=m.nextSibling,j=m.nodeName;m[Cn]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&m.rel.toLowerCase()==="stylesheet"||l.removeChild(m),m=v}}else l==="body"&&Fc(n.ownerDocument.body);l=f}while(l);go(r)}function ev(n,r){var l=n;n=0;do{var c=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),c&&c.nodeType===8)if(l=c.data,l==="/$"){if(n===0)break;n--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||n++;l=c}while(l)}function wp(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":wp(l),kl(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}n.removeChild(l)}}function Ij(n,r,l,c){for(;n.nodeType===1;){var f=l;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[Cn])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Js(n.nextSibling),n===null)break}return null}function Dj(n,r,l){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=Js(n.nextSibling),n===null))return null;return n}function tv(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Js(n.nextSibling),n===null))return null;return n}function _p(n){return n.data==="$?"||n.data==="$~"}function Np(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function Oj(n,r){var l=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||l.readyState!=="loading")r();else{var c=function(){r(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Js(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var Tp=null;function nv(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"||l==="/&"){if(r===0)return Js(n.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}n=n.nextSibling}return null}function sv(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return n;r--}else l!=="/$"&&l!=="/&"||r++}n=n.previousSibling}return null}function rv(n,r,l){switch(r=eh(l),n){case"html":if(n=r.documentElement,!n)throw Error(a(452));return n;case"head":if(n=r.head,!n)throw Error(a(453));return n;case"body":if(n=r.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function Fc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);kl(n)}var Zs=new Map,av=new Set;function th(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var wa=Z.d;Z.d={f:Mj,r:Vj,D:Pj,C:Lj,L:Uj,m:zj,X:Hj,S:Bj,M:Fj};function Mj(){var n=wa.f(),r=Kd();return n||r}function Vj(n){var r=Hs(n);r!==null&&r.tag===5&&r.type==="form"?_y(r):wa.r(n)}var fo=typeof document>"u"?null:document;function iv(n,r,l){var c=fo;if(c&&typeof r=="string"&&r){var f=ls(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),av.has(f)||(av.add(f),n={rel:n,crossOrigin:l,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Pn(r,"link",n),pn(r),c.head.appendChild(r)))}}function Pj(n){wa.D(n),iv("dns-prefetch",n,null)}function Lj(n,r){wa.C(n,r),iv("preconnect",n,r)}function Uj(n,r,l){wa.L(n,r,l);var c=fo;if(c&&n&&r){var f='link[rel="preload"][as="'+ls(r)+'"]';r==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+ls(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+ls(l.imageSizes)+'"]')):f+='[href="'+ls(n)+'"]';var m=f;switch(r){case"style":m=mo(n);break;case"script":m=po(n)}Zs.has(m)||(n=w({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:n,as:r},l),Zs.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(qc(m))||r==="script"&&c.querySelector($c(m))||(r=c.createElement("link"),Pn(r,"link",n),pn(r),c.head.appendChild(r)))}}function zj(n,r){wa.m(n,r);var l=fo;if(l&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+ls(c)+'"][href="'+ls(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=po(n)}if(!Zs.has(m)&&(n=w({rel:"modulepreload",href:n},r),Zs.set(m,n),l.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector($c(m)))return}c=l.createElement("link"),Pn(c,"link",n),pn(c),l.head.appendChild(c)}}}function Bj(n,r,l){wa.S(n,r,l);var c=fo;if(c&&n){var f=Sr(c).hoistableStyles,m=mo(n);r=r||"default";var v=f.get(m);if(!v){var j={loading:0,preload:null};if(v=c.querySelector(qc(m)))j.loading=5;else{n=w({rel:"stylesheet",href:n,"data-precedence":r},l),(l=Zs.get(m))&&jp(n,l);var P=v=c.createElement("link");pn(P),Pn(P,"link",n),P._p=new Promise(function(te,ue){P.onload=te,P.onerror=ue}),P.addEventListener("load",function(){j.loading|=1}),P.addEventListener("error",function(){j.loading|=2}),j.loading|=4,nh(v,r,c)}v={type:"stylesheet",instance:v,count:1,state:j},f.set(m,v)}}}function Hj(n,r){wa.X(n,r);var l=fo;if(l&&n){var c=Sr(l).hoistableScripts,f=po(n),m=c.get(f);m||(m=l.querySelector($c(f)),m||(n=w({src:n,async:!0},r),(r=Zs.get(f))&&Ep(n,r),m=l.createElement("script"),pn(m),Pn(m,"link",n),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function Fj(n,r){wa.M(n,r);var l=fo;if(l&&n){var c=Sr(l).hoistableScripts,f=po(n),m=c.get(f);m||(m=l.querySelector($c(f)),m||(n=w({src:n,async:!0,type:"module"},r),(r=Zs.get(f))&&Ep(n,r),m=l.createElement("script"),pn(m),Pn(m,"link",n),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function lv(n,r,l,c){var f=(f=be.current)?th(f):null;if(!f)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=mo(l.href),l=Sr(f).hoistableStyles,c=l.get(r),c||(c={type:"style",instance:null,count:0,state:null},l.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){n=mo(l.href);var m=Sr(f).hoistableStyles,v=m.get(n);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,v),(m=f.querySelector(qc(n)))&&!m._p&&(v.instance=m,v.state.loading=5),Zs.has(n)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Zs.set(n,l),m||qj(f,n,l,v.state))),r&&c===null)throw Error(a(528,""));return v}if(r&&c!==null)throw Error(a(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=po(l),l=Sr(f).hoistableScripts,c=l.get(r),c||(c={type:"script",instance:null,count:0,state:null},l.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function mo(n){return'href="'+ls(n)+'"'}function qc(n){return'link[rel="stylesheet"]['+n+"]"}function ov(n){return w({},n,{"data-precedence":n.precedence,precedence:null})}function qj(n,r,l,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Pn(r,"link",l),pn(r),n.head.appendChild(r))}function po(n){return'[src="'+ls(n)+'"]'}function $c(n){return"script[async]"+n}function cv(n,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+ls(l.href)+'"]');if(c)return r.instance=c,pn(c),c;var f=w({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),pn(c),Pn(c,"style",f),nh(c,l.precedence,n),r.instance=c;case"stylesheet":f=mo(l.href);var m=n.querySelector(qc(f));if(m)return r.state.loading|=4,r.instance=m,pn(m),m;c=ov(l),(f=Zs.get(f))&&jp(c,f),m=(n.ownerDocument||n).createElement("link"),pn(m);var v=m;return v._p=new Promise(function(j,P){v.onload=j,v.onerror=P}),Pn(m,"link",c),r.state.loading|=4,nh(m,l.precedence,n),r.instance=m;case"script":return m=po(l.src),(f=n.querySelector($c(m)))?(r.instance=f,pn(f),f):(c=l,(f=Zs.get(m))&&(c=w({},l),Ep(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),pn(f),Pn(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(a(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,nh(c,l.precedence,n));return r.instance}function nh(n,r,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,v=0;v<c.length;v++){var j=c[v];if(j.dataset.precedence===r)m=j;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(n,r.firstChild))}function jp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function Ep(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var sh=null;function uv(n,r,l){if(sh===null){var c=new Map,f=sh=new Map;f.set(l,c)}else f=sh,c=f.get(l),c||(c=new Map,f.set(l,c));if(c.has(n))return c;for(c.set(n,null),l=l.getElementsByTagName(n),f=0;f<l.length;f++){var m=l[f];if(!(m[Cn]||m[tt]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var v=m.getAttribute(r)||"";v=n+v;var j=c.get(v);j?j.push(m):c.set(v,[m])}}return c}function dv(n,r,l){n=n.ownerDocument||n,n.head.insertBefore(l,r==="title"?n.querySelector("head > title"):null)}function $j(n,r,l){if(l===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return n=r.disabled,typeof r.precedence=="string"&&n==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function hv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function Kj(n,r,l,c){if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var f=mo(c.href),m=r.querySelector(qc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=rh.bind(n),r.then(n,n)),l.state.loading|=4,l.instance=m,pn(m);return}m=r.ownerDocument||r,c=ov(c),(f=Zs.get(f))&&jp(c,f),m=m.createElement("link"),pn(m);var v=m;v._p=new Promise(function(j,P){v.onload=j,v.onerror=P}),Pn(m,"link",c),l.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(n.count++,l=rh.bind(n),r.addEventListener("load",l),r.addEventListener("error",l))}}var Sp=0;function Gj(n,r){return n.stylesheets&&n.count===0&&ih(n,n.stylesheets),0<n.count||0<n.imgCount?function(l){var c=setTimeout(function(){if(n.stylesheets&&ih(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&Sp===0&&(Sp=62500*Sj());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&ih(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>Sp?50:800)+r);return n.unsuspend=l,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function rh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ih(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var ah=null;function ih(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,ah=new Map,r.forEach(Yj,n),ah=null,rh.call(n))}function Yj(n,r){if(!(r.state.loading&4)){var l=ah.get(n);if(l)var c=l.get(null);else{l=new Map,ah.set(n,l);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var v=f[m];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(l.set(v.dataset.precedence,v),c=v)}c&&l.set(null,c)}f=r.instance,v=f.getAttribute("data-precedence"),m=l.get(v)||c,m===c&&l.set(null,f),l.set(v,f),this.count++,c=rh.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var Kc={$$typeof:$,Provider:null,Consumer:null,_currentValue:Se,_currentValue2:Se,_threadCount:0};function Qj(n,r,l,c,f,m,v,j,P){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Fn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fn(0),this.hiddenUpdates=Fn(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function fv(n,r,l,c,f,m,v,j,P,te,ue,ge){return n=new Qj(n,r,l,v,P,te,ue,ge,j),r=1,m===!0&&(r|=24),m=As(3,null,null,r),n.current=m,m.stateNode=n,r=im(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:l,cache:r},um(m),n}function mv(n){return n?(n=$l,n):$l}function pv(n,r,l,c,f,m){f=mv(f),c.context===null?c.context=f:c.pendingContext=f,c=ni(r),c.payload={element:l},m=m===void 0?null:m,m!==null&&(c.callback=m),l=si(n,c,r),l!==null&&(fs(l,n,r),Tc(l,n,r))}function gv(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<r?l:r}}function Cp(n,r){gv(n,r),(n=n.alternate)&&gv(n,r)}function xv(n){if(n.tag===13||n.tag===31){var r=el(n,67108864);r!==null&&fs(r,n,67108864),Cp(n,67108864)}}function yv(n){if(n.tag===13||n.tag===31){var r=Os();r=we(r);var l=el(n,r);l!==null&&fs(l,n,r),Cp(n,r)}}var lh=!0;function Xj(n,r,l,c){var f=X.T;X.T=null;var m=Z.p;try{Z.p=2,Ap(n,r,l,c)}finally{Z.p=m,X.T=f}}function Wj(n,r,l,c){var f=X.T;X.T=null;var m=Z.p;try{Z.p=8,Ap(n,r,l,c)}finally{Z.p=m,X.T=f}}function Ap(n,r,l,c){if(lh){var f=Rp(c);if(f===null)pp(n,r,c,oh,l),vv(n,c);else if(Zj(f,n,r,l,c))c.stopPropagation();else if(vv(n,c),r&4&&-1<Jj.indexOf(n)){for(;f!==null;){var m=Hs(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var v=Hn(m.pendingLanes);if(v!==0){var j=m;for(j.pendingLanes|=2,j.entangledLanes|=2;v;){var P=1<<31-wt(v);j.entanglements[1]|=P,v&=~P}zr(m),(Nt&6)===0&&(qd=Bt()+500,zc(0))}}break;case 31:case 13:j=el(m,2),j!==null&&fs(j,m,2),Kd(),Cp(m,2)}if(m=Rp(c),m===null&&pp(n,r,c,oh,l),m===f)break;f=m}f!==null&&c.stopPropagation()}else pp(n,r,c,null,l)}}function Rp(n){return n=Fs(n),kp(n)}var oh=null;function kp(n){if(oh=null,n=Er(n),n!==null){var r=u(n);if(r===null)n=null;else{var l=r.tag;if(l===13){if(n=d(r),n!==null)return n;n=null}else if(l===31){if(n=p(r),n!==null)return n;n=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return oh=n,null}function bv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(_s()){case Ns:return 2;case Bs:return 8;case Bn:case gt:return 32;case Qe:return 268435456;default:return 32}default:return 32}}var Ip=!1,mi=null,pi=null,gi=null,Gc=new Map,Yc=new Map,xi=[],Jj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vv(n,r){switch(n){case"focusin":case"focusout":mi=null;break;case"dragenter":case"dragleave":pi=null;break;case"mouseover":case"mouseout":gi=null;break;case"pointerover":case"pointerout":Gc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yc.delete(r.pointerId)}}function Qc(n,r,l,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:l,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=Hs(r),r!==null&&xv(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function Zj(n,r,l,c,f){switch(r){case"focusin":return mi=Qc(mi,n,r,l,c,f),!0;case"dragenter":return pi=Qc(pi,n,r,l,c,f),!0;case"mouseover":return gi=Qc(gi,n,r,l,c,f),!0;case"pointerover":var m=f.pointerId;return Gc.set(m,Qc(Gc.get(m)||null,n,r,l,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Yc.set(m,Qc(Yc.get(m)||null,n,r,l,c,f)),!0}return!1}function wv(n){var r=Er(n.target);if(r!==null){var l=u(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){n.blockedOn=r,Le(n.priority,function(){yv(l)});return}}else if(r===31){if(r=p(l),r!==null){n.blockedOn=r,Le(n.priority,function(){yv(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ch(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var l=Rp(n.nativeEvent);if(l===null){l=n.nativeEvent;var c=new l.constructor(l.type,l);oc=c,l.target.dispatchEvent(c),oc=null}else return r=Hs(l),r!==null&&xv(r),n.blockedOn=l,!1;r.shift()}return!0}function _v(n,r,l){ch(n)&&l.delete(r)}function eE(){Ip=!1,mi!==null&&ch(mi)&&(mi=null),pi!==null&&ch(pi)&&(pi=null),gi!==null&&ch(gi)&&(gi=null),Gc.forEach(_v),Yc.forEach(_v)}function uh(n,r){n.blockedOn===r&&(n.blockedOn=null,Ip||(Ip=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,eE)))}var dh=null;function Nv(n){dh!==n&&(dh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){dh===n&&(dh=null);for(var r=0;r<n.length;r+=3){var l=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(kp(c||l)===null)continue;break}var m=Hs(l);m!==null&&(n.splice(r,3),r-=3,Rm(m,{pending:!0,data:f,method:l.method,action:c},c,f))}}))}function go(n){function r(P){return uh(P,n)}mi!==null&&uh(mi,n),pi!==null&&uh(pi,n),gi!==null&&uh(gi,n),Gc.forEach(r),Yc.forEach(r);for(var l=0;l<xi.length;l++){var c=xi[l];c.blockedOn===n&&(c.blockedOn=null)}for(;0<xi.length&&(l=xi[0],l.blockedOn===null);)wv(l),l.blockedOn===null&&xi.shift();if(l=(n.ownerDocument||n).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var f=l[c],m=l[c+1],v=f[it]||null;if(typeof m=="function")v||Nv(l);else if(v){var j=null;if(m&&m.hasAttribute("formAction")){if(f=m,v=m[it]||null)j=v.formAction;else if(kp(f)!==null)continue}else j=v.action;typeof j=="function"?l[c+1]=j:(l.splice(c,3),c-=3),Nv(l)}}}function Tv(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(l,20)}function l(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function Dp(n){this._internalRoot=n}hh.prototype.render=Dp.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(a(409));var l=r.current,c=Os();pv(l,c,n,r,null,null)},hh.prototype.unmount=Dp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;pv(n.current,2,null,n,null,null),Kd(),r[$t]=null}};function hh(n){this._internalRoot=n}hh.prototype.unstable_scheduleHydration=function(n){if(n){var r=Ue();n={blockedOn:null,target:n,priority:r};for(var l=0;l<xi.length&&r!==0&&r<xi[l].priority;l++);xi.splice(l,0,n),l===0&&wv(n)}};var jv=e.version;if(jv!=="19.2.0")throw Error(a(527,jv,"19.2.0"));Z.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=g(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var tE={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fh.isDisabled&&fh.supportsFiber)try{Dt=fh.inject(tE),vt=fh}catch{}}return Wc.createRoot=function(n,r){if(!o(n))throw Error(a(299));var l=!1,c="",f=Iy,m=Dy,v=Oy;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(v=r.onRecoverableError)),r=fv(n,1,!1,null,null,l,c,null,f,m,v,Tv),n[$t]=r.current,mp(n),new Dp(r)},Wc.hydrateRoot=function(n,r,l){if(!o(n))throw Error(a(299));var c=!1,f="",m=Iy,v=Dy,j=Oy,P=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(j=l.onRecoverableError),l.formState!==void 0&&(P=l.formState)),r=fv(n,1,!0,r,l??null,c,f,P,m,v,j,Tv),r.context=mv(null),l=r.current,c=Os(),c=we(c),f=ni(c),f.callback=null,si(l,f,c),l=c,r.current.lanes=l,ne(r,l),zr(r),n[$t]=r.current,mp(n),new hh(r)},Wc.version="19.2.0",Wc}var Mv;function dE(){if(Mv)return Vp.exports;Mv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Vp.exports=uE(),Vp.exports}var hE=dE();const fE=P_(hE);/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Vv="popstate";function mE(s={}){function e(o,u){let{pathname:d="/",search:p="",hash:x=""}=Nl(o.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),cg("",{pathname:d,search:p,hash:x},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function t(o,u){let d=o.document.querySelector("base"),p="";if(d&&d.getAttribute("href")){let x=o.location.href,g=x.indexOf("#");p=g===-1?x:x.slice(0,g)}return p+"#"+(typeof u=="string"?u:pu(u))}function a(o,u){Us(o.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(u)})`)}return gE(e,t,a,s)}function Wt(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Us(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function pE(){return Math.random().toString(36).substring(2,10)}function Pv(s,e){return{usr:s.state,key:s.key,idx:e}}function cg(s,e,t=null,a){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Nl(e):e,state:t,key:e&&e.key||a||pE()}}function pu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Nl(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let a=s.indexOf("?");a>=0&&(e.search=s.substring(a),s=s.substring(0,a)),s&&(e.pathname=s)}return e}function gE(s,e,t,a={}){let{window:o=document.defaultView,v5Compat:u=!1}=a,d=o.history,p="POP",x=null,g=b();g==null&&(g=0,d.replaceState({...d.state,idx:g},""));function b(){return(d.state||{idx:null}).idx}function w(){p="POP";let L=b(),W=L==null?null:L-g;g=L,x&&x({action:p,location:q.location,delta:W})}function N(L,W){p="PUSH";let re=cg(q.location,L,W);t&&t(re,L),g=b()+1;let $=Pv(re,g),z=q.createHref(re);try{d.pushState($,"",z)}catch(he){if(he instanceof DOMException&&he.name==="DataCloneError")throw he;o.location.assign(z)}u&&x&&x({action:p,location:q.location,delta:1})}function R(L,W){p="REPLACE";let re=cg(q.location,L,W);t&&t(re,L),g=b();let $=Pv(re,g),z=q.createHref(re);d.replaceState($,"",z),u&&x&&x({action:p,location:q.location,delta:0})}function D(L){return xE(L)}let q={get action(){return p},get location(){return s(o,d)},listen(L){if(x)throw new Error("A history only accepts one active listener");return o.addEventListener(Vv,w),x=L,()=>{o.removeEventListener(Vv,w),x=null}},createHref(L){return e(o,L)},createURL:D,encodeLocation(L){let W=D(L);return{pathname:W.pathname,search:W.search,hash:W.hash}},push:N,replace:R,go(L){return d.go(L)}};return q}function xE(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Wt(t,"No window.location.(origin|href) available to create URL");let a=typeof s=="string"?s:pu(s);return a=a.replace(/ $/,"%20"),!e&&a.startsWith("//")&&(a=t+a),new URL(a,t)}function L_(s,e,t="/"){return yE(s,e,t,!1)}function yE(s,e,t,a){let o=typeof e=="string"?Nl(e):e,u=Ia(o.pathname||"/",t);if(u==null)return null;let d=U_(s);bE(d);let p=null;for(let x=0;p==null&&x<d.length;++x){let g=RE(u);p=CE(d[x],g,a)}return p}function U_(s,e=[],t=[],a="",o=!1){let u=(d,p,x=o,g)=>{let b={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(a)&&x)return;Wt(b.relativePath.startsWith(a),`Absolute route path "${b.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(a.length)}let w=Aa([a,b.relativePath]),N=t.concat(b);d.children&&d.children.length>0&&(Wt(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),U_(d.children,e,N,w,x)),!(d.path==null&&!d.index)&&e.push({path:w,score:EE(w,d.index),routesMeta:N})};return s.forEach((d,p)=>{var x;if(d.path===""||!((x=d.path)!=null&&x.includes("?")))u(d,p);else for(let g of z_(d.path))u(d,p,!0,g)}),e}function z_(s){let e=s.split("/");if(e.length===0)return[];let[t,...a]=e,o=t.endsWith("?"),u=t.replace(/\?$/,"");if(a.length===0)return o?[u,""]:[u];let d=z_(a.join("/")),p=[];return p.push(...d.map(x=>x===""?u:[u,x].join("/"))),o&&p.push(...d),p.map(x=>s.startsWith("/")&&x===""?"/":x)}function bE(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:SE(e.routesMeta.map(a=>a.childrenIndex),t.routesMeta.map(a=>a.childrenIndex)))}var vE=/^:[\w-]+$/,wE=3,_E=2,NE=1,TE=10,jE=-2,Lv=s=>s==="*";function EE(s,e){let t=s.split("/"),a=t.length;return t.some(Lv)&&(a+=jE),e&&(a+=_E),t.filter(o=>!Lv(o)).reduce((o,u)=>o+(vE.test(u)?wE:u===""?NE:TE),a)}function SE(s,e){return s.length===e.length&&s.slice(0,-1).every((a,o)=>a===e[o])?s[s.length-1]-e[e.length-1]:0}function CE(s,e,t=!1){let{routesMeta:a}=s,o={},u="/",d=[];for(let p=0;p<a.length;++p){let x=a[p],g=p===a.length-1,b=u==="/"?e:e.slice(u.length)||"/",w=Vh({path:x.relativePath,caseSensitive:x.caseSensitive,end:g},b),N=x.route;if(!w&&g&&t&&!a[a.length-1].route.index&&(w=Vh({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},b)),!w)return null;Object.assign(o,w.params),d.push({params:o,pathname:Aa([u,w.pathname]),pathnameBase:ME(Aa([u,w.pathnameBase])),route:N}),w.pathnameBase!=="/"&&(u=Aa([u,w.pathnameBase]))}return d}function Vh(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,a]=AE(s.path,s.caseSensitive,s.end),o=e.match(t);if(!o)return null;let u=o[0],d=u.replace(/(.)\/+$/,"$1"),p=o.slice(1);return{params:a.reduce((g,{paramName:b,isOptional:w},N)=>{if(b==="*"){let D=p[N]||"";d=u.slice(0,u.length-D.length).replace(/(.)\/+$/,"$1")}const R=p[N];return w&&!R?g[b]=void 0:g[b]=(R||"").replace(/%2F/g,"/"),g},{}),pathname:u,pathnameBase:d,pattern:s}}function AE(s,e=!1,t=!0){Us(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let a=[],o="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,x)=>(a.push({paramName:p,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(a.push({paramName:"*"}),o+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":s!==""&&s!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),a]}function RE(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Us(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function Ia(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,a=s.charAt(t);return a&&a!=="/"?null:s.slice(t)||"/"}var kE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,IE=s=>kE.test(s);function DE(s,e="/"){let{pathname:t,search:a="",hash:o=""}=typeof s=="string"?Nl(s):s,u;if(t)if(IE(t))u=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),Us(!1,`Pathnames cannot have embedded double slashes - normalizing ${d} -> ${t}`)}t.startsWith("/")?u=Uv(t.substring(1),"/"):u=Uv(t,e)}else u=e;return{pathname:u,search:VE(a),hash:PE(o)}}function Uv(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function zp(s,e,t,a){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function OE(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function B_(s){let e=OE(s);return e.map((t,a)=>a===e.length-1?t.pathname:t.pathnameBase)}function H_(s,e,t,a=!1){let o;typeof s=="string"?o=Nl(s):(o={...s},Wt(!o.pathname||!o.pathname.includes("?"),zp("?","pathname","search",o)),Wt(!o.pathname||!o.pathname.includes("#"),zp("#","pathname","hash",o)),Wt(!o.search||!o.search.includes("#"),zp("#","search","hash",o)));let u=s===""||o.pathname==="",d=u?"/":o.pathname,p;if(d==null)p=t;else{let w=e.length-1;if(!a&&d.startsWith("..")){let N=d.split("/");for(;N[0]==="..";)N.shift(),w-=1;o.pathname=N.join("/")}p=w>=0?e[w]:"/"}let x=DE(o,p),g=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&t.endsWith("/");return!x.pathname.endsWith("/")&&(g||b)&&(x.pathname+="/"),x}var Aa=s=>s.join("/").replace(/\/\/+/g,"/"),ME=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),VE=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,PE=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function LE(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var F_=["POST","PUT","PATCH","DELETE"];new Set(F_);var UE=["GET",...F_];new Set(UE);var $o=T.createContext(null);$o.displayName="DataRouter";var lf=T.createContext(null);lf.displayName="DataRouterState";T.createContext(!1);var q_=T.createContext({isTransitioning:!1});q_.displayName="ViewTransition";var zE=T.createContext(new Map);zE.displayName="Fetchers";var BE=T.createContext(null);BE.displayName="Await";var Zr=T.createContext(null);Zr.displayName="Navigation";var ju=T.createContext(null);ju.displayName="Location";var ea=T.createContext({outlet:null,matches:[],isDataRoute:!1});ea.displayName="Route";var Xg=T.createContext(null);Xg.displayName="RouteError";function HE(s,{relative:e}={}){Wt(Eu(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:a}=T.useContext(Zr),{hash:o,pathname:u,search:d}=Su(s,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:Aa([t,u])),a.createHref({pathname:p,search:d,hash:o})}function Eu(){return T.useContext(ju)!=null}function Ua(){return Wt(Eu(),"useLocation() may be used only in the context of a <Router> component."),T.useContext(ju).location}var $_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function K_(s){T.useContext(Zr).static||T.useLayoutEffect(s)}function ar(){let{isDataRoute:s}=T.useContext(ea);return s?nS():FE()}function FE(){Wt(Eu(),"useNavigate() may be used only in the context of a <Router> component.");let s=T.useContext($o),{basename:e,navigator:t}=T.useContext(Zr),{matches:a}=T.useContext(ea),{pathname:o}=Ua(),u=JSON.stringify(B_(a)),d=T.useRef(!1);return K_(()=>{d.current=!0}),T.useCallback((x,g={})=>{if(Us(d.current,$_),!d.current)return;if(typeof x=="number"){t.go(x);return}let b=H_(x,JSON.parse(u),o,g.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Aa([e,b.pathname])),(g.replace?t.replace:t.push)(b,g.state,g)},[e,t,u,o,s])}T.createContext(null);function qE(){let{matches:s}=T.useContext(ea),e=s[s.length-1];return e?e.params:{}}function Su(s,{relative:e}={}){let{matches:t}=T.useContext(ea),{pathname:a}=Ua(),o=JSON.stringify(B_(t));return T.useMemo(()=>H_(s,JSON.parse(o),a,e==="path"),[s,o,a,e])}function $E(s,e){return G_(s,e)}function G_(s,e,t,a,o){var re;Wt(Eu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=T.useContext(Zr),{matches:d}=T.useContext(ea),p=d[d.length-1],x=p?p.params:{},g=p?p.pathname:"/",b=p?p.pathnameBase:"/",w=p&&p.route;{let $=w&&w.path||"";Y_(g,!w||$.endsWith("*")||$.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${$}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${$}"> to <Route path="${$==="/"?"*":`${$}/*`}">.`)}let N=Ua(),R;if(e){let $=typeof e=="string"?Nl(e):e;Wt(b==="/"||((re=$.pathname)==null?void 0:re.startsWith(b)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${$.pathname}" was given in the \`location\` prop.`),R=$}else R=N;let D=R.pathname||"/",q=D;if(b!=="/"){let $=b.replace(/^\//,"").split("/");q="/"+D.replace(/^\//,"").split("/").slice($.length).join("/")}let L=L_(s,{pathname:q});Us(w||L!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),Us(L==null||L[L.length-1].route.element!==void 0||L[L.length-1].route.Component!==void 0||L[L.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let W=XE(L&&L.map($=>Object.assign({},$,{params:Object.assign({},x,$.params),pathname:Aa([b,u.encodeLocation?u.encodeLocation($.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:$.pathname]),pathnameBase:$.pathnameBase==="/"?b:Aa([b,u.encodeLocation?u.encodeLocation($.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:$.pathnameBase])})),d,t,a,o);return e&&W?T.createElement(ju.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...R},navigationType:"POP"}},W):W}function KE(){let s=tS(),e=LE(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,a="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:a},u={padding:"2px 4px",backgroundColor:a},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=T.createElement(T.Fragment,null,T.createElement("p",null," Hey developer "),T.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",T.createElement("code",{style:u},"ErrorBoundary")," or"," ",T.createElement("code",{style:u},"errorElement")," prop on your route.")),T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),t?T.createElement("pre",{style:o},t):null,d)}var GE=T.createElement(KE,null),YE=class extends T.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){return this.state.error!==void 0?T.createElement(ea.Provider,{value:this.props.routeContext},T.createElement(Xg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function QE({routeContext:s,match:e,children:t}){let a=T.useContext($o);return a&&a.static&&a.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=e.route.id),T.createElement(ea.Provider,{value:s},t)}function XE(s,e=[],t=null,a=null,o=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,d=t==null?void 0:t.errors;if(d!=null){let b=u.findIndex(w=>w.route.id&&(d==null?void 0:d[w.route.id])!==void 0);Wt(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let p=!1,x=-1;if(t)for(let b=0;b<u.length;b++){let w=u[b];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(x=b),w.route.id){let{loaderData:N,errors:R}=t,D=w.route.loader&&!N.hasOwnProperty(w.route.id)&&(!R||R[w.route.id]===void 0);if(w.route.lazy||D){p=!0,x>=0?u=u.slice(0,x+1):u=[u[0]];break}}}let g=t&&a?(b,w)=>{var N,R;a(b,{location:t.location,params:((R=(N=t.matches)==null?void 0:N[0])==null?void 0:R.params)??{},errorInfo:w})}:void 0;return u.reduceRight((b,w,N)=>{let R,D=!1,q=null,L=null;t&&(R=d&&w.route.id?d[w.route.id]:void 0,q=w.route.errorElement||GE,p&&(x<0&&N===0?(Y_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),D=!0,L=null):x===N&&(D=!0,L=w.route.hydrateFallbackElement||null)));let W=e.concat(u.slice(0,N+1)),re=()=>{let $;return R?$=q:D?$=L:w.route.Component?$=T.createElement(w.route.Component,null):w.route.element?$=w.route.element:$=b,T.createElement(QE,{match:w,routeContext:{outlet:b,matches:W,isDataRoute:t!=null},children:$})};return t&&(w.route.ErrorBoundary||w.route.errorElement||N===0)?T.createElement(YE,{location:t.location,revalidation:t.revalidation,component:q,error:R,children:re(),routeContext:{outlet:null,matches:W,isDataRoute:!0},onError:g}):re()},null)}function Wg(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function WE(s){let e=T.useContext($o);return Wt(e,Wg(s)),e}function JE(s){let e=T.useContext(lf);return Wt(e,Wg(s)),e}function ZE(s){let e=T.useContext(ea);return Wt(e,Wg(s)),e}function Jg(s){let e=ZE(s),t=e.matches[e.matches.length-1];return Wt(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function eS(){return Jg("useRouteId")}function tS(){var a;let s=T.useContext(Xg),e=JE("useRouteError"),t=Jg("useRouteError");return s!==void 0?s:(a=e.errors)==null?void 0:a[t]}function nS(){let{router:s}=WE("useNavigate"),e=Jg("useNavigate"),t=T.useRef(!1);return K_(()=>{t.current=!0}),T.useCallback(async(o,u={})=>{Us(t.current,$_),t.current&&(typeof o=="number"?s.navigate(o):await s.navigate(o,{fromRouteId:e,...u}))},[s,e])}var zv={};function Y_(s,e,t){!e&&!zv[s]&&(zv[s]=!0,Us(!1,t))}T.memo(sS);function sS({routes:s,future:e,state:t,unstable_onError:a}){return G_(s,void 0,t,a,e)}function Br(s){Wt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function rS({basename:s="/",children:e=null,location:t,navigationType:a="POP",navigator:o,static:u=!1}){Wt(!Eu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=s.replace(/^\/*/,"/"),p=T.useMemo(()=>({basename:d,navigator:o,static:u,future:{}}),[d,o,u]);typeof t=="string"&&(t=Nl(t));let{pathname:x="/",search:g="",hash:b="",state:w=null,key:N="default"}=t,R=T.useMemo(()=>{let D=Ia(x,d);return D==null?null:{location:{pathname:D,search:g,hash:b,state:w,key:N},navigationType:a}},[d,x,g,b,w,N,a]);return Us(R!=null,`<Router basename="${d}"> is not able to match the URL "${x}${g}${b}" because it does not start with the basename, so the <Router> won't render anything.`),R==null?null:T.createElement(Zr.Provider,{value:p},T.createElement(ju.Provider,{children:e,value:R}))}function aS({children:s,location:e}){return $E(ug(s),e)}function ug(s,e=[]){let t=[];return T.Children.forEach(s,(a,o)=>{if(!T.isValidElement(a))return;let u=[...e,o];if(a.type===T.Fragment){t.push.apply(t,ug(a.props.children,u));return}Wt(a.type===Br,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Wt(!a.props.index||!a.props.children,"An index route cannot have child routes.");let d={id:a.props.id||u.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(d.children=ug(a.props.children,u)),t.push(d)}),t}var Nh="get",Th="application/x-www-form-urlencoded";function of(s){return s!=null&&typeof s.tagName=="string"}function iS(s){return of(s)&&s.tagName.toLowerCase()==="button"}function lS(s){return of(s)&&s.tagName.toLowerCase()==="form"}function oS(s){return of(s)&&s.tagName.toLowerCase()==="input"}function cS(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function uS(s,e){return s.button===0&&(!e||e==="_self")&&!cS(s)}function dg(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let a=s[t];return e.concat(Array.isArray(a)?a.map(o=>[t,o]):[[t,a]])},[]))}function dS(s,e){let t=dg(s);return e&&e.forEach((a,o)=>{t.has(o)||e.getAll(o).forEach(u=>{t.append(o,u)})}),t}var mh=null;function hS(){if(mh===null)try{new FormData(document.createElement("form"),0),mh=!1}catch{mh=!0}return mh}var fS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Bp(s){return s!=null&&!fS.has(s)?(Us(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Th}"`),null):s}function mS(s,e){let t,a,o,u,d;if(lS(s)){let p=s.getAttribute("action");a=p?Ia(p,e):null,t=s.getAttribute("method")||Nh,o=Bp(s.getAttribute("enctype"))||Th,u=new FormData(s)}else if(iS(s)||oS(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let x=s.getAttribute("formaction")||p.getAttribute("action");if(a=x?Ia(x,e):null,t=s.getAttribute("formmethod")||p.getAttribute("method")||Nh,o=Bp(s.getAttribute("formenctype"))||Bp(p.getAttribute("enctype"))||Th,u=new FormData(p,s),!hS()){let{name:g,type:b,value:w}=s;if(b==="image"){let N=g?`${g}.`:"";u.append(`${N}x`,"0"),u.append(`${N}y`,"0")}else g&&u.append(g,w)}}else{if(of(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Nh,a=null,o=Th,d=s}return u&&o==="text/plain"&&(d=u,u=void 0),{action:a,method:t.toLowerCase(),encType:o,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Zg(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function pS(s,e,t){let a=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return a.pathname==="/"?a.pathname=`_root.${t}`:e&&Ia(a.pathname,e)==="/"?a.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${t}`,a}async function gS(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function xS(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function yS(s,e,t){let a=await Promise.all(s.map(async o=>{let u=e.routes[o.route.id];if(u){let d=await gS(u,t);return d.links?d.links():[]}return[]}));return _S(a.flat(1).filter(xS).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Bv(s,e,t,a,o,u){let d=(x,g)=>t[g]?x.route.id!==t[g].route.id:!0,p=(x,g)=>{var b;return t[g].pathname!==x.pathname||((b=t[g].route.path)==null?void 0:b.endsWith("*"))&&t[g].params["*"]!==x.params["*"]};return u==="assets"?e.filter((x,g)=>d(x,g)||p(x,g)):u==="data"?e.filter((x,g)=>{var w;let b=a.routes[x.route.id];if(!b||!b.hasLoader)return!1;if(d(x,g)||p(x,g))return!0;if(x.route.shouldRevalidate){let N=x.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((w=t[0])==null?void 0:w.params)||{},nextUrl:new URL(s,window.origin),nextParams:x.params,defaultShouldRevalidate:!0});if(typeof N=="boolean")return N}return!0}):[]}function bS(s,e,{includeHydrateFallback:t}={}){return vS(s.map(a=>{let o=e.routes[a.route.id];if(!o)return[];let u=[o.module];return o.clientActionModule&&(u=u.concat(o.clientActionModule)),o.clientLoaderModule&&(u=u.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(u=u.concat(o.hydrateFallbackModule)),o.imports&&(u=u.concat(o.imports)),u}).flat(1))}function vS(s){return[...new Set(s)]}function wS(s){let e={},t=Object.keys(s).sort();for(let a of t)e[a]=s[a];return e}function _S(s,e){let t=new Set;return new Set(e),s.reduce((a,o)=>{let u=JSON.stringify(wS(o));return t.has(u)||(t.add(u),a.push({key:u,link:o})),a},[])}function Q_(){let s=T.useContext($o);return Zg(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function NS(){let s=T.useContext(lf);return Zg(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var e0=T.createContext(void 0);e0.displayName="FrameworkContext";function X_(){let s=T.useContext(e0);return Zg(s,"You must render this element inside a <HydratedRouter> element"),s}function TS(s,e){let t=T.useContext(e0),[a,o]=T.useState(!1),[u,d]=T.useState(!1),{onFocus:p,onBlur:x,onMouseEnter:g,onMouseLeave:b,onTouchStart:w}=e,N=T.useRef(null);T.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let q=W=>{W.forEach(re=>{d(re.isIntersecting)})},L=new IntersectionObserver(q,{threshold:.5});return N.current&&L.observe(N.current),()=>{L.disconnect()}}},[s]),T.useEffect(()=>{if(a){let q=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(q)}}},[a]);let R=()=>{o(!0)},D=()=>{o(!1),d(!1)};return t?s!=="intent"?[u,N,{}]:[u,N,{onFocus:Jc(p,R),onBlur:Jc(x,D),onMouseEnter:Jc(g,R),onMouseLeave:Jc(b,D),onTouchStart:Jc(w,R)}]:[!1,N,{}]}function Jc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function jS({page:s,...e}){let{router:t}=Q_(),a=T.useMemo(()=>L_(t.routes,s,t.basename),[t.routes,s,t.basename]);return a?T.createElement(SS,{page:s,matches:a,...e}):null}function ES(s){let{manifest:e,routeModules:t}=X_(),[a,o]=T.useState([]);return T.useEffect(()=>{let u=!1;return yS(s,e,t).then(d=>{u||o(d)}),()=>{u=!0}},[s,e,t]),a}function SS({page:s,matches:e,...t}){let a=Ua(),{manifest:o,routeModules:u}=X_(),{basename:d}=Q_(),{loaderData:p,matches:x}=NS(),g=T.useMemo(()=>Bv(s,e,x,o,a,"data"),[s,e,x,o,a]),b=T.useMemo(()=>Bv(s,e,x,o,a,"assets"),[s,e,x,o,a]),w=T.useMemo(()=>{if(s===a.pathname+a.search+a.hash)return[];let D=new Set,q=!1;if(e.forEach(W=>{var $;let re=o.routes[W.route.id];!re||!re.hasLoader||(!g.some(z=>z.route.id===W.route.id)&&W.route.id in p&&(($=u[W.route.id])!=null&&$.shouldRevalidate)||re.hasClientLoader?q=!0:D.add(W.route.id))}),D.size===0)return[];let L=pS(s,d,"data");return q&&D.size>0&&L.searchParams.set("_routes",e.filter(W=>D.has(W.route.id)).map(W=>W.route.id).join(",")),[L.pathname+L.search]},[d,p,a,o,g,e,s,u]),N=T.useMemo(()=>bS(b,o),[b,o]),R=ES(b);return T.createElement(T.Fragment,null,w.map(D=>T.createElement("link",{key:D,rel:"prefetch",as:"fetch",href:D,...t})),N.map(D=>T.createElement("link",{key:D,rel:"modulepreload",href:D,...t})),R.map(({key:D,link:q})=>T.createElement("link",{key:D,nonce:t.nonce,...q})))}function CS(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var W_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{W_&&(window.__reactRouterVersion="7.9.6")}catch{}function AS({basename:s,children:e,window:t}){let a=T.useRef();a.current==null&&(a.current=mE({window:t,v5Compat:!0}));let o=a.current,[u,d]=T.useState({action:o.action,location:o.location}),p=T.useCallback(x=>{T.startTransition(()=>d(x))},[d]);return T.useLayoutEffect(()=>o.listen(p),[o,p]),T.createElement(rS,{basename:s,children:e,location:u.location,navigationType:u.action,navigator:o})}var J_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Z_=T.forwardRef(function({onClick:e,discover:t="render",prefetch:a="none",relative:o,reloadDocument:u,replace:d,state:p,target:x,to:g,preventScrollReset:b,viewTransition:w,...N},R){let{basename:D}=T.useContext(Zr),q=typeof g=="string"&&J_.test(g),L,W=!1;if(typeof g=="string"&&q&&(L=g,W_))try{let k=new URL(window.location.href),M=g.startsWith("//")?new URL(k.protocol+g):new URL(g),I=Ia(M.pathname,D);M.origin===k.origin&&I!=null?g=I+M.search+M.hash:W=!0}catch{Us(!1,`<Link to="${g}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let re=HE(g,{relative:o}),[$,z,he]=TS(a,N),_e=DS(g,{replace:d,state:p,target:x,preventScrollReset:b,relative:o,viewTransition:w});function S(k){e&&e(k),k.defaultPrevented||_e(k)}let C=T.createElement("a",{...N,...he,href:L||re,onClick:W||u?e:S,ref:CS(R,z),target:x,"data-discover":!q&&t==="render"?"true":void 0});return $&&!q?T.createElement(T.Fragment,null,C,T.createElement(jS,{page:re})):C});Z_.displayName="Link";var RS=T.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:a="",end:o=!1,style:u,to:d,viewTransition:p,children:x,...g},b){let w=Su(d,{relative:g.relative}),N=Ua(),R=T.useContext(lf),{navigator:D,basename:q}=T.useContext(Zr),L=R!=null&&LS(w)&&p===!0,W=D.encodeLocation?D.encodeLocation(w).pathname:w.pathname,re=N.pathname,$=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;t||(re=re.toLowerCase(),$=$?$.toLowerCase():null,W=W.toLowerCase()),$&&q&&($=Ia($,q)||$);const z=W!=="/"&&W.endsWith("/")?W.length-1:W.length;let he=re===W||!o&&re.startsWith(W)&&re.charAt(z)==="/",_e=$!=null&&($===W||!o&&$.startsWith(W)&&$.charAt(W.length)==="/"),S={isActive:he,isPending:_e,isTransitioning:L},C=he?e:void 0,k;typeof a=="function"?k=a(S):k=[a,he?"active":null,_e?"pending":null,L?"transitioning":null].filter(Boolean).join(" ");let M=typeof u=="function"?u(S):u;return T.createElement(Z_,{...g,"aria-current":C,className:k,ref:b,style:M,to:d,viewTransition:p},typeof x=="function"?x(S):x)});RS.displayName="NavLink";var kS=T.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:a,replace:o,state:u,method:d=Nh,action:p,onSubmit:x,relative:g,preventScrollReset:b,viewTransition:w,...N},R)=>{let D=VS(),q=PS(p,{relative:g}),L=d.toLowerCase()==="get"?"get":"post",W=typeof p=="string"&&J_.test(p),re=$=>{if(x&&x($),$.defaultPrevented)return;$.preventDefault();let z=$.nativeEvent.submitter,he=(z==null?void 0:z.getAttribute("formmethod"))||d;D(z||$.currentTarget,{fetcherKey:e,method:he,navigate:t,replace:o,state:u,relative:g,preventScrollReset:b,viewTransition:w})};return T.createElement("form",{ref:R,method:L,action:q,onSubmit:a?x:re,...N,"data-discover":!W&&s==="render"?"true":void 0})});kS.displayName="Form";function IS(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function e1(s){let e=T.useContext($o);return Wt(e,IS(s)),e}function DS(s,{target:e,replace:t,state:a,preventScrollReset:o,relative:u,viewTransition:d}={}){let p=ar(),x=Ua(),g=Su(s,{relative:u});return T.useCallback(b=>{if(uS(b,e)){b.preventDefault();let w=t!==void 0?t:pu(x)===pu(g);p(s,{replace:w,state:a,preventScrollReset:o,relative:u,viewTransition:d})}},[x,p,g,t,a,e,s,o,u,d])}function t1(s){Us(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=T.useRef(dg(s)),t=T.useRef(!1),a=Ua(),o=T.useMemo(()=>dS(a.search,t.current?null:e.current),[a.search]),u=ar(),d=T.useCallback((p,x)=>{const g=dg(typeof p=="function"?p(new URLSearchParams(o)):p);t.current=!0,u("?"+g,x)},[u,o]);return[o,d]}var OS=0,MS=()=>`__${String(++OS)}__`;function VS(){let{router:s}=e1("useSubmit"),{basename:e}=T.useContext(Zr),t=eS();return T.useCallback(async(a,o={})=>{let{action:u,method:d,encType:p,formData:x,body:g}=mS(a,e);if(o.navigate===!1){let b=o.fetcherKey||MS();await s.fetch(b,t,o.action||u,{preventScrollReset:o.preventScrollReset,formData:x,body:g,formMethod:o.method||d,formEncType:o.encType||p,flushSync:o.flushSync})}else await s.navigate(o.action||u,{preventScrollReset:o.preventScrollReset,formData:x,body:g,formMethod:o.method||d,formEncType:o.encType||p,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[s,e,t])}function PS(s,{relative:e}={}){let{basename:t}=T.useContext(Zr),a=T.useContext(ea);Wt(a,"useFormAction must be used inside a RouteContext");let[o]=a.matches.slice(-1),u={...Su(s||".",{relative:e})},d=Ua();if(s==null){u.search=d.search;let p=new URLSearchParams(u.search),x=p.getAll("index");if(x.some(b=>b==="")){p.delete("index"),x.filter(w=>w).forEach(w=>p.append("index",w));let b=p.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&o.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:Aa([t,u.pathname])),pu(u)}function LS(s,{relative:e}={}){let t=T.useContext(q_);Wt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=e1("useViewTransitionState"),o=Su(s,{relative:e});if(!t.isTransitioning)return!1;let u=Ia(t.currentLocation.pathname,a)||t.currentLocation.pathname,d=Ia(t.nextLocation.pathname,a)||t.nextLocation.pathname;return Vh(o.pathname,d)!=null||Vh(o.pathname,u)!=null}/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),zS=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),Hv=s=>{const e=zS(s);return e.charAt(0).toUpperCase()+e.slice(1)},n1=(...s)=>s.filter((e,t,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===t).join(" ").trim(),BS=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=T.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:a,className:o="",children:u,iconNode:d,...p},x)=>T.createElement("svg",{ref:x,...HS,width:e,height:e,stroke:s,strokeWidth:a?Number(t)*24/Number(e):t,className:n1("lucide",o),...!u&&!BS(p)&&{"aria-hidden":"true"},...p},[...d.map(([g,b])=>T.createElement(g,b)),...Array.isArray(u)?u:[u]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=(s,e)=>{const t=T.forwardRef(({className:a,...o},u)=>T.createElement(FS,{ref:u,iconNode:e,className:n1(`lucide-${US(Hv(s))}`,`lucide-${s}`,a),...o}));return t.displayName=Hv(s),t};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],s1=Ie("arrow-down",qS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],cf=Ie("arrow-left",$S);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Ph=Ie("arrow-right",KS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],r1=Ie("arrow-up",GS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=[["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M19.38 6.813A9 9 0 0 1 20.8 10.2a2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"11xh7x"}],["path",{d:"M9 12h.01",key:"157uk2"}]],Hp=Ie("baby",YS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],XS=Ie("banknote",QS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Fv=Ie("bell",WS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ZS=Ie("book-open",JS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eC=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Lh=Ie("briefcase",eC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tC=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],hg=Ie("building-2",tC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],sC=Ie("calendar-days",nC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Da=Ie("calendar",rC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],iC=Ie("camera",aC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lC=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],oC=Ie("chart-column",lC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],uC=Ie("chart-pie",cC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dC=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],iu=Ie("check",dC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],fg=Ie("chevron-down",hC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],mC=Ie("chevron-left",fC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pC=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ps=Ie("chevron-right",pC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gC=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],qv=Ie("chevron-up",gC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Yn=Ie("circle-alert",xC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yC=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ys=Ie("circle-check-big",yC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],pr=Ie("circle-check",bC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],wC=Ie("circle-question-mark",vC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _C=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],NC=Ie("circle-user",_C);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Uh=Ie("circle-x",TC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jC=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],gr=Ie("clock",jC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EC=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],uf=Ie("cloud-upload",EC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SC=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],$v=Ie("database",SC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CC=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Qn=Ie("download",CC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AC=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],df=Ie("external-link",AC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RC=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],mg=Ie("eye-off",RC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kC=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pg=Ie("eye",kC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IC=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],t0=Ie("file-spreadsheet",IC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DC=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ze=Ie("file-text",DC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OC=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],hf=Ie("file",OC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MC=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Fp=Ie("flask-conical",MC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VC=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Kv=Ie("folder-open",VC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PC=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Gv=Ie("folder",PC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LC=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],UC=Ie("funnel",LC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zC=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],n0=Ie("graduation-cap",zC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BC=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],qp=Ie("image",BC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],yl=Ie("info",HC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],qC=Ie("landmark",FC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],a1=Ie("layout-grid",$C);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KC=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],$p=Ie("list",KC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GC=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ni=Ie("loader-circle",GC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Ro=Ie("lock",YC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],XC=Ie("log-out",QC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],i1=Ie("mail",WC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ZC=Ie("map-pin",JC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eA=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],l1=Ie("maximize-2",eA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tA=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Ea=Ie("message-circle",tA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nA=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Fr=Ie("message-square",nA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sA=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],o1=Ie("paperclip",sA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rA=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Ms=Ie("pen-line",rA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aA=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],c1=Ie("phone",aA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iA=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ko=Ie("plus",iA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lA=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Yv=Ie("refresh-ccw",lA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oA=[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]],cA=Ie("reply",oA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uA=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],s0=Ie("save",uA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dA=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],u1=Ie("school",dA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hA=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Tl=Ie("search",hA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fA=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Cu=Ie("send",fA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mA=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pA=Ie("settings",mA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gA=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],_o=Ie("shield-check",gA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xA=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Kp=Ie("square-check-big",xA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yA=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Io=Ie("square-pen",yA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bA=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],vA=Ie("stethoscope",bA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wA=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],hn=Ie("trash-2",wA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _A=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Qv=Ie("triangle-alert",_A);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NA=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],En=Ie("upload",NA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TA=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],xr=Ie("user",TA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jA=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],xo=Ie("users",jA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EA=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],gg=Ie("utensils",EA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SA=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],fn=Ie("x",SA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CA=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],AA=Ie("zoom-in",CA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RA=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],kA=Ie("zoom-out",RA),IA=[{id:"quan-tri-he-thong",title:"QUN TR H THNG",description:"Qun l ti khon, phn quyn ngi dng v cu hnh h thng.",icon:_o,colorClass:"text-slate-700",bgClass:"from-slate-100 to-slate-200",hoverClass:"hover:shadow-slate-300 hover:border-slate-400",stats:"Dnh cho Admin"}],d1="TRC D LIU TRNG MU GIO VNG ANH",DA="modulepreload",OA=function(s){return"/"+s},Xv={},lu=function(e,t,a){let o=Promise.resolve();if(t&&t.length>0){let d=function(g){return Promise.all(g.map(b=>Promise.resolve(b).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),x=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));o=d(t.map(g=>{if(g=OA(g),g in Xv)return;Xv[g]=!0;const b=g.endsWith(".css"),w=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${w}`))return;const N=document.createElement("link");if(N.rel=b?"stylesheet":DA,b||(N.as="script"),N.crossOrigin="",N.href=g,x&&N.setAttribute("nonce",x),document.head.appendChild(N),b)return new Promise((R,D)=>{N.addEventListener("load",R),N.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${g}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return o.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})},MA=()=>{};var Wv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1=function(s){const e=[];let t=0;for(let a=0;a<s.length;a++){let o=s.charCodeAt(a);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&a+1<s.length&&(s.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(s.charCodeAt(++a)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},VA=function(s){const e=[];let t=0,a=0;for(;t<s.length;){const o=s[t++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const u=s[t++];e[a++]=String.fromCharCode((o&31)<<6|u&63)}else if(o>239&&o<365){const u=s[t++],d=s[t++],p=s[t++],x=((o&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[a++]=String.fromCharCode(55296+(x>>10)),e[a++]=String.fromCharCode(56320+(x&1023))}else{const u=s[t++],d=s[t++];e[a++]=String.fromCharCode((o&15)<<12|(u&63)<<6|d&63)}}return e.join("")},f1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<s.length;o+=3){const u=s[o],d=o+1<s.length,p=d?s[o+1]:0,x=o+2<s.length,g=x?s[o+2]:0,b=u>>2,w=(u&3)<<4|p>>4;let N=(p&15)<<2|g>>6,R=g&63;x||(R=64,d||(N=64)),a.push(t[b],t[w],t[N],t[R])}return a.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(h1(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):VA(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<s.length;){const u=t[s.charAt(o++)],p=o<s.length?t[s.charAt(o)]:0;++o;const g=o<s.length?t[s.charAt(o)]:64;++o;const w=o<s.length?t[s.charAt(o)]:64;if(++o,u==null||p==null||g==null||w==null)throw new PA;const N=u<<2|p>>4;if(a.push(N),g!==64){const R=p<<4&240|g>>2;if(a.push(R),w!==64){const D=g<<6&192|w;a.push(D)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class PA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LA=function(s){const e=h1(s);return f1.encodeByteArray(e,!0)},zh=function(s){return LA(s).replace(/\./g,"")},m1=function(s){try{return f1.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA=()=>UA().__FIREBASE_DEFAULTS__,BA=()=>{if(typeof process>"u"||typeof Wv>"u")return;const s=Wv.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},HA=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&m1(s[1]);return e&&JSON.parse(e)},ff=()=>{try{return MA()||zA()||BA()||HA()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},p1=s=>{var e,t;return(t=(e=ff())==null?void 0:e.emulatorHosts)==null?void 0:t[s]},r0=s=>{const e=p1(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},g1=()=>{var s;return(s=ff())==null?void 0:s.config},x1=s=>{var e;return(e=ff())==null?void 0:e[`_${s}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ta(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function mf(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y1(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",o=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${a}`,aud:a,iat:o,exp:o+3600,auth_time:o,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[zh(JSON.stringify(t)),zh(JSON.stringify(d)),""].join(".")}const ou={};function qA(){const s={prod:[],emulator:[]};for(const e of Object.keys(ou))ou[e]?s.emulator.push(e):s.prod.push(e);return s}function $A(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let Jv=!1;function pf(s,e){if(typeof window>"u"||typeof document>"u"||!ta(window.location.host)||ou[s]===e||ou[s]||Jv)return;ou[s]=e;function t(N){return`__firebase__banner__${N}`}const a="__firebase__banner",u=qA().prod.length>0;function d(){const N=document.getElementById(a);N&&N.remove()}function p(N){N.style.display="flex",N.style.background="#7faaf0",N.style.position="fixed",N.style.bottom="5px",N.style.left="5px",N.style.padding=".5em",N.style.borderRadius="5px",N.style.alignItems="center"}function x(N,R){N.setAttribute("width","24"),N.setAttribute("id",R),N.setAttribute("height","24"),N.setAttribute("viewBox","0 0 24 24"),N.setAttribute("fill","none"),N.style.marginLeft="-6px"}function g(){const N=document.createElement("span");return N.style.cursor="pointer",N.style.marginLeft="16px",N.style.fontSize="24px",N.innerHTML=" &times;",N.onclick=()=>{Jv=!0,d()},N}function b(N,R){N.setAttribute("id",R),N.innerText="Learn more",N.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",N.setAttribute("target","__blank"),N.style.paddingLeft="5px",N.style.textDecoration="underline"}function w(){const N=$A(a),R=t("text"),D=document.getElementById(R)||document.createElement("span"),q=t("learnmore"),L=document.getElementById(q)||document.createElement("a"),W=t("preprendIcon"),re=document.getElementById(W)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(N.created){const $=N.element;p($),b(L,q);const z=g();x(re,W),$.append(re,D,L,z),document.body.appendChild($)}u?(D.innerText="Preview backend disconnected.",re.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(re.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,D.innerText="Preview backend running in this workspace."),D.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function KA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xn())}function GA(){var e;const s=(e=ff())==null?void 0:e.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function QA(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function XA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function WA(){const s=Xn();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function JA(){return!GA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ZA(){try{return typeof indexedDB=="object"}catch{return!1}}function e5(){return new Promise((s,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(a),s(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var u;e(((u=o.error)==null?void 0:u.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t5="FirebaseError";class Tr extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=t5,Object.setPrototypeOf(this,Tr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Au.prototype.create)}}class Au{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},o=`${this.service}/${e}`,u=this.errors[e],d=u?n5(u,a):"Error",p=`${this.serviceName}: ${d} (${o}).`;return new Tr(o,p,a)}}function n5(s,e){return s.replace(s5,(t,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const s5=/\{\$([^}]+)}/g;function r5(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Ci(s,e){if(s===e)return!0;const t=Object.keys(s),a=Object.keys(e);for(const o of t){if(!a.includes(o))return!1;const u=s[o],d=e[o];if(Zv(u)&&Zv(d)){if(!Ci(u,d))return!1}else if(u!==d)return!1}for(const o of a)if(!t.includes(o))return!1;return!0}function Zv(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ru(s){const e=[];for(const[t,a]of Object.entries(s))Array.isArray(a)?a.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function eu(s){const e={};return s.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[o,u]=a.split("=");e[decodeURIComponent(o)]=decodeURIComponent(u)}}),e}function tu(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function a5(s,e){const t=new i5(s,e);return t.subscribe.bind(t)}class i5{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let o;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");l5(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:a},o.next===void 0&&(o.next=Gp),o.error===void 0&&(o.error=Gp),o.complete===void 0&&(o.complete=Gp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function l5(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Gp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(s){return s&&s._delegate?s._delegate:s}class Oa{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o5{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new FA;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(u5(e))try{this.getOrInitializeService({instanceIdentifier:fl})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:o});a.resolve(u)}catch{}}}}clearInstance(e=fl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fl){return this.instances.has(e)}getOptions(e=fl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);a===p&&d.resolve(o)}return o}onInit(e,t){const a=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(a)??new Set;o.add(e),this.onInitCallbacks.set(a,o);const u=this.instances.get(a);return u&&e(u,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const o of a)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:c5(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=fl){return this.component?this.component.multipleInstances?e:fl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function c5(s){return s===fl?void 0:s}function u5(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new o5(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(dt||(dt={}));const h5={debug:dt.DEBUG,verbose:dt.VERBOSE,info:dt.INFO,warn:dt.WARN,error:dt.ERROR,silent:dt.SILENT},f5=dt.INFO,m5={[dt.DEBUG]:"log",[dt.VERBOSE]:"log",[dt.INFO]:"info",[dt.WARN]:"warn",[dt.ERROR]:"error"},p5=(s,e,...t)=>{if(e<s.logLevel)return;const a=new Date().toISOString(),o=m5[e];if(o)console[o](`[${a}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class a0{constructor(e){this.name=e,this._logLevel=f5,this._logHandler=p5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?h5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dt.DEBUG,...e),this._logHandler(this,dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dt.VERBOSE,...e),this._logHandler(this,dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dt.INFO,...e),this._logHandler(this,dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dt.WARN,...e),this._logHandler(this,dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dt.ERROR,...e),this._logHandler(this,dt.ERROR,...e)}}const g5=(s,e)=>e.some(t=>s instanceof t);let ew,tw;function x5(){return ew||(ew=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function y5(){return tw||(tw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const b1=new WeakMap,xg=new WeakMap,v1=new WeakMap,Yp=new WeakMap,i0=new WeakMap;function b5(s){const e=new Promise((t,a)=>{const o=()=>{s.removeEventListener("success",u),s.removeEventListener("error",d)},u=()=>{t(Ti(s.result)),o()},d=()=>{a(s.error),o()};s.addEventListener("success",u),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&b1.set(t,s)}).catch(()=>{}),i0.set(e,s),e}function v5(s){if(xg.has(s))return;const e=new Promise((t,a)=>{const o=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",d),s.removeEventListener("abort",d)},u=()=>{t(),o()},d=()=>{a(s.error||new DOMException("AbortError","AbortError")),o()};s.addEventListener("complete",u),s.addEventListener("error",d),s.addEventListener("abort",d)});xg.set(s,e)}let yg={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return xg.get(s);if(e==="objectStoreNames")return s.objectStoreNames||v1.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ti(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function w5(s){yg=s(yg)}function _5(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=s.call(Qp(this),e,...t);return v1.set(a,e.sort?e.sort():[e]),Ti(a)}:y5().includes(s)?function(...e){return s.apply(Qp(this),e),Ti(b1.get(this))}:function(...e){return Ti(s.apply(Qp(this),e))}}function N5(s){return typeof s=="function"?_5(s):(s instanceof IDBTransaction&&v5(s),g5(s,x5())?new Proxy(s,yg):s)}function Ti(s){if(s instanceof IDBRequest)return b5(s);if(Yp.has(s))return Yp.get(s);const e=N5(s);return e!==s&&(Yp.set(s,e),i0.set(e,s)),e}const Qp=s=>i0.get(s);function T5(s,e,{blocked:t,upgrade:a,blocking:o,terminated:u}={}){const d=indexedDB.open(s,e),p=Ti(d);return a&&d.addEventListener("upgradeneeded",x=>{a(Ti(d.result),x.oldVersion,x.newVersion,Ti(d.transaction),x)}),t&&d.addEventListener("blocked",x=>t(x.oldVersion,x.newVersion,x)),p.then(x=>{u&&x.addEventListener("close",()=>u()),o&&x.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),p}const j5=["get","getKey","getAll","getAllKeys","count"],E5=["put","add","delete","clear"],Xp=new Map;function nw(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Xp.get(e))return Xp.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,o=E5.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(o||j5.includes(t)))return;const u=async function(d,...p){const x=this.transaction(d,o?"readwrite":"readonly");let g=x.store;return a&&(g=g.index(p.shift())),(await Promise.all([g[t](...p),o&&x.done]))[0]};return Xp.set(e,u),u}w5(s=>({...s,get:(e,t,a)=>nw(e,t)||s.get(e,t,a),has:(e,t)=>!!nw(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(C5(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function C5(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const bg="@firebase/app",sw="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma=new a0("@firebase/app"),A5="@firebase/app-compat",R5="@firebase/analytics-compat",k5="@firebase/analytics",I5="@firebase/app-check-compat",D5="@firebase/app-check",O5="@firebase/auth",M5="@firebase/auth-compat",V5="@firebase/database",P5="@firebase/data-connect",L5="@firebase/database-compat",U5="@firebase/functions",z5="@firebase/functions-compat",B5="@firebase/installations",H5="@firebase/installations-compat",F5="@firebase/messaging",q5="@firebase/messaging-compat",$5="@firebase/performance",K5="@firebase/performance-compat",G5="@firebase/remote-config",Y5="@firebase/remote-config-compat",Q5="@firebase/storage",X5="@firebase/storage-compat",W5="@firebase/firestore",J5="@firebase/ai",Z5="@firebase/firestore-compat",e4="firebase",t4="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg="[DEFAULT]",n4={[bg]:"fire-core",[A5]:"fire-core-compat",[k5]:"fire-analytics",[R5]:"fire-analytics-compat",[D5]:"fire-app-check",[I5]:"fire-app-check-compat",[O5]:"fire-auth",[M5]:"fire-auth-compat",[V5]:"fire-rtdb",[P5]:"fire-data-connect",[L5]:"fire-rtdb-compat",[U5]:"fire-fn",[z5]:"fire-fn-compat",[B5]:"fire-iid",[H5]:"fire-iid-compat",[F5]:"fire-fcm",[q5]:"fire-fcm-compat",[$5]:"fire-perf",[K5]:"fire-perf-compat",[G5]:"fire-rc",[Y5]:"fire-rc-compat",[Q5]:"fire-gcs",[X5]:"fire-gcs-compat",[W5]:"fire-fst",[Z5]:"fire-fst-compat",[J5]:"fire-vertex","fire-js":"fire-js",[e4]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do=new Map,wg=new Map,_g=new Map;function rw(s,e){try{s.container.addComponent(e)}catch(t){Ma.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function Ai(s){const e=s.name;if(_g.has(e))return Ma.debug(`There were multiple attempts to register component ${e}.`),!1;_g.set(e,s);for(const t of Do.values())rw(t,s);for(const t of wg.values())rw(t,s);return!0}function ku(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function gs(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ji=new Au("app","Firebase",s4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(e,t,a){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new Oa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ji.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jl=t4;function l0(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const a={name:vg,automaticDataCollectionEnabled:!0,...e},o=a.name;if(typeof o!="string"||!o)throw ji.create("bad-app-name",{appName:String(o)});if(t||(t=g1()),!t)throw ji.create("no-options");const u=Do.get(o);if(u){if(Ci(t,u.options)&&Ci(a,u.config))return u;throw ji.create("duplicate-app",{appName:o})}const d=new d5(o);for(const x of _g.values())d.addComponent(x);const p=new r4(t,a,d);return Do.set(o,p),p}function gf(s=vg){const e=Do.get(s);if(!e&&s===vg&&g1())return l0();if(!e)throw ji.create("no-app",{appName:s});return e}async function a4(s){let e=!1;const t=s.name;Do.has(t)?(e=!0,Do.delete(t)):wg.has(t)&&s.decRefCount()<=0&&(wg.delete(t),e=!0),e&&(await Promise.all(s.container.getProviders().map(a=>a.delete())),s.isDeleted=!0)}function tr(s,e,t){let a=n4[s]??s;t&&(a+=`-${t}`);const o=a.match(/\s|\//),u=e.match(/\s|\//);if(o||u){const d=[`Unable to register library "${a}" with version "${e}":`];o&&d.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ma.warn(d.join(" "));return}Ai(new Oa(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4="firebase-heartbeat-database",l4=1,gu="firebase-heartbeat-store";let Wp=null;function w1(){return Wp||(Wp=T5(i4,l4,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(gu)}catch(t){console.warn(t)}}}}).catch(s=>{throw ji.create("idb-open",{originalErrorMessage:s.message})})),Wp}async function o4(s){try{const t=(await w1()).transaction(gu),a=await t.objectStore(gu).get(_1(s));return await t.done,a}catch(e){if(e instanceof Tr)Ma.warn(e.message);else{const t=ji.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ma.warn(t.message)}}}async function aw(s,e){try{const a=(await w1()).transaction(gu,"readwrite");await a.objectStore(gu).put(e,_1(s)),await a.done}catch(t){if(t instanceof Tr)Ma.warn(t.message);else{const a=ji.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ma.warn(a.message)}}}function _1(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4=1024,u4=30;class d4{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new f4(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),u=iw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===u||this._heartbeatsCache.heartbeats.some(d=>d.date===u))return;if(this._heartbeatsCache.heartbeats.push({date:u,agent:o}),this._heartbeatsCache.heartbeats.length>u4){const d=m4(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Ma.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=iw(),{heartbeatsToSend:a,unsentEntries:o}=h4(this._heartbeatsCache.heartbeats),u=zh(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),u}catch(t){return Ma.warn(t),""}}}function iw(){return new Date().toISOString().substring(0,10)}function h4(s,e=c4){const t=[];let a=s.slice();for(const o of s){const u=t.find(d=>d.agent===o.agent);if(u){if(u.dates.push(o.date),lw(t)>e){u.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),lw(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class f4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ZA()?e5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await o4(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return aw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return aw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function lw(s){return zh(JSON.stringify({version:2,heartbeats:s})).length}function m4(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let a=1;a<s.length;a++)s[a].date<t&&(t=s[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p4(s){Ai(new Oa("platform-logger",e=>new S5(e),"PRIVATE")),Ai(new Oa("heartbeat",e=>new d4(e),"PRIVATE")),tr(bg,sw,s),tr(bg,sw,"esm2020"),tr("fire-js","")}p4("");var g4="firebase",x4="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tr(g4,x4,"app");var ow=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ei,N1;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,C){function k(){}k.prototype=C.prototype,S.F=C.prototype,S.prototype=new k,S.prototype.constructor=S,S.D=function(M,I,O){for(var E=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)E[ve-2]=arguments[ve];return C.prototype[I].apply(M,E)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(a,t),a.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(S,C,k){k||(k=0);const M=Array(16);if(typeof C=="string")for(var I=0;I<16;++I)M[I]=C.charCodeAt(k++)|C.charCodeAt(k++)<<8|C.charCodeAt(k++)<<16|C.charCodeAt(k++)<<24;else for(I=0;I<16;++I)M[I]=C[k++]|C[k++]<<8|C[k++]<<16|C[k++]<<24;C=S.g[0],k=S.g[1],I=S.g[2];let O=S.g[3],E;E=C+(O^k&(I^O))+M[0]+3614090360&4294967295,C=k+(E<<7&4294967295|E>>>25),E=O+(I^C&(k^I))+M[1]+3905402710&4294967295,O=C+(E<<12&4294967295|E>>>20),E=I+(k^O&(C^k))+M[2]+606105819&4294967295,I=O+(E<<17&4294967295|E>>>15),E=k+(C^I&(O^C))+M[3]+3250441966&4294967295,k=I+(E<<22&4294967295|E>>>10),E=C+(O^k&(I^O))+M[4]+4118548399&4294967295,C=k+(E<<7&4294967295|E>>>25),E=O+(I^C&(k^I))+M[5]+1200080426&4294967295,O=C+(E<<12&4294967295|E>>>20),E=I+(k^O&(C^k))+M[6]+2821735955&4294967295,I=O+(E<<17&4294967295|E>>>15),E=k+(C^I&(O^C))+M[7]+4249261313&4294967295,k=I+(E<<22&4294967295|E>>>10),E=C+(O^k&(I^O))+M[8]+1770035416&4294967295,C=k+(E<<7&4294967295|E>>>25),E=O+(I^C&(k^I))+M[9]+2336552879&4294967295,O=C+(E<<12&4294967295|E>>>20),E=I+(k^O&(C^k))+M[10]+4294925233&4294967295,I=O+(E<<17&4294967295|E>>>15),E=k+(C^I&(O^C))+M[11]+2304563134&4294967295,k=I+(E<<22&4294967295|E>>>10),E=C+(O^k&(I^O))+M[12]+1804603682&4294967295,C=k+(E<<7&4294967295|E>>>25),E=O+(I^C&(k^I))+M[13]+4254626195&4294967295,O=C+(E<<12&4294967295|E>>>20),E=I+(k^O&(C^k))+M[14]+2792965006&4294967295,I=O+(E<<17&4294967295|E>>>15),E=k+(C^I&(O^C))+M[15]+1236535329&4294967295,k=I+(E<<22&4294967295|E>>>10),E=C+(I^O&(k^I))+M[1]+4129170786&4294967295,C=k+(E<<5&4294967295|E>>>27),E=O+(k^I&(C^k))+M[6]+3225465664&4294967295,O=C+(E<<9&4294967295|E>>>23),E=I+(C^k&(O^C))+M[11]+643717713&4294967295,I=O+(E<<14&4294967295|E>>>18),E=k+(O^C&(I^O))+M[0]+3921069994&4294967295,k=I+(E<<20&4294967295|E>>>12),E=C+(I^O&(k^I))+M[5]+3593408605&4294967295,C=k+(E<<5&4294967295|E>>>27),E=O+(k^I&(C^k))+M[10]+38016083&4294967295,O=C+(E<<9&4294967295|E>>>23),E=I+(C^k&(O^C))+M[15]+3634488961&4294967295,I=O+(E<<14&4294967295|E>>>18),E=k+(O^C&(I^O))+M[4]+3889429448&4294967295,k=I+(E<<20&4294967295|E>>>12),E=C+(I^O&(k^I))+M[9]+568446438&4294967295,C=k+(E<<5&4294967295|E>>>27),E=O+(k^I&(C^k))+M[14]+3275163606&4294967295,O=C+(E<<9&4294967295|E>>>23),E=I+(C^k&(O^C))+M[3]+4107603335&4294967295,I=O+(E<<14&4294967295|E>>>18),E=k+(O^C&(I^O))+M[8]+1163531501&4294967295,k=I+(E<<20&4294967295|E>>>12),E=C+(I^O&(k^I))+M[13]+2850285829&4294967295,C=k+(E<<5&4294967295|E>>>27),E=O+(k^I&(C^k))+M[2]+4243563512&4294967295,O=C+(E<<9&4294967295|E>>>23),E=I+(C^k&(O^C))+M[7]+1735328473&4294967295,I=O+(E<<14&4294967295|E>>>18),E=k+(O^C&(I^O))+M[12]+2368359562&4294967295,k=I+(E<<20&4294967295|E>>>12),E=C+(k^I^O)+M[5]+4294588738&4294967295,C=k+(E<<4&4294967295|E>>>28),E=O+(C^k^I)+M[8]+2272392833&4294967295,O=C+(E<<11&4294967295|E>>>21),E=I+(O^C^k)+M[11]+1839030562&4294967295,I=O+(E<<16&4294967295|E>>>16),E=k+(I^O^C)+M[14]+4259657740&4294967295,k=I+(E<<23&4294967295|E>>>9),E=C+(k^I^O)+M[1]+2763975236&4294967295,C=k+(E<<4&4294967295|E>>>28),E=O+(C^k^I)+M[4]+1272893353&4294967295,O=C+(E<<11&4294967295|E>>>21),E=I+(O^C^k)+M[7]+4139469664&4294967295,I=O+(E<<16&4294967295|E>>>16),E=k+(I^O^C)+M[10]+3200236656&4294967295,k=I+(E<<23&4294967295|E>>>9),E=C+(k^I^O)+M[13]+681279174&4294967295,C=k+(E<<4&4294967295|E>>>28),E=O+(C^k^I)+M[0]+3936430074&4294967295,O=C+(E<<11&4294967295|E>>>21),E=I+(O^C^k)+M[3]+3572445317&4294967295,I=O+(E<<16&4294967295|E>>>16),E=k+(I^O^C)+M[6]+76029189&4294967295,k=I+(E<<23&4294967295|E>>>9),E=C+(k^I^O)+M[9]+3654602809&4294967295,C=k+(E<<4&4294967295|E>>>28),E=O+(C^k^I)+M[12]+3873151461&4294967295,O=C+(E<<11&4294967295|E>>>21),E=I+(O^C^k)+M[15]+530742520&4294967295,I=O+(E<<16&4294967295|E>>>16),E=k+(I^O^C)+M[2]+3299628645&4294967295,k=I+(E<<23&4294967295|E>>>9),E=C+(I^(k|~O))+M[0]+4096336452&4294967295,C=k+(E<<6&4294967295|E>>>26),E=O+(k^(C|~I))+M[7]+1126891415&4294967295,O=C+(E<<10&4294967295|E>>>22),E=I+(C^(O|~k))+M[14]+2878612391&4294967295,I=O+(E<<15&4294967295|E>>>17),E=k+(O^(I|~C))+M[5]+4237533241&4294967295,k=I+(E<<21&4294967295|E>>>11),E=C+(I^(k|~O))+M[12]+1700485571&4294967295,C=k+(E<<6&4294967295|E>>>26),E=O+(k^(C|~I))+M[3]+2399980690&4294967295,O=C+(E<<10&4294967295|E>>>22),E=I+(C^(O|~k))+M[10]+4293915773&4294967295,I=O+(E<<15&4294967295|E>>>17),E=k+(O^(I|~C))+M[1]+2240044497&4294967295,k=I+(E<<21&4294967295|E>>>11),E=C+(I^(k|~O))+M[8]+1873313359&4294967295,C=k+(E<<6&4294967295|E>>>26),E=O+(k^(C|~I))+M[15]+4264355552&4294967295,O=C+(E<<10&4294967295|E>>>22),E=I+(C^(O|~k))+M[6]+2734768916&4294967295,I=O+(E<<15&4294967295|E>>>17),E=k+(O^(I|~C))+M[13]+1309151649&4294967295,k=I+(E<<21&4294967295|E>>>11),E=C+(I^(k|~O))+M[4]+4149444226&4294967295,C=k+(E<<6&4294967295|E>>>26),E=O+(k^(C|~I))+M[11]+3174756917&4294967295,O=C+(E<<10&4294967295|E>>>22),E=I+(C^(O|~k))+M[2]+718787259&4294967295,I=O+(E<<15&4294967295|E>>>17),E=k+(O^(I|~C))+M[9]+3951481745&4294967295,S.g[0]=S.g[0]+C&4294967295,S.g[1]=S.g[1]+(I+(E<<21&4294967295|E>>>11))&4294967295,S.g[2]=S.g[2]+I&4294967295,S.g[3]=S.g[3]+O&4294967295}a.prototype.v=function(S,C){C===void 0&&(C=S.length);const k=C-this.blockSize,M=this.C;let I=this.h,O=0;for(;O<C;){if(I==0)for(;O<=k;)o(this,S,O),O+=this.blockSize;if(typeof S=="string"){for(;O<C;)if(M[I++]=S.charCodeAt(O++),I==this.blockSize){o(this,M),I=0;break}}else for(;O<C;)if(M[I++]=S[O++],I==this.blockSize){o(this,M),I=0;break}}this.h=I,this.o+=C},a.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var C=1;C<S.length-8;++C)S[C]=0;C=this.o*8;for(var k=S.length-8;k<S.length;++k)S[k]=C&255,C/=256;for(this.v(S),S=Array(16),C=0,k=0;k<4;++k)for(let M=0;M<32;M+=8)S[C++]=this.g[k]>>>M&255;return S};function u(S,C){var k=p;return Object.prototype.hasOwnProperty.call(k,S)?k[S]:k[S]=C(S)}function d(S,C){this.h=C;const k=[];let M=!0;for(let I=S.length-1;I>=0;I--){const O=S[I]|0;M&&O==C||(k[I]=O,M=!1)}this.g=k}var p={};function x(S){return-128<=S&&S<128?u(S,function(C){return new d([C|0],C<0?-1:0)}):new d([S|0],S<0?-1:0)}function g(S){if(isNaN(S)||!isFinite(S))return w;if(S<0)return L(g(-S));const C=[];let k=1;for(let M=0;S>=k;M++)C[M]=S/k|0,k*=4294967296;return new d(C,0)}function b(S,C){if(S.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(S.charAt(0)=="-")return L(b(S.substring(1),C));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=g(Math.pow(C,8));let M=w;for(let O=0;O<S.length;O+=8){var I=Math.min(8,S.length-O);const E=parseInt(S.substring(O,O+I),C);I<8?(I=g(Math.pow(C,I)),M=M.j(I).add(g(E))):(M=M.j(k),M=M.add(g(E)))}return M}var w=x(0),N=x(1),R=x(16777216);s=d.prototype,s.m=function(){if(q(this))return-L(this).m();let S=0,C=1;for(let k=0;k<this.g.length;k++){const M=this.i(k);S+=(M>=0?M:4294967296+M)*C,C*=4294967296}return S},s.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(D(this))return"0";if(q(this))return"-"+L(this).toString(S);const C=g(Math.pow(S,6));var k=this;let M="";for(;;){const I=z(k,C).g;k=W(k,I.j(C));let O=((k.g.length>0?k.g[0]:k.h)>>>0).toString(S);if(k=I,D(k))return O+M;for(;O.length<6;)O="0"+O;M=O+M}},s.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function D(S){if(S.h!=0)return!1;for(let C=0;C<S.g.length;C++)if(S.g[C]!=0)return!1;return!0}function q(S){return S.h==-1}s.l=function(S){return S=W(this,S),q(S)?-1:D(S)?0:1};function L(S){const C=S.g.length,k=[];for(let M=0;M<C;M++)k[M]=~S.g[M];return new d(k,~S.h).add(N)}s.abs=function(){return q(this)?L(this):this},s.add=function(S){const C=Math.max(this.g.length,S.g.length),k=[];let M=0;for(let I=0;I<=C;I++){let O=M+(this.i(I)&65535)+(S.i(I)&65535),E=(O>>>16)+(this.i(I)>>>16)+(S.i(I)>>>16);M=E>>>16,O&=65535,E&=65535,k[I]=E<<16|O}return new d(k,k[k.length-1]&-2147483648?-1:0)};function W(S,C){return S.add(L(C))}s.j=function(S){if(D(this)||D(S))return w;if(q(this))return q(S)?L(this).j(L(S)):L(L(this).j(S));if(q(S))return L(this.j(L(S)));if(this.l(R)<0&&S.l(R)<0)return g(this.m()*S.m());const C=this.g.length+S.g.length,k=[];for(var M=0;M<2*C;M++)k[M]=0;for(M=0;M<this.g.length;M++)for(let I=0;I<S.g.length;I++){const O=this.i(M)>>>16,E=this.i(M)&65535,ve=S.i(I)>>>16,Te=S.i(I)&65535;k[2*M+2*I]+=E*Te,re(k,2*M+2*I),k[2*M+2*I+1]+=O*Te,re(k,2*M+2*I+1),k[2*M+2*I+1]+=E*ve,re(k,2*M+2*I+1),k[2*M+2*I+2]+=O*ve,re(k,2*M+2*I+2)}for(S=0;S<C;S++)k[S]=k[2*S+1]<<16|k[2*S];for(S=C;S<2*C;S++)k[S]=0;return new d(k,0)};function re(S,C){for(;(S[C]&65535)!=S[C];)S[C+1]+=S[C]>>>16,S[C]&=65535,C++}function $(S,C){this.g=S,this.h=C}function z(S,C){if(D(C))throw Error("division by zero");if(D(S))return new $(w,w);if(q(S))return C=z(L(S),C),new $(L(C.g),L(C.h));if(q(C))return C=z(S,L(C)),new $(L(C.g),C.h);if(S.g.length>30){if(q(S)||q(C))throw Error("slowDivide_ only works with positive integers.");for(var k=N,M=C;M.l(S)<=0;)k=he(k),M=he(M);var I=_e(k,1),O=_e(M,1);for(M=_e(M,2),k=_e(k,2);!D(M);){var E=O.add(M);E.l(S)<=0&&(I=I.add(k),O=E),M=_e(M,1),k=_e(k,1)}return C=W(S,I.j(C)),new $(I,C)}for(I=w;S.l(C)>=0;){for(k=Math.max(1,Math.floor(S.m()/C.m())),M=Math.ceil(Math.log(k)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),O=g(k),E=O.j(C);q(E)||E.l(S)>0;)k-=M,O=g(k),E=O.j(C);D(O)&&(O=N),I=I.add(O),S=W(S,E)}return new $(I,S)}s.B=function(S){return z(this,S).h},s.and=function(S){const C=Math.max(this.g.length,S.g.length),k=[];for(let M=0;M<C;M++)k[M]=this.i(M)&S.i(M);return new d(k,this.h&S.h)},s.or=function(S){const C=Math.max(this.g.length,S.g.length),k=[];for(let M=0;M<C;M++)k[M]=this.i(M)|S.i(M);return new d(k,this.h|S.h)},s.xor=function(S){const C=Math.max(this.g.length,S.g.length),k=[];for(let M=0;M<C;M++)k[M]=this.i(M)^S.i(M);return new d(k,this.h^S.h)};function he(S){const C=S.g.length+1,k=[];for(let M=0;M<C;M++)k[M]=S.i(M)<<1|S.i(M-1)>>>31;return new d(k,S.h)}function _e(S,C){const k=C>>5;C%=32;const M=S.g.length-k,I=[];for(let O=0;O<M;O++)I[O]=C>0?S.i(O+k)>>>C|S.i(O+k+1)<<32-C:S.i(O+k);return new d(I,S.h)}a.prototype.digest=a.prototype.A,a.prototype.reset=a.prototype.u,a.prototype.update=a.prototype.v,N1=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=g,d.fromString=b,Ei=d}).apply(typeof ow<"u"?ow:typeof self<"u"?self:typeof window<"u"?window:{});var ph=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var T1,nu,j1,jh,Ng,E1,S1,C1;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ph=="object"&&ph];for(var y=0;y<h.length;++y){var _=h[y];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var a=t(this);function o(h,y){if(y)e:{var _=a;h=h.split(".");for(var A=0;A<h.length-1;A++){var J=h[A];if(!(J in _))break e;_=_[J]}h=h[h.length-1],A=_[h],y=y(A),y!=A&&y!=null&&e(_,h,{configurable:!0,writable:!0,value:y})}}o("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(h){return h||function(y){var _=[],A;for(A in y)Object.prototype.hasOwnProperty.call(y,A)&&_.push([A,y[A]]);return _}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},d=this||self;function p(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function x(h,y,_){return h.call.apply(h.bind,arguments)}function g(h,y,_){return g=x,g.apply(null,arguments)}function b(h,y){var _=Array.prototype.slice.call(arguments,1);return function(){var A=_.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function w(h,y){function _(){}_.prototype=y.prototype,h.Z=y.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(A,J,ae){for(var Re=Array(arguments.length-2),st=2;st<arguments.length;st++)Re[st-2]=arguments[st];return y.prototype[J].apply(A,Re)}}var N=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function R(h){const y=h.length;if(y>0){const _=Array(y);for(let A=0;A<y;A++)_[A]=h[A];return _}return[]}function D(h,y){for(let A=1;A<arguments.length;A++){const J=arguments[A];var _=typeof J;if(_=_!="object"?_:J?Array.isArray(J)?"array":_:"null",_=="array"||_=="object"&&typeof J.length=="number"){_=h.length||0;const ae=J.length||0;h.length=_+ae;for(let Re=0;Re<ae;Re++)h[_+Re]=J[Re]}else h.push(J)}}class q{constructor(y,_){this.i=y,this.j=_,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function L(h){d.setTimeout(()=>{throw h},0)}function W(){var h=S;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class re{constructor(){this.h=this.g=null}add(y,_){const A=$.get();A.set(y,_),this.h?this.h.next=A:this.g=A,this.h=A}}var $=new q(()=>new z,h=>h.reset());class z{constructor(){this.next=this.g=this.h=null}set(y,_){this.h=y,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let he,_e=!1,S=new re,C=()=>{const h=Promise.resolve(void 0);he=()=>{h.then(k)}};function k(){for(var h;h=W();){try{h.h.call(h.g)}catch(_){L(_)}var y=$;y.j(h),y.h<100&&(y.h++,h.next=y.g,y.g=h)}_e=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,y),d.removeEventListener("test",_,y)}catch{}return h})();function E(h){return/^[\s\xa0]*$/.test(h)}function ve(h,y){I.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,y)}w(ve,I),ve.prototype.init=function(h,y){const _=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget,y||(_=="mouseover"?y=h.fromElement:_=="mouseout"&&(y=h.toElement)),this.relatedTarget=y,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&ve.Z.h.call(this)},ve.prototype.h=function(){ve.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Te="closure_listenable_"+(Math.random()*1e6|0),X=0;function Z(h,y,_,A,J){this.listener=h,this.proxy=null,this.src=y,this.type=_,this.capture=!!A,this.ha=J,this.key=++X,this.da=this.fa=!1}function Se(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Be(h,y,_){for(const A in h)y.call(_,h[A],A,h)}function Pe(h,y){for(const _ in h)y.call(void 0,h[_],_,h)}function V(h){const y={};for(const _ in h)y[_]=h[_];return y}const oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(h,y){let _,A;for(let J=1;J<arguments.length;J++){A=arguments[J];for(_ in A)h[_]=A[_];for(let ae=0;ae<oe.length;ae++)_=oe[ae],Object.prototype.hasOwnProperty.call(A,_)&&(h[_]=A[_])}}function ye(h){this.src=h,this.g={},this.h=0}ye.prototype.add=function(h,y,_,A,J){const ae=h.toString();h=this.g[ae],h||(h=this.g[ae]=[],this.h++);const Re=be(h,y,A,J);return Re>-1?(y=h[Re],_||(y.fa=!1)):(y=new Z(y,this.src,ae,!!A,J),y.fa=_,h.push(y)),y};function Y(h,y){const _=y.type;if(_ in h.g){var A=h.g[_],J=Array.prototype.indexOf.call(A,y,void 0),ae;(ae=J>=0)&&Array.prototype.splice.call(A,J,1),ae&&(Se(y),h.g[_].length==0&&(delete h.g[_],h.h--))}}function be(h,y,_,A){for(let J=0;J<h.length;++J){const ae=h[J];if(!ae.da&&ae.listener==y&&ae.capture==!!_&&ae.ha==A)return J}return-1}var B="closure_lm_"+(Math.random()*1e6|0),ce={};function K(h,y,_,A,J){if(Array.isArray(y)){for(let ae=0;ae<y.length;ae++)K(h,y[ae],_,A,J);return null}return _=xt(_),h&&h[Te]?h.J(y,_,p(A)?!!A.capture:!1,J):Ee(h,y,_,!1,A,J)}function Ee(h,y,_,A,J,ae){if(!y)throw Error("Invalid event type");const Re=p(J)?!!J.capture:!!J;let st=Xe(h);if(st||(h[B]=st=new ye(h)),_=st.add(y,_,A,Re,ae),_.proxy)return _;if(A=F(),_.proxy=A,A.src=h,A.listener=_,h.addEventListener)O||(J=Re),J===void 0&&(J=!1),h.addEventListener(y.toString(),A,J);else if(h.attachEvent)h.attachEvent(ke(y.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return _}function F(){function h(_){return y.call(h.src,h.listener,_)}const y=Me;return h}function je(h,y,_,A,J){if(Array.isArray(y))for(var ae=0;ae<y.length;ae++)je(h,y[ae],_,A,J);else A=p(A)?!!A.capture:!!A,_=xt(_),h&&h[Te]?(h=h.i,ae=String(y).toString(),ae in h.g&&(y=h.g[ae],_=be(y,_,A,J),_>-1&&(Se(y[_]),Array.prototype.splice.call(y,_,1),y.length==0&&(delete h.g[ae],h.h--)))):h&&(h=Xe(h))&&(y=h.g[y.toString()],h=-1,y&&(h=be(y,_,A,J)),(_=h>-1?y[h]:null)&&le(_))}function le(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[Te])Y(y.i,h);else{var _=h.type,A=h.proxy;y.removeEventListener?y.removeEventListener(_,A,h.capture):y.detachEvent?y.detachEvent(ke(_),A):y.addListener&&y.removeListener&&y.removeListener(A),(_=Xe(y))?(Y(_,h),_.h==0&&(_.src=null,y[B]=null)):Se(h)}}}function ke(h){return h in ce?ce[h]:ce[h]="on"+h}function Me(h,y){if(h.da)h=!0;else{y=new ve(y,this);const _=h.listener,A=h.ha||h.src;h.fa&&le(h),h=_.call(A,y)}return h}function Xe(h){return h=h[B],h instanceof ye?h:null}var nt="__closure_events_fn_"+(Math.random()*1e9>>>0);function xt(h){return typeof h=="function"?h:(h[nt]||(h[nt]=function(y){return h.handleEvent(y)}),h[nt])}function jt(){M.call(this),this.i=new ye(this),this.M=this,this.G=null}w(jt,M),jt.prototype[Te]=!0,jt.prototype.removeEventListener=function(h,y,_,A){je(this,h,y,_,A)};function zt(h,y){var _,A=h.G;if(A)for(_=[];A;A=A.G)_.push(A);if(h=h.M,A=y.type||y,typeof y=="string")y=new I(y,h);else if(y instanceof I)y.target=y.target||h;else{var J=y;y=new I(A,h),de(y,J)}J=!0;let ae,Re;if(_)for(Re=_.length-1;Re>=0;Re--)ae=y.g=_[Re],J=ws(ae,A,!0,y)&&J;if(ae=y.g=h,J=ws(ae,A,!0,y)&&J,J=ws(ae,A,!1,y)&&J,_)for(Re=0;Re<_.length;Re++)ae=y.g=_[Re],J=ws(ae,A,!1,y)&&J}jt.prototype.N=function(){if(jt.Z.N.call(this),this.i){var h=this.i;for(const y in h.g){const _=h.g[y];for(let A=0;A<_.length;A++)Se(_[A]);delete h.g[y],h.h--}}this.G=null},jt.prototype.J=function(h,y,_,A){return this.i.add(String(h),y,!1,_,A)},jt.prototype.K=function(h,y,_,A){return this.i.add(String(h),y,!0,_,A)};function ws(h,y,_,A){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();let J=!0;for(let ae=0;ae<y.length;++ae){const Re=y[ae];if(Re&&!Re.da&&Re.capture==_){const st=Re.listener,on=Re.ha||Re.src;Re.fa&&Y(h.i,Re),J=st.call(on,A)!==!1&&J}}return J&&!A.defaultPrevented}function ir(h,y){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:d.setTimeout(h,y||0)}function In(h){h.g=ir(()=>{h.g=null,h.i&&(h.i=!1,In(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Bt extends M{constructor(y,_){super(),this.m=y,this.l=_,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:In(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _s(h){M.call(this),this.h=h,this.g={}}w(_s,M);var Ns=[];function Bs(h){Be(h.g,function(y,_){this.g.hasOwnProperty(_)&&le(y)},h),h.g={}}_s.prototype.N=function(){_s.Z.N.call(this),Bs(this)},_s.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Bn=d.JSON.stringify,gt=d.JSON.parse,Qe=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Ct(){}function Zt(){}var Dt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function vt(){I.call(this,"d")}w(vt,I);function Xt(){I.call(this,"c")}w(Xt,I);var wt={},an=null;function as(){return an=an||new jt}wt.Ia="serverreachability";function Ts(h){I.call(this,wt.Ia,h)}w(Ts,I);function Tn(h){const y=as();zt(y,new Ts(y))}wt.STAT_EVENT="statevent";function js(h,y){I.call(this,wt.STAT_EVENT,h),this.stat=y}w(js,I);function At(h){const y=as();zt(y,new js(y,h))}wt.Ja="timingevent";function Hn(h,y){I.call(this,wt.Ja,h),this.size=y}w(Hn,I);function is(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},y)}function Wn(){this.g=!0}Wn.prototype.ua=function(){this.g=!1};function Hi(h,y,_,A,J,ae){h.info(function(){if(h.g)if(ae){var Re="",st=ae.split("&");for(let _t=0;_t<st.length;_t++){var on=st[_t].split("=");if(on.length>1){const Gt=on[0];on=on[1];const $s=Gt.split("_");Re=$s.length>=2&&$s[1]=="type"?Re+(Gt+"="+on+"&"):Re+(Gt+"=redacted&")}}}else Re=null;else Re=ae;return"XMLHTTP REQ ("+A+") [attempt "+J+"]: "+y+`
`+_+`
`+Re})}function Ba(h,y,_,A,J,ae,Re){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+J+"]: "+y+`
`+_+`
`+ae+" "+Re})}function Fn(h,y,_,A){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+pe(h,_)+(A?" "+A:"")})}function ne(h,y){h.info(function(){return"TIMEOUT: "+y})}Wn.prototype.info=function(){};function pe(h,y){if(!h.g)return y;if(!y)return null;try{const ae=JSON.parse(y);if(ae){for(h=0;h<ae.length;h++)if(Array.isArray(ae[h])){var _=ae[h];if(!(_.length<2)){var A=_[1];if(Array.isArray(A)&&!(A.length<1)){var J=A[0];if(J!="noop"&&J!="stop"&&J!="close")for(let Re=1;Re<A.length;Re++)A[Re]=""}}}}return Bn(ae)}catch{return y}}var Ce={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},U={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Q;function we(){}w(we,Ct),we.prototype.g=function(){return new XMLHttpRequest},Q=new we;function Ne(h){return encodeURIComponent(String(h))}function Ue(h){var y=1;h=h.split(":");const _=[];for(;y>0&&h.length;)_.push(h.shift()),y--;return h.length&&_.push(h.join(":")),_}function Le(h,y,_,A){this.j=h,this.i=y,this.l=_,this.S=A||1,this.V=new _s(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ke}function Ke(){this.i=null,this.g="",this.h=!1}var tt={},it={};function $t(h,y,_){h.M=1,h.A=Fi(gn(y)),h.u=_,h.R=!0,ln(h,null)}function ln(h,y){h.F=Date.now(),Cn(h),h.B=gn(h.A);var _=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),Ol(_.i,"t",A),h.C=0,_=h.j.L,h.h=new Ke,h.g=ld(h.j,_?y:null,!h.u),h.P>0&&(h.O=new Bt(g(h.Y,h,h.g),h.P)),y=h.V,_=h.g,A=h.ba;var J="readystatechange";Array.isArray(J)||(J&&(Ns[0]=J.toString()),J=Ns);for(let ae=0;ae<J.length;ae++){const Re=K(_,J[ae],A||y.handleEvent,!1,y.h||y);if(!Re)break;y.g[Re.key]=Re}y=h.J?V(h.J):{},h.u?(h.v||(h.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,y)):(h.v="GET",h.g.ea(h.B,h.v,null,y)),Tn(),Hi(h.i,h.v,h.B,h.l,h.S,h.u)}Le.prototype.ba=function(h){h=h.target;const y=this.O;y&&cr(h)==3?y.j():this.Y(h)},Le.prototype.Y=function(h){try{if(h==this.g)e:{const st=cr(this.g),on=this.g.ya(),_t=this.g.ca();if(!(st<3)&&(st!=3||this.g&&(this.h.h||this.g.la()||Dn(this.g)))){this.K||st!=4||on==7||(on==8||_t<=0?Tn(3):Tn(2)),Er(this);var y=this.g.ca();this.X=y;var _=Kt(this);if(this.o=y==200,Ba(this.i,this.v,this.B,this.l,this.S,st,y),this.o){if(this.U&&!this.L){t:{if(this.g){var A,J=this.g;if((A=J.g?J.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(A)){var ae=A;break t}}ae=null}if(h=ae)Fn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Sr(this,h);else{this.o=!1,this.m=3,At(12),Es(this),Hs(this);break e}}if(this.R){h=!0;let Gt;for(;!this.K&&this.C<_.length;)if(Gt=sa(this,_),Gt==it){st==4&&(this.m=4,At(14),h=!1),Fn(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==tt){this.m=4,At(15),Fn(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else Fn(this.i,this.l,Gt,null),Sr(this,Gt);if(Jn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),st!=4||_.length!=0||this.h.h||(this.m=1,At(16),h=!1),this.o=this.o&&h,!h)Fn(this.i,this.l,_,"[Invalid Chunked Response]"),Es(this),Hs(this);else if(_.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),fc(Re),Re.P=!0,At(11))}}else Fn(this.i,this.l,_,null),Sr(this,_);st==4&&Es(this),this.o&&!this.K&&(st==4?sd(this.j,this):(this.o=!1,Cn(this)))}else aa(this.g),y==400&&_.indexOf("Unknown SID")>0?(this.m=3,At(12)):(this.m=0,At(13)),Es(this),Hs(this)}}}catch{}finally{}};function Kt(h){if(!Jn(h))return h.g.la();const y=Dn(h.g);if(y==="")return"";let _="";const A=y.length,J=cr(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Es(h),Hs(h),"";h.h.i=new d.TextDecoder}for(let ae=0;ae<A;ae++)h.h.h=!0,_+=h.h.i.decode(y[ae],{stream:!(J&&ae==A-1)});return y.length=0,h.h.g+=_,h.C=0,h.h.g}function Jn(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function sa(h,y){var _=h.C,A=y.indexOf(`
`,_);return A==-1?it:(_=Number(y.substring(_,A)),isNaN(_)?tt:(A+=1,A+_>y.length?it:(y=y.slice(A,A+_),h.C=A+_,y)))}Le.prototype.cancel=function(){this.K=!0,Es(this)};function Cn(h){h.T=Date.now()+h.H,kl(h,h.H)}function kl(h,y){if(h.D!=null)throw Error("WatchDog timer not null");h.D=is(g(h.aa,h),y)}function Er(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Le.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(ne(this.i,this.B),this.M!=2&&(Tn(),At(17)),Es(this),this.m=2,Hs(this)):kl(this,this.T-h)};function Hs(h){h.j.I==0||h.K||sd(h.j,h)}function Es(h){Er(h);var y=h.O;y&&typeof y.dispose=="function"&&y.dispose(),h.O=null,Bs(h.V),h.g&&(y=h.g,h.g=null,y.abort(),y.dispose())}function Sr(h,y){try{var _=h.j;if(_.I!=0&&(_.g==h||Ar(_.h,h))){if(!h.L&&Ar(_.h,h)&&_.I==3){try{var A=_.Ba.g.parse(y)}catch{A=null}if(Array.isArray(A)&&A.length==3){var J=A;if(J[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)Ul(_),Qa(_);else break e;Xi(_),At(18)}}else _.xa=J[1],0<_.xa-_.K&&J[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=is(g(_.Va,_),6e3));Cr(_.h)<=1&&_.ta&&(_.ta=void 0)}else Mr(_,11)}else if((h.L||_.g==h)&&Ul(_),!E(y))for(J=_.Ba.g.parse(y),y=0;y<J.length;y++){let _t=J[y];const Gt=_t[0];if(!(Gt<=_.K))if(_.K=Gt,_t=_t[1],_.I==2)if(_t[0]=="c"){_.M=_t[1],_.ba=_t[2];const $s=_t[3];$s!=null&&(_.ka=$s,_.j.info("VER="+_.ka));const Vr=_t[4];Vr!=null&&(_.za=Vr,_.j.info("SVER="+_.za));const ur=_t[5];ur!=null&&typeof ur=="number"&&ur>0&&(A=1.5*ur,_.O=A,_.j.info("backChannelRequestTimeoutMs_="+A)),A=_;const dr=h.g;if(dr){const Wi=dr.g?dr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wi){var ae=A.h;ae.g||Wi.indexOf("spdy")==-1&&Wi.indexOf("quic")==-1&&Wi.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(tc(ae,ae.h),ae.h=null))}if(A.G){const zl=dr.g?dr.g.getResponseHeader("X-HTTP-Session-Id"):null;zl&&(A.wa=zl,Rt(A.J,A.G,zl))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),A=_;var Re=h;if(A.na=id(A,A.L?A.ba:null,A.W),Re.L){nc(A.h,Re);var st=Re,on=A.O;on&&(st.H=on),st.D&&(Er(st),Cn(st)),A.g=Re}else td(A);_.i.length>0&&Or(_)}else _t[0]!="stop"&&_t[0]!="close"||Mr(_,7);else _.I==3&&(_t[0]=="stop"||_t[0]=="close"?_t[0]=="stop"?Mr(_,7):dc(_):_t[0]!="noop"&&_.l&&_.l.qa(_t),_.A=0)}}Tn(4)}catch{}}var pn=class{constructor(h,y){this.g=h,this.map=y}};function Zo(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ec(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Cr(h){return h.h?1:h.g?h.g.size:0}function Ar(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function tc(h,y){h.g?h.g.add(y):h.h=y}function nc(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Zo.prototype.cancel=function(){if(this.i=sc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function sc(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const _ of h.g.values())y=y.concat(_.G);return y}return R(h.i)}var Qu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Il(h,y){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const A=h[_].indexOf("=");let J,ae=null;A>=0?(J=h[_].substring(0,A),ae=h[_].substring(A+1)):J=h[_],y(J,ae?decodeURIComponent(ae.replace(/\+/g," ")):"")}}}function Ss(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;h instanceof Ss?(this.l=h.l,An(this,h.j),this.o=h.o,this.g=h.g,Ha(this,h.u),this.h=h.h,rc(this,Zu(h.i)),this.m=h.m):h&&(y=String(h).match(Qu))?(this.l=!1,An(this,y[1]||"",!0),this.o=Rr(y[2]||""),this.g=Rr(y[3]||"",!0),Ha(this,y[4]),this.h=Rr(y[5]||"",!0),rc(this,y[6]||"",!0),this.m=Rr(y[7]||"")):(this.l=!1,this.i=new qa(null,this.l))}Ss.prototype.toString=function(){const h=[];var y=this.j;y&&h.push(qi(y,Dl,!0),":");var _=this.g;return(_||y=="file")&&(h.push("//"),(y=this.o)&&h.push(qi(y,Dl,!0),"@"),h.push(Ne(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(qi(_,_.charAt(0)=="/"?ac:Xu,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",qi(_,Wu)),h.join("")},Ss.prototype.resolve=function(h){const y=gn(this);let _=!!h.j;_?An(y,h.j):_=!!h.o,_?y.o=h.o:_=!!h.g,_?y.g=h.g:_=h.u!=null;var A=h.h;if(_)Ha(y,h.u);else if(_=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var J=y.h.lastIndexOf("/");J!=-1&&(A=y.h.slice(0,J+1)+A)}if(J=A,J==".."||J==".")A="";else if(J.indexOf("./")!=-1||J.indexOf("/.")!=-1){A=J.lastIndexOf("/",0)==0,J=J.split("/");const ae=[];for(let Re=0;Re<J.length;){const st=J[Re++];st=="."?A&&Re==J.length&&ae.push(""):st==".."?((ae.length>1||ae.length==1&&ae[0]!="")&&ae.pop(),A&&Re==J.length&&ae.push("")):(ae.push(st),A=!0)}A=ae.join("/")}else A=J}return _?y.h=A:_=h.i.toString()!=="",_?rc(y,Zu(h.i)):_=!!h.m,_&&(y.m=h.m),y};function gn(h){return new Ss(h)}function An(h,y,_){h.j=_?Rr(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Ha(h,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);h.u=y}else h.u=null}function rc(h,y,_){y instanceof qa?(h.i=y,Ml(h.i,h.l)):(_||(y=qi(y,Fa)),h.i=new qa(y,h.l))}function Rt(h,y,_){h.i.set(y,_)}function Fi(h){return Rt(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Rr(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function qi(h,y,_){return typeof h=="string"?(h=encodeURI(h).replace(y,ls),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function ls(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Dl=/[#\/\?@]/g,Xu=/[#\?:]/g,ac=/[#\?]/g,Fa=/[#\?@]/g,Wu=/#/g;function qa(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function os(h){h.g||(h.g=new Map,h.h=0,h.i&&Il(h.i,function(y,_){h.add(decodeURIComponent(y.replace(/\+/g," ")),_)}))}s=qa.prototype,s.add=function(h,y){os(this),this.i=null,h=$a(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(y),this.h+=1,this};function Ju(h,y){os(h),y=$a(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function ic(h,y){return os(h),y=$a(h,y),h.g.has(y)}s.forEach=function(h,y){os(this),this.g.forEach(function(_,A){_.forEach(function(J){h.call(y,J,A,this)},this)},this)};function lc(h,y){os(h);let _=[];if(typeof y=="string")ic(h,y)&&(_=_.concat(h.g.get($a(h,y))));else for(h=Array.from(h.g.values()),y=0;y<h.length;y++)_=_.concat(h[y]);return _}s.set=function(h,y){return os(this),this.i=null,h=$a(this,h),ic(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},s.get=function(h,y){return h?(h=lc(this,h),h.length>0?String(h[0]):y):y};function Ol(h,y,_){Ju(h,y),_.length>0&&(h.i=null,h.g.set($a(h,y),R(_)),h.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(let A=0;A<y.length;A++){var _=y[A];const J=Ne(_);_=lc(this,_);for(let ae=0;ae<_.length;ae++){let Re=J;_[ae]!==""&&(Re+="="+Ne(_[ae])),h.push(Re)}}return this.i=h.join("&")};function Zu(h){const y=new qa;return y.i=h.i,h.g&&(y.g=new Map(h.g),y.h=h.h),y}function $a(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Ml(h,y){y&&!h.j&&(os(h),h.i=null,h.g.forEach(function(_,A){const J=A.toLowerCase();A!=J&&(Ju(this,A),Ol(this,J,_))},h)),h.j=y}function lr(h,y){const _=new Wn;if(d.Image){const A=new Image;A.onload=b(Fs,_,"TestLoadImage: loaded",!0,y,A),A.onerror=b(Fs,_,"TestLoadImage: error",!1,y,A),A.onabort=b(Fs,_,"TestLoadImage: abort",!1,y,A),A.ontimeout=b(Fs,_,"TestLoadImage: timeout",!1,y,A),d.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else y(!1)}function oc(h,y){const _=new Wn,A=new AbortController,J=setTimeout(()=>{A.abort(),Fs(_,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:A.signal}).then(ae=>{clearTimeout(J),ae.ok?Fs(_,"TestPingServer: ok",!0,y):Fs(_,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(J),Fs(_,"TestPingServer: error",!1,y)})}function Fs(h,y,_,A,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),A(_)}catch{}}function Ka(){this.g=new Qe}function kr(h){this.i=h.Sb||null,this.h=h.ab||!1}w(kr,Ct),kr.prototype.g=function(){return new $i(this.i,this.h)};function $i(h,y){jt.call(this),this.H=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w($i,jt),s=$i.prototype,s.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=y,this.readyState=1,or(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(y.body=h),(this.H||d).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ga(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,or(this)),this.g&&(this.readyState=3,or(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Vl(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Vl(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Ga(this):or(this),this.readyState==3&&Vl(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,Ga(this))},s.Na=function(h){this.g&&(this.response=h,Ga(this))},s.ga=function(){this.g&&Ga(this)};function Ga(h){h.readyState=4,h.l=null,h.j=null,h.B=null,or(h)}s.setRequestHeader=function(h,y){this.A.append(h,y)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var _=y.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=y.next();return h.join(`\r
`)};function or(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty($i.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function qs(h){let y="";return Be(h,function(_,A){y+=A,y+=":",y+=_,y+=`\r
`}),y}function Ki(h,y,_){e:{for(A in _){var A=!1;break e}A=!0}A||(_=qs(_),typeof h=="string"?_!=null&&Ne(_):Rt(h,y,_))}function Ot(h){jt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(Ot,jt);var Ir=/^https?$/i,cc=["POST","PUT"];s=Ot.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,y,_,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Q.g(),this.g.onreadystatechange=N(g(this.Ca,this));try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(ae){Gi(this,ae);return}if(h=_||"",_=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var J in A)_.set(J,A[J]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const ae of A.keys())_.set(ae,A.get(ae));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(_.keys()).find(ae=>ae.toLowerCase()=="content-type"),J=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(cc,y,void 0)>=0)||A||J||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,Re]of _)this.g.setRequestHeader(ae,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ae){Gi(this,ae)}};function Gi(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.o=5,uc(h),ra(h)}function uc(h){h.A||(h.A=!0,zt(h,"complete"),zt(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,zt(this,"complete"),zt(this,"abort"),ra(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ra(this,!0)),Ot.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Yi(this):this.Xa())},s.Xa=function(){Yi(this)};function Yi(h){if(h.h&&typeof u<"u"){if(h.v&&cr(h)==4)setTimeout(h.Ca.bind(h),0);else if(zt(h,"readystatechange"),cr(h)==4){h.h=!1;try{const ae=h.ca();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var _;if(!(_=y)){var A;if(A=ae===0){let Re=String(h.D).match(Qu)[1]||null;!Re&&d.self&&d.self.location&&(Re=d.self.location.protocol.slice(0,-1)),A=!Ir.test(Re?Re.toLowerCase():"")}_=A}if(_)zt(h,"complete"),zt(h,"success");else{h.o=6;try{var J=cr(h)>2?h.g.statusText:""}catch{J=""}h.l=J+" ["+h.ca()+"]",uc(h)}}finally{ra(h)}}}}function ra(h,y){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,y||zt(h,"ready");try{_.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function cr(h){return h.g?h.g.readyState:0}s.ca=function(){try{return cr(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),gt(y)}};function Dn(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function aa(h){const y={};h=(h.g&&cr(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(E(h[A]))continue;var _=Ue(h[A]);const J=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const ae=y[J]||[];y[J]=ae,ae.push(_)}Pe(y,function(A){return A.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Dr(h,y,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||y}function Ya(h){this.za=0,this.i=[],this.j=new Wn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Dr("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Dr("baseRetryDelayMs",5e3,h),this.Za=Dr("retryDelaySeedMs",1e4,h),this.Ta=Dr("forwardChannelMaxRetries",2,h),this.va=Dr("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Zo(h&&h.concurrentRequestLimit),this.Ba=new Ka,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=Ya.prototype,s.ka=8,s.I=1,s.connect=function(h,y,_,A){At(0),this.W=h,this.H=y||{},_&&A!==void 0&&(this.H.OSID=_,this.H.OAID=A),this.F=this.X,this.J=id(this,null,this.W),Or(this)};function dc(h){if(Pl(h),h.I==3){var y=h.V++,_=gn(h.J);if(Rt(_,"SID",h.M),Rt(_,"RID",y),Rt(_,"TYPE","terminate"),Qi(h,_),y=new Le(h,h.j,y),y.M=2,y.A=Fi(gn(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(y.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=y.A,_=!0),_||(y.g=ld(y.j,null),y.g.ea(y.A)),y.F=Date.now(),Cn(y)}ad(h)}function Qa(h){h.g&&(fc(h),h.g.cancel(),h.g=null)}function Pl(h){Qa(h),h.v&&(d.clearTimeout(h.v),h.v=null),Ul(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Or(h){if(!ec(h.h)&&!h.m){h.m=!0;var y=h.Ea;he||C(),_e||(he(),_e=!0),S.add(y,h),h.D=0}}function Ll(h,y){return Cr(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=y.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=is(g(h.Ea,h,y),rd(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const J=new Le(this,this.j,h);let ae=this.o;if(this.U&&(ae?(ae=V(ae),de(ae,this.U)):ae=this.U),this.u!==null||this.R||(J.J=ae,ae=null),this.S)e:{for(var y=0,_=0;_<this.i.length;_++){t:{var A=this.i[_];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(y+=A,y>4096){y=_;break e}if(y===4096||_===this.i.length-1){y=_+1;break e}}y=1e3}else y=1e3;y=ed(this,J,y),_=gn(this.J),Rt(_,"RID",h),Rt(_,"CVER",22),this.G&&Rt(_,"X-HTTP-Session-Id",this.G),Qi(this,_),ae&&(this.R?y="headers="+Ne(qs(ae))+"&"+y:this.u&&Ki(_,this.u,ae)),tc(this.h,J),this.Ra&&Rt(_,"TYPE","init"),this.S?(Rt(_,"$req",y),Rt(_,"SID","null"),J.U=!0,$t(J,_,null)):$t(J,_,y),this.I=2}}else this.I==3&&(h?hc(this,h):this.i.length==0||ec(this.h)||hc(this))};function hc(h,y){var _;y?_=y.l:_=h.V++;const A=gn(h.J);Rt(A,"SID",h.M),Rt(A,"RID",_),Rt(A,"AID",h.K),Qi(h,A),h.u&&h.o&&Ki(A,h.u,h.o),_=new Le(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),y&&(h.i=y.G.concat(h.i)),y=ed(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),tc(h.h,_),$t(_,A,y)}function Qi(h,y){h.H&&Be(h.H,function(_,A){Rt(y,A,_)}),h.l&&Be({},function(_,A){Rt(y,A,_)})}function ed(h,y,_){_=Math.min(h.i.length,_);const A=h.l?g(h.l.Ka,h.l,h):null;e:{var J=h.i;let st=-1;for(;;){const on=["count="+_];st==-1?_>0?(st=J[0].g,on.push("ofs="+st)):st=0:on.push("ofs="+st);let _t=!0;for(let Gt=0;Gt<_;Gt++){var ae=J[Gt].g;const $s=J[Gt].map;if(ae-=st,ae<0)st=Math.max(0,J[Gt].g-100),_t=!1;else try{ae="req"+ae+"_"||"";try{var Re=$s instanceof Map?$s:Object.entries($s);for(const[Vr,ur]of Re){let dr=ur;p(ur)&&(dr=Bn(ur)),on.push(ae+Vr+"="+encodeURIComponent(dr))}}catch(Vr){throw on.push(ae+"type="+encodeURIComponent("_badmap")),Vr}}catch{A&&A($s)}}if(_t){Re=on.join("&");break e}}Re=void 0}return h=h.i.splice(0,_),y.G=h,Re}function td(h){if(!h.g&&!h.v){h.Y=1;var y=h.Da;he||C(),_e||(he(),_e=!0),S.add(y,h),h.A=0}}function Xi(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=is(g(h.Da,h),rd(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,nd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=is(g(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,At(10),Qa(this),nd(this))};function fc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function nd(h){h.g=new Le(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var y=gn(h.na);Rt(y,"RID","rpc"),Rt(y,"SID",h.M),Rt(y,"AID",h.K),Rt(y,"CI",h.F?"0":"1"),!h.F&&h.ia&&Rt(y,"TO",h.ia),Rt(y,"TYPE","xmlhttp"),Qi(h,y),h.u&&h.o&&Ki(y,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=Fi(gn(y)),_.u=null,_.R=!0,ln(_,h)}s.Va=function(){this.C!=null&&(this.C=null,Qa(this),Xi(this),At(19))};function Ul(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function sd(h,y){var _=null;if(h.g==y){Ul(h),fc(h),h.g=null;var A=2}else if(Ar(h.h,y))_=y.G,nc(h.h,y),A=1;else return;if(h.I!=0){if(y.o)if(A==1){_=y.u?y.u.length:0,y=Date.now()-y.F;var J=h.D;A=as(),zt(A,new Hn(A,_)),Or(h)}else td(h);else if(J=y.m,J==3||J==0&&y.X>0||!(A==1&&Ll(h,y)||A==2&&Xi(h)))switch(_&&_.length>0&&(y=h.h,y.i=y.i.concat(_)),J){case 1:Mr(h,5);break;case 4:Mr(h,10);break;case 3:Mr(h,6);break;default:Mr(h,2)}}}function rd(h,y){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*y}function Mr(h,y){if(h.j.info("Error code "+y),y==2){var _=g(h.bb,h),A=h.Ua;const J=!A;A=new Ss(A||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||An(A,"https"),Fi(A),J?lr(A.toString(),_):oc(A.toString(),_)}else At(2);h.I=0,h.l&&h.l.pa(y),ad(h),Pl(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),At(2)):(this.j.info("Failed to ping google.com"),At(1))};function ad(h){if(h.I=0,h.ja=[],h.l){const y=sc(h.h);(y.length!=0||h.i.length!=0)&&(D(h.ja,y),D(h.ja,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.oa()}}function id(h,y,_){var A=_ instanceof Ss?gn(_):new Ss(_);if(A.g!="")y&&(A.g=y+"."+A.g),Ha(A,A.u);else{var J=d.location;A=J.protocol,y=y?y+"."+J.hostname:J.hostname,J=+J.port;const ae=new Ss(null);A&&An(ae,A),y&&(ae.g=y),J&&Ha(ae,J),_&&(ae.h=_),A=ae}return _=h.G,y=h.wa,_&&y&&Rt(A,_,y),Rt(A,"VER",h.ka),Qi(h,A),A}function ld(h,y,_){if(y&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Aa&&!h.ma?new Ot(new kr({ab:_})):new Ot(h.ma),y.Fa(h.L),y}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function od(){}s=od.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function Xa(){}Xa.prototype.g=function(h,y){return new Zn(h,y)};function Zn(h,y){jt.call(this),this.g=new Ya(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(h?h["X-WebChannel-Client-Profile"]=y.sa:h={"X-WebChannel-Client-Profile":y.sa}),this.g.U=h,(h=y&&y.Qb)&&!E(h)&&(this.g.u=h),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!E(y)&&(this.g.G=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new ia(this)}w(Zn,jt),Zn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Zn.prototype.close=function(){dc(this.g)},Zn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=Bn(h),h=_);y.i.push(new pn(y.Ya++,h)),y.I==3&&Or(y)},Zn.prototype.N=function(){this.g.l=null,delete this.j,dc(this.g),delete this.g,Zn.Z.N.call(this)};function cd(h){vt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const _ in y){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}w(cd,vt);function ud(){Xt.call(this),this.status=1}w(ud,Xt);function ia(h){this.g=h}w(ia,od),ia.prototype.ra=function(){zt(this.g,"a")},ia.prototype.qa=function(h){zt(this.g,new cd(h))},ia.prototype.pa=function(h){zt(this.g,new ud)},ia.prototype.oa=function(){zt(this.g,"b")},Xa.prototype.createWebChannel=Xa.prototype.g,Zn.prototype.send=Zn.prototype.o,Zn.prototype.open=Zn.prototype.m,Zn.prototype.close=Zn.prototype.close,C1=function(){return new Xa},S1=function(){return as()},E1=wt,Ng={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ce.NO_ERROR=0,Ce.TIMEOUT=8,Ce.HTTP_ERROR=6,jh=Ce,U.COMPLETE="complete",j1=U,Zt.EventType=Dt,Dt.OPEN="a",Dt.CLOSE="b",Dt.ERROR="c",Dt.MESSAGE="d",jt.prototype.listen=jt.prototype.J,nu=Zt,Ot.prototype.listenOnce=Ot.prototype.K,Ot.prototype.getLastError=Ot.prototype.Ha,Ot.prototype.getLastErrorCode=Ot.prototype.ya,Ot.prototype.getStatus=Ot.prototype.ca,Ot.prototype.getResponseJson=Ot.prototype.La,Ot.prototype.getResponseText=Ot.prototype.la,Ot.prototype.send=Ot.prototype.ea,Ot.prototype.setWithCredentials=Ot.prototype.Fa,T1=Ot}).apply(typeof ph<"u"?ph:typeof self<"u"?self:typeof window<"u"?window:{});const cw="@firebase/firestore",uw="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Kn.UNAUTHENTICATED=new Kn(null),Kn.GOOGLE_CREDENTIALS=new Kn("google-credentials-uid"),Kn.FIRST_PARTY=new Kn("first-party-uid"),Kn.MOCK_USER=new Kn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ko="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl=new a0("@firebase/firestore");function yo(){return bl.logLevel}function Oe(s,...e){if(bl.logLevel<=dt.DEBUG){const t=e.map(o0);bl.debug(`Firestore (${Ko}): ${s}`,...t)}}function Va(s,...e){if(bl.logLevel<=dt.ERROR){const t=e.map(o0);bl.error(`Firestore (${Ko}): ${s}`,...t)}}function Oo(s,...e){if(bl.logLevel<=dt.WARN){const t=e.map(o0);bl.warn(`Firestore (${Ko}): ${s}`,...t)}}function o0(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(s,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,A1(s,a,t)}function A1(s,e,t){let a=`FIRESTORE (${Ko}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Va(a),new Error(a)}function Et(s,e,t,a){let o="Unexpected state";typeof t=="string"?o=t:a=t,s||A1(e,o,a)}function et(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class De extends Tr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class y4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Kn.UNAUTHENTICATED)))}shutdown(){}}class b4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class v4{constructor(e){this.t=e,this.currentUser=Kn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Et(this.o===void 0,42304);let a=this.i;const o=x=>this.i!==a?(a=this.i,t(x)):Promise.resolve();let u=new Ra;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new Ra,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const x=u;e.enqueueRetryable((async()=>{await x.promise,await o(this.currentUser)}))},p=x=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=x,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((x=>p(x))),setTimeout((()=>{if(!this.auth){const x=this.t.getImmediate({optional:!0});x?p(x):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new Ra)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((a=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Et(typeof a.accessToken=="string",31837,{l:a}),new R1(a.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Et(e===null||typeof e=="string",2055,{h:e}),new Kn(e)}}class w4{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=Kn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class _4{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new w4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Kn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class N4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,gs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Et(this.o===void 0,3512);const a=u=>{u.error!=null&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,Oe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>a(u)))};const o=u=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>o(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?o(u):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Et(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new dw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<s;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=T4(40);for(let u=0;u<o.length;++u)a.length<20&&o[u]<t&&(a+=e.charAt(o[u]%62))}return a}}function ht(s,e){return s<e?-1:s>e?1:0}function Tg(s,e){const t=Math.min(s.length,e.length);for(let a=0;a<t;a++){const o=s.charAt(a),u=e.charAt(a);if(o!==u)return Jp(o)===Jp(u)?ht(o,u):Jp(o)?1:-1}return ht(s.length,e.length)}const j4=55296,E4=57343;function Jp(s){const e=s.charCodeAt(0);return e>=j4&&e<=E4}function Mo(s,e,t){return s.length===e.length&&s.every(((a,o)=>t(a,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hw="__name__";class Hr{constructor(e,t,a){t===void 0?t=0:t>e.length&&Ye(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&Ye(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Hr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hr?e.forEach((a=>{t.push(a)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let o=0;o<a;o++){const u=Hr.compareSegments(e.get(o),t.get(o));if(u!==0)return u}return ht(e.length,t.length)}static compareSegments(e,t){const a=Hr.isNumericId(e),o=Hr.isNumericId(t);return a&&!o?-1:!a&&o?1:a&&o?Hr.extractNumericId(e).compare(Hr.extractNumericId(t)):Tg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ei.fromString(e.substring(4,e.length-2))}}class Ut extends Hr{construct(e,t,a){return new Ut(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new De(me.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter((o=>o.length>0)))}return new Ut(t)}static emptyPath(){return new Ut([])}}const S4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Un extends Hr{construct(e,t,a){return new Un(e,t,a)}static isValidIdentifier(e){return S4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Un.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hw}static keyField(){return new Un([hw])}static fromServerFormat(e){const t=[];let a="",o=0;const u=()=>{if(a.length===0)throw new De(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let d=!1;for(;o<e.length;){const p=e[o];if(p==="\\"){if(o+1===e.length)throw new De(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const x=e[o+1];if(x!=="\\"&&x!=="."&&x!=="`")throw new De(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=x,o+=2}else p==="`"?(d=!d,o++):p!=="."||d?(a+=p,o++):(u(),o++)}if(u(),d)throw new De(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Un(t)}static emptyPath(){return new Un([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(Ut.fromString(e))}static fromName(e){return new Fe(Ut.fromString(e).popFirst(5))}static empty(){return new Fe(Ut.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ut.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ut.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new Ut(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k1(s,e,t){if(!t)throw new De(me.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function C4(s,e,t,a){if(e===!0&&a===!0)throw new De(me.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function fw(s){if(!Fe.isDocumentKey(s))throw new De(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function mw(s){if(Fe.isDocumentKey(s))throw new De(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function I1(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function xf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(a){return a.constructor?a.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Ye(12329,{type:typeof s})}function ss(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new De(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=xf(s);throw new De(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(s,e){const t={typeString:s};return e&&(t.value=e),t}function Iu(s,e){if(!I1(s))throw new De(me.INVALID_ARGUMENT,"JSON must be an object");let t;for(const a in e)if(e[a]){const o=e[a].typeString,u="value"in e[a]?{value:e[a].value}:void 0;if(!(a in s)){t=`JSON missing required field: '${a}'`;break}const d=s[a];if(o&&typeof d!==o){t=`JSON field '${a}' must be a ${o}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${a}' field to equal '${u.value}'`;break}}if(t)throw new De(me.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pw=-62135596800,gw=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(e){return qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*gw);return new qt(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new De(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new De(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<pw)throw new De(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new De(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gw}_compareTo(e){return this.seconds===e.seconds?ht(this.nanoseconds,e.nanoseconds):ht(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Iu(e,qt._jsonSchema))return new qt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-pw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qt._jsonSchemaVersion="firestore/timestamp/1.0",qt._jsonSchema={type:Nn("string",qt._jsonSchemaVersion),seconds:Nn("number"),nanoseconds:Nn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{static fromTimestamp(e){return new We(e)}static min(){return new We(new qt(0,0))}static max(){return new We(new qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xu=-1;function A4(s,e){const t=s.toTimestamp().seconds,a=s.toTimestamp().nanoseconds+1,o=We.fromTimestamp(a===1e9?new qt(t+1,0):new qt(t,a));return new Ri(o,Fe.empty(),e)}function R4(s){return new Ri(s.readTime,s.key,xu)}class Ri{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new Ri(We.min(),Fe.empty(),xu)}static max(){return new Ri(We.max(),Fe.empty(),xu)}}function k4(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=Fe.comparator(s.documentKey,e.documentKey),t!==0?t:ht(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class D4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Go(s){if(s.code!==me.FAILED_PRECONDITION||s.message!==I4)throw s;Oe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new xe(((a,o)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(a,o)},this.catchCallback=u=>{this.wrapFailure(t,u).next(a,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof xe?t:xe.resolve(t)}catch(t){return xe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):xe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):xe.reject(t)}static resolve(e){return new xe(((t,a)=>{t(e)}))}static reject(e){return new xe(((t,a)=>{a(e)}))}static waitFor(e){return new xe(((t,a)=>{let o=0,u=0,d=!1;e.forEach((p=>{++o,p.next((()=>{++u,d&&u===o&&t()}),(x=>a(x)))})),d=!0,u===o&&t()}))}static or(e){let t=xe.resolve(!1);for(const a of e)t=t.next((o=>o?xe.resolve(o):a()));return t}static forEach(e,t){const a=[];return e.forEach(((o,u)=>{a.push(t.call(this,o,u))})),this.waitFor(a)}static mapArray(e,t){return new xe(((a,o)=>{const u=e.length,d=new Array(u);let p=0;for(let x=0;x<u;x++){const g=x;t(e[g]).next((b=>{d[g]=b,++p,p===u&&a(d)}),(b=>o(b)))}}))}static doWhile(e,t){return new xe(((a,o)=>{const u=()=>{e()===!0?t().next((()=>{u()}),o):a()};u()}))}}function O4(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Yo(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ae(a),this.ue=a=>t.writeSequenceNumber(a))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}yf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0=-1;function bf(s){return s==null}function Bh(s){return s===0&&1/s==-1/0}function M4(s){return typeof s=="number"&&Number.isInteger(s)&&!Bh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="";function V4(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=xw(e)),e=P4(s.get(t),e);return xw(e)}function P4(s,e){let t=e;const a=s.length;for(let o=0;o<a;o++){const u=s.charAt(o);switch(u){case"\0":t+="";break;case D1:t+="";break;default:t+=u}}return t}function xw(s){return s+D1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Pi(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function O1(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e,t){this.comparator=e,this.root=t||Ln.EMPTY}insert(e,t){return new Jt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ln.BLACK,null,null))}remove(e){return new Jt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return t+a.left.size;o<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,a)=>(e(t,a),!1)))}toString(){const e=[];return this.inorderTraversal(((t,a)=>(e.push(`${t}:${a}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gh(this.root,e,this.comparator,!1)}getReverseIterator(){return new gh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gh(this.root,e,this.comparator,!0)}}class gh{constructor(e,t,a,o){this.isReverse=o,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?a(e.key,t):1,t&&o&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ln{constructor(e,t,a,o,u){this.key=e,this.value=t,this.color=a??Ln.RED,this.left=o??Ln.EMPTY,this.right=u??Ln.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,o,u){return new Ln(e??this.key,t??this.value,a??this.color,o??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let o=this;const u=a(e,o.key);return o=u<0?o.copy(null,null,null,o.left.insert(e,t,a),null):u===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Ln.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Ln.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ye(27949);return e+(this.isRed()?0:1)}}Ln.EMPTY=null,Ln.RED=!0,Ln.BLACK=!1;Ln.EMPTY=new class{constructor(){this.size=0}get key(){throw Ye(57766)}get value(){throw Ye(16141)}get color(){throw Ye(16727)}get left(){throw Ye(29726)}get right(){throw Ye(36894)}copy(e,t,a,o,u){return this}insert(e,t,a){return new Ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.comparator=e,this.data=new Jt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,a)=>(e(t),!1)))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new bw(this.data.getIterator())}getIteratorFrom(e){return new bw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((a=>{t=t.add(a)})),t}isEqual(e){if(!(e instanceof Sn)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,u=a.getNext().key;if(this.comparator(o,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Sn(this.comparator);return t.data=e,t}}class bw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e){this.fields=e,e.sort(Un.comparator)}static empty(){return new Vs([])}unionWith(e){let t=new Sn(Un.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new Vs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Mo(this.fields,e.fields,((t,a)=>t.isEqual(a)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new M1("Invalid base64 string: "+u):u}})(e);return new zn(t)}static fromUint8Array(e){const t=(function(o){let u="";for(let d=0;d<o.length;++d)u+=String.fromCharCode(o[d]);return u})(e);return new zn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const a=new Uint8Array(t.length);for(let o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ht(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zn.EMPTY_BYTE_STRING=new zn("");const L4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ki(s){if(Et(!!s,39018),typeof s=="string"){let e=0;const t=L4.exec(s);if(Et(!!t,46558,{timestamp:s}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(s);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:dn(s.seconds),nanos:dn(s.nanos)}}function dn(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Ii(s){return typeof s=="string"?zn.fromBase64String(s):zn.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V1="server_timestamp",P1="__type__",L1="__previous_value__",U1="__local_write_time__";function d0(s){var t,a;return((a=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[P1])==null?void 0:a.stringValue)===V1}function vf(s){const e=s.mapValue.fields[L1];return d0(e)?vf(e):e}function yu(s){const e=ki(s.mapValue.fields[U1].timestampValue);return new qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(e,t,a,o,u,d,p,x,g,b){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=o,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=x,this.useFetchStreams=g,this.isUsingEmulator=b}}const Hh="(default)";class bu{constructor(e,t){this.projectId=e,this.database=t||Hh}static empty(){return new bu("","")}get isDefaultDatabase(){return this.database===Hh}isEqual(e){return e instanceof bu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z1="__type__",z4="__max__",xh={mapValue:{}},B1="__vector__",Fh="value";function Di(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?d0(s)?4:H4(s)?9007199254740991:B4(s)?10:11:Ye(28295,{value:s})}function Wr(s,e){if(s===e)return!0;const t=Di(s);if(t!==Di(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return yu(s).isEqual(yu(e));case 3:return(function(o,u){if(typeof o.timestampValue=="string"&&typeof u.timestampValue=="string"&&o.timestampValue.length===u.timestampValue.length)return o.timestampValue===u.timestampValue;const d=ki(o.timestampValue),p=ki(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(o,u){return Ii(o.bytesValue).isEqual(Ii(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(o,u){return dn(o.geoPointValue.latitude)===dn(u.geoPointValue.latitude)&&dn(o.geoPointValue.longitude)===dn(u.geoPointValue.longitude)})(s,e);case 2:return(function(o,u){if("integerValue"in o&&"integerValue"in u)return dn(o.integerValue)===dn(u.integerValue);if("doubleValue"in o&&"doubleValue"in u){const d=dn(o.doubleValue),p=dn(u.doubleValue);return d===p?Bh(d)===Bh(p):isNaN(d)&&isNaN(p)}return!1})(s,e);case 9:return Mo(s.arrayValue.values||[],e.arrayValue.values||[],Wr);case 10:case 11:return(function(o,u){const d=o.mapValue.fields||{},p=u.mapValue.fields||{};if(yw(d)!==yw(p))return!1;for(const x in d)if(d.hasOwnProperty(x)&&(p[x]===void 0||!Wr(d[x],p[x])))return!1;return!0})(s,e);default:return Ye(52216,{left:s})}}function vu(s,e){return(s.values||[]).find((t=>Wr(t,e)))!==void 0}function Vo(s,e){if(s===e)return 0;const t=Di(s),a=Di(e);if(t!==a)return ht(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return ht(s.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=dn(u.integerValue||u.doubleValue),x=dn(d.integerValue||d.doubleValue);return p<x?-1:p>x?1:p===x?0:isNaN(p)?isNaN(x)?0:-1:1})(s,e);case 3:return vw(s.timestampValue,e.timestampValue);case 4:return vw(yu(s),yu(e));case 5:return Tg(s.stringValue,e.stringValue);case 6:return(function(u,d){const p=Ii(u),x=Ii(d);return p.compareTo(x)})(s.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),x=d.split("/");for(let g=0;g<p.length&&g<x.length;g++){const b=ht(p[g],x[g]);if(b!==0)return b}return ht(p.length,x.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=ht(dn(u.latitude),dn(d.latitude));return p!==0?p:ht(dn(u.longitude),dn(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return ww(s.arrayValue,e.arrayValue);case 10:return(function(u,d){var N,R,D,q;const p=u.fields||{},x=d.fields||{},g=(N=p[Fh])==null?void 0:N.arrayValue,b=(R=x[Fh])==null?void 0:R.arrayValue,w=ht(((D=g==null?void 0:g.values)==null?void 0:D.length)||0,((q=b==null?void 0:b.values)==null?void 0:q.length)||0);return w!==0?w:ww(g,b)})(s.mapValue,e.mapValue);case 11:return(function(u,d){if(u===xh.mapValue&&d===xh.mapValue)return 0;if(u===xh.mapValue)return 1;if(d===xh.mapValue)return-1;const p=u.fields||{},x=Object.keys(p),g=d.fields||{},b=Object.keys(g);x.sort(),b.sort();for(let w=0;w<x.length&&w<b.length;++w){const N=Tg(x[w],b[w]);if(N!==0)return N;const R=Vo(p[x[w]],g[b[w]]);if(R!==0)return R}return ht(x.length,b.length)})(s.mapValue,e.mapValue);default:throw Ye(23264,{he:t})}}function vw(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return ht(s,e);const t=ki(s),a=ki(e),o=ht(t.seconds,a.seconds);return o!==0?o:ht(t.nanos,a.nanos)}function ww(s,e){const t=s.values||[],a=e.values||[];for(let o=0;o<t.length&&o<a.length;++o){const u=Vo(t[o],a[o]);if(u)return u}return ht(t.length,a.length)}function Po(s){return jg(s)}function jg(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const a=ki(t);return`time(${a.seconds},${a.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Ii(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return Fe.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let a="[",o=!0;for(const u of t.values||[])o?o=!1:a+=",",a+=jg(u);return a+"]"})(s.arrayValue):"mapValue"in s?(function(t){const a=Object.keys(t.fields||{}).sort();let o="{",u=!0;for(const d of a)u?u=!1:o+=",",o+=`${d}:${jg(t.fields[d])}`;return o+"}"})(s.mapValue):Ye(61005,{value:s})}function Eh(s){switch(Di(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=vf(s);return e?16+Eh(e):16;case 5:return 2*s.stringValue.length;case 6:return Ii(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(a){return(a.values||[]).reduce(((o,u)=>o+Eh(u)),0)})(s.arrayValue);case 10:case 11:return(function(a){let o=0;return Pi(a.fields,((u,d)=>{o+=u.length+Eh(d)})),o})(s.mapValue);default:throw Ye(13486,{value:s})}}function _w(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Eg(s){return!!s&&"integerValue"in s}function h0(s){return!!s&&"arrayValue"in s}function Nw(s){return!!s&&"nullValue"in s}function Tw(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Sh(s){return!!s&&"mapValue"in s}function B4(s){var t,a;return((a=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[z1])==null?void 0:a.stringValue)===B1}function cu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Pi(s.mapValue.fields,((t,a)=>e.mapValue.fields[t]=cu(a))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cu(s.arrayValue.values[t]);return e}return{...s}}function H4(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===z4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e){this.value=e}static empty(){return new xs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!Sh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cu(t)}setAll(e){let t=Un.emptyPath(),a={},o=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const x=this.getFieldsMap(t);this.applyChanges(x,a,o),a={},o=[],t=p.popLast()}d?a[p.lastSegment()]=cu(d):o.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,a,o)}delete(e){const t=this.field(e.popLast());Sh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=t.mapValue.fields[e.get(a)];Sh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,a){Pi(t,((o,u)=>e[o]=u));for(const o of a)delete e[o]}clone(){return new xs(cu(this.value))}}function H1(s){const e=[];return Pi(s.fields,((t,a)=>{const o=new Un([t]);if(Sh(a)){const u=H1(a.mapValue).fields;if(u.length===0)e.push(o);else for(const d of u)e.push(o.child(d))}else e.push(o)})),new Vs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,t,a,o,u,d,p){this.key=e,this.documentType=t,this.version=a,this.readTime=o,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new Gn(e,0,We.min(),We.min(),We.min(),xs.empty(),0)}static newFoundDocument(e,t,a,o){return new Gn(e,1,t,We.min(),a,o,0)}static newNoDocument(e,t){return new Gn(e,2,t,We.min(),We.min(),xs.empty(),0)}static newUnknownDocument(e,t){return new Gn(e,3,t,We.min(),We.min(),xs.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(We.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=We.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Gn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,t){this.position=e,this.inclusive=t}}function jw(s,e,t){let a=0;for(let o=0;o<s.position.length;o++){const u=e[o],d=s.position[o];if(u.field.isKeyField()?a=Fe.comparator(Fe.fromName(d.referenceValue),t.key):a=Vo(d,t.data.field(u.field)),u.dir==="desc"&&(a*=-1),a!==0)break}return a}function Ew(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Wr(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,t="asc"){this.field=e,this.dir=t}}function F4(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{}class _n extends F1{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new $4(e,t,a):t==="array-contains"?new Y4(e,a):t==="in"?new Q4(e,a):t==="not-in"?new X4(e,a):t==="array-contains-any"?new W4(e,a):new _n(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new K4(e,a):new G4(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Vo(t,this.value)):t!==null&&Di(this.value)===Di(t)&&this.matchesComparison(Vo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _r extends F1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new _r(e,t)}matches(e){return q1(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function q1(s){return s.op==="and"}function $1(s){return q4(s)&&q1(s)}function q4(s){for(const e of s.filters)if(e instanceof _r)return!1;return!0}function Sg(s){if(s instanceof _n)return s.field.canonicalString()+s.op.toString()+Po(s.value);if($1(s))return s.filters.map((e=>Sg(e))).join(",");{const e=s.filters.map((t=>Sg(t))).join(",");return`${s.op}(${e})`}}function K1(s,e){return s instanceof _n?(function(a,o){return o instanceof _n&&a.op===o.op&&a.field.isEqual(o.field)&&Wr(a.value,o.value)})(s,e):s instanceof _r?(function(a,o){return o instanceof _r&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce(((u,d,p)=>u&&K1(d,o.filters[p])),!0):!1})(s,e):void Ye(19439)}function G1(s){return s instanceof _n?(function(t){return`${t.field.canonicalString()} ${t.op} ${Po(t.value)}`})(s):s instanceof _r?(function(t){return t.op.toString()+" {"+t.getFilters().map(G1).join(" ,")+"}"})(s):"Filter"}class $4 extends _n{constructor(e,t,a){super(e,t,a),this.key=Fe.fromName(a.referenceValue)}matches(e){const t=Fe.comparator(e.key,this.key);return this.matchesComparison(t)}}class K4 extends _n{constructor(e,t){super(e,"in",t),this.keys=Y1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class G4 extends _n{constructor(e,t){super(e,"not-in",t),this.keys=Y1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Y1(s,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((a=>Fe.fromName(a.referenceValue)))}class Y4 extends _n{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return h0(t)&&vu(t.arrayValue,this.value)}}class Q4 extends _n{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&vu(this.value.arrayValue,t)}}class X4 extends _n{constructor(e,t){super(e,"not-in",t)}matches(e){if(vu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!vu(this.value.arrayValue,t)}}class W4 extends _n{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!h0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((a=>vu(this.value.arrayValue,a)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e,t=null,a=[],o=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=o,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Sw(s,e=null,t=[],a=[],o=null,u=null,d=null){return new J4(s,e,t,a,o,u,d)}function f0(s){const e=et(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((a=>Sg(a))).join(","),t+="|ob:",t+=e.orderBy.map((a=>(function(u){return u.field.canonicalString()+u.dir})(a))).join(","),bf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((a=>Po(a))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((a=>Po(a))).join(",")),e.Te=t}return e.Te}function m0(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!F4(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!K1(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Ew(s.startAt,e.startAt)&&Ew(s.endAt,e.endAt)}function Cg(s){return Fe.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e,t=null,a=[],o=[],u=null,d="F",p=null,x=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=o,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=x,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Z4(s,e,t,a,o,u,d,p){return new Qo(s,e,t,a,o,u,d,p)}function wf(s){return new Qo(s)}function Cw(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function Q1(s){return s.collectionGroup!==null}function uu(s){const e=et(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Sn(Un.comparator);return d.filters.forEach((x=>{x.getFlattenedFilters().forEach((g=>{g.isInequality()&&(p=p.add(g.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new wu(u,a))})),t.has(Un.keyField().canonicalString())||e.Ie.push(new wu(Un.keyField(),a))}return e.Ie}function $r(s){const e=et(s);return e.Ee||(e.Ee=eR(e,uu(s))),e.Ee}function eR(s,e){if(s.limitType==="F")return Sw(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((o=>{const u=o.dir==="desc"?"asc":"desc";return new wu(o.field,u)}));const t=s.endAt?new qh(s.endAt.position,s.endAt.inclusive):null,a=s.startAt?new qh(s.startAt.position,s.startAt.inclusive):null;return Sw(s.path,s.collectionGroup,e,s.filters,s.limit,t,a)}}function Ag(s,e){const t=s.filters.concat([e]);return new Qo(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function Rg(s,e,t){return new Qo(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function _f(s,e){return m0($r(s),$r(e))&&s.limitType===e.limitType}function X1(s){return`${f0($r(s))}|lt:${s.limitType}`}function bo(s){return`Query(target=${(function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map((o=>G1(o))).join(", ")}]`),bf(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map((o=>Po(o))).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map((o=>Po(o))).join(",")),`Target(${a})`})($r(s))}; limitType=${s.limitType})`}function Nf(s,e){return e.isFoundDocument()&&(function(a,o){const u=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(u):Fe.isDocumentKey(a.path)?a.path.isEqual(u):a.path.isImmediateParentOf(u)})(s,e)&&(function(a,o){for(const u of uu(a))if(!u.field.isKeyField()&&o.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(a,o){for(const u of a.filters)if(!u.matches(o))return!1;return!0})(s,e)&&(function(a,o){return!(a.startAt&&!(function(d,p,x){const g=jw(d,p,x);return d.inclusive?g<=0:g<0})(a.startAt,uu(a),o)||a.endAt&&!(function(d,p,x){const g=jw(d,p,x);return d.inclusive?g>=0:g>0})(a.endAt,uu(a),o))})(s,e)}function tR(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function W1(s){return(e,t)=>{let a=!1;for(const o of uu(s)){const u=nR(o,e,t);if(u!==0)return u;a=a||o.field.isKeyField()}return 0}}function nR(s,e,t){const a=s.field.isKeyField()?Fe.comparator(e.key,t.key):(function(u,d,p){const x=d.data.field(u),g=p.data.field(u);return x!==null&&g!==null?Vo(x,g):Ye(42886)})(s.field,e,t);switch(s.dir){case"asc":return a;case"desc":return-1*a;default:return Ye(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[o,u]of a)if(this.equalsFn(o,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let u=0;u<o.length;u++)if(this.equalsFn(o[u][0],e))return void(o[u]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[t]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Pi(this.inner,((t,a)=>{for(const[o,u]of a)e(o,u)}))}isEmpty(){return O1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR=new Jt(Fe.comparator);function Pa(){return sR}const J1=new Jt(Fe.comparator);function su(...s){let e=J1;for(const t of s)e=e.insert(t.key,t);return e}function Z1(s){let e=J1;return s.forEach(((t,a)=>e=e.insert(t,a.overlayedDocument))),e}function ml(){return du()}function eN(){return du()}function du(){return new El((s=>s.toString()),((s,e)=>s.isEqual(e)))}const rR=new Jt(Fe.comparator),aR=new Sn(Fe.comparator);function ft(...s){let e=aR;for(const t of s)e=e.add(t);return e}const iR=new Sn(ht);function lR(){return iR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bh(e)?"-0":e}}function tN(s){return{integerValue:""+s}}function oR(s,e){return M4(e)?tN(e):p0(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(){this._=void 0}}function cR(s,e,t){return s instanceof _u?(function(o,u){const d={fields:{[P1]:{stringValue:V1},[U1]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return u&&d0(u)&&(u=vf(u)),u&&(d.fields[L1]=u),{mapValue:d}})(t,e):s instanceof Lo?sN(s,e):s instanceof Nu?rN(s,e):(function(o,u){const d=nN(o,u),p=Aw(d)+Aw(o.Ae);return Eg(d)&&Eg(o.Ae)?tN(p):p0(o.serializer,p)})(s,e)}function uR(s,e,t){return s instanceof Lo?sN(s,e):s instanceof Nu?rN(s,e):t}function nN(s,e){return s instanceof $h?(function(a){return Eg(a)||(function(u){return!!u&&"doubleValue"in u})(a)})(e)?e:{integerValue:0}:null}class _u extends Tf{}class Lo extends Tf{constructor(e){super(),this.elements=e}}function sN(s,e){const t=aN(e);for(const a of s.elements)t.some((o=>Wr(o,a)))||t.push(a);return{arrayValue:{values:t}}}class Nu extends Tf{constructor(e){super(),this.elements=e}}function rN(s,e){let t=aN(e);for(const a of s.elements)t=t.filter((o=>!Wr(o,a)));return{arrayValue:{values:t}}}class $h extends Tf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Aw(s){return dn(s.integerValue||s.doubleValue)}function aN(s){return h0(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e,t){this.field=e,this.transform=t}}function dR(s,e){return s.field.isEqual(e.field)&&(function(a,o){return a instanceof Lo&&o instanceof Lo||a instanceof Nu&&o instanceof Nu?Mo(a.elements,o.elements,Wr):a instanceof $h&&o instanceof $h?Wr(a.Ae,o.Ae):a instanceof _u&&o instanceof _u})(s.transform,e.transform)}class hR{constructor(e,t){this.version=e,this.transformResults=t}}class rs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rs}static exists(e){return new rs(void 0,e)}static updateTime(e){return new rs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ch(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class jf{}function lN(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new Ef(s.key,rs.none()):new Du(s.key,s.data,rs.none());{const t=s.data,a=xs.empty();let o=new Sn(Un.comparator);for(let u of e.fields)if(!o.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?a.delete(u):a.set(u,d),o=o.add(u)}return new Li(s.key,a,new Vs(o.toArray()),rs.none())}}function fR(s,e,t){s instanceof Du?(function(o,u,d){const p=o.value.clone(),x=kw(o.fieldTransforms,u,d.transformResults);p.setAll(x),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(s,e,t):s instanceof Li?(function(o,u,d){if(!Ch(o.precondition,u))return void u.convertToUnknownDocument(d.version);const p=kw(o.fieldTransforms,u,d.transformResults),x=u.data;x.setAll(oN(o)),x.setAll(p),u.convertToFoundDocument(d.version,x).setHasCommittedMutations()})(s,e,t):(function(o,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function hu(s,e,t,a){return s instanceof Du?(function(u,d,p,x){if(!Ch(u.precondition,d))return p;const g=u.value.clone(),b=Iw(u.fieldTransforms,x,d);return g.setAll(b),d.convertToFoundDocument(d.version,g).setHasLocalMutations(),null})(s,e,t,a):s instanceof Li?(function(u,d,p,x){if(!Ch(u.precondition,d))return p;const g=Iw(u.fieldTransforms,x,d),b=d.data;return b.setAll(oN(u)),b.setAll(g),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((w=>w.field)))})(s,e,t,a):(function(u,d,p){return Ch(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(s,e,t)}function mR(s,e){let t=null;for(const a of s.fieldTransforms){const o=e.data.field(a.field),u=nN(a.transform,o||null);u!=null&&(t===null&&(t=xs.empty()),t.set(a.field,u))}return t||null}function Rw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&Mo(a,o,((u,d)=>dR(u,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Du extends jf{constructor(e,t,a,o=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Li extends jf{constructor(e,t,a,o,u=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=o,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function oN(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const a=s.data.field(t);e.set(t,a)}})),e}function kw(s,e,t){const a=new Map;Et(s.length===t.length,32656,{Re:t.length,Ve:s.length});for(let o=0;o<t.length;o++){const u=s[o],d=u.transform,p=e.data.field(u.field);a.set(u.field,uR(d,p,t[o]))}return a}function Iw(s,e,t){const a=new Map;for(const o of s){const u=o.transform,d=t.data.field(o.field);a.set(o.field,cR(u,d,e))}return a}class Ef extends jf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class pR extends jf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e,t,a,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const u=this.mutations[o];u.key.isEqual(e.key)&&fR(u,e,a[o])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=hu(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=hu(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=eN();return this.mutations.forEach((o=>{const u=e.get(o.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(o.key)?null:p;const x=lN(d,p);x!==null&&a.set(o.key,x),d.isValidDocument()||d.convertToNoDocument(We.min())})),a}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ft())}isEqual(e){return this.batchId===e.batchId&&Mo(this.mutations,e.mutations,((t,a)=>Rw(t,a)))&&Mo(this.baseMutations,e.baseMutations,((t,a)=>Rw(t,a)))}}class g0{constructor(e,t,a,o){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=o}static from(e,t,a){Et(e.mutations.length===a.length,58842,{me:e.mutations.length,fe:a.length});let o=(function(){return rR})();const u=e.mutations;for(let d=0;d<u.length;d++)o=o.insert(u[d].key,a[d].version);return new g0(e,t,a,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wn,pt;function bR(s){switch(s){case me.OK:return Ye(64938);case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0;default:return Ye(15467,{code:s})}}function cN(s){if(s===void 0)return Va("GRPC error has no .code"),me.UNKNOWN;switch(s){case wn.OK:return me.OK;case wn.CANCELLED:return me.CANCELLED;case wn.UNKNOWN:return me.UNKNOWN;case wn.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case wn.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case wn.INTERNAL:return me.INTERNAL;case wn.UNAVAILABLE:return me.UNAVAILABLE;case wn.UNAUTHENTICATED:return me.UNAUTHENTICATED;case wn.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case wn.NOT_FOUND:return me.NOT_FOUND;case wn.ALREADY_EXISTS:return me.ALREADY_EXISTS;case wn.PERMISSION_DENIED:return me.PERMISSION_DENIED;case wn.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case wn.ABORTED:return me.ABORTED;case wn.OUT_OF_RANGE:return me.OUT_OF_RANGE;case wn.UNIMPLEMENTED:return me.UNIMPLEMENTED;case wn.DATA_LOSS:return me.DATA_LOSS;default:return Ye(39323,{code:s})}}(pt=wn||(wn={}))[pt.OK=0]="OK",pt[pt.CANCELLED=1]="CANCELLED",pt[pt.UNKNOWN=2]="UNKNOWN",pt[pt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pt[pt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pt[pt.NOT_FOUND=5]="NOT_FOUND",pt[pt.ALREADY_EXISTS=6]="ALREADY_EXISTS",pt[pt.PERMISSION_DENIED=7]="PERMISSION_DENIED",pt[pt.UNAUTHENTICATED=16]="UNAUTHENTICATED",pt[pt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pt[pt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pt[pt.ABORTED=10]="ABORTED",pt[pt.OUT_OF_RANGE=11]="OUT_OF_RANGE",pt[pt.UNIMPLEMENTED=12]="UNIMPLEMENTED",pt[pt.INTERNAL=13]="INTERNAL",pt[pt.UNAVAILABLE=14]="UNAVAILABLE",pt[pt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wR=new Ei([4294967295,4294967295],0);function Dw(s){const e=vR().encode(s),t=new N1;return t.update(e),new Uint8Array(t.digest())}function Ow(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Ei([t,a],0),new Ei([o,u],0)]}class x0{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new ru(`Invalid padding: ${t}`);if(a<0)throw new ru(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new ru(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new ru(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ei.fromNumber(this.ge)}ye(e,t,a){let o=e.add(t.multiply(Ei.fromNumber(a)));return o.compare(wR)===1&&(o=new Ei([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Dw(e),[a,o]=Ow(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(a,o,u);if(!this.we(d))return!1}return!0}static create(e,t,a){const o=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new x0(u,o,t);return a.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Dw(e),[a,o]=Ow(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(a,o,u);this.Se(d)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class ru extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,t,a,o,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const o=new Map;return o.set(e,Ou.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new Sf(We.min(),o,new Jt(ht),Pa(),ft())}}class Ou{constructor(e,t,a,o,u){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new Ou(a,t,ft(),ft(),ft())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,t,a,o){this.be=e,this.removedTargetIds=t,this.key=a,this.De=o}}class uN{constructor(e,t){this.targetId=e,this.Ce=t}}class dN{constructor(e,t,a=zn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=o}}class Mw{constructor(){this.ve=0,this.Fe=Vw(),this.Me=zn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ft(),t=ft(),a=ft();return this.Fe.forEach(((o,u)=>{switch(u){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:a=a.add(o);break;default:Ye(38017,{changeType:u})}})),new Ou(this.Me,this.xe,e,t,a)}qe(){this.Oe=!1,this.Fe=Vw()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Et(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class _R{constructor(e){this.Ge=e,this.ze=new Map,this.je=Pa(),this.Je=yh(),this.He=yh(),this.Ye=new Jt(ht)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const a=this.nt(t);switch(e.state){case 0:this.rt(t)&&a.Le(e.resumeToken);break;case 1:a.Ke(),a.Ne||a.qe(),a.Le(e.resumeToken);break;case 2:a.Ke(),a.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(a.We(),a.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),a.Le(e.resumeToken));break;default:Ye(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((a,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,a=e.Ce.count,o=this.ot(t);if(o){const u=o.target;if(Cg(u))if(a===0){const d=new Fe(u.path);this.et(t,d,Gn.newNoDocument(d,We.min()))}else Et(a===1,20013,{expectedCount:a});else{const d=this._t(t);if(d!==a){const p=this.ut(e),x=p?this.ct(p,e,d):1;if(x!==0){this.it(t);const g=x===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,g)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:u=0}=t;let d,p;try{d=Ii(a).toUint8Array()}catch(x){if(x instanceof M1)return Oo("Decoding the base64 bloom filter in existence filter failed ("+x.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw x}try{p=new x0(d,o,u)}catch(x){return Oo(x instanceof ru?"BloomFilter error: ":"Applying bloom filter failed: ",x),null}return p.ge===0?null:p}ct(e,t,a){return t.Ce.count===a-this.Pt(e,t.targetId)?0:2}Pt(e,t){const a=this.Ge.getRemoteKeysForTarget(t);let o=0;return a.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&Cg(p.target)){const x=new Fe(p.target.path);this.It(x).has(d)||this.Et(d,x)||this.et(d,x,Gn.newNoDocument(x,e))}u.Be&&(t.set(d,u.ke()),u.qe())}}));let a=ft();this.He.forEach(((u,d)=>{let p=!0;d.forEachWhile((x=>{const g=this.ot(x);return!g||g.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(a=a.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const o=new Sf(e,t,this.Ye,this.je,a);return this.je=Pa(),this.Je=yh(),this.He=yh(),this.Ye=new Jt(ht),o}Xe(e,t){if(!this.rt(e))return;const a=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,a),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,a){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),a&&(this.je=this.je.insert(t,a))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Mw,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Sn(ht),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Sn(ht),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Mw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function yh(){return new Jt(Fe.comparator)}function Vw(){return new Jt(Fe.comparator)}const NR={asc:"ASCENDING",desc:"DESCENDING"},TR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jR={and:"AND",or:"OR"};class ER{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function kg(s,e){return s.useProto3Json||bf(e)?e:{value:e}}function Kh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hN(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function SR(s,e){return Kh(s,e.toTimestamp())}function Kr(s){return Et(!!s,49232),We.fromTimestamp((function(t){const a=ki(t);return new qt(a.seconds,a.nanos)})(s))}function y0(s,e){return Ig(s,e).canonicalString()}function Ig(s,e){const t=(function(o){return new Ut(["projects",o.projectId,"databases",o.database])})(s).child("documents");return e===void 0?t:t.child(e)}function fN(s){const e=Ut.fromString(s);return Et(yN(e),10190,{key:e.toString()}),e}function Dg(s,e){return y0(s.databaseId,e.path)}function Zp(s,e){const t=fN(e);if(t.get(1)!==s.databaseId.projectId)throw new De(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new De(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new Fe(pN(t))}function mN(s,e){return y0(s.databaseId,e)}function CR(s){const e=fN(s);return e.length===4?Ut.emptyPath():pN(e)}function Og(s){return new Ut(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function pN(s){return Et(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Pw(s,e,t){return{name:Dg(s,e),fields:t.value.mapValue.fields}}function AR(s,e){let t;if("targetChange"in e){e.targetChange;const a=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Ye(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],u=(function(g,b){return g.useProto3Json?(Et(b===void 0||typeof b=="string",58123),zn.fromBase64String(b||"")):(Et(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),zn.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(g){const b=g.code===void 0?me.UNKNOWN:cN(g.code);return new De(b,g.message||"")})(d);t=new dN(a,o,u,p||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=Zp(s,a.document.name),u=Kr(a.document.updateTime),d=a.document.createTime?Kr(a.document.createTime):We.min(),p=new xs({mapValue:{fields:a.document.fields}}),x=Gn.newFoundDocument(o,u,d,p),g=a.targetIds||[],b=a.removedTargetIds||[];t=new Ah(g,b,x.key,x)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=Zp(s,a.document),u=a.readTime?Kr(a.readTime):We.min(),d=Gn.newNoDocument(o,u),p=a.removedTargetIds||[];t=new Ah([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=Zp(s,a.document),u=a.removedTargetIds||[];t=new Ah([],u,o,null)}else{if(!("filter"in e))return Ye(11601,{Rt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:u}=a,d=new yR(o,u),p=a.targetId;t=new uN(p,d)}}return t}function RR(s,e){let t;if(e instanceof Du)t={update:Pw(s,e.key,e.value)};else if(e instanceof Ef)t={delete:Dg(s,e.key)};else if(e instanceof Li)t={update:Pw(s,e.key,e.data),updateMask:UR(e.fieldMask)};else{if(!(e instanceof pR))return Ye(16599,{Vt:e.type});t={verify:Dg(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((a=>(function(u,d){const p=d.transform;if(p instanceof _u)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Lo)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Nu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof $h)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Ye(20930,{transform:d.transform})})(0,a)))),e.precondition.isNone||(t.currentDocument=(function(o,u){return u.updateTime!==void 0?{updateTime:SR(o,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Ye(27497)})(s,e.precondition)),t}function kR(s,e){return s&&s.length>0?(Et(e!==void 0,14353),s.map((t=>(function(o,u){let d=o.updateTime?Kr(o.updateTime):Kr(u);return d.isEqual(We.min())&&(d=Kr(u)),new hR(d,o.transformResults||[])})(t,e)))):[]}function IR(s,e){return{documents:[mN(s,e.path)]}}function DR(s,e){const t={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=mN(s,o);const u=(function(g){if(g.length!==0)return xN(_r.create(g,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(g){if(g.length!==0)return g.map((b=>(function(N){return{field:vo(N.field),direction:VR(N.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=kg(s,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:o}}function OR(s){let e=CR(s.parent);const t=s.structuredQuery,a=t.from?t.from.length:0;let o=null;if(a>0){Et(a===1,65062);const b=t.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(w){const N=gN(w);return N instanceof _r&&$1(N)?N.getFilters():[N]})(t.where));let d=[];t.orderBy&&(d=(function(w){return w.map((N=>(function(D){return new wu(wo(D.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(D.direction))})(N)))})(t.orderBy));let p=null;t.limit&&(p=(function(w){let N;return N=typeof w=="object"?w.value:w,bf(N)?null:N})(t.limit));let x=null;t.startAt&&(x=(function(w){const N=!!w.before,R=w.values||[];return new qh(R,N)})(t.startAt));let g=null;return t.endAt&&(g=(function(w){const N=!w.before,R=w.values||[];return new qh(R,N)})(t.endAt)),Z4(e,o,d,u,p,"F",x,g)}function MR(s,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ye(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function gN(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=wo(t.unaryFilter.field);return _n.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=wo(t.unaryFilter.field);return _n.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=wo(t.unaryFilter.field);return _n.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=wo(t.unaryFilter.field);return _n.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ye(61313);default:return Ye(60726)}})(s):s.fieldFilter!==void 0?(function(t){return _n.create(wo(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ye(58110);default:return Ye(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return _r.create(t.compositeFilter.filters.map((a=>gN(a))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ye(1026)}})(t.compositeFilter.op))})(s):Ye(30097,{filter:s})}function VR(s){return NR[s]}function PR(s){return TR[s]}function LR(s){return jR[s]}function vo(s){return{fieldPath:s.canonicalString()}}function wo(s){return Un.fromServerFormat(s.fieldPath)}function xN(s){return s instanceof _n?(function(t){if(t.op==="=="){if(Tw(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NAN"}};if(Nw(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Tw(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NOT_NAN"}};if(Nw(t.value))return{unaryFilter:{field:vo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vo(t.field),op:PR(t.op),value:t.value}}})(s):s instanceof _r?(function(t){const a=t.getFilters().map((o=>xN(o)));return a.length===1?a[0]:{compositeFilter:{op:LR(t.op),filters:a}}})(s):Ye(54877,{filter:s})}function UR(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function yN(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,t,a,o,u=We.min(),d=We.min(),p=zn.EMPTY_BYTE_STRING,x=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=x}withSequenceNumber(e){return new _i(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _i(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e){this.yt=e}}function BR(s){const e=OR({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Rg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{constructor(){this.Cn=new FR}addToCollectionParentIndex(e,t){return this.Cn.add(t),xe.resolve()}getCollectionParents(e,t){return xe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return xe.resolve()}deleteFieldIndex(e,t){return xe.resolve()}deleteAllFieldIndexes(e){return xe.resolve()}createTargetIndexes(e,t){return xe.resolve()}getDocumentsMatchingTarget(e,t){return xe.resolve(null)}getIndexType(e,t){return xe.resolve(0)}getFieldIndexes(e,t){return xe.resolve([])}getNextCollectionGroupToUpdate(e){return xe.resolve(null)}getMinOffset(e,t){return xe.resolve(Ri.min())}getMinOffsetFromCollectionGroup(e,t){return xe.resolve(Ri.min())}updateCollectionGroup(e,t,a){return xe.resolve()}updateIndexEntries(e,t){return xe.resolve()}}class FR{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t]||new Sn(Ut.comparator),u=!o.has(a);return this.index[t]=o.add(a),u}has(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t];return o&&o.has(a)}getEntries(e){return(this.index[e]||new Sn(Ut.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},bN=41943040;class ms{static withCacheSize(e){return new ms(e,ms.DEFAULT_COLLECTION_PERCENTILE,ms.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ms.DEFAULT_COLLECTION_PERCENTILE=10,ms.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ms.DEFAULT=new ms(bN,ms.DEFAULT_COLLECTION_PERCENTILE,ms.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ms.DISABLED=new ms(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Uo(0)}static cr(){return new Uo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw="LruGarbageCollector",qR=1048576;function zw([s,e],[t,a]){const o=ht(s,t);return o===0?ht(e,a):o}class $R{constructor(e){this.Ir=e,this.buffer=new Sn(zw),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();zw(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class KR{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Oe(Uw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Yo(t)?Oe(Uw,"Ignoring IndexedDB error during garbage collection: ",t):await Go(t)}await this.Vr(3e5)}))}}class GR{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((a=>Math.floor(t/100*a)))}nthSequenceNumber(e,t){if(t===0)return xe.resolve(yf.ce);const a=new $R(t);return this.mr.forEachTarget(e,(o=>a.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>a.Ar(o))))).next((()=>a.maxValue))}removeTargets(e,t,a){return this.mr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Oe("LruGarbageCollector","Garbage collection skipped; disabled"),xe.resolve(Lw)):this.getCacheSize(e).next((a=>a<this.params.cacheSizeCollectionThreshold?(Oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Lw):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let a,o,u,d,p,x,g;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(Oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),o=this.params.maximumSequenceNumbersToCollect):o=w,d=Date.now(),this.nthSequenceNumber(e,o)))).next((w=>(a=w,p=Date.now(),this.removeTargets(e,a,t)))).next((w=>(u=w,x=Date.now(),this.removeOrphanedDocuments(e,a)))).next((w=>(g=Date.now(),yo()<=dt.DEBUG&&Oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${o} in `+(p-d)+`ms
	Removed ${u} targets in `+(x-p)+`ms
	Removed ${w} documents in `+(g-x)+`ms
Total Duration: ${g-b}ms`),xe.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:u,documentsRemoved:w}))))}}function YR(s,e){return new GR(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(){this.changes=new El((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Gn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?xe.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,t,a,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(a=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(a!==null&&hu(a.mutation,o,Vs.empty(),qt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((a=>this.getLocalViewOfDocuments(e,a,ft()).next((()=>a))))}getLocalViewOfDocuments(e,t,a=ft()){const o=ml();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,a).next((u=>{let d=su();return u.forEach(((p,x)=>{d=d.insert(p,x.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const a=ml();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,ft())))}populateOverlays(e,t,a){const o=[];return a.forEach((u=>{t.has(u)||o.push(u)})),this.documentOverlayCache.getOverlays(e,o).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,a,o){let u=Pa();const d=du(),p=(function(){return du()})();return t.forEach(((x,g)=>{const b=a.get(g.key);o.has(g.key)&&(b===void 0||b.mutation instanceof Li)?u=u.insert(g.key,g):b!==void 0?(d.set(g.key,b.mutation.getFieldMask()),hu(b.mutation,g,b.mutation.getFieldMask(),qt.now())):d.set(g.key,Vs.empty())})),this.recalculateAndSaveOverlays(e,u).next((x=>(x.forEach(((g,b)=>d.set(g,b))),t.forEach(((g,b)=>p.set(g,new XR(b,d.get(g)??null)))),p)))}recalculateAndSaveOverlays(e,t){const a=du();let o=new Jt(((d,p)=>d-p)),u=ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((x=>{const g=t.get(x);if(g===null)return;let b=a.get(x)||Vs.empty();b=p.applyToLocalView(g,b),a.set(x,b);const w=(o.get(p.batchId)||ft()).add(x);o=o.insert(p.batchId,w)}))})).next((()=>{const d=[],p=o.getReverseIterator();for(;p.hasNext();){const x=p.getNext(),g=x.key,b=x.value,w=eN();b.forEach((N=>{if(!u.has(N)){const R=lN(t.get(N),a.get(N));R!==null&&w.set(N,R),u=u.add(N)}})),d.push(this.documentOverlayCache.saveOverlays(e,g,w))}return xe.waitFor(d)})).next((()=>a))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((a=>this.recalculateAndSaveOverlays(e,a)))}getDocumentsMatchingQuery(e,t,a,o){return(function(d){return Fe.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Q1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,o):this.getDocumentsMatchingCollectionQuery(e,t,a,o)}getNextDocuments(e,t,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,o).next((u=>{const d=o-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,o-u.size):xe.resolve(ml());let p=xu,x=u;return d.next((g=>xe.forEach(g,((b,w)=>(p<w.largestBatchId&&(p=w.largestBatchId),u.get(b)?xe.resolve():this.remoteDocumentCache.getEntry(e,b).next((N=>{x=x.insert(b,N)}))))).next((()=>this.populateOverlays(e,g,u))).next((()=>this.computeViews(e,x,g,ft()))).next((b=>({batchId:p,changes:Z1(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Fe(t)).next((a=>{let o=su();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,a,o){const u=t.collectionGroup;let d=su();return this.indexManager.getCollectionParents(e,u).next((p=>xe.forEach(p,(x=>{const g=(function(w,N){return new Qo(N,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,x.child(u));return this.getDocumentsMatchingCollectionQuery(e,g,a,o).next((b=>{b.forEach(((w,N)=>{d=d.insert(w,N)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,a,o){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,u,o)))).next((d=>{u.forEach(((x,g)=>{const b=g.getKey();d.get(b)===null&&(d=d.insert(b,Gn.newInvalidDocument(b)))}));let p=su();return d.forEach(((x,g)=>{const b=u.get(x);b!==void 0&&hu(b.mutation,g,Vs.empty(),qt.now()),Nf(t,g)&&(p=p.insert(x,g))})),p}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return xe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Kr(o.createTime)}})(t)),xe.resolve()}getNamedQuery(e,t){return xe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:BR(o.bundledQuery),readTime:Kr(o.readTime)}})(t)),xe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(){this.overlays=new Jt(Fe.comparator),this.qr=new Map}getOverlay(e,t){return xe.resolve(this.overlays.get(t))}getOverlays(e,t){const a=ml();return xe.forEach(t,(o=>this.getOverlay(e,o).next((u=>{u!==null&&a.set(o,u)})))).next((()=>a))}saveOverlays(e,t,a){return a.forEach(((o,u)=>{this.St(e,t,u)})),xe.resolve()}removeOverlaysForBatchId(e,t,a){const o=this.qr.get(a);return o!==void 0&&(o.forEach((u=>this.overlays=this.overlays.remove(u))),this.qr.delete(a)),xe.resolve()}getOverlaysForCollection(e,t,a){const o=ml(),u=t.length+1,d=new Fe(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const x=p.getNext().value,g=x.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===u&&x.largestBatchId>a&&o.set(x.getKey(),x)}return xe.resolve(o)}getOverlaysForCollectionGroup(e,t,a,o){let u=new Jt(((g,b)=>g-b));const d=this.overlays.getIterator();for(;d.hasNext();){const g=d.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>a){let b=u.get(g.largestBatchId);b===null&&(b=ml(),u=u.insert(g.largestBatchId,b)),b.set(g.getKey(),g)}}const p=ml(),x=u.getIterator();for(;x.hasNext()&&(x.getNext().value.forEach(((g,b)=>p.set(g,b))),!(p.size()>=o)););return xe.resolve(p)}St(e,t,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.qr.get(o.largestBatchId).delete(a.key);this.qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new xR(t,a));let u=this.qr.get(t);u===void 0&&(u=ft(),this.qr.set(t,u)),this.qr.set(t,u.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(){this.sessionToken=zn.EMPTY_BYTE_STRING}getSessionToken(e){return xe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,xe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(){this.Qr=new Sn(kn.$r),this.Ur=new Sn(kn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const a=new kn(e,t);this.Qr=this.Qr.add(a),this.Ur=this.Ur.add(a)}Wr(e,t){e.forEach((a=>this.addReference(a,t)))}removeReference(e,t){this.Gr(new kn(e,t))}zr(e,t){e.forEach((a=>this.removeReference(a,t)))}jr(e){const t=new Fe(new Ut([])),a=new kn(t,e),o=new kn(t,e+1),u=[];return this.Ur.forEachInRange([a,o],(d=>{this.Gr(d),u.push(d.key)})),u}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Fe(new Ut([])),a=new kn(t,e),o=new kn(t,e+1);let u=ft();return this.Ur.forEachInRange([a,o],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new kn(e,0),a=this.Qr.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class kn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Fe.comparator(e.key,t.key)||ht(e.Yr,t.Yr)}static Kr(e,t){return ht(e.Yr,t.Yr)||Fe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Sn(kn.$r)}checkEmpty(e){return xe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,o){const u=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new gR(u,t,a,o);this.mutationQueue.push(d);for(const p of o)this.Zr=this.Zr.add(new kn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return xe.resolve(d)}lookupMutationBatch(e,t){return xe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,o=this.ei(a),u=o<0?0:o;return xe.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return xe.resolve(this.mutationQueue.length===0?u0:this.tr-1)}getAllMutationBatches(e){return xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new kn(t,0),o=new kn(t,Number.POSITIVE_INFINITY),u=[];return this.Zr.forEachInRange([a,o],(d=>{const p=this.Xr(d.Yr);u.push(p)})),xe.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new Sn(ht);return t.forEach((o=>{const u=new kn(o,0),d=new kn(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([u,d],(p=>{a=a.add(p.Yr)}))})),xe.resolve(this.ti(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,o=a.length+1;let u=a;Fe.isDocumentKey(u)||(u=u.child(""));const d=new kn(new Fe(u),0);let p=new Sn(ht);return this.Zr.forEachWhile((x=>{const g=x.key.path;return!!a.isPrefixOf(g)&&(g.length===o&&(p=p.add(x.Yr)),!0)}),d),xe.resolve(this.ti(p))}ti(e){const t=[];return e.forEach((a=>{const o=this.Xr(a);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){Et(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Zr;return xe.forEach(t.mutations,(o=>{const u=new kn(o.key,t.batchId);return a=a.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=a}))}ir(e){}containsKey(e,t){const a=new kn(t,0),o=this.Zr.firstAfterOrEqual(a);return xe.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,xe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e){this.ri=e,this.docs=(function(){return new Jt(Fe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,o=this.docs.get(a),u=o?o.size:0,d=this.ri(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return xe.resolve(a?a.document.mutableCopy():Gn.newInvalidDocument(t))}getEntries(e,t){let a=Pa();return t.forEach((o=>{const u=this.docs.get(o);a=a.insert(o,u?u.document.mutableCopy():Gn.newInvalidDocument(o))})),xe.resolve(a)}getDocumentsMatchingQuery(e,t,a,o){let u=Pa();const d=t.path,p=new Fe(d.child("__id-9223372036854775808__")),x=this.docs.getIteratorFrom(p);for(;x.hasNext();){const{key:g,value:{document:b}}=x.getNext();if(!d.isPrefixOf(g.path))break;g.path.length>d.length+1||k4(R4(b),a)<=0||(o.has(b.key)||Nf(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return xe.resolve(u)}getAllFromCollectionGroup(e,t,a,o){Ye(9500)}ii(e,t){return xe.forEach(this.docs,(a=>t(a)))}newChangeBuffer(e){return new sk(this)}getSize(e){return xe.resolve(this.size)}}class sk extends QR{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((a,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(a)})),xe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.persistence=e,this.si=new El((t=>f0(t)),m0),this.lastRemoteSnapshotVersion=We.min(),this.highestTargetId=0,this.oi=0,this._i=new b0,this.targetCount=0,this.ai=Uo.ur()}forEachTarget(e,t){return this.si.forEach(((a,o)=>t(o))),xe.resolve()}getLastRemoteSnapshotVersion(e){return xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return xe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),xe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this.oi&&(this.oi=t),xe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Uo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,xe.resolve()}updateTargetData(e,t){return this.Pr(t),xe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,xe.resolve()}removeTargets(e,t,a){let o=0;const u=[];return this.si.forEach(((d,p)=>{p.sequenceNumber<=t&&a.get(p.targetId)===null&&(this.si.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),o++)})),xe.waitFor(u).next((()=>o))}getTargetCount(e){return xe.resolve(this.targetCount)}getTargetData(e,t){const a=this.si.get(t)||null;return xe.resolve(a)}addMatchingKeys(e,t,a){return this._i.Wr(t,a),xe.resolve()}removeMatchingKeys(e,t,a){this._i.zr(t,a);const o=this.persistence.referenceDelegate,u=[];return o&&t.forEach((d=>{u.push(o.markPotentiallyOrphaned(e,d))})),xe.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),xe.resolve()}getMatchingKeysForTargetId(e,t){const a=this._i.Hr(t);return xe.resolve(a)}containsKey(e,t){return xe.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(e,t){this.ui={},this.overlays={},this.ci=new yf(0),this.li=!1,this.li=!0,this.hi=new ek,this.referenceDelegate=e(this),this.Pi=new rk(this),this.indexManager=new HR,this.remoteDocumentCache=(function(o){return new nk(o)})((a=>this.referenceDelegate.Ti(a))),this.serializer=new zR(t),this.Ii=new JR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ZR,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ui[e.toKey()];return a||(a=new tk(t,this.referenceDelegate),this.ui[e.toKey()]=a),a}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,a){Oe("MemoryPersistence","Starting transaction:",e);const o=new ak(this.ci.next());return this.referenceDelegate.Ei(),a(o).next((u=>this.referenceDelegate.di(o).next((()=>u)))).toPromise().then((u=>(o.raiseOnCommittedEvent(),u)))}Ai(e,t){return xe.or(Object.values(this.ui).map((a=>()=>a.containsKey(e,t))))}}class ak extends D4{constructor(e){super(),this.currentSequenceNumber=e}}class v0{constructor(e){this.persistence=e,this.Ri=new b0,this.Vi=null}static mi(e){return new v0(e)}get fi(){if(this.Vi)return this.Vi;throw Ye(60996)}addReference(e,t,a){return this.Ri.addReference(a,t),this.fi.delete(a.toString()),xe.resolve()}removeReference(e,t,a){return this.Ri.removeReference(a,t),this.fi.add(a.toString()),xe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),xe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((u=>this.fi.add(u.toString())))})).next((()=>a.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xe.forEach(this.fi,(a=>{const o=Fe.fromPath(a);return this.gi(e,o).next((u=>{u||t.removeEntry(o,We.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((a=>{a?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return xe.or([()=>xe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Gh{constructor(e,t){this.persistence=e,this.pi=new El((a=>V4(a.path)),((a,o)=>a.isEqual(o))),this.garbageCollector=YR(this,t)}static mi(e,t){return new Gh(e,t)}Ei(){}di(e){return xe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((a=>t.next((o=>a+o))))}wr(e){let t=0;return this.pr(e,(a=>{t++})).next((()=>t))}pr(e,t){return xe.forEach(this.pi,((a,o)=>this.br(e,a,o).next((u=>u?xe.resolve():t(o)))))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const o=this.persistence.getRemoteDocumentCache(),u=o.newChangeBuffer();return o.ii(e,(d=>this.br(e,d,t).next((p=>{p||(a++,u.removeEntry(d,We.min()))})))).next((()=>u.apply(e))).next((()=>a))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),xe.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.pi.set(a,e.currentSequenceNumber),xe.resolve()}removeReference(e,t,a){return this.pi.set(a,e.currentSequenceNumber),xe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),xe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Eh(e.data.value)),t}br(e,t,a){return xe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return xe.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,t,a,o){this.targetId=e,this.fromCache=t,this.Es=a,this.ds=o}static As(e,t){let a=ft(),o=ft();for(const u of t.docChanges)switch(u.type){case 0:a=a.add(u.doc.key);break;case 1:o=o.add(u.doc.key)}return new w0(e,t.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return JA()?8:O4(Xn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,a,o){const u={result:null};return this.ys(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ws(e,t,o,a).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new ik;return this.Ss(e,t,d).next((p=>{if(u.result=p,this.Vs)return this.bs(e,t,d,p.size)}))})).next((()=>u.result))}bs(e,t,a,o){return a.documentReadCount<this.fs?(yo()<=dt.DEBUG&&Oe("QueryEngine","SDK will not create cache indexes for query:",bo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),xe.resolve()):(yo()<=dt.DEBUG&&Oe("QueryEngine","Query:",bo(t),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.gs*o?(yo()<=dt.DEBUG&&Oe("QueryEngine","The SDK decides to create cache indexes for query:",bo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$r(t))):xe.resolve())}ys(e,t){if(Cw(t))return xe.resolve(null);let a=$r(t);return this.indexManager.getIndexType(e,a).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=Rg(t,null,"F"),a=$r(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next((u=>{const d=ft(...u);return this.ps.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,a).next((x=>{const g=this.Ds(t,p);return this.Cs(t,g,d,x.readTime)?this.ys(e,Rg(t,null,"F")):this.vs(e,g,t,x)}))))})))))}ws(e,t,a,o){return Cw(t)||o.isEqual(We.min())?xe.resolve(null):this.ps.getDocuments(e,a).next((u=>{const d=this.Ds(t,u);return this.Cs(t,d,a,o)?xe.resolve(null):(yo()<=dt.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),bo(t)),this.vs(e,d,t,A4(o,xu)).next((p=>p)))}))}Ds(e,t){let a=new Sn(W1(e));return t.forEach(((o,u)=>{Nf(e,u)&&(a=a.add(u))})),a}Cs(e,t,a,o){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(o)>0)}Ss(e,t,a){return yo()<=dt.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",bo(t)),this.ps.getDocumentsMatchingQuery(e,t,Ri.min(),a)}vs(e,t,a,o){return this.ps.getDocumentsMatchingQuery(e,a,o).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0="LocalStore",ok=3e8;class ck{constructor(e,t,a,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new Jt(ht),this.xs=new El((u=>f0(u)),m0),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(a)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new WR(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function uk(s,e,t,a){return new ck(s,e,t,a)}async function wN(s,e){const t=et(s);return await t.persistence.runTransaction("Handle user change","readonly",(a=>{let o;return t.mutationQueue.getAllMutationBatches(a).next((u=>(o=u,t.Bs(e),t.mutationQueue.getAllMutationBatches(a)))).next((u=>{const d=[],p=[];let x=ft();for(const g of o){d.push(g.batchId);for(const b of g.mutations)x=x.add(b.key)}for(const g of u){p.push(g.batchId);for(const b of g.mutations)x=x.add(b.key)}return t.localDocuments.getDocuments(a,x).next((g=>({Ls:g,removedBatchIds:d,addedBatchIds:p})))}))}))}function dk(s,e){const t=et(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(a=>{const o=e.batch.keys(),u=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(p,x,g,b){const w=g.batch,N=w.keys();let R=xe.resolve();return N.forEach((D=>{R=R.next((()=>b.getEntry(x,D))).next((q=>{const L=g.docVersions.get(D);Et(L!==null,48541),q.version.compareTo(L)<0&&(w.applyToRemoteDocument(q,g),q.isValidDocument()&&(q.setReadTime(g.commitVersion),b.addEntry(q)))}))})),R.next((()=>p.mutationQueue.removeMutationBatch(x,w)))})(t,a,e,u).next((()=>u.apply(a))).next((()=>t.mutationQueue.performConsistencyCheck(a))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(a,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,(function(p){let x=ft();for(let g=0;g<p.mutationResults.length;++g)p.mutationResults[g].transformResults.length>0&&(x=x.add(p.batch.mutations[g].key));return x})(e)))).next((()=>t.localDocuments.getDocuments(a,o)))}))}function _N(s){const e=et(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function hk(s,e){const t=et(s),a=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const p=[];e.targetChanges.forEach(((b,w)=>{const N=o.get(w);if(!N)return;p.push(t.Pi.removeMatchingKeys(u,b.removedDocuments,w).next((()=>t.Pi.addMatchingKeys(u,b.addedDocuments,w))));let R=N.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(w)!==null?R=R.withResumeToken(zn.EMPTY_BYTE_STRING,We.min()).withLastLimboFreeSnapshotVersion(We.min()):b.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(b.resumeToken,a)),o=o.insert(w,R),(function(q,L,W){return q.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-q.snapshotVersion.toMicroseconds()>=ok?!0:W.addedDocuments.size+W.modifiedDocuments.size+W.removedDocuments.size>0})(N,R,b)&&p.push(t.Pi.updateTargetData(u,R))}));let x=Pa(),g=ft();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),p.push(fk(u,d,e.documentUpdates).next((b=>{x=b.ks,g=b.qs}))),!a.isEqual(We.min())){const b=t.Pi.getLastRemoteSnapshotVersion(u).next((w=>t.Pi.setTargetsMetadata(u,u.currentSequenceNumber,a)));p.push(b)}return xe.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,x,g))).next((()=>x))})).then((u=>(t.Ms=o,u)))}function fk(s,e,t){let a=ft(),o=ft();return t.forEach((u=>a=a.add(u))),e.getEntries(s,a).next((u=>{let d=Pa();return t.forEach(((p,x)=>{const g=u.get(p);x.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(p)),x.isNoDocument()&&x.version.isEqual(We.min())?(e.removeEntry(p,x.readTime),d=d.insert(p,x)):!g.isValidDocument()||x.version.compareTo(g.version)>0||x.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(x),d=d.insert(p,x)):Oe(_0,"Ignoring outdated watch update for ",p,". Current version:",g.version," Watch version:",x.version)})),{ks:d,qs:o}}))}function mk(s,e){const t=et(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(a=>(e===void 0&&(e=u0),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e))))}function pk(s,e){const t=et(s);return t.persistence.runTransaction("Allocate target","readwrite",(a=>{let o;return t.Pi.getTargetData(a,e).next((u=>u?(o=u,xe.resolve(o)):t.Pi.allocateTargetId(a).next((d=>(o=new _i(e,d,"TargetPurposeListen",a.currentSequenceNumber),t.Pi.addTargetData(a,o).next((()=>o)))))))})).then((a=>{const o=t.Ms.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(a.targetId,a),t.xs.set(e,a.targetId)),a}))}async function Mg(s,e,t){const a=et(s),o=a.Ms.get(e),u=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",u,(d=>a.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!Yo(d))throw d;Oe(_0,`Failed to update sequence numbers for target ${e}: ${d}`)}a.Ms=a.Ms.remove(e),a.xs.delete(o.target)}function Bw(s,e,t){const a=et(s);let o=We.min(),u=ft();return a.persistence.runTransaction("Execute query","readwrite",(d=>(function(x,g,b){const w=et(x),N=w.xs.get(b);return N!==void 0?xe.resolve(w.Ms.get(N)):w.Pi.getTargetData(g,b)})(a,d,$r(e)).next((p=>{if(p)return o=p.lastLimboFreeSnapshotVersion,a.Pi.getMatchingKeysForTargetId(d,p.targetId).next((x=>{u=x}))})).next((()=>a.Fs.getDocumentsMatchingQuery(d,e,t?o:We.min(),t?u:ft()))).next((p=>(gk(a,tR(e),p),{documents:p,Qs:u})))))}function gk(s,e,t){let a=s.Os.get(e)||We.min();t.forEach(((o,u)=>{u.readTime.compareTo(a)>0&&(a=u.readTime)})),s.Os.set(e,a)}class Hw{constructor(){this.activeTargetIds=lR()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xk{constructor(){this.Mo=new Hw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,a){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Hw,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="ConnectivityMonitor";class qw{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Oe(Fw,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Oe(Fw,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bh=null;function Vg(){return bh===null?bh=(function(){return 268435456+Math.round(2147483648*Math.random())})():bh++,"0x"+bh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eg="RestConnection",bk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class vk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${a}/databases/${o}`,this.Wo=this.databaseId.database===Hh?`project_id=${a}`:`project_id=${a}&database_id=${o}`}Go(e,t,a,o,u){const d=Vg(),p=this.zo(e,t.toUriEncodedString());Oe(eg,`Sending RPC '${e}' ${d}:`,p,a);const x={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(x,o,u);const{host:g}=new URL(p),b=ta(g);return this.Jo(e,p,x,a,b).then((w=>(Oe(eg,`Received RPC '${e}' ${d}: `,w),w)),(w=>{throw Oo(eg,`RPC '${e}' ${d} failed with error: `,w,"url: ",p,"request:",a),w}))}Ho(e,t,a,o,u,d){return this.Go(e,t,a,o,u)}jo(e,t,a){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ko})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,u)=>e[u]=o)),a&&a.headers.forEach(((o,u)=>e[u]=o))}zo(e,t){const a=bk[e];return`${this.Uo}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n="WebChannelConnection";class _k extends vk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,o,u){const d=Vg();return new Promise(((p,x)=>{const g=new T1;g.setWithCredentials(!0),g.listenOnce(j1.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case jh.NO_ERROR:const w=g.getResponseJson();Oe($n,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(w)),p(w);break;case jh.TIMEOUT:Oe($n,`RPC '${e}' ${d} timed out`),x(new De(me.DEADLINE_EXCEEDED,"Request time out"));break;case jh.HTTP_ERROR:const N=g.getStatus();if(Oe($n,`RPC '${e}' ${d} failed with status:`,N,"response text:",g.getResponseText()),N>0){let R=g.getResponseJson();Array.isArray(R)&&(R=R[0]);const D=R==null?void 0:R.error;if(D&&D.status&&D.message){const q=(function(W){const re=W.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(re)>=0?re:me.UNKNOWN})(D.status);x(new De(q,D.message))}else x(new De(me.UNKNOWN,"Server responded with status "+g.getStatus()))}else x(new De(me.UNAVAILABLE,"Connection failed."));break;default:Ye(9055,{l_:e,streamId:d,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Oe($n,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(o);Oe($n,`RPC '${e}' ${d} sending request:`,o),g.send(t,"POST",b,a,15)}))}T_(e,t,a){const o=Vg(),u=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=C1(),p=S1(),x={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(x.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(x.useFetchStreams=!0),this.jo(x.initMessageHeaders,t,a),x.encodeInitMessageHeaders=!0;const b=u.join("");Oe($n,`Creating RPC '${e}' stream ${o}: ${b}`,x);const w=d.createWebChannel(b,x);this.I_(w);let N=!1,R=!1;const D=new wk({Yo:L=>{R?Oe($n,`Not sending because RPC '${e}' stream ${o} is closed:`,L):(N||(Oe($n,`Opening RPC '${e}' stream ${o} transport.`),w.open(),N=!0),Oe($n,`RPC '${e}' stream ${o} sending:`,L),w.send(L))},Zo:()=>w.close()}),q=(L,W,re)=>{L.listen(W,($=>{try{re($)}catch(z){setTimeout((()=>{throw z}),0)}}))};return q(w,nu.EventType.OPEN,(()=>{R||(Oe($n,`RPC '${e}' stream ${o} transport opened.`),D.o_())})),q(w,nu.EventType.CLOSE,(()=>{R||(R=!0,Oe($n,`RPC '${e}' stream ${o} transport closed`),D.a_(),this.E_(w))})),q(w,nu.EventType.ERROR,(L=>{R||(R=!0,Oo($n,`RPC '${e}' stream ${o} transport errored. Name:`,L.name,"Message:",L.message),D.a_(new De(me.UNAVAILABLE,"The operation could not be completed")))})),q(w,nu.EventType.MESSAGE,(L=>{var W;if(!R){const re=L.data[0];Et(!!re,16349);const $=re,z=($==null?void 0:$.error)||((W=$[0])==null?void 0:W.error);if(z){Oe($n,`RPC '${e}' stream ${o} received error:`,z);const he=z.status;let _e=(function(k){const M=wn[k];if(M!==void 0)return cN(M)})(he),S=z.message;_e===void 0&&(_e=me.INTERNAL,S="Unknown error status: "+he+" with message "+z.message),R=!0,D.a_(new De(_e,S)),w.close()}else Oe($n,`RPC '${e}' stream ${o} received:`,re),D.u_(re)}})),q(p,E1.STAT_EVENT,(L=>{L.stat===Ng.PROXY?Oe($n,`RPC '${e}' stream ${o} detected buffering proxy`):L.stat===Ng.NOPROXY&&Oe($n,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{D.__()}),0),D}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function tg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(s){return new ER(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e,t,a=1e3,o=1.5,u=6e4){this.Mi=e,this.timerId=t,this.d_=a,this.A_=o,this.R_=u,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),a=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-a);o>0&&Oe("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="PersistentStream";class TN{constructor(e,t,a,o,u,d,p,x){this.Mi=e,this.S_=a,this.b_=o,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=x,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new NN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===me.RESOURCE_EXHAUSTED?(Va(t.toString()),Va("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([a,o])=>{this.D_===t&&this.G_(a,o)}),(a=>{e((()=>{const o=new De(me.UNKNOWN,"Fetching auth token failed: "+a.message);return this.z_(o)}))}))}G_(e,t){const a=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{a((()=>this.listener.Xo()))})),this.stream.t_((()=>{a((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{a((()=>this.z_(o)))})),this.stream.onMessage((o=>{a((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Oe($w,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Oe($w,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Nk extends TN{constructor(e,t,a,o,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,o,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=AR(this.serializer,e),a=(function(u){if(!("targetChange"in u))return We.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?We.min():d.readTime?Kr(d.readTime):We.min()})(e);return this.listener.H_(t,a)}Y_(e){const t={};t.database=Og(this.serializer),t.addTarget=(function(u,d){let p;const x=d.target;if(p=Cg(x)?{documents:IR(u,x)}:{query:DR(u,x).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=hN(u,d.resumeToken);const g=kg(u,d.expectedCount);g!==null&&(p.expectedCount=g)}else if(d.snapshotVersion.compareTo(We.min())>0){p.readTime=Kh(u,d.snapshotVersion.toTimestamp());const g=kg(u,d.expectedCount);g!==null&&(p.expectedCount=g)}return p})(this.serializer,e);const a=MR(this.serializer,e);a&&(t.labels=a),this.q_(t)}Z_(e){const t={};t.database=Og(this.serializer),t.removeTarget=e,this.q_(t)}}class Tk extends TN{constructor(e,t,a,o,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,o,d),this.serializer=u}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=kR(e.writeResults,e.commitTime),a=Kr(e.commitTime);return this.listener.na(a,t)}ra(){const e={};e.database=Og(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((a=>RR(this.serializer,a)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{}class Ek extends jk{constructor(e,t,a,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new De(me.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,a,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Go(e,Ig(t,a),o,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new De(me.UNKNOWN,u.toString())}))}Ho(e,t,a,o,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.Ho(e,Ig(t,a),o,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new De(me.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Sk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Va(t),this.aa=!1):Oe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl="RemoteStore";class Ck{constructor(e,t,a,o,u){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=u,this.Aa.Oo((d=>{a.enqueueAndForget((async()=>{Sl(this)&&(Oe(vl,"Restarting streams for network reachability change."),await(async function(x){const g=et(x);g.Ea.add(4),await Mu(g),g.Ra.set("Unknown"),g.Ea.delete(4),await Af(g)})(this))}))})),this.Ra=new Sk(a,o)}}async function Af(s){if(Sl(s))for(const e of s.da)await e(!0)}async function Mu(s){for(const e of s.da)await e(!1)}function jN(s,e){const t=et(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),E0(t)?j0(t):Xo(t).O_()&&T0(t,e))}function N0(s,e){const t=et(s),a=Xo(t);t.Ia.delete(e),a.O_()&&EN(t,e),t.Ia.size===0&&(a.O_()?a.L_():Sl(t)&&t.Ra.set("Unknown"))}function T0(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(We.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Xo(s).Y_(e)}function EN(s,e){s.Va.Ue(e),Xo(s).Z_(e)}function j0(s){s.Va=new _R({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Xo(s).start(),s.Ra.ua()}function E0(s){return Sl(s)&&!Xo(s).x_()&&s.Ia.size>0}function Sl(s){return et(s).Ea.size===0}function SN(s){s.Va=void 0}async function Ak(s){s.Ra.set("Online")}async function Rk(s){s.Ia.forEach(((e,t)=>{T0(s,e)}))}async function kk(s,e){SN(s),E0(s)?(s.Ra.ha(e),j0(s)):s.Ra.set("Unknown")}async function Ik(s,e,t){if(s.Ra.set("Online"),e instanceof dN&&e.state===2&&e.cause)try{await(async function(o,u){const d=u.cause;for(const p of u.targetIds)o.Ia.has(p)&&(await o.remoteSyncer.rejectListen(p,d),o.Ia.delete(p),o.Va.removeTarget(p))})(s,e)}catch(a){Oe(vl,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await Yh(s,a)}else if(e instanceof Ah?s.Va.Ze(e):e instanceof uN?s.Va.st(e):s.Va.tt(e),!t.isEqual(We.min()))try{const a=await _N(s.localStore);t.compareTo(a)>=0&&await(function(u,d){const p=u.Va.Tt(d);return p.targetChanges.forEach(((x,g)=>{if(x.resumeToken.approximateByteSize()>0){const b=u.Ia.get(g);b&&u.Ia.set(g,b.withResumeToken(x.resumeToken,d))}})),p.targetMismatches.forEach(((x,g)=>{const b=u.Ia.get(x);if(!b)return;u.Ia.set(x,b.withResumeToken(zn.EMPTY_BYTE_STRING,b.snapshotVersion)),EN(u,x);const w=new _i(b.target,x,g,b.sequenceNumber);T0(u,w)})),u.remoteSyncer.applyRemoteEvent(p)})(s,t)}catch(a){Oe(vl,"Failed to raise snapshot:",a),await Yh(s,a)}}async function Yh(s,e,t){if(!Yo(e))throw e;s.Ea.add(1),await Mu(s),s.Ra.set("Offline"),t||(t=()=>_N(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Oe(vl,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await Af(s)}))}function CN(s,e){return e().catch((t=>Yh(s,t,e)))}async function Rf(s){const e=et(s),t=Oi(e);let a=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:u0;for(;Dk(e);)try{const o=await mk(e.localStore,a);if(o===null){e.Ta.length===0&&t.L_();break}a=o.batchId,Ok(e,o)}catch(o){await Yh(e,o)}AN(e)&&RN(e)}function Dk(s){return Sl(s)&&s.Ta.length<10}function Ok(s,e){s.Ta.push(e);const t=Oi(s);t.O_()&&t.X_&&t.ea(e.mutations)}function AN(s){return Sl(s)&&!Oi(s).x_()&&s.Ta.length>0}function RN(s){Oi(s).start()}async function Mk(s){Oi(s).ra()}async function Vk(s){const e=Oi(s);for(const t of s.Ta)e.ea(t.mutations)}async function Pk(s,e,t){const a=s.Ta.shift(),o=g0.from(a,e,t);await CN(s,(()=>s.remoteSyncer.applySuccessfulWrite(o))),await Rf(s)}async function Lk(s,e){e&&Oi(s).X_&&await(async function(a,o){if((function(d){return bR(d)&&d!==me.ABORTED})(o.code)){const u=a.Ta.shift();Oi(a).B_(),await CN(a,(()=>a.remoteSyncer.rejectFailedWrite(u.batchId,o))),await Rf(a)}})(s,e),AN(s)&&RN(s)}async function Kw(s,e){const t=et(s);t.asyncQueue.verifyOperationInProgress(),Oe(vl,"RemoteStore received new credentials");const a=Sl(t);t.Ea.add(3),await Mu(t),a&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Af(t)}async function Uk(s,e){const t=et(s);e?(t.Ea.delete(2),await Af(t)):e||(t.Ea.add(2),await Mu(t),t.Ra.set("Unknown"))}function Xo(s){return s.ma||(s.ma=(function(t,a,o){const u=et(t);return u.sa(),new Nk(a,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(s.datastore,s.asyncQueue,{Xo:Ak.bind(null,s),t_:Rk.bind(null,s),r_:kk.bind(null,s),H_:Ik.bind(null,s)}),s.da.push((async e=>{e?(s.ma.B_(),E0(s)?j0(s):s.Ra.set("Unknown")):(await s.ma.stop(),SN(s))}))),s.ma}function Oi(s){return s.fa||(s.fa=(function(t,a,o){const u=et(t);return u.sa(),new Tk(a,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,o)})(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:Mk.bind(null,s),r_:Lk.bind(null,s),ta:Vk.bind(null,s),na:Pk.bind(null,s)}),s.da.push((async e=>{e?(s.fa.B_(),await Rf(s)):(await s.fa.stop(),s.Ta.length>0&&(Oe(vl,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,t,a,o,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=o,this.removalCallback=u,this.deferred=new Ra,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,o,u){const d=Date.now()+a,p=new S0(e,t,d,o,u);return p.start(a),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new De(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function C0(s,e){if(Va("AsyncQueue",`${e}: ${s}`),Yo(s))return new De(me.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{static emptySet(e){return new jo(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||Fe.comparator(t.key,a.key):(t,a)=>Fe.comparator(t.key,a.key),this.keyedMap=su(),this.sortedSet=new Jt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,a)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof jo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,u=a.getNext().key;if(!o.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new jo;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(){this.ga=new Jt(Fe.comparator)}track(e){const t=e.doc.key,a=this.ga.get(t);a?e.type!==0&&a.type===3?this.ga=this.ga.insert(t,e):e.type===3&&a.type!==1?this.ga=this.ga.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.ga=this.ga.remove(t):e.type===1&&a.type===2?this.ga=this.ga.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ye(63341,{Rt:e,pa:a}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,a)=>{e.push(a)})),e}}class zo{constructor(e,t,a,o,u,d,p,x,g){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=x,this.hasCachedResults=g}static fromInitialDocuments(e,t,a,o,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new zo(e,t,jo.emptySet(t),d,a,o,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_f(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==a[o].type||!t[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Bk{constructor(){this.queries=Yw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const o=et(t),u=o.queries;o.queries=Yw(),u.forEach(((d,p)=>{for(const x of p.Sa)x.onError(a)}))})(this,new De(me.ABORTED,"Firestore shutting down"))}}function Yw(){return new El((s=>X1(s)),_f)}async function A0(s,e){const t=et(s);let a=3;const o=e.query;let u=t.queries.get(o);u?!u.ba()&&e.Da()&&(a=2):(u=new zk,a=e.Da()?0:1);try{switch(a){case 0:u.wa=await t.onListen(o,!0);break;case 1:u.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const p=C0(d,`Initialization of query '${bo(e.query)}' failed`);return void e.onError(p)}t.queries.set(o,u),u.Sa.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&k0(t)}async function R0(s,e){const t=et(s),a=e.query;let o=3;const u=t.queries.get(a);if(u){const d=u.Sa.indexOf(e);d>=0&&(u.Sa.splice(d,1),u.Sa.length===0?o=e.Da()?0:1:!u.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function Hk(s,e){const t=et(s);let a=!1;for(const o of e){const u=o.query,d=t.queries.get(u);if(d){for(const p of d.Sa)p.Fa(o)&&(a=!0);d.wa=o}}a&&k0(t)}function Fk(s,e,t){const a=et(s),o=a.queries.get(e);if(o)for(const u of o.Sa)u.onError(t);a.queries.delete(e)}function k0(s){s.Ca.forEach((e=>{e.next()}))}var Pg,Qw;(Qw=Pg||(Pg={})).Ma="default",Qw.Cache="cache";class I0{constructor(e,t,a){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=a||{}}Fa(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new zo(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const a=t!=="Offline";return(!this.options.qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=zo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Pg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e){this.key=e}}class IN{constructor(e){this.key=e}}class qk{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ft(),this.mutatedKeys=ft(),this.eu=W1(e),this.tu=new jo(this.eu)}get nu(){return this.Ya}ru(e,t){const a=t?t.iu:new Gw,o=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=o,p=!1;const x=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,w)=>{const N=o.get(b),R=Nf(this.query,w)?w:null,D=!!N&&this.mutatedKeys.has(N.key),q=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let L=!1;N&&R?N.data.isEqual(R.data)?D!==q&&(a.track({type:3,doc:R}),L=!0):this.su(N,R)||(a.track({type:2,doc:R}),L=!0,(x&&this.eu(R,x)>0||g&&this.eu(R,g)<0)&&(p=!0)):!N&&R?(a.track({type:0,doc:R}),L=!0):N&&!R&&(a.track({type:1,doc:N}),L=!0,(x||g)&&(p=!0)),L&&(R?(d=d.add(R),u=q?u.add(b):u.delete(b)):(d=d.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),u=u.delete(b.key),a.track({type:1,doc:b})}return{tu:d,iu:a,Cs:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,o){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,w)=>(function(R,D){const q=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ye(20277,{Rt:L})}};return q(R)-q(D)})(b.type,w.type)||this.eu(b.doc,w.doc))),this.ou(a),o=o??!1;const p=t&&!o?this._u():[],x=this.Xa.size===0&&this.current&&!o?1:0,g=x!==this.Za;return this.Za=x,d.length!==0||g?{snapshot:new zo(this.query,e.tu,u,d,e.mutatedKeys,x===0,g,!1,!!a&&a.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Gw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ft(),this.tu.forEach((a=>{this.uu(a.key)&&(this.Xa=this.Xa.add(a.key))}));const t=[];return e.forEach((a=>{this.Xa.has(a)||t.push(new IN(a))})),this.Xa.forEach((a=>{e.has(a)||t.push(new kN(a))})),t}cu(e){this.Ya=e.Qs,this.Xa=ft();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return zo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const D0="SyncEngine";class $k{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class Kk{constructor(e){this.key=e,this.hu=!1}}class Gk{constructor(e,t,a,o,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=o,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new El((p=>X1(p)),_f),this.Iu=new Map,this.Eu=new Set,this.du=new Jt(Fe.comparator),this.Au=new Map,this.Ru=new b0,this.Vu={},this.mu=new Map,this.fu=Uo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Yk(s,e,t=!0){const a=LN(s);let o;const u=a.Tu.get(e);return u?(a.sharedClientState.addLocalQueryTarget(u.targetId),o=u.view.lu()):o=await DN(a,e,t,!0),o}async function Qk(s,e){const t=LN(s);await DN(t,e,!0,!1)}async function DN(s,e,t,a){const o=await pk(s.localStore,$r(e)),u=o.targetId,d=s.sharedClientState.addLocalQueryTarget(u,t);let p;return a&&(p=await Xk(s,e,u,d==="current",o.resumeToken)),s.isPrimaryClient&&t&&jN(s.remoteStore,o),p}async function Xk(s,e,t,a,o){s.pu=(w,N,R)=>(async function(q,L,W,re){let $=L.view.ru(W);$.Cs&&($=await Bw(q.localStore,L.query,!1).then((({documents:S})=>L.view.ru(S,$))));const z=re&&re.targetChanges.get(L.targetId),he=re&&re.targetMismatches.get(L.targetId)!=null,_e=L.view.applyChanges($,q.isPrimaryClient,z,he);return Ww(q,L.targetId,_e.au),_e.snapshot})(s,w,N,R);const u=await Bw(s.localStore,e,!0),d=new qk(e,u.Qs),p=d.ru(u.documents),x=Ou.createSynthesizedTargetChangeForCurrentChange(t,a&&s.onlineState!=="Offline",o),g=d.applyChanges(p,s.isPrimaryClient,x);Ww(s,t,g.au);const b=new $k(e,t,d);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),g.snapshot}async function Wk(s,e,t){const a=et(s),o=a.Tu.get(e),u=a.Iu.get(o.targetId);if(u.length>1)return a.Iu.set(o.targetId,u.filter((d=>!_f(d,e)))),void a.Tu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await Mg(a.localStore,o.targetId,!1).then((()=>{a.sharedClientState.clearQueryState(o.targetId),t&&N0(a.remoteStore,o.targetId),Lg(a,o.targetId)})).catch(Go)):(Lg(a,o.targetId),await Mg(a.localStore,o.targetId,!0))}async function Jk(s,e){const t=et(s),a=t.Tu.get(e),o=t.Iu.get(a.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),N0(t.remoteStore,a.targetId))}async function Zk(s,e,t){const a=i3(s);try{const o=await(function(d,p){const x=et(d),g=qt.now(),b=p.reduce(((R,D)=>R.add(D.key)),ft());let w,N;return x.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let D=Pa(),q=ft();return x.Ns.getEntries(R,b).next((L=>{D=L,D.forEach(((W,re)=>{re.isValidDocument()||(q=q.add(W))}))})).next((()=>x.localDocuments.getOverlayedDocuments(R,D))).next((L=>{w=L;const W=[];for(const re of p){const $=mR(re,w.get(re.key).overlayedDocument);$!=null&&W.push(new Li(re.key,$,H1($.value.mapValue),rs.exists(!0)))}return x.mutationQueue.addMutationBatch(R,g,W,p)})).next((L=>{N=L;const W=L.applyToLocalDocumentSet(w,q);return x.documentOverlayCache.saveOverlays(R,L.batchId,W)}))})).then((()=>({batchId:N.batchId,changes:Z1(w)})))})(a.localStore,e);a.sharedClientState.addPendingMutation(o.batchId),(function(d,p,x){let g=d.Vu[d.currentUser.toKey()];g||(g=new Jt(ht)),g=g.insert(p,x),d.Vu[d.currentUser.toKey()]=g})(a,o.batchId,t),await Vu(a,o.changes),await Rf(a.remoteStore)}catch(o){const u=C0(o,"Failed to persist write");t.reject(u)}}async function ON(s,e){const t=et(s);try{const a=await hk(t.localStore,e);e.targetChanges.forEach(((o,u)=>{const d=t.Au.get(u);d&&(Et(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?Et(d.hu,14607):o.removedDocuments.size>0&&(Et(d.hu,42227),d.hu=!1))})),await Vu(t,a,e)}catch(a){await Go(a)}}function Xw(s,e,t){const a=et(s);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const o=[];a.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&o.push(p.snapshot)})),(function(d,p){const x=et(d);x.onlineState=p;let g=!1;x.queries.forEach(((b,w)=>{for(const N of w.Sa)N.va(p)&&(g=!0)})),g&&k0(x)})(a.eventManager,e),o.length&&a.Pu.H_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function e3(s,e,t){const a=et(s);a.sharedClientState.updateQueryState(e,"rejected",t);const o=a.Au.get(e),u=o&&o.key;if(u){let d=new Jt(Fe.comparator);d=d.insert(u,Gn.newNoDocument(u,We.min()));const p=ft().add(u),x=new Sf(We.min(),new Map,new Jt(ht),d,p);await ON(a,x),a.du=a.du.remove(u),a.Au.delete(e),O0(a)}else await Mg(a.localStore,e,!1).then((()=>Lg(a,e,t))).catch(Go)}async function t3(s,e){const t=et(s),a=e.batch.batchId;try{const o=await dk(t.localStore,e);VN(t,a,null),MN(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await Vu(t,o)}catch(o){await Go(o)}}async function n3(s,e,t){const a=et(s);try{const o=await(function(d,p){const x=et(d);return x.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let b;return x.mutationQueue.lookupMutationBatch(g,p).next((w=>(Et(w!==null,37113),b=w.keys(),x.mutationQueue.removeMutationBatch(g,w)))).next((()=>x.mutationQueue.performConsistencyCheck(g))).next((()=>x.documentOverlayCache.removeOverlaysForBatchId(g,b,p))).next((()=>x.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,b))).next((()=>x.localDocuments.getDocuments(g,b)))}))})(a.localStore,e);VN(a,e,t),MN(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await Vu(a,o)}catch(o){await Go(o)}}function MN(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function VN(s,e,t){const a=et(s);let o=a.Vu[a.currentUser.toKey()];if(o){const u=o.get(e);u&&(t?u.reject(t):u.resolve(),o=o.remove(e)),a.Vu[a.currentUser.toKey()]=o}}function Lg(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const a of s.Iu.get(e))s.Tu.delete(a),t&&s.Pu.yu(a,t);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach((a=>{s.Ru.containsKey(a)||PN(s,a)}))}function PN(s,e){s.Eu.delete(e.path.canonicalString());const t=s.du.get(e);t!==null&&(N0(s.remoteStore,t),s.du=s.du.remove(e),s.Au.delete(t),O0(s))}function Ww(s,e,t){for(const a of t)a instanceof kN?(s.Ru.addReference(a.key,e),s3(s,a)):a instanceof IN?(Oe(D0,"Document no longer in limbo: "+a.key),s.Ru.removeReference(a.key,e),s.Ru.containsKey(a.key)||PN(s,a.key)):Ye(19791,{wu:a})}function s3(s,e){const t=e.key,a=t.path.canonicalString();s.du.get(t)||s.Eu.has(a)||(Oe(D0,"New document in limbo: "+t),s.Eu.add(a),O0(s))}function O0(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new Fe(Ut.fromString(e)),a=s.fu.next();s.Au.set(a,new Kk(t)),s.du=s.du.insert(t,a),jN(s.remoteStore,new _i($r(wf(t.path)),a,"TargetPurposeLimboResolution",yf.ce))}}async function Vu(s,e,t){const a=et(s),o=[],u=[],d=[];a.Tu.isEmpty()||(a.Tu.forEach(((p,x)=>{d.push(a.pu(x,e,t).then((g=>{var b;if((g||t)&&a.isPrimaryClient){const w=g?!g.fromCache:(b=t==null?void 0:t.targetChanges.get(x.targetId))==null?void 0:b.current;a.sharedClientState.updateQueryState(x.targetId,w?"current":"not-current")}if(g){o.push(g);const w=w0.As(x.targetId,g);u.push(w)}})))})),await Promise.all(d),a.Pu.H_(o),await(async function(x,g){const b=et(x);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>xe.forEach(g,(N=>xe.forEach(N.Es,(R=>b.persistence.referenceDelegate.addReference(w,N.targetId,R))).next((()=>xe.forEach(N.ds,(R=>b.persistence.referenceDelegate.removeReference(w,N.targetId,R)))))))))}catch(w){if(!Yo(w))throw w;Oe(_0,"Failed to update sequence numbers: "+w)}for(const w of g){const N=w.targetId;if(!w.fromCache){const R=b.Ms.get(N),D=R.snapshotVersion,q=R.withLastLimboFreeSnapshotVersion(D);b.Ms=b.Ms.insert(N,q)}}})(a.localStore,u))}async function r3(s,e){const t=et(s);if(!t.currentUser.isEqual(e)){Oe(D0,"User change. New user:",e.toKey());const a=await wN(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((x=>{x.reject(new De(me.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await Vu(t,a.Ls)}}function a3(s,e){const t=et(s),a=t.Au.get(e);if(a&&a.hu)return ft().add(a.key);{let o=ft();const u=t.Iu.get(e);if(!u)return o;for(const d of u){const p=t.Tu.get(d);o=o.unionWith(p.view.nu)}return o}}function LN(s){const e=et(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=ON.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=a3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=e3.bind(null,e),e.Pu.H_=Hk.bind(null,e.eventManager),e.Pu.yu=Fk.bind(null,e.eventManager),e}function i3(s){const e=et(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=t3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=n3.bind(null,e),e}class Qh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return uk(this.persistence,new lk,e.initialUser,this.serializer)}Cu(e){return new vN(v0.mi,this.serializer)}Du(e){return new xk}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qh.provider={build:()=>new Qh};class l3 extends Qh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Et(this.persistence.referenceDelegate instanceof Gh,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new KR(a,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ms.withCacheSize(this.cacheSizeBytes):ms.DEFAULT;return new vN((a=>Gh.mi(a,t)),this.serializer)}}class Ug{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>Xw(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=r3.bind(null,this.syncEngine),await Uk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Bk})()}createDatastore(e){const t=Cf(e.databaseInfo.databaseId),a=(function(u){return new _k(u)})(e.databaseInfo);return(function(u,d,p,x){return new Ek(u,d,p,x)})(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return(function(a,o,u,d,p){return new Ck(a,o,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>Xw(this.syncEngine,t,0)),(function(){return qw.v()?new qw:new yk})())}createSyncEngine(e,t){return(function(o,u,d,p,x,g,b){const w=new Gk(o,u,d,p,x,g);return b&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(o){const u=et(o);Oe(vl,"RemoteStore shutting down."),u.Ea.add(5),await Mu(u),u.Aa.shutdown(),u.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Ug.provider={build:()=>new Ug};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Va("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi="FirestoreClient";class o3{constructor(e,t,a,o,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=o,this.user=Kn.UNAUTHENTICATED,this.clientId=c0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(a,(async d=>{Oe(Mi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(a,(d=>(Oe(Mi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ra;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=C0(t,"Failed to shutdown persistence");e.reject(a)}})),e.promise}}async function ng(s,e){s.asyncQueue.verifyOperationInProgress(),Oe(Mi,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let a=t.initialUser;s.setCredentialChangeListener((async o=>{a.isEqual(o)||(await wN(e.localStore,o),a=o)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Jw(s,e){s.asyncQueue.verifyOperationInProgress();const t=await c3(s);Oe(Mi,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((a=>Kw(e.remoteStore,a))),s.setAppCheckTokenChangeListener(((a,o)=>Kw(e.remoteStore,o))),s._onlineComponents=e}async function c3(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Oe(Mi,"Using user provided OfflineComponentProvider");try{await ng(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===me.FAILED_PRECONDITION||o.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Oo("Error using user provided cache. Falling back to memory cache: "+t),await ng(s,new Qh)}}else Oe(Mi,"Using default OfflineComponentProvider"),await ng(s,new l3(void 0));return s._offlineComponents}async function UN(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Oe(Mi,"Using user provided OnlineComponentProvider"),await Jw(s,s._uninitializedComponentsProvider._online)):(Oe(Mi,"Using default OnlineComponentProvider"),await Jw(s,new Ug))),s._onlineComponents}function u3(s){return UN(s).then((e=>e.syncEngine))}async function Xh(s){const e=await UN(s),t=e.eventManager;return t.onListen=Yk.bind(null,e.syncEngine),t.onUnlisten=Wk.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Qk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Jk.bind(null,e.syncEngine),t}function d3(s,e,t={}){const a=new Ra;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,x,g){const b=new M0({next:N=>{b.Nu(),d.enqueueAndForget((()=>R0(u,w)));const R=N.docs.has(p);!R&&N.fromCache?g.reject(new De(me.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&N.fromCache&&x&&x.source==="server"?g.reject(new De(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(N)},error:N=>g.reject(N)}),w=new I0(wf(p.path),b,{includeMetadataChanges:!0,qa:!0});return A0(u,w)})(await Xh(s),s.asyncQueue,e,t,a))),a.promise}function h3(s,e,t={}){const a=new Ra;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,x,g){const b=new M0({next:N=>{b.Nu(),d.enqueueAndForget((()=>R0(u,w))),N.fromCache&&x.source==="server"?g.reject(new De(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(N)},error:N=>g.reject(N)}),w=new I0(p,b,{includeMetadataChanges:!0,qa:!0});return A0(u,w)})(await Xh(s),s.asyncQueue,e,t,a))),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BN="firestore.googleapis.com",e_=!0;class t_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new De(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=BN,this.ssl=e_}else this.host=e.host,this.ssl=e.ssl??e_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=bN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<qR)throw new De(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}C4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zN(e.experimentalLongPollingOptions??{}),(function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new De(me.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new De(me.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new De(me.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(a,o){return a.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kf{constructor(e,t,a,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new t_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new De(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new De(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new t_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(a){if(!a)return new y4;switch(a.type){case"firstParty":return new _4(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new De(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const a=Zw.get(t);a&&(Oe("ComponentProvider","Removing Datastore"),Zw.delete(t),a.terminate())})(this),Promise.resolve()}}function f3(s,e,t,a={}){var g;s=ss(s,kf);const o=ta(e),u=s._getSettings(),d={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${t}`;o&&(mf(`https://${p}`),pf("Firestore",!0)),u.host!==BN&&u.host!==p&&Oo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const x={...u,host:p,ssl:o,emulatorOptions:a};if(!Ci(x,d)&&(s._setSettings(x),a.mockUserToken)){let b,w;if(typeof a.mockUserToken=="string")b=a.mockUserToken,w=Kn.MOCK_USER;else{b=y1(a.mockUserToken,(g=s._app)==null?void 0:g.options.projectId);const N=a.mockUserToken.sub||a.mockUserToken.user_id;if(!N)throw new De(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new Kn(N)}s._authCredentials=new b4(new R1(b,w))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Ui(this.firestore,e,this._query)}}class nn{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Si(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new nn(this.firestore,e,this._key)}toJSON(){return{type:nn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,a){if(Iu(t,nn._jsonSchema))return new nn(e,a||null,new Fe(Ut.fromString(t.referencePath)))}}nn._jsonSchemaVersion="firestore/documentReference/1.0",nn._jsonSchema={type:Nn("string",nn._jsonSchemaVersion),referencePath:Nn("string")};class Si extends Ui{constructor(e,t,a){super(e,t,wf(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new nn(this.firestore,null,new Fe(e))}withConverter(e){return new Si(this.firestore,e,this._path)}}function Tt(s,e,...t){if(s=St(s),k1("collection","path",e),s instanceof kf){const a=Ut.fromString(e,...t);return mw(a),new Si(s,null,a)}{if(!(s instanceof nn||s instanceof Si))throw new De(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=s._path.child(Ut.fromString(e,...t));return mw(a),new Si(s.firestore,null,a)}}function qe(s,e,...t){if(s=St(s),arguments.length===1&&(e=c0.newId()),k1("doc","path",e),s instanceof kf){const a=Ut.fromString(e,...t);return fw(a),new nn(s,null,new Fe(a))}{if(!(s instanceof nn||s instanceof Si))throw new De(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=s._path.child(Ut.fromString(e,...t));return fw(a),new nn(s.firestore,s instanceof Si?s.converter:null,new Fe(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_="AsyncQueue";class s_{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new NN(this,"async_queue_retry"),this._c=()=>{const a=tg();a&&Oe(n_,"Visibility state changed to "+a.visibilityState),this.M_.w_()},this.ac=e;const t=tg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=tg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ra;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Yo(e))throw e;Oe(n_,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((a=>{throw this.nc=a,this.rc=!1,Va("INTERNAL UNHANDLED ERROR: ",r_(a)),a})).then((a=>(this.rc=!1,a))))));return this.ac=t,t}enqueueAfterDelay(e,t,a){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=S0.createAndSchedule(this,e,t,a,(u=>this.hc(u)));return this.tc.push(o),o}uc(){this.nc&&Ye(47125,{Pc:r_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,a)=>t.targetTimeMs-a.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function r_(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a_(s){return(function(t,a){if(typeof t!="object"||t===null)return!1;const o=t;for(const u of a)if(u in o&&typeof o[u]=="function")return!0;return!1})(s,["next","error","complete"])}class Jr extends kf{constructor(e,t,a,o){super(e,t,a,o),this.type="firestore",this._queue=new s_,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new s_(e),this._firestoreClient=void 0,await e}}}function m3(s,e){const t=typeof s=="object"?s:gf(),a=typeof s=="string"?s:Hh,o=ku(t,"firestore").getImmediate({identifier:a});if(!o._initialized){const u=r0("firestore");u&&f3(o,...u)}return o}function Pu(s){if(s._terminated)throw new De(me.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||p3(s),s._firestoreClient}function p3(s){var a,o,u;const e=s._freezeSettings(),t=(function(p,x,g,b){return new U4(p,x,g,b.host,b.ssl,b.experimentalForceLongPolling,b.experimentalAutoDetectLongPolling,zN(b.experimentalLongPollingOptions),b.useFetchStreams,b.isUsingEmulator)})(s._databaseId,((a=s._app)==null?void 0:a.options.appId)||"",s._persistenceKey,e);s._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((u=e.localCache)!=null&&u._onlineComponentProvider)&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new o3(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(p){const x=p==null?void 0:p._online.build();return{_offline:p==null?void 0:p._offline.build(x),_online:x}})(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this._byteString=e}static fromBase64String(e){try{return new er(zn.fromBase64String(e))}catch(t){throw new De(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new er(zn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:er._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Iu(e,er._jsonSchema))return er.fromBase64String(e.bytes)}}er._jsonSchemaVersion="firestore/bytes/1.0",er._jsonSchema={type:Nn("string",er._jsonSchemaVersion),bytes:Nn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new De(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new De(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new De(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ht(this._lat,e._lat)||ht(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Gr._jsonSchemaVersion}}static fromJSON(e){if(Iu(e,Gr._jsonSchema))return new Gr(e.latitude,e.longitude)}}Gr._jsonSchemaVersion="firestore/geoPoint/1.0",Gr._jsonSchema={type:Nn("string",Gr._jsonSchemaVersion),latitude:Nn("number"),longitude:Nn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(a,o){if(a.length!==o.length)return!1;for(let u=0;u<a.length;++u)if(a[u]!==o[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Yr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Iu(e,Yr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Yr(e.vectorValues);throw new De(me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Yr._jsonSchemaVersion="firestore/vectorValue/1.0",Yr._jsonSchema={type:Nn("string",Yr._jsonSchemaVersion),vectorValues:Nn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3=/^__.*__$/;class x3{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new Li(e,this.data,this.fieldMask,t,this.fieldTransforms):new Du(e,this.data,t,this.fieldTransforms)}}class HN{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new Li(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function FN(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ye(40011,{Ac:s})}}class If{constructor(e,t,a,o,u,d){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=o,u===void 0&&this.Rc(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new If({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),a=this.Vc({path:t,fc:!1});return a.gc(e),a}yc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),a=this.Vc({path:t,fc:!1});return a.Rc(),a}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Wh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(FN(this.Ac)&&g3.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class y3{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||Cf(e)}Cc(e,t,a,o=!1){return new If({Ac:e,methodName:t,Dc:a,path:Un.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zu(s){const e=s._freezeSettings(),t=Cf(s._databaseId);return new y3(s._databaseId,!!e.ignoreUndefinedProperties,t)}function V0(s,e,t,a,o,u={}){const d=s.Cc(u.merge||u.mergeFields?2:0,e,t,o);U0("Data must be an object, but it was:",d,a);const p=KN(a,d);let x,g;if(u.merge)x=new Vs(d.fieldMask),g=d.fieldTransforms;else if(u.mergeFields){const b=[];for(const w of u.mergeFields){const N=zg(e,w,t);if(!d.contains(N))throw new De(me.INVALID_ARGUMENT,`Field '${N}' is specified in your field mask but missing from your input data.`);YN(b,N)||b.push(N)}x=new Vs(b),g=d.fieldTransforms.filter((w=>x.covers(w.field)))}else x=null,g=d.fieldTransforms;return new x3(new xs(p),x,g)}class Bu extends Uu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Bu}}function b3(s,e,t){return new If({Ac:3,Dc:e.settings.Dc,methodName:s._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class P0 extends Uu{_toFieldTransform(e){return new iN(e.path,new _u)}isEqual(e){return e instanceof P0}}class L0 extends Uu{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=b3(this,e,!0),a=this.vc.map((u=>Wo(u,t))),o=new Lo(a);return new iN(e.path,o)}isEqual(e){return e instanceof L0&&Ci(this.vc,e.vc)}}function qN(s,e,t,a){const o=s.Cc(1,e,t);U0("Data must be an object, but it was:",o,a);const u=[],d=xs.empty();Pi(a,((x,g)=>{const b=z0(e,x,t);g=St(g);const w=o.yc(b);if(g instanceof Bu)u.push(b);else{const N=Wo(g,w);N!=null&&(u.push(b),d.set(b,N))}}));const p=new Vs(u);return new HN(d,p,o.fieldTransforms)}function $N(s,e,t,a,o,u){const d=s.Cc(1,e,t),p=[zg(e,a,t)],x=[o];if(u.length%2!=0)throw new De(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let N=0;N<u.length;N+=2)p.push(zg(e,u[N])),x.push(u[N+1]);const g=[],b=xs.empty();for(let N=p.length-1;N>=0;--N)if(!YN(g,p[N])){const R=p[N];let D=x[N];D=St(D);const q=d.yc(R);if(D instanceof Bu)g.push(R);else{const L=Wo(D,q);L!=null&&(g.push(R),b.set(R,L))}}const w=new Vs(g);return new HN(b,w,d.fieldTransforms)}function v3(s,e,t,a=!1){return Wo(t,s.Cc(a?4:3,e))}function Wo(s,e){if(GN(s=St(s)))return U0("Unsupported field value:",e,s),KN(s,e);if(s instanceof Uu)return(function(a,o){if(!FN(o.Ac))throw o.Sc(`${a._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${a._methodName}() is not currently supported inside arrays`);const u=a._toFieldTransform(o);u&&o.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(a,o){const u=[];let d=0;for(const p of a){let x=Wo(p,o.wc(d));x==null&&(x={nullValue:"NULL_VALUE"}),u.push(x),d++}return{arrayValue:{values:u}}})(s,e)}return(function(a,o){if((a=St(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return oR(o.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const u=qt.fromDate(a);return{timestampValue:Kh(o.serializer,u)}}if(a instanceof qt){const u=new qt(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:Kh(o.serializer,u)}}if(a instanceof Gr)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof er)return{bytesValue:hN(o.serializer,a._byteString)};if(a instanceof nn){const u=o.databaseId,d=a.firestore._databaseId;if(!d.isEqual(u))throw o.Sc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:y0(a.firestore._databaseId||o.databaseId,a._key.path)}}if(a instanceof Yr)return(function(d,p){return{mapValue:{fields:{[z1]:{stringValue:B1},[Fh]:{arrayValue:{values:d.toArray().map((g=>{if(typeof g!="number")throw p.Sc("VectorValues must only contain numeric values.");return p0(p.serializer,g)}))}}}}}})(a,o);throw o.Sc(`Unsupported field value: ${xf(a)}`)})(s,e)}function KN(s,e){const t={};return O1(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pi(s,((a,o)=>{const u=Wo(o,e.mc(a));u!=null&&(t[a]=u)})),{mapValue:{fields:t}}}function GN(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof qt||s instanceof Gr||s instanceof er||s instanceof nn||s instanceof Uu||s instanceof Yr)}function U0(s,e,t){if(!GN(t)||!I1(t)){const a=xf(t);throw a==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+a)}}function zg(s,e,t){if((e=St(e))instanceof Lu)return e._internalPath;if(typeof e=="string")return z0(s,e);throw Wh("Field path arguments must be of type string or ",s,!1,void 0,t)}const w3=new RegExp("[~\\*/\\[\\]]");function z0(s,e,t){if(e.search(w3)>=0)throw Wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Lu(...e.split("."))._internalPath}catch{throw Wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Wh(s,e,t,a,o){const u=a&&!a.isEmpty(),d=o!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let x="";return(u||d)&&(x+=" (found",u&&(x+=` in field ${a}`),d&&(x+=` in document ${o}`),x+=")"),new De(me.INVALID_ARGUMENT,p+s+x)}function YN(s,e){return s.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e,t,a,o,u){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=o,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Df("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class _3 extends QN{data(){return super.data()}}function Df(s,e){return typeof e=="string"?z0(s,e):e instanceof Lu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XN(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new De(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class B0{}class WN extends B0{}function mn(s,e,...t){let a=[];e instanceof B0&&a.push(e),a=a.concat(t),(function(u){const d=u.filter((x=>x instanceof H0)).length,p=u.filter((x=>x instanceof Of)).length;if(d>1||d>0&&p>0)throw new De(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(a);for(const o of a)s=o._apply(s);return s}class Of extends WN{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new Of(e,t,a)}_apply(e){const t=this._parse(e);return JN(e._query,t),new Ui(e.firestore,e.converter,Ag(e._query,t))}_parse(e){const t=zu(e.firestore);return(function(u,d,p,x,g,b,w){let N;if(g.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new De(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){l_(w,b);const D=[];for(const q of w)D.push(i_(x,u,q));N={arrayValue:{values:D}}}else N=i_(x,u,w)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||l_(w,b),N=v3(p,d,w,b==="in"||b==="not-in");return _n.create(g,b,N)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bs(s,e,t){const a=e,o=Df("where",s);return Of._create(o,a,t)}class H0 extends B0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new H0(e,t)}_parse(e){const t=this._queryConstraints.map((a=>a._parse(e))).filter((a=>a.getFilters().length>0));return t.length===1?t[0]:_r.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,u){let d=o;const p=u.getFlattenedFilters();for(const x of p)JN(d,x),d=Ag(d,x)})(e._query,t),new Ui(e.firestore,e.converter,Ag(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class F0 extends WN{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new F0(e,t)}_apply(e){const t=(function(o,u,d){if(o.startAt!==null)throw new De(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new De(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new wu(u,d)})(e._query,this._field,this._direction);return new Ui(e.firestore,e.converter,(function(o,u){const d=o.explicitOrderBy.concat([u]);return new Qo(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)})(e._query,t))}}function Jo(s,e="asc"){const t=e,a=Df("orderBy",s);return F0._create(a,t)}function i_(s,e,t){if(typeof(t=St(t))=="string"){if(t==="")throw new De(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Q1(e)&&t.indexOf("/")!==-1)throw new De(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(Ut.fromString(t));if(!Fe.isDocumentKey(a))throw new De(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return _w(s,new Fe(a))}if(t instanceof nn)return _w(s,t._key);throw new De(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xf(t)}.`)}function l_(s,e){if(!Array.isArray(s)||s.length===0)throw new De(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function JN(s,e){const t=(function(o,u){for(const d of o)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new De(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new De(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class N3{convertValue(e,t="none"){switch(Di(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ii(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ye(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return Pi(e,((o,u)=>{a[o]=this.convertValue(u,t)})),a}convertVectorValue(e){var a,o,u;const t=(u=(o=(a=e.fields)==null?void 0:a[Fh].arrayValue)==null?void 0:o.values)==null?void 0:u.map((d=>dn(d.doubleValue)));return new Yr(t)}convertGeoPoint(e){return new Gr(dn(e.latitude),dn(e.longitude))}convertArray(e,t){return(e.values||[]).map((a=>this.convertValue(a,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const a=vf(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(yu(e));default:return null}}convertTimestamp(e){const t=ki(e);return new qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=Ut.fromString(e);Et(yN(a),9688,{name:e});const o=new bu(a.get(1),a.get(3)),u=new Fe(a.popFirst(5));return o.isEqual(t)||Va(`Document ${u} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(s,e,t){let a;return a=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,a}class au{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pl extends QN{constructor(e,t,a,o,u,d){super(e,t,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(Df("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new De(me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=pl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}pl._jsonSchemaVersion="firestore/documentSnapshot/1.0",pl._jsonSchema={type:Nn("string",pl._jsonSchemaVersion),bundleSource:Nn("string","DocumentSnapshot"),bundleName:Nn("string"),bundle:Nn("string")};class Rh extends pl{data(e={}){return super.data(e)}}class gl{constructor(e,t,a,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new au(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((a=>{e.call(t,new Rh(this._firestore,this._userDataWriter,a.key,a,new au(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new De(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,u){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((p=>{const x=new Rh(o._firestore,o._userDataWriter,p.doc.key,p.doc,new au(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);return p.doc,{type:"added",doc:x,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const x=new Rh(o._firestore,o._userDataWriter,p.doc.key,p.doc,new au(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,b=-1;return p.type!==0&&(g=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),b=d.indexOf(p.doc.key)),{type:T3(p.type),doc:x,oldIndex:g,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new De(me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=gl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=c0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],a=[],o=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),a.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),o.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function T3(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ye(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vr(s){s=ss(s,nn);const e=ss(s.firestore,Jr);return d3(Pu(e),s._key).then((t=>ZN(e,s,t)))}gl._jsonSchemaVersion="firestore/querySnapshot/1.0",gl._jsonSchema={type:Nn("string",gl._jsonSchemaVersion),bundleSource:Nn("string","QuerySnapshot"),bundleName:Nn("string"),bundle:Nn("string")};class $0 extends N3{constructor(e){super(),this.firestore=e}convertBytes(e){return new er(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new nn(this.firestore,null,t)}}function wr(s){s=ss(s,Ui);const e=ss(s.firestore,Jr),t=Pu(e),a=new $0(e);return XN(s._query),h3(t,s._query).then((o=>new gl(e,a,s,o)))}function Eo(s,e,t){s=ss(s,nn);const a=ss(s.firestore,Jr),o=q0(s.converter,e,t);return Hu(a,[V0(zu(a),"setDoc",s._key,o,s.converter!==null,t).toMutation(s._key,rs.none())])}function Qt(s,e,t,...a){s=ss(s,nn);const o=ss(s.firestore,Jr),u=zu(o);let d;return d=typeof(e=St(e))=="string"||e instanceof Lu?$N(u,"updateDoc",s._key,e,t,a):qN(u,"updateDoc",s._key,e),Hu(o,[d.toMutation(s._key,rs.exists(!0))])}function Cl(s){return Hu(ss(s.firestore,Jr),[new Ef(s._key,rs.none())])}function Al(s,e){const t=ss(s.firestore,Jr),a=qe(s),o=q0(s.converter,e);return Hu(t,[V0(zu(s.firestore),"addDoc",a._key,o,s.converter!==null,{}).toMutation(a._key,rs.exists(!1))]).then((()=>a))}function zs(s,...e){var x,g,b;s=St(s);let t={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||a_(e[a])||(t=e[a++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(a_(e[a])){const w=e[a];e[a]=(x=w.next)==null?void 0:x.bind(w),e[a+1]=(g=w.error)==null?void 0:g.bind(w),e[a+2]=(b=w.complete)==null?void 0:b.bind(w)}let u,d,p;if(s instanceof nn)d=ss(s.firestore,Jr),p=wf(s._key.path),u={next:w=>{e[a]&&e[a](ZN(d,s,w))},error:e[a+1],complete:e[a+2]};else{const w=ss(s,Ui);d=ss(w.firestore,Jr),p=w._query;const N=new $0(d);u={next:R=>{e[a]&&e[a](new gl(d,N,w,R))},error:e[a+1],complete:e[a+2]},XN(s._query)}return(function(N,R,D,q){const L=new M0(q),W=new I0(R,L,D);return N.asyncQueue.enqueueAndForget((async()=>A0(await Xh(N),W))),()=>{L.Nu(),N.asyncQueue.enqueueAndForget((async()=>R0(await Xh(N),W)))}})(Pu(d),p,o,u)}function Hu(s,e){return(function(a,o){const u=new Ra;return a.asyncQueue.enqueueAndForget((async()=>Zk(await u3(a),o,u))),u.promise})(Pu(s),e)}function ZN(s,e,t){const a=t.docs.get(e._key),o=new $0(s);return new pl(s,o,e._key,a,new au(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zu(e)}set(e,t,a){this._verifyNotCommitted();const o=sg(e,this._firestore),u=q0(o.converter,t,a),d=V0(this._dataReader,"WriteBatch.set",o._key,u,o.converter!==null,a);return this._mutations.push(d.toMutation(o._key,rs.none())),this}update(e,t,a,...o){this._verifyNotCommitted();const u=sg(e,this._firestore);let d;return d=typeof(t=St(t))=="string"||t instanceof Lu?$N(this._dataReader,"WriteBatch.update",u._key,t,a,o):qN(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,rs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=sg(e,this._firestore);return this._mutations=this._mutations.concat(new Ef(t._key,rs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new De(me.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function sg(s,e){if((s=St(s)).firestore!==e)throw new De(me.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(){return new Bu("deleteField")}function Bg(){return new P0("serverTimestamp")}function Bo(...s){return new L0("arrayUnion",s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rg(s){return Pu(s=ss(s,Jr)),new j3(s,(e=>Hu(s,e)))}(function(e,t=!0){(function(o){Ko=o})(jl),Ai(new Oa("firestore",((a,{instanceIdentifier:o,options:u})=>{const d=a.getProvider("app").getImmediate(),p=new Jr(new v4(a.getProvider("auth-internal")),new N4(d,a.getProvider("app-check-internal")),(function(g,b){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new De(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bu(g.options.projectId,b)})(d,o),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),tr(cw,uw,e),tr(cw,uw,"esm2020")})();function e2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const t2=e2,n2=new Au("auth","Firebase",e2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jh=new a0("@firebase/auth");function E3(s,...e){Jh.logLevel<=dt.WARN&&Jh.warn(`Auth (${jl}): ${s}`,...e)}function kh(s,...e){Jh.logLevel<=dt.ERROR&&Jh.error(`Auth (${jl}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(s,...e){throw K0(s,...e)}function Qr(s,...e){return K0(s,...e)}function s2(s,e,t){const a={...t2(),[e]:t};return new Au("auth","Firebase",a).create(e,{appName:s.name})}function ka(s){return s2(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function K0(s,...e){if(typeof s!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=s.name),s._errorFactory.create(t,...a)}return n2.create(s,...e)}function Ge(s,e,...t){if(!s)throw K0(e,...t)}function Sa(s){const e="INTERNAL ASSERTION FAILED: "+s;throw kh(e),new Error(e)}function La(s,e){s||Sa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(){var s;return typeof self<"u"&&((s=self.location)==null?void 0:s.href)||""}function S3(){return o_()==="http:"||o_()==="https:"}function o_(){var s;return typeof self<"u"&&((s=self.location)==null?void 0:s.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(S3()||QA()||"connection"in navigator)?navigator.onLine:!0}function A3(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,t){this.shortDelay=e,this.longDelay=t,La(t>e,"Short delay should be less than long delay!"),this.isMobile=KA()||XA()}get(){return C3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G0(s,e){La(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Sa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Sa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Sa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],I3=new Fu(3e4,6e4);function zi(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function za(s,e,t,a,o={}){return a2(s,o,async()=>{let u={},d={};a&&(e==="GET"?d=a:u={body:JSON.stringify(a)});const p=Ru({key:s.config.apiKey,...d}).slice(1),x=await s._getAdditionalHeaders();x["Content-Type"]="application/json",s.languageCode&&(x["X-Firebase-Locale"]=s.languageCode);const g={method:e,headers:x,...u};return YA()||(g.referrerPolicy="no-referrer"),s.emulatorConfig&&ta(s.emulatorConfig.host)&&(g.credentials="include"),r2.fetch()(await i2(s,s.config.apiHost,t,p),g)})}async function a2(s,e,t){s._canInitEmulator=!1;const a={...R3,...e};try{const o=new O3(s),u=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw vh(s,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[x,g]=p.split(" : ");if(x==="FEDERATED_USER_ID_ALREADY_LINKED")throw vh(s,"credential-already-in-use",d);if(x==="EMAIL_EXISTS")throw vh(s,"email-already-in-use",d);if(x==="USER_DISABLED")throw vh(s,"user-disabled",d);const b=a[x]||x.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw s2(s,b,g);Nr(s,b)}}catch(o){if(o instanceof Tr)throw o;Nr(s,"network-request-failed",{message:String(o)})}}async function qu(s,e,t,a,o={}){const u=await za(s,e,t,a,o);return"mfaPendingCredential"in u&&Nr(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function i2(s,e,t,a){const o=`${e}${t}?${a}`,u=s,d=u.config.emulator?G0(s.config,o):`${s.config.apiScheme}://${o}`;return k3.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function D3(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class O3{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(Qr(this.auth,"network-request-failed")),I3.get())})}}function vh(s,e,t){const a={appName:s.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const o=Qr(s,e,a);return o.customData._tokenResponse=t,o}function c_(s){return s!==void 0&&s.enterprise!==void 0}class M3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return D3(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function V3(s,e){return za(s,"GET","/v2/recaptchaConfig",zi(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P3(s,e){return za(s,"POST","/v1/accounts:delete",e)}async function Zh(s,e){return za(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function l2(s,e=!1){const t=St(s),a=await t.getIdToken(e),o=Y0(a);Ge(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const u=typeof o.firebase=="object"?o.firebase:void 0,d=u==null?void 0:u.sign_in_provider;return{claims:o,token:a,authTime:fu(ag(o.auth_time)),issuedAtTime:fu(ag(o.iat)),expirationTime:fu(ag(o.exp)),signInProvider:d||null,signInSecondFactor:(u==null?void 0:u.sign_in_second_factor)||null}}function ag(s){return Number(s)*1e3}function Y0(s){const[e,t,a]=s.split(".");if(e===void 0||t===void 0||a===void 0)return kh("JWT malformed, contained fewer than 3 sections"),null;try{const o=m1(t);return o?JSON.parse(o):(kh("Failed to decode base64 JWT payload"),null)}catch(o){return kh("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function u_(s){const e=Y0(s);return Ge(e,"internal-error"),Ge(typeof e.exp<"u","internal-error"),Ge(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ho(s,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof Tr&&L3(a)&&s.auth.currentUser===s&&await s.auth.signOut(),a}}function L3({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const a=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fu(this.lastLoginAt),this.creationTime=fu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ef(s){var w;const e=s.auth,t=await s.getIdToken(),a=await Ho(s,Zh(e,{idToken:t}));Ge(a==null?void 0:a.users.length,e,"internal-error");const o=a.users[0];s._notifyReloadListener(o);const u=(w=o.providerUserInfo)!=null&&w.length?c2(o.providerUserInfo):[],d=z3(s.providerData,u),p=s.isAnonymous,x=!(s.email&&o.passwordHash)&&!(d!=null&&d.length),g=p?x:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new Fg(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(s,b)}async function o2(s){const e=St(s);await ef(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function z3(s,e){return[...s.filter(a=>!e.some(o=>o.providerId===a.providerId)),...e]}function c2(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B3(s,e){const t=await a2(s,{},async()=>{const a=Ru({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:u}=s.config,d=await i2(s,o,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const x={method:"POST",headers:p,body:a};return s.emulatorConfig&&ta(s.emulatorConfig.host)&&(x.credentials="include"),r2.fetch()(d,x)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function H3(s,e){return za(s,"POST","/v2/accounts:revokeToken",zi(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ge(e.idToken,"internal-error"),Ge(typeof e.idToken<"u","internal-error"),Ge(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):u_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ge(e.length!==0,"internal-error");const t=u_(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ge(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:o,expiresIn:u}=await B3(e,t);this.updateTokensAndExpiration(a,o,Number(u))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:o,expirationTime:u}=t,d=new So;return a&&(Ge(typeof a=="string","internal-error",{appName:e}),d.refreshToken=a),o&&(Ge(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),u&&(Ge(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new So,this.toJSON())}_performRefresh(){return Sa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(s,e){Ge(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class yr{constructor({uid:e,auth:t,stsTokenManager:a,...o}){this.providerId="firebase",this.proactiveRefresh=new U3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Fg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Ho(this,this.stsTokenManager.getToken(this.auth,e));return Ge(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return l2(this,e)}reload(){return o2(this)}_assign(e){this!==e&&(Ge(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new yr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await ef(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(gs(this.auth.app))return Promise.reject(ka(this.auth));const e=await this.getIdToken();return await Ho(this,P3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const a=t.displayName??void 0,o=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,x=t._redirectEventId??void 0,g=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:w,emailVerified:N,isAnonymous:R,providerData:D,stsTokenManager:q}=t;Ge(w&&q,e,"internal-error");const L=So.fromJSON(this.name,q);Ge(typeof w=="string",e,"internal-error"),bi(a,e.name),bi(o,e.name),Ge(typeof N=="boolean",e,"internal-error"),Ge(typeof R=="boolean",e,"internal-error"),bi(u,e.name),bi(d,e.name),bi(p,e.name),bi(x,e.name),bi(g,e.name),bi(b,e.name);const W=new yr({uid:w,auth:e,email:o,emailVerified:N,displayName:a,isAnonymous:R,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:L,createdAt:g,lastLoginAt:b});return D&&Array.isArray(D)&&(W.providerData=D.map(re=>({...re}))),x&&(W._redirectEventId=x),W}static async _fromIdTokenResponse(e,t,a=!1){const o=new So;o.updateFromServerResponse(t);const u=new yr({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:a});return await ef(u),u}static async _fromGetAccountInfoResponse(e,t,a){const o=t.users[0];Ge(o.localId!==void 0,"internal-error");const u=o.providerUserInfo!==void 0?c2(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!(u!=null&&u.length),p=new So;p.updateFromIdToken(a);const x=new yr({uid:o.localId,auth:e,stsTokenManager:p,isAnonymous:d}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Fg(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(u!=null&&u.length)};return Object.assign(x,g),x}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=new Map;function Ca(s){La(s instanceof Function,"Expected a class definition");let e=d_.get(s);return e?(La(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,d_.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}u2.type="NONE";const qg=u2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ih(s,e,t){return`firebase:${s}:${e}:${t}`}class Co{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:o,name:u}=this.auth;this.fullUserKey=Ih(this.userKey,o.apiKey,u),this.fullPersistenceKey=Ih("persistence",o.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Zh(this.auth,{idToken:e}).catch(()=>{});return t?yr._fromGetAccountInfoResponse(this.auth,t,e):null}return yr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new Co(Ca(qg),e,a);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let u=o[0]||Ca(qg);const d=Ih(a,e.config.apiKey,e.name);let p=null;for(const g of t)try{const b=await g._get(d);if(b){let w;if(typeof b=="string"){const N=await Zh(e,{idToken:b}).catch(()=>{});if(!N)break;w=await yr._fromGetAccountInfoResponse(e,N,b)}else w=yr._fromJSON(e,b);g!==u&&(p=w),u=g;break}}catch{}const x=o.filter(g=>g._shouldAllowMigration);return!u._shouldAllowMigration||!x.length?new Co(u,e,a):(u=x[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async g=>{if(g!==u)try{await g._remove(d)}catch{}})),new Co(u,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(m2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(d2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(g2(e))return"Blackberry";if(x2(e))return"Webos";if(h2(e))return"Safari";if((e.includes("chrome/")||f2(e))&&!e.includes("edge/"))return"Chrome";if(p2(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=s.match(t);if((a==null?void 0:a.length)===2)return a[1]}return"Other"}function d2(s=Xn()){return/firefox\//i.test(s)}function h2(s=Xn()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function f2(s=Xn()){return/crios\//i.test(s)}function m2(s=Xn()){return/iemobile/i.test(s)}function p2(s=Xn()){return/android/i.test(s)}function g2(s=Xn()){return/blackberry/i.test(s)}function x2(s=Xn()){return/webos/i.test(s)}function Q0(s=Xn()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function F3(s=Xn()){var e;return Q0(s)&&!!((e=window.navigator)!=null&&e.standalone)}function q3(){return WA()&&document.documentMode===10}function y2(s=Xn()){return Q0(s)||p2(s)||x2(s)||g2(s)||/windows phone/i.test(s)||m2(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b2(s,e=[]){let t;switch(s){case"Browser":t=h_(Xn());break;case"Worker":t=`${h_(Xn())}-${s}`;break;default:t=s}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${jl}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $3{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=u=>new Promise((d,p)=>{try{const x=e(u);d(x)}catch(x){p(x)}});a.onAbort=t,this.queue.push(a);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a==null?void 0:a.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K3(s,e={}){return za(s,"GET","/v2/passwordPolicy",zi(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3=6;class Y3{constructor(e){var a;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??G3,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((a=e.allowedNonAlphanumericCharacters)==null?void 0:a.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let o=0;o<e.length;o++)a=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,o,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(e,t,a,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new f_(this),this.idTokenSubscription=new f_(this),this.beforeStateQueue=new $3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=n2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ca(t)),this._initializationPromise=this.queue(async()=>{var a,o,u;if(!this._deleted&&(this.persistenceManager=await Co.create(this,e),(a=this._resolvePersistenceManagerAvailable)==null||a.call(this),!this._deleted)){if((o=this._popupRedirectResolver)!=null&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((u=this.currentUser)==null?void 0:u.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Zh(this,{idToken:e}),a=await yr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var u;if(gs(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(p=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(p,p))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let a=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(u=this.redirectUser)==null?void 0:u._redirectEventId,p=a==null?void 0:a._redirectEventId,x=await this.tryRedirectSignIn(e);(!d||d===p)&&(x!=null&&x.user)&&(a=x.user,o=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Ge(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ef(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=A3()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(gs(this.app))return Promise.reject(ka(this));const t=e?St(e):null;return t&&Ge(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ge(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return gs(this.app)?Promise.reject(ka(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return gs(this.app)?Promise.reject(ka(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ca(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await K3(this),t=new Y3(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Au("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await H3(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ca(e)||this._popupRedirectResolver;Ge(t,this,"argument-error"),this.redirectPersistenceManager=await Co.create(this,[Ca(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)==null?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,o){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ge(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const x=e.addObserver(t,a,o);return()=>{d=!0,x()}}else{const x=e.addObserver(t);return()=>{d=!0,x()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=b2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var o;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((o=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:o.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const a=await this._getAppCheckToken();return a&&(e["X-Firebase-AppCheck"]=a),e}async _getAppCheckToken(){var t;if(gs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&E3(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Rl(s){return St(s)}class f_{constructor(e){this.auth=e,this.observer=null,this.addObserver=a5(t=>this.observer=t)}get next(){return Ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function X3(s){Mf=s}function v2(s){return Mf.loadJS(s)}function W3(){return Mf.recaptchaEnterpriseScript}function J3(){return Mf.gapiScript}function Z3(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class eI{constructor(){this.enterprise=new tI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class tI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const nI="recaptcha-enterprise",w2="NO_RECAPTCHA";class sI{constructor(e){this.type=nI,this.auth=Rl(e)}async verify(e="verify",t=!1){async function a(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{V3(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(x=>{if(x.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const g=new M3(x);return u.tenantId==null?u._agentRecaptchaConfig=g:u._tenantRecaptchaConfigs[u.tenantId]=g,d(g.siteKey)}}).catch(x=>{p(x)})})}function o(u,d,p){const x=window.grecaptcha;c_(x)?x.enterprise.ready(()=>{x.enterprise.execute(u,{action:e}).then(g=>{d(g)}).catch(()=>{d(w2)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new eI().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{a(this.auth).then(p=>{if(!t&&c_(window.grecaptcha))o(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let x=W3();x.length!==0&&(x+=p),v2(x).then(()=>{o(p,u,d)}).catch(g=>{d(g)})}}).catch(p=>{d(p)})})}}async function m_(s,e,t,a=!1,o=!1){const u=new sI(s);let d;if(o)d=w2;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const x=p.phoneEnrollmentInfo.phoneNumber,g=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:x,recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const x=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:x,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return a?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function $g(s,e,t,a,o){var u;if((u=s._getRecaptchaConfig())!=null&&u.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await m_(s,e,t,t==="getOobCode");return a(s,d)}else return a(s,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const p=await m_(s,e,t,t==="getOobCode");return a(s,p)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _2(s,e){const t=ku(s,"auth");if(t.isInitialized()){const o=t.getImmediate(),u=t.getOptions();if(Ci(u,e??{}))return o;Nr(o,"already-initialized")}return t.initialize({options:e})}function rI(s,e){const t=(e==null?void 0:e.persistence)||[],a=(Array.isArray(t)?t:[t]).map(Ca);e!=null&&e.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(a,e==null?void 0:e.popupRedirectResolver)}function N2(s,e,t){const a=Rl(s);Ge(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const o=!1,u=T2(e),{host:d,port:p}=aI(e),x=p===null?"":`:${p}`,g={url:`${u}//${d}${x}/`},b=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!a._canInitEmulator){Ge(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Ge(Ci(g,a.config.emulator)&&Ci(b,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=g,a.emulatorConfig=b,a.settings.appVerificationDisabledForTesting=!0,ta(d)?(mf(`${u}//${d}${x}`),pf("Auth",!0)):iI()}function T2(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function aI(s){const e=T2(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(a);if(o){const u=o[1];return{host:u,port:p_(a.substr(u.length+1))}}else{const[u,d]=a.split(":");return{host:u,port:p_(d)}}}function p_(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function iI(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Sa("not implemented")}_getIdTokenResponse(e){return Sa("not implemented")}_linkToIdToken(e,t){return Sa("not implemented")}_getReauthenticationResolver(e){return Sa("not implemented")}}async function lI(s,e){return za(s,"POST","/v1/accounts:update",e)}async function oI(s,e){return za(s,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cI(s,e){return qu(s,"POST","/v1/accounts:signInWithPassword",zi(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uI(s,e){return qu(s,"POST","/v1/accounts:signInWithEmailLink",zi(s,e))}async function dI(s,e){return qu(s,"POST","/v1/accounts:signInWithEmailLink",zi(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo extends Vf{constructor(e,t,a,o=null){super("password",a),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Fo(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new Fo(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $g(e,t,"signInWithPassword",cI);case"emailLink":return uI(e,{email:this._email,oobCode:this._password});default:Nr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $g(e,a,"signUpPassword",oI);case"emailLink":return dI(e,{idToken:t,email:this._email,oobCode:this._password});default:Nr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ao(s,e){return qu(s,"POST","/v1/accounts:signInWithIdp",zi(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI="http://localhost";class Vi extends Vf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Vi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Nr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:o,...u}=t;if(!a||!o)return null;const d=new Vi(a,o);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Ao(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,Ao(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ao(e,t)}buildRequest(){const e={requestUri:hI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ru(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function mI(s){const e=eu(tu(s)).link,t=e?eu(tu(e)).deep_link_id:null,a=eu(tu(s)).deep_link_id;return(a?eu(tu(a)).link:null)||a||t||e||s}class Pf{constructor(e){const t=eu(tu(e)),a=t.apiKey??null,o=t.oobCode??null,u=fI(t.mode??null);Ge(a&&o&&u,"argument-error"),this.apiKey=a,this.operation=u,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=mI(e);try{return new Pf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(){this.providerId=Bi.PROVIDER_ID}static credential(e,t){return Fo._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=Pf.parseLink(t);return Ge(a,"argument-error"),Fo._fromEmailAndCode(e,a.code,a.tenantId)}}Bi.PROVIDER_ID="password";Bi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Bi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u extends j2{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a extends $u{constructor(){super("facebook.com")}static credential(e){return Vi._fromParams({providerId:_a.PROVIDER_ID,signInMethod:_a.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _a.credentialFromTaggedObject(e)}static credentialFromError(e){return _a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _a.credential(e.oauthAccessToken)}catch{return null}}}_a.FACEBOOK_SIGN_IN_METHOD="facebook.com";_a.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na extends $u{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Vi._fromParams({providerId:Na.PROVIDER_ID,signInMethod:Na.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Na.credentialFromTaggedObject(e)}static credentialFromError(e){return Na.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return Na.credential(t,a)}catch{return null}}}Na.GOOGLE_SIGN_IN_METHOD="google.com";Na.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta extends $u{constructor(){super("github.com")}static credential(e){return Vi._fromParams({providerId:Ta.PROVIDER_ID,signInMethod:Ta.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ta.credentialFromTaggedObject(e)}static credentialFromError(e){return Ta.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ta.credential(e.oauthAccessToken)}catch{return null}}}Ta.GITHUB_SIGN_IN_METHOD="github.com";Ta.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja extends $u{constructor(){super("twitter.com")}static credential(e,t){return Vi._fromParams({providerId:ja.PROVIDER_ID,signInMethod:ja.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ja.credentialFromTaggedObject(e)}static credentialFromError(e){return ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return ja.credential(t,a)}catch{return null}}}ja.TWITTER_SIGN_IN_METHOD="twitter.com";ja.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pI(s,e){return qu(s,"POST","/v1/accounts:signUp",zi(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,o=!1){const u=await yr._fromIdTokenResponse(e,a,o),d=g_(a);return new wl({user:u,providerId:d,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const o=g_(a);return new wl({user:e,providerId:o,_tokenResponse:a,operationType:t})}}function g_(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends Tr{constructor(e,t,a,o){super(t.code,t.message),this.operationType=a,this.user=o,Object.setPrototypeOf(this,tf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,o){return new tf(e,t,a,o)}}function E2(s,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?tf._fromErrorAndOperation(s,u,e,a):u})}async function gI(s,e,t=!1){const a=await Ho(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return wl._forOperation(s,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S2(s,e,t=!1){const{auth:a}=s;if(gs(a.app))return Promise.reject(ka(a));const o="reauthenticate";try{const u=await Ho(s,E2(a,o,e,s),t);Ge(u.idToken,a,"internal-error");const d=Y0(u.idToken);Ge(d,a,"internal-error");const{sub:p}=d;return Ge(s.uid===p,a,"user-mismatch"),wl._forOperation(s,o,u)}catch(u){throw(u==null?void 0:u.code)==="auth/user-not-found"&&Nr(a,"user-mismatch"),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C2(s,e,t=!1){if(gs(s.app))return Promise.reject(ka(s));const a="signIn",o=await E2(s,a,e),u=await wl._fromIdTokenResponse(s,a,o);return t||await s._updateCurrentUser(u.user),u}async function A2(s,e){return C2(Rl(s),e)}async function R2(s,e){return S2(St(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k2(s){const e=Rl(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function I2(s,e,t){if(gs(s.app))return Promise.reject(ka(s));const a=Rl(s),d=await $g(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",pI).catch(x=>{throw x.code==="auth/password-does-not-meet-requirements"&&k2(s),x}),p=await wl._fromIdTokenResponse(a,"signIn",d);return await a._updateCurrentUser(p.user),p}function D2(s,e,t){return gs(s.app)?Promise.reject(ka(s)):A2(St(s),Bi.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&k2(s),a})}function O2(s,e){return xI(St(s),null,e)}async function xI(s,e,t){const{auth:a}=s,u={idToken:await s.getIdToken(),returnSecureToken:!0};t&&(u.password=t);const d=await Ho(s,lI(a,u));await s._updateTokensIfNecessary(d,!0)}function M2(s,e,t,a){return St(s).onIdTokenChanged(e,t,a)}function V2(s,e,t){return St(s).beforeAuthStateChanged(e,t)}function P2(s,e,t,a){return St(s).onAuthStateChanged(e,t,a)}function L2(s){return St(s).signOut()}const nf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(nf,"1"),this.storage.removeItem(nf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI=1e3,bI=10;class z2 extends U2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=y2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),o=this.localCache[t];a!==o&&e(t,o,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,x)=>{this.notifyListeners(d,x)});return}const a=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(a);!t&&this.localCache[a]===d||this.notifyListeners(a,d)},u=this.storage.getItem(a);q3()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,bI):o()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},yI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}z2.type="LOCAL";const B2=z2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2 extends U2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}H2.type="SESSION";const X0=H2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vI(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const a=new Lf(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:o,data:u}=t.data,d=this.handlersMap[o];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:o});const p=Array.from(d).map(async g=>g(t.origin,u)),x=await vI(p);t.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:x})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Lf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(s="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let u,d;return new Promise((p,x)=>{const g=W0("",20);o.port1.start();const b=setTimeout(()=>{x(new Error("unsupported_event"))},a);d={messageChannel:o,onMessage(w){const N=w;if(N.data.eventId===g)switch(N.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{x(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(N.data.response);break;default:clearTimeout(b),clearTimeout(u),x(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(){return window}function _I(s){Xr().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F2(){return typeof Xr().WorkerGlobalScope<"u"&&typeof Xr().importScripts=="function"}async function NI(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function TI(){var s;return((s=navigator==null?void 0:navigator.serviceWorker)==null?void 0:s.controller)||null}function jI(){return F2()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q2="firebaseLocalStorageDb",EI=1,sf="firebaseLocalStorage",$2="fbase_key";class Ku{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Uf(s,e){return s.transaction([sf],e?"readwrite":"readonly").objectStore(sf)}function SI(){const s=indexedDB.deleteDatabase(q2);return new Ku(s).toPromise()}function Kg(){const s=indexedDB.open(q2,EI);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const a=s.result;try{a.createObjectStore(sf,{keyPath:$2})}catch(o){t(o)}}),s.addEventListener("success",async()=>{const a=s.result;a.objectStoreNames.contains(sf)?e(a):(a.close(),await SI(),e(await Kg()))})})}async function x_(s,e,t){const a=Uf(s,!0).put({[$2]:e,value:t});return new Ku(a).toPromise()}async function CI(s,e){const t=Uf(s,!1).get(e),a=await new Ku(t).toPromise();return a===void 0?null:a.value}function y_(s,e){const t=Uf(s,!0).delete(e);return new Ku(t).toPromise()}const AI=800,RI=3;class K2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Kg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>RI)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return F2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Lf._getInstance(jI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,a;if(this.activeServiceWorker=await NI(),!this.activeServiceWorker)return;this.sender=new wI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(a=e[0])!=null&&a.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||TI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Kg();return await x_(e,nf,"1"),await y_(e,nf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>x_(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>CI(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>y_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const u=Uf(o,!1).getAll();return new Ku(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:o,value:u}of e)a.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(u)&&(this.notifyListeners(o,u),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!a.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),AI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}K2.type="LOCAL";const G2=K2;new Fu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(s,e){return e?Ca(e):(Ge(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0 extends Vf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ao(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ao(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ao(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function II(s){return C2(s.auth,new J0(s),s.bypassAuthState)}function DI(s){const{auth:e,user:t}=s;return Ge(t,e,"internal-error"),S2(t,new J0(s),s.bypassAuthState)}async function OI(s){const{auth:e,user:t}=s;return Ge(t,e,"internal-error"),gI(t,new J0(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,t,a,o,u=!1){this.auth=e,this.resolver=a,this.user=o,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:o,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const x={auth:this.auth,requestUri:t,sessionId:a,tenantId:u||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(x))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return II;case"linkViaPopup":case"linkViaRedirect":return OI;case"reauthViaPopup":case"reauthViaRedirect":return DI;default:Nr(this.auth,"internal-error")}}resolve(e){La(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){La(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI=new Fu(2e3,1e4);class To extends Y2{constructor(e,t,a,o,u){super(e,t,o,u),this.provider=a,this.authWindow=null,this.pollId=null,To.currentPopupAction&&To.currentPopupAction.cancel(),To.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ge(e,this.auth,"internal-error"),e}async onExecution(){La(this.filter.length===1,"Popup operations only handle one event");const e=W0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Qr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Qr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,To.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if((a=(t=this.authWindow)==null?void 0:t.window)!=null&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,MI.get())};e()}}To.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI="pendingRedirect",Dh=new Map;class PI extends Y2{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=Dh.get(this.auth._key());if(!e){try{const a=await LI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}Dh.set(this.auth._key(),e)}return this.bypassAuthState||Dh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function LI(s,e){const t=BI(e),a=zI(s);if(!await a._isAvailable())return!1;const o=await a._get(t)==="true";return await a._remove(t),o}function UI(s,e){Dh.set(s._key(),e)}function zI(s){return Ca(s._redirectPersistence)}function BI(s){return Ih(VI,s.config.apiKey,s.name)}async function HI(s,e,t=!1){if(gs(s.app))return Promise.reject(ka(s));const a=Rl(s),o=kI(a,e),d=await new PI(a,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await a._persistUserIfCurrent(d.user),await a._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI=600*1e3;class qI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$I(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!Q2(e)){const o=((a=e.error.code)==null?void 0:a.split("auth/")[1])||"internal-error";t.onError(Qr(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=FI&&this.cachedEventUids.clear(),this.cachedEventUids.has(b_(e))}saveEventToCache(e){this.cachedEventUids.add(b_(e)),this.lastProcessedEventTime=Date.now()}}function b_(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function Q2({type:s,error:e}){return s==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function $I(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Q2(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KI(s,e={}){return za(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,YI=/^https?/;async function QI(s){if(s.config.emulator)return;const{authorizedDomains:e}=await KI(s);for(const t of e)try{if(XI(t))return}catch{}Nr(s,"unauthorized-domain")}function XI(s){const e=Hg(),{protocol:t,hostname:a}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&a===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===a}if(!YI.test(t))return!1;if(GI.test(s))return a===s;const o=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI=new Fu(3e4,6e4);function v_(){const s=Xr().___jsl;if(s!=null&&s.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function JI(s){return new Promise((e,t)=>{var o,u,d;function a(){v_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{v_(),t(Qr(s,"network-request-failed"))},timeout:WI.get()})}if((u=(o=Xr().gapi)==null?void 0:o.iframes)!=null&&u.Iframe)e(gapi.iframes.getContext());else if((d=Xr().gapi)!=null&&d.load)a();else{const p=Z3("iframefcb");return Xr()[p]=()=>{gapi.load?a():t(Qr(s,"network-request-failed"))},v2(`${J3()}?onload=${p}`).catch(x=>t(x))}}).catch(e=>{throw Oh=null,e})}let Oh=null;function ZI(s){return Oh=Oh||JI(s),Oh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e6=new Fu(5e3,15e3),t6="__/auth/iframe",n6="emulator/auth/iframe",s6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},r6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function a6(s){const e=s.config;Ge(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?G0(e,n6):`https://${s.config.authDomain}/${t6}`,a={apiKey:e.apiKey,appName:s.name,v:jl},o=r6.get(s.config.apiHost);o&&(a.eid=o);const u=s._getFrameworks();return u.length&&(a.fw=u.join(",")),`${t}?${Ru(a).slice(1)}`}async function i6(s){const e=await ZI(s),t=Xr().gapi;return Ge(t,s,"internal-error"),e.open({where:document.body,url:a6(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:s6,dontclear:!0},a=>new Promise(async(o,u)=>{await a.restyle({setHideOnLeave:!1});const d=Qr(s,"network-request-failed"),p=Xr().setTimeout(()=>{u(d)},e6.get());function x(){Xr().clearTimeout(p),o(a)}a.ping(x).then(x,()=>{u(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},o6=500,c6=600,u6="_blank",d6="http://localhost";class w_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function h6(s,e,t,a=o6,o=c6){const u=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-a)/2,0).toString();let p="";const x={...l6,width:a.toString(),height:o.toString(),top:u,left:d},g=Xn().toLowerCase();t&&(p=f2(g)?u6:t),d2(g)&&(e=e||d6,x.scrollbars="yes");const b=Object.entries(x).reduce((N,[R,D])=>`${N}${R}=${D},`,"");if(F3(g)&&p!=="_self")return f6(e||"",p),new w_(null);const w=window.open(e||"",p,b);Ge(w,s,"popup-blocked");try{w.focus()}catch{}return new w_(w)}function f6(s,e){const t=document.createElement("a");t.href=s,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6="__/auth/handler",p6="emulator/auth/handler",g6=encodeURIComponent("fac");async function __(s,e,t,a,o,u){Ge(s.config.authDomain,s,"auth-domain-config-required"),Ge(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:a,v:jl,eventId:o};if(e instanceof j2){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",r5(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,w]of Object.entries({}))d[b]=w}if(e instanceof $u){const b=e.getScopes().filter(w=>w!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const p=d;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const x=await s._getAppCheckToken(),g=x?`#${g6}=${encodeURIComponent(x)}`:"";return`${x6(s)}?${Ru(p).slice(1)}${g}`}function x6({config:s}){return s.emulator?G0(s,p6):`https://${s.authDomain}/${m6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ig="webStorageSupport";class y6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=X0,this._completeRedirectFn=HI,this._overrideRedirectResult=UI}async _openPopup(e,t,a,o){var d;La((d=this.eventManagers[e._key()])==null?void 0:d.manager,"_initialize() not called before _openPopup()");const u=await __(e,t,a,Hg(),o);return h6(e,u,W0())}async _openRedirect(e,t,a,o){await this._originValidation(e);const u=await __(e,t,a,Hg(),o);return _I(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:u}=this.eventManagers[t];return o?Promise.resolve(o):(La(u,"If manager is not set, promise should be"),u)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await i6(e),a=new qI(e);return t.register("authEvent",o=>(Ge(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:a.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ig,{type:ig},o=>{var d;const u=(d=o==null?void 0:o[0])==null?void 0:d[ig];u!==void 0&&t(!!u),Nr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=QI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return y2()||h2()||Q0()}}const X2=y6;var N_="@firebase/auth",T_="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e((a==null?void 0:a.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v6(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function w6(s){Ai(new Oa("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=a.options;Ge(d&&!d.includes(":"),"invalid-api-key",{appName:a.name});const x={apiKey:d,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:b2(s)},g=new Q3(a,o,u,x);return rI(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),Ai(new Oa("auth-internal",e=>{const t=Rl(e.getProvider("auth").getImmediate());return(a=>new b6(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),tr(N_,T_,v6(s)),tr(N_,T_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6=300,N6=x1("authIdTokenMaxAge")||_6;let j_=null;const T6=s=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>N6)return;const o=t==null?void 0:t.token;j_!==o&&(j_=o,await fetch(s,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function Tu(s=gf()){const e=ku(s,"auth");if(e.isInitialized())return e.getImmediate();const t=_2(s,{popupRedirectResolver:X2,persistence:[G2,B2,X0]}),a=x1("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(a,location.origin);if(location.origin===u.origin){const d=T6(u.toString());V2(t,d,()=>d(t.currentUser)),M2(t,p=>d(p))}}const o=p1("auth");return o&&N2(t,`http://${o}`),t}function j6(){var s;return((s=document.getElementsByTagName("head"))==null?void 0:s[0])??document}X3({loadJS(s){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",s),a.onload=e,a.onerror=o=>{const u=Qr("internal-error");u.customData=o,t(u)},a.type="text/javascript",a.charset="UTF-8",j6().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});w6("Browser");const E6=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Pf,AuthCredential:Vf,EmailAuthCredential:Fo,EmailAuthProvider:Bi,FacebookAuthProvider:_a,GithubAuthProvider:Ta,GoogleAuthProvider:Na,OAuthCredential:Vi,TwitterAuthProvider:ja,beforeAuthStateChanged:V2,browserLocalPersistence:B2,browserPopupRedirectResolver:X2,browserSessionPersistence:X0,connectAuthEmulator:N2,createUserWithEmailAndPassword:I2,getAuth:Tu,getIdTokenResult:l2,inMemoryPersistence:qg,indexedDBLocalPersistence:G2,initializeAuth:_2,onAuthStateChanged:P2,onIdTokenChanged:M2,prodErrorMap:t2,reauthenticateWithCredential:R2,reload:o2,signInWithCredential:A2,signInWithEmailAndPassword:D2,signOut:L2,updatePassword:O2},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6="type.googleapis.com/google.protobuf.Int64Value",C6="type.googleapis.com/google.protobuf.UInt64Value";function W2(s,e){const t={};for(const a in s)s.hasOwnProperty(a)&&(t[a]=e(s[a]));return t}function rf(s){if(s==null)return null;if(s instanceof Number&&(s=s.valueOf()),typeof s=="number"&&isFinite(s)||s===!0||s===!1||Object.prototype.toString.call(s)==="[object String]")return s;if(s instanceof Date)return s.toISOString();if(Array.isArray(s))return s.map(e=>rf(e));if(typeof s=="function"||typeof s=="object")return W2(s,e=>rf(e));throw new Error("Data cannot be encoded in JSON: "+s)}function qo(s){if(s==null)return s;if(s["@type"])switch(s["@type"]){case S6:case C6:{const e=Number(s.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+s);return e}default:throw new Error("Data cannot be decoded from JSON: "+s)}return Array.isArray(s)?s.map(e=>qo(e)):typeof s=="function"||typeof s=="object"?W2(s,e=>qo(e)):s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ns extends Tr{constructor(e,t,a){super(`${Z0}/${e}`,t||""),this.details=a,Object.setPrototypeOf(this,ns.prototype)}}function A6(s){if(s>=200&&s<300)return"ok";switch(s){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function af(s,e){let t=A6(s),a=t,o;try{const u=e&&e.error;if(u){const d=u.status;if(typeof d=="string"){if(!E_[d])return new ns("internal","internal");t=E_[d],a=d}const p=u.message;typeof p=="string"&&(a=p),o=u.details,o!==void 0&&(o=qo(o))}}catch{}return t==="ok"?null:new ns(t,a,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e,t,a,o){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,gs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=a.getImmediate({optional:!0}),this.auth||t.get().then(u=>this.auth=u,()=>{}),this.messaging||a.get().then(u=>this.messaging=u,()=>{}),this.appCheck||o==null||o.get().then(u=>this.appCheck=u,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),a=await this.getMessagingToken(),o=await this.getAppCheckToken(e);return{authToken:t,messagingToken:a,appCheckToken:o}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg="us-central1",k6=/^data: (.*?)(?:\n|$)/;function I6(s){let e=null;return{promise:new Promise((t,a)=>{e=setTimeout(()=>{a(new ns("deadline-exceeded","deadline-exceeded"))},s)}),cancel:()=>{e&&clearTimeout(e)}}}class D6{constructor(e,t,a,o,u=Gg,d=(...p)=>fetch(...p)){this.app=e,this.fetchImpl=d,this.emulatorOrigin=null,this.contextProvider=new R6(e,t,a,o),this.cancelAllRequests=new Promise(p=>{this.deleteService=()=>Promise.resolve(p())});try{const p=new URL(u);this.customDomain=p.origin+(p.pathname==="/"?"":p.pathname),this.region=Gg}catch{this.customDomain=null,this.region=u}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function O6(s,e,t){const a=ta(e);s.emulatorOrigin=`http${a?"s":""}://${e}:${t}`,a&&(mf(s.emulatorOrigin+"/backends"),pf("Functions",!0))}function M6(s,e,t){const a=o=>P6(s,e,o,t||{});return a.stream=(o,u)=>U6(s,e,o,u),a}function J2(s){return s.emulatorOrigin&&ta(s.emulatorOrigin)?"include":void 0}async function V6(s,e,t,a,o){t["Content-Type"]="application/json";let u;try{u=await a(s,{method:"POST",body:JSON.stringify(e),headers:t,credentials:J2(o)})}catch{return{status:0,json:null}}let d=null;try{d=await u.json()}catch{}return{status:u.status,json:d}}async function Z2(s,e){const t={},a=await s.contextProvider.getContext(e.limitedUseAppCheckTokens);return a.authToken&&(t.Authorization="Bearer "+a.authToken),a.messagingToken&&(t["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=a.appCheckToken),t}function P6(s,e,t,a){const o=s._url(e);return L6(s,o,t,a)}async function L6(s,e,t,a){t=rf(t);const o={data:t},u=await Z2(s,a),d=a.timeout||7e4,p=I6(d),x=await Promise.race([V6(e,o,u,s.fetchImpl,s),p.promise,s.cancelAllRequests]);if(p.cancel(),!x)throw new ns("cancelled","Firebase Functions instance was deleted.");const g=af(x.status,x.json);if(g)throw g;if(!x.json)throw new ns("internal","Response is not valid JSON object.");let b=x.json.data;if(typeof b>"u"&&(b=x.json.result),typeof b>"u")throw new ns("internal","Response is missing data field.");return{data:qo(b)}}function U6(s,e,t,a){const o=s._url(e);return z6(s,o,t,a||{})}async function z6(s,e,t,a){var N;t=rf(t);const o={data:t},u=await Z2(s,a);u["Content-Type"]="application/json",u.Accept="text/event-stream";let d;try{d=await s.fetchImpl(e,{method:"POST",body:JSON.stringify(o),headers:u,signal:a==null?void 0:a.signal,credentials:J2(s)})}catch(R){if(R instanceof Error&&R.name==="AbortError"){const q=new ns("cancelled","Request was cancelled.");return{data:Promise.reject(q),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(q)}}}}}}const D=af(0,null);return{data:Promise.reject(D),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(D)}}}}}}let p,x;const g=new Promise((R,D)=>{p=R,x=D});(N=a==null?void 0:a.signal)==null||N.addEventListener("abort",()=>{const R=new ns("cancelled","Request was cancelled.");x(R)});const b=d.body.getReader(),w=B6(b,p,x,a==null?void 0:a.signal);return{stream:{[Symbol.asyncIterator](){const R=w.getReader();return{async next(){const{value:D,done:q}=await R.read();return{value:D,done:q}},async return(){return await R.cancel(),{done:!0,value:void 0}}}}},data:g}}function B6(s,e,t,a){const o=(d,p)=>{const x=d.match(k6);if(!x)return;const g=x[1];try{const b=JSON.parse(g);if("result"in b){e(qo(b.result));return}if("message"in b){p.enqueue(qo(b.message));return}if("error"in b){const w=af(0,b);p.error(w),t(w);return}}catch(b){if(b instanceof ns){p.error(b),t(b);return}}},u=new TextDecoder;return new ReadableStream({start(d){let p="";return x();async function x(){if(a!=null&&a.aborted){const g=new ns("cancelled","Request was cancelled");return d.error(g),t(g),Promise.resolve()}try{const{value:g,done:b}=await s.read();if(b){p.trim()&&o(p.trim(),d),d.close();return}if(a!=null&&a.aborted){const N=new ns("cancelled","Request was cancelled");d.error(N),t(N),await s.cancel();return}p+=u.decode(g,{stream:!0});const w=p.split(`
`);p=w.pop()||"";for(const N of w)N.trim()&&o(N.trim(),d);return x()}catch(g){const b=g instanceof ns?g:af(0,null);d.error(b),t(b)}}},cancel(){return s.cancel()}})}const S_="@firebase/functions",C_="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6="auth-internal",F6="app-check-internal",q6="messaging-internal";function $6(s){const e=(t,{instanceIdentifier:a})=>{const o=t.getProvider("app").getImmediate(),u=t.getProvider(H6),d=t.getProvider(q6),p=t.getProvider(F6);return new D6(o,u,d,p,a)};Ai(new Oa(Z0,e,"PUBLIC").setMultipleInstances(!0)),tr(S_,C_,s),tr(S_,C_,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(s=gf(),e=Gg){const a=ku(St(s),Z0).getImmediate({identifier:e}),o=r0("functions");return o&&tT(a,...o),a}function tT(s,e,t){O6(St(s),e,t)}function K6(s,e,t){return M6(St(s),e,t)}$6();const nT=Object.freeze(Object.defineProperty({__proto__:null,FunctionsError:ns,connectFunctionsEmulator:tT,getFunctions:eT,httpsCallable:K6},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT="firebasestorage.googleapis.com",rT="storageBucket",G6=120*1e3,Y6=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn extends Tr{constructor(e,t,a=0){super(lg(e),`Firebase Storage: ${t} (${lg(e)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,rn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return lg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var sn;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(sn||(sn={}));function lg(s){return"storage/"+s}function ex(){const s="An unknown error occurred, please check the error payload for server response.";return new rn(sn.UNKNOWN,s)}function Q6(s){return new rn(sn.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function X6(s){return new rn(sn.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function W6(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new rn(sn.UNAUTHENTICATED,s)}function J6(){return new rn(sn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Z6(s){return new rn(sn.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function eD(){return new rn(sn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function tD(){return new rn(sn.CANCELED,"User canceled the upload/download.")}function nD(s){return new rn(sn.INVALID_URL,"Invalid URL '"+s+"'.")}function sD(s){return new rn(sn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function rD(){return new rn(sn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+rT+"' property when initializing the app?")}function aD(){return new rn(sn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function iD(){return new rn(sn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function lD(s){return new rn(sn.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Yg(s){return new rn(sn.INVALID_ARGUMENT,s)}function aT(){return new rn(sn.APP_DELETED,"The Firebase app was deleted.")}function oD(s){return new rn(sn.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function mu(s,e){return new rn(sn.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Zc(s){throw new rn(sn.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let a;try{a=Ps.makeFromUrl(e,t)}catch{return new Ps(e,"")}if(a.path==="")return a;throw sD(e)}static makeFromUrl(e,t){let a=null;const o="([A-Za-z0-9.\\-_]+)";function u(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+o+d,"i"),x={bucket:1,path:3};function g(z){z.path_=decodeURIComponent(z.path)}const b="v[A-Za-z0-9_]+",w=t.replace(/[.]/g,"\\."),N="(/([^?#]*).*)?$",R=new RegExp(`^https?://${w}/${b}/b/${o}/o${N}`,"i"),D={bucket:1,path:3},q=t===sT?"(?:storage.googleapis.com|storage.cloud.google.com)":t,L="([^?#]*)",W=new RegExp(`^https?://${q}/${o}/${L}`,"i"),$=[{regex:p,indices:x,postModify:u},{regex:R,indices:D,postModify:g},{regex:W,indices:{bucket:1,path:2},postModify:g}];for(let z=0;z<$.length;z++){const he=$[z],_e=he.regex.exec(e);if(_e){const S=_e[he.indices.bucket];let C=_e[he.indices.path];C||(C=""),a=new Ps(S,C),he.postModify(a);break}}if(a==null)throw nD(e);return a}}class cD{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uD(s,e,t){let a=1,o=null,u=null,d=!1,p=0;function x(){return p===2}let g=!1;function b(...L){g||(g=!0,e.apply(null,L))}function w(L){o=setTimeout(()=>{o=null,s(R,x())},L)}function N(){u&&clearTimeout(u)}function R(L,...W){if(g){N();return}if(L){N(),b.call(null,L,...W);return}if(x()||d){N(),b.call(null,L,...W);return}a<64&&(a*=2);let $;p===1?(p=2,$=0):$=(a+Math.random())*1e3,w($)}let D=!1;function q(L){D||(D=!0,N(),!g&&(o!==null?(L||(p=2),clearTimeout(o),w(0)):L||(p=1)))}return w(0),u=setTimeout(()=>{d=!0,q(!0)},t),q}function dD(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hD(s){return s!==void 0}function fD(s){return typeof s=="object"&&!Array.isArray(s)}function tx(s){return typeof s=="string"||s instanceof String}function A_(s){return nx()&&s instanceof Blob}function nx(){return typeof Blob<"u"}function R_(s,e,t,a){if(a<e)throw Yg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(a>t)throw Yg(`Invalid value for '${s}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sx(s,e,t){let a=e;return t==null&&(a=`https://${e}`),`${t}://${a}/v0${s}`}function iT(s){const e=encodeURIComponent;let t="?";for(const a in s)if(s.hasOwnProperty(a)){const o=e(a)+"="+e(s[a]);t=t+o+"&"}return t=t.slice(0,-1),t}var xl;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(xl||(xl={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mD(s,e){const t=s>=500&&s<600,o=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||o||u}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e,t,a,o,u,d,p,x,g,b,w,N=!0,R=!1){this.url_=e,this.method_=t,this.headers_=a,this.body_=o,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=x,this.timeout_=g,this.progressCallback_=b,this.connectionFactory_=w,this.retry=N,this.isUsingEmulator=R,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((D,q)=>{this.resolve_=D,this.reject_=q,this.start_()})}start_(){const e=(a,o)=>{if(o){a(!1,new wh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const x=p.loaded,g=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(x,g)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===xl.NO_ERROR,x=u.getStatus();if(!p||mD(x,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===xl.ABORT;a(!1,new wh(!1,null,b));return}const g=this.successCodes_.indexOf(x)!==-1;a(!0,new wh(g,u))})},t=(a,o)=>{const u=this.resolve_,d=this.reject_,p=o.connection;if(o.wasSuccessCode)try{const x=this.callback_(p,p.getResponse());hD(x)?u(x):u()}catch(x){d(x)}else if(p!==null){const x=ex();x.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,x)):d(x)}else if(o.canceled){const x=this.appDelete_?aT():tD();d(x)}else{const x=eD();d(x)}};this.canceled_?t(!1,new wh(!1,null,!0)):this.backoffId_=uD(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&dD(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class wh{constructor(e,t,a){this.wasSuccessCode=e,this.connection=t,this.canceled=!!a}}function gD(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function xD(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function yD(s,e){e&&(s["X-Firebase-GMPID"]=e)}function bD(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function vD(s,e,t,a,o,u,d=!0,p=!1){const x=iT(s.urlParams),g=s.url+x,b=Object.assign({},s.headers);return yD(b,e),gD(b,t),xD(b,u),bD(b,a),new pD(g,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,o,d,p)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function _D(...s){const e=wD();if(e!==void 0){const t=new e;for(let a=0;a<s.length;a++)t.append(s[a]);return t.getBlob()}else{if(nx())return new Blob(s);throw new rn(sn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function ND(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TD(s){if(typeof atob>"u")throw lD("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class og{constructor(e,t){this.data=e,this.contentType=t||null}}function jD(s,e){switch(s){case qr.RAW:return new og(lT(e));case qr.BASE64:case qr.BASE64URL:return new og(oT(s,e));case qr.DATA_URL:return new og(SD(e),CD(e))}throw ex()}function lT(s){const e=[];for(let t=0;t<s.length;t++){let a=s.charCodeAt(t);if(a<=127)e.push(a);else if(a<=2047)e.push(192|a>>6,128|a&63);else if((a&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=a,d=s.charCodeAt(++t);a=65536|(u&1023)<<10|d&1023,e.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|a&63)}else(a&64512)===56320?e.push(239,191,189):e.push(224|a>>12,128|a>>6&63,128|a&63)}return new Uint8Array(e)}function ED(s){let e;try{e=decodeURIComponent(s)}catch{throw mu(qr.DATA_URL,"Malformed data URL.")}return lT(e)}function oT(s,e){switch(s){case qr.BASE64:{const o=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(o||u)throw mu(s,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case qr.BASE64URL:{const o=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(o||u)throw mu(s,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=TD(e)}catch(o){throw o.message.includes("polyfill")?o:mu(s,"Invalid character found")}const a=new Uint8Array(t.length);for(let o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a}class cT{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw mu(qr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const a=t[1]||null;a!=null&&(this.base64=AD(a,";base64"),this.contentType=this.base64?a.substring(0,a.length-7):a),this.rest=e.substring(e.indexOf(",")+1)}}function SD(s){const e=new cT(s);return e.base64?oT(qr.BASE64,e.rest):ED(e.rest)}function CD(s){return new cT(s).contentType}function AD(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,t){let a=0,o="";A_(e)?(this.data_=e,a=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),a=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),a=e.length),this.size_=a,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(A_(this.data_)){const a=this.data_,o=ND(a,e,t);return o===null?null:new wi(o)}else{const a=new Uint8Array(this.data_.buffer,e,t-e);return new wi(a,!0)}}static getBlob(...e){if(nx()){const t=e.map(a=>a instanceof wi?a.data_:a);return new wi(_D.apply(null,t))}else{const t=e.map(d=>tx(d)?jD(qr.RAW,d).data:d.data_);let a=0;t.forEach(d=>{a+=d.byteLength});const o=new Uint8Array(a);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)o[u++]=d[p]}),new wi(o,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uT(s){let e;try{e=JSON.parse(s)}catch{return null}return fD(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RD(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function kD(s,e){const t=e.split("/").filter(a=>a.length>0).join("/");return s.length===0?t:s+"/"+t}function dT(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ID(s,e){return e}class ts{constructor(e,t,a,o){this.server=e,this.local=t||e,this.writable=!!a,this.xform=o||ID}}let _h=null;function DD(s){return!tx(s)||s.length<2?s:dT(s)}function hT(){if(_h)return _h;const s=[];s.push(new ts("bucket")),s.push(new ts("generation")),s.push(new ts("metageneration")),s.push(new ts("name","fullPath",!0));function e(u,d){return DD(d)}const t=new ts("name");t.xform=e,s.push(t);function a(u,d){return d!==void 0?Number(d):d}const o=new ts("size");return o.xform=a,s.push(o),s.push(new ts("timeCreated")),s.push(new ts("updated")),s.push(new ts("md5Hash",null,!0)),s.push(new ts("cacheControl",null,!0)),s.push(new ts("contentDisposition",null,!0)),s.push(new ts("contentEncoding",null,!0)),s.push(new ts("contentLanguage",null,!0)),s.push(new ts("contentType",null,!0)),s.push(new ts("metadata","customMetadata",!0)),_h=s,_h}function OD(s,e){function t(){const a=s.bucket,o=s.fullPath,u=new Ps(a,o);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function MD(s,e,t){const a={};a.type="file";const o=t.length;for(let u=0;u<o;u++){const d=t[u];a[d.local]=d.xform(a,e[d.server])}return OD(a,s),a}function fT(s,e,t){const a=uT(e);return a===null?null:MD(s,a,t)}function VD(s,e,t,a){const o=uT(e);if(o===null||!tx(o.downloadTokens))return null;const u=o.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(g=>{const b=s.bucket,w=s.fullPath,N="/b/"+d(b)+"/o/"+d(w),R=sx(N,t,a),D=iT({alt:"media",token:g});return R+D})[0]}function PD(s,e){const t={},a=e.length;for(let o=0;o<a;o++){const u=e[o];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}class mT{constructor(e,t,a,o){this.url=e,this.method=t,this.handler=a,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(s){if(!s)throw ex()}function LD(s,e){function t(a,o){const u=fT(s,o,e);return pT(u!==null),u}return t}function UD(s,e){function t(a,o){const u=fT(s,o,e);return pT(u!==null),VD(u,o,s.host,s._protocol)}return t}function gT(s){function e(t,a){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=J6():o=W6():t.getStatus()===402?o=X6(s.bucket):t.getStatus()===403?o=Z6(s.path):o=a,o.status=t.getStatus(),o.serverResponse=a.serverResponse,o}return e}function zD(s){const e=gT(s);function t(a,o){let u=e(a,o);return a.getStatus()===404&&(u=Q6(s.path)),u.serverResponse=o.serverResponse,u}return t}function BD(s,e,t){const a=e.fullServerUrl(),o=sx(a,s.host,s._protocol),u="GET",d=s.maxOperationRetryTime,p=new mT(o,u,UD(s,t),d);return p.errorHandler=zD(e),p}function HD(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function FD(s,e,t){const a=Object.assign({},t);return a.fullPath=s.path,a.size=e.size(),a.contentType||(a.contentType=HD(null,e)),a}function qD(s,e,t,a,o){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let $="";for(let z=0;z<2;z++)$=$+Math.random().toString().slice(2);return $}const x=p();d["Content-Type"]="multipart/related; boundary="+x;const g=FD(e,a,o),b=PD(g,t),w="--"+x+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+x+`\r
Content-Type: `+g.contentType+`\r
\r
`,N=`\r
--`+x+"--",R=wi.getBlob(w,a,N);if(R===null)throw aD();const D={name:g.fullPath},q=sx(u,s.host,s._protocol),L="POST",W=s.maxUploadRetryTime,re=new mT(q,L,LD(s,t),W);return re.urlParams=D,re.headers=d,re.body=R.uploadData(),re.errorHandler=gT(e),re}class $D{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=xl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=xl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=xl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,a,o,u){if(this.sent_)throw Zc("cannot .send() more than once");if(ta(e)&&a&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Zc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Zc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Zc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Zc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class KD extends $D{initXhr(){this.xhr_.responseType="text"}}function xT(){return new KD}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,t){this._service=e,t instanceof Ps?this._location=t:this._location=Ps.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new _l(e,t)}get root(){const e=new Ps(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return dT(this._location.path)}get storage(){return this._service}get parent(){const e=RD(this._location.path);if(e===null)return null;const t=new Ps(this._location.bucket,e);return new _l(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw oD(e)}}function GD(s,e,t){s._throwIfRoot("uploadBytes");const a=qD(s.storage,s._location,hT(),new wi(e,!0),t);return s.storage.makeRequestWithTokens(a,xT).then(o=>({metadata:o,ref:s}))}function YD(s){s._throwIfRoot("getDownloadURL");const e=BD(s.storage,s._location,hT());return s.storage.makeRequestWithTokens(e,xT).then(t=>{if(t===null)throw iD();return t})}function QD(s,e){const t=kD(s._location.path,e),a=new Ps(s._location.bucket,t);return new _l(s.storage,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(s){return/^[A-Za-z]+:\/\//.test(s)}function WD(s,e){return new _l(s,e)}function yT(s,e){if(s instanceof rx){const t=s;if(t._bucket==null)throw rD();const a=new _l(t,t._bucket);return e!=null?yT(a,e):a}else return e!==void 0?QD(s,e):s}function JD(s,e){if(e&&XD(e)){if(s instanceof rx)return WD(s,e);throw Yg("To use ref(service, url), the first argument must be a Storage instance.")}else return yT(s,e)}function k_(s,e){const t=e==null?void 0:e[rT];return t==null?null:Ps.makeFromBucketSpec(t,s)}function ZD(s,e,t,a={}){s.host=`${e}:${t}`;const o=ta(e);o&&(mf(`https://${s.host}/b`),pf("Storage",!0)),s._isUsingEmulator=!0,s._protocol=o?"https":"http";const{mockUserToken:u}=a;u&&(s._overrideAuthToken=typeof u=="string"?u:y1(u,s.app.options.projectId))}class rx{constructor(e,t,a,o,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=a,this._url=o,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=sT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=G6,this._maxUploadRetryTime=Y6,this._requests=new Set,o!=null?this._bucket=Ps.makeFromBucketSpec(o,this._host):this._bucket=k_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ps.makeFromBucketSpec(this._url,e):this._bucket=k_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){R_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){R_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(gs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new _l(this,e)}_makeRequest(e,t,a,o,u=!0){if(this._deleted)return new cD(aT());{const d=vD(e,this._appId,a,o,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[a,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,a,o).getPromise()}}const I_="@firebase/storage",D_="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT="storage";function nr(s,e,t){return s=St(s),GD(s,e,t)}function sr(s){return s=St(s),YD(s)}function rr(s,e){return s=St(s),JD(s,e)}function eO(s=gf(),e){s=St(s);const a=ku(s,bT).getImmediate({identifier:e}),o=r0("storage");return o&&tO(a,...o),a}function tO(s,e,t,a={}){ZD(s,e,t,a)}function nO(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),a=s.getProvider("auth-internal"),o=s.getProvider("app-check-internal");return new rx(t,a,o,e,jl)}function sO(){Ai(new Oa(bT,nO,"PUBLIC").setMultipleInstances(!0)),tr(I_,D_,""),tr(I_,D_,"esm2020")}sO();const ax={apiKey:"AIzaSyAfqqFbf2AVCOOm8Trm57qTSpWoAk-Jbx4",authDomain:"vang-anh-bd21c.firebaseapp.com",projectId:"vang-anh-bd21c",storageBucket:"vang-anh-bd21c.firebasestorage.app",messagingSenderId:"246040395102",appId:"1:246040395102:web:83653e18267f8eb242e3cf"},zf=l0(ax),Ae=m3(zf),Mh=Tu(zf),rO=eT(zf),Ls=eO(zf),vT=Object.freeze(Object.defineProperty({__proto__:null,auth:Mh,db:Ae,firebaseConfig:ax,functions:rO,storage:Ls},Symbol.toStringTag,{value:"Module"})),wT=T.createContext(void 0),aO=({children:s})=>{const[e,t]=T.useState(null),[a,o]=T.useState(!0);T.useEffect(()=>{const p=P2(Mh,async x=>{if(x)try{const g=qe(Ae,"users",x.uid),b=await vr(g);if(b.exists())t({id:b.id,...b.data()});else if(x.email){const w=mn(Tt(Ae,"users"),bs("email","==",x.email)),N=await wr(w);if(N.empty)console.warn("User found in Auth but not in Firestore (ID or Email mismatch)"),t(null);else{const R=N.docs[0].data();t({id:N.docs[0].id,...R})}}else t(null)}catch(g){console.error("Error fetching user data:",g),t(null)}else t(null);o(!1)});return()=>p()},[]);const u=async(p,x)=>{try{if(!x)throw new Error("Password is required for Firebase Auth");let g=p;if(!p.includes("@"))try{const{httpsCallable:b}=await lu(async()=>{const{httpsCallable:q}=await Promise.resolve().then(()=>nT);return{httpsCallable:q}},[]),{functions:w}=await lu(async()=>{const{functions:q}=await Promise.resolve().then(()=>vT);return{functions:q}},void 0);g=(await b(w,"getEmailByUsername")({username:p})).data.email}catch(b){console.error("Username lookup failed:",b);const w=mn(Tt(Ae,"users"),bs("username","==",p)),N=await wr(w);if(N.empty)return console.error("Username not found"),!1;const R=N.docs[0].data();R.email&&(g=R.email)}return await D2(Mh,g,x),!0}catch(g){return console.error("Login failed:",g),!1}},d=async()=>{try{await L2(Mh),t(null)}catch(p){console.error("Logout failed:",p)}};return i.jsx(wT.Provider,{value:{user:e,login:u,logout:d,isAuthenticated:!!e,loading:a},children:!a&&s})},vs=()=>{const s=T.useContext(wT);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},_T=T.createContext(void 0),iO=({toasts:s,removeToast:e})=>i.jsx("div",{className:"fixed top-4 right-4 z-[100] flex flex-col gap-3 pointer-events-none",children:s.map(t=>i.jsxs("div",{className:"pointer-events-auto w-80 bg-white rounded-xl shadow-2xl border-l-4 border-green-500 overflow-hidden animate-in slide-in-from-right duration-300 relative",children:[i.jsxs("div",{className:"p-4 flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 mt-0.5",children:i.jsx("div",{className:"h-6 w-6 rounded-full bg-green-100 flex items-center justify-center",children:i.jsx(iu,{className:"h-4 w-4 text-green-600"})})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-bold text-gray-900",children:t.message}),t.subMessage&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t.subMessage})]}),i.jsx("button",{onClick:()=>e(t.id),className:"text-gray-400 hover:text-gray-600",children:i.jsx(fn,{className:"h-4 w-4"})})]}),i.jsx("div",{className:"h-1 w-full bg-gray-100",children:i.jsx("div",{className:"h-full bg-green-500 animate-[width_3s_linear_forwards] w-full origin-left"})}),i.jsx("style",{children:`
            @keyframes width {
              from { width: 100%; }
              to { width: 0%; }
            }
          `})]},t.id))}),lO=s=>{const e=new Date(s),a=Math.floor((new Date().getTime()-e.getTime())/1e3);return a<60?"Va xong":a<3600?`${Math.floor(a/60)} pht trc`:a<86400?`${Math.floor(a/3600)} gi trc`:`${Math.floor(a/86400)} ngy trc`},oO=({children:s})=>{const{user:e}=vs(),[t,a]=T.useState([]),[o,u]=T.useState([]);T.useEffect(()=>{const N=setTimeout(()=>{d("Cho mng quay tr li!","H thng  sn sng lm vic.","success")},1e3);return()=>clearTimeout(N)},[]),T.useEffect(()=>{if(!e){u([]);return}const N=mn(Tt(Ae,"notifications"),bs("receivers","array-contains",e.id),Jo("createdAt","desc")),R=zs(N,D=>{const q=D.docs.map(L=>{var re;const W=L.data();return{id:L.id,type:W.type,user:W.senderName,avatar:W.senderAvatar,content:W.message.replace(W.senderName,"").trim(),time:lO(W.createdAt),isRead:W.isRead,fileType:(re=W.metadata)==null?void 0:re.fileType,targetPath:W.targetPath}});u(q)});return()=>R()},[e]);const d=(N,R="",D="success")=>{const q=Date.now().toString();a(L=>[...L,{id:q,message:N,subMessage:R,type:D}]),setTimeout(()=>{a(L=>L.filter(W=>W.id!==q))},3e3)},p=N=>{a(R=>R.filter(D=>D.id!==N))},x=async N=>{u(R=>R.map(D=>D.id===N?{...D,isRead:!0}:D));try{const R=qe(Ae,"notifications",N);await Qt(R,{isRead:!0})}catch(R){console.error("Error marking notification as read:",R)}},g=async()=>{u(R=>R.map(D=>({...D,isRead:!0}))),o.filter(R=>!R.isRead).map(R=>R.id).forEach(async R=>{try{await Qt(qe(Ae,"notifications",R),{isRead:!0})}catch(D){console.error(D)}})},b=N=>{u(R=>R.filter(D=>D.id!==N))},w=o.filter(N=>!N.isRead).length;return i.jsxs(_T.Provider,{value:{addToast:d,notifications:o,markAsRead:x,markAllAsRead:g,removeNotification:b,unreadCount:w},children:[s,i.jsx(iO,{toasts:t,removeToast:p})]})},jr=()=>{const s=T.useContext(_T);if(s===void 0)throw new Error("useNotification must be used within a NotificationProvider");return s},cO=({isOpen:s,onClose:e})=>{const[t,a]=T.useState(""),[o,u]=T.useState(""),[d,p]=T.useState(""),[x,g]=T.useState(!1),[b,w]=T.useState(!1),[N,R]=T.useState(!1),{addToast:D}=jr();if(!s)return null;const q=async L=>{if(L.preventDefault(),o!==d){D("Mt khu mi khng khp!","error");return}if(o.length<6){D("Mt khu mi phi c t nht 6 k t.","error");return}R(!0);try{const re=Tu().currentUser;if(re&&re.email){const $=Bi.credential(re.email,t);await R2(re,$),await O2(re,o),D("i mt khu thnh cng!","success"),e(),a(""),u(""),p("")}else D("Khng tm thy thng tin ngi dng.","error")}catch(W){console.error("Error changing password:",W),W.code==="auth/wrong-password"?D("Mt khu hin ti khng ng.","error"):W.code==="auth/too-many-requests"?D("Qu nhiu ln th tht bi. Vui lng th li sau.","error"):D(`Li: ${W.message}`,"error")}finally{R(!1)}};return i.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200 text-gray-900",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"bg-slate-800 px-6 py-4 flex justify-between items-center flex-shrink-0",children:[i.jsxs("h3",{className:"text-white font-semibold text-lg flex items-center gap-2",children:[i.jsx(Ro,{className:"h-5 w-5"}),"i mt khu"]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:i.jsx(fn,{className:"h-6 w-6"})})]}),i.jsx("div",{className:"p-6",children:i.jsxs("form",{onSubmit:q,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu hin ti"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:x?"text":"password",required:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-slate-500 focus:border-slate-500 outline-none transition-all text-gray-900 bg-white",value:t,onChange:L=>a(L.target.value),placeholder:"Nhp mt khu hin ti..."}),i.jsx("button",{type:"button",onClick:()=>g(!x),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:x?i.jsx(mg,{className:"h-4 w-4"}):i.jsx(pg,{className:"h-4 w-4"})})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu mi"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:b?"text":"password",required:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-slate-500 focus:border-slate-500 outline-none transition-all text-gray-900 bg-white",value:o,onChange:L=>u(L.target.value),placeholder:"Nhp mt khu mi..."}),i.jsx("button",{type:"button",onClick:()=>w(!b),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:b?i.jsx(mg,{className:"h-4 w-4"}):i.jsx(pg,{className:"h-4 w-4"})})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xc nhn mt khu mi"}),i.jsx("input",{type:"password",required:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-slate-500 focus:border-slate-500 outline-none transition-all text-gray-900 bg-white",value:d,onChange:L=>p(L.target.value),placeholder:"Nhp li mt khu mi..."})]}),i.jsxs("div",{className:"pt-4 flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg border border-transparent hover:border-gray-300 transition-all",children:"Hy b"}),i.jsx("button",{type:"submit",disabled:N,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-slate-700 hover:bg-slate-800 rounded-lg shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:N?i.jsxs(i.Fragment,{children:[i.jsx(Ni,{className:"h-4 w-4 animate-spin"})," ang x l..."]}):i.jsxs(i.Fragment,{children:[i.jsx(s0,{className:"h-4 w-4"})," Lu thay i"]})})]})]})})]})})},uO=({isOpen:s,onClose:e})=>{const{user:t}=vs(),{addToast:a}=jr(),[o,u]=T.useState(""),[d,p]=T.useState(""),[x,g]=T.useState(""),[b,w]=T.useState(""),[N,R]=T.useState(""),[D,q]=T.useState(!1),[L,W]=T.useState(!1),[re,$]=T.useState(!1),z=T.useRef(null),he=T.useRef(null);if(T.useEffect(()=>{t&&s&&(u(t.fullName||""),p(t.phone||""),g(t.address||""),w(t.avatar||""),R(t.signatureUrl||""))},[t,s]),!s)return null;const _e=async O=>{var ve;const E=(ve=O.target.files)==null?void 0:ve[0];if(!(!E||!t)){if(!E.type.startsWith("image/")){a("Vui lng chn file nh!","","error");return}if(E.size>2*1024*1024){a("Kch thc nh ti a l 2MB!","","error");return}W(!0);try{const Te=rr(Ls,`avatars/${t.id}/${Date.now()}_${E.name}`);await nr(Te,E);const X=await sr(Te);w(X),a("Ti nh i din thnh cng!","","success")}catch(Te){console.error("Error uploading avatar:",Te),a("Li khi ti nh i din!","","error")}finally{W(!1)}}},S=async O=>{var ve;const E=(ve=O.target.files)==null?void 0:ve[0];if(!(!E||!t)){if(E.type!=="image/png"){a("Vui lng chn file PNG cho ch k ( c nn trong sut)!","","error");return}if(E.size>1*1024*1024){a("Kch thc ch k ti a l 1MB!","","error");return}$(!0);try{const Te=rr(Ls,`signatures/${t.id}/signature.png`);await nr(Te,E,{contentType:"image/png"});const X=await sr(Te);R(X),a("Ti ch k thnh cng!","","success")}catch(Te){console.error("Error uploading signature:",Te),a("Li khi ti ch k!","","error")}finally{$(!1)}}},C=()=>{R(""),a(" xa ch k!","","success")},k=async O=>{if(O.preventDefault(),!!t){if(!o.trim()){a("H v tn khng c  trng!","","error");return}q(!0);try{const E=qe(Ae,"users",t.id);await Qt(E,{fullName:o.trim(),phone:d.trim(),address:x.trim(),avatar:b,signatureUrl:N}),a("Cp nht thng tin thnh cng!","","success"),e(),window.location.reload()}catch(E){console.error("Error updating profile:",E),a("Li khi cp nht thng tin!","","error")}finally{q(!1)}}},M=O=>O?O.charAt(0).toUpperCase():"U",I=O=>{switch(O){case"admin":return"bg-red-100 text-red-700 border-red-200";case"head_teacher":return"bg-blue-100 text-blue-700 border-blue-200";case"office_head":return"bg-cyan-100 text-cyan-700 border-cyan-200";case"teacher":return"bg-emerald-100 text-emerald-700 border-emerald-200";case"staff":return"bg-purple-100 text-purple-700 border-purple-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}};return i.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200 text-gray-900",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-4 flex justify-between items-center flex-shrink-0",children:[i.jsxs("h3",{className:"text-white font-semibold text-lg flex items-center gap-2",children:[i.jsx(xr,{className:"h-5 w-5"}),"Thng tin ti khon"]}),i.jsx("button",{onClick:e,className:"text-white/80 hover:text-white transition-colors",children:i.jsx(fn,{className:"h-6 w-6"})})]}),i.jsx("div",{className:"p-6 overflow-y-auto",children:i.jsxs("form",{onSubmit:k,className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col items-center gap-4",children:[i.jsxs("div",{className:"relative group",children:[b?i.jsx("img",{src:b,alt:o,className:"h-24 w-24 rounded-full object-cover border-4 border-blue-100 shadow-lg"}):i.jsx("div",{className:"h-24 w-24 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white text-3xl font-bold border-4 border-blue-100 shadow-lg",children:M(o)}),i.jsx("button",{type:"button",onClick:()=>{var O;return(O=z.current)==null?void 0:O.click()},disabled:L,className:"absolute inset-0 rounded-full bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center cursor-pointer",children:L?i.jsx(Ni,{className:"h-6 w-6 text-white animate-spin"}):i.jsx(iC,{className:"h-6 w-6 text-white"})}),i.jsx("input",{type:"file",ref:z,onChange:_e,accept:"image/*",className:"hidden"})]}),i.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full border ${I(t==null?void 0:t.role)}`,children:t==null?void 0:t.roleLabel})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-xl border border-gray-200",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Email"}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[i.jsx(i1,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{className:"truncate",children:t==null?void 0:t.email})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Tn ng nhp"}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[i.jsx(xr,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{children:t==null?void 0:t.username})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Nhm"}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[i.jsx(Lh,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{children:(t==null?void 0:t.group)||"Cha cp nht"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Trng thi"}),i.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-xs font-medium rounded-full ${(t==null?void 0:t.status)==="active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:(t==null?void 0:t.status)==="active"?"Hot ng":"Khng hot ng"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["H v tn ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(xr,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),i.jsx("input",{type:"text",required:!0,className:"w-full border border-gray-300 rounded-lg pl-10 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all text-gray-900 bg-white",value:o,onChange:O=>u(O.target.value),placeholder:"Nhp h v tn..."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S in thoi"}),i.jsxs("div",{className:"relative",children:[i.jsx(c1,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),i.jsx("input",{type:"tel",className:"w-full border border-gray-300 rounded-lg pl-10 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all text-gray-900 bg-white",value:d,onChange:O=>p(O.target.value),placeholder:"Nhp s in thoi..."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"a ch"}),i.jsxs("div",{className:"relative",children:[i.jsx(ZC,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg pl-10 pr-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all text-gray-900 bg-white",value:x,onChange:O=>g(O.target.value),placeholder:"Nhp a ch..."})]})]})]}),i.jsxs("div",{className:"p-4 bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl border border-indigo-100",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx(Ms,{className:"h-5 w-5 text-indigo-600"}),i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Ch k in t"})]}),i.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Ti ln nh ch k nh dng PNG vi nn trong sut. Ch k s c s dng khi chn vo ti liu Word."}),N?i.jsx("div",{className:"mb-3",children:i.jsxs("div",{className:"relative inline-block rounded-lg border-2 border-dashed border-indigo-200 p-2",style:{background:"repeating-conic-gradient(#e5e7eb 0% 25%, transparent 0% 50%) 50% / 16px 16px"},children:[i.jsx("img",{src:N,alt:"Ch k",className:"max-h-20 max-w-full object-contain"}),i.jsx("button",{type:"button",onClick:C,className:"absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors shadow-md",title:"Xa ch k",children:i.jsx(hn,{className:"h-3 w-3"})})]})}):i.jsx("div",{className:"mb-3 flex items-center justify-center h-20 rounded-lg border-2 border-dashed border-indigo-200",style:{background:"repeating-conic-gradient(#e5e7eb 0% 25%, transparent 0% 50%) 50% / 16px 16px"},children:i.jsx("span",{className:"text-sm text-gray-400",children:"Cha c ch k"})}),i.jsx("button",{type:"button",onClick:()=>{var O;return(O=he.current)==null?void 0:O.click()},disabled:re,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-indigo-700 bg-white border border-indigo-300 rounded-lg hover:bg-indigo-50 transition-colors disabled:opacity-50",children:re?i.jsxs(i.Fragment,{children:[i.jsx(Ni,{className:"h-4 w-4 animate-spin"})," ang ti..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ms,{className:"h-4 w-4"})," ",N?"Thay i ch k":"Ti ln ch k"]})}),i.jsx("input",{type:"file",ref:he,onChange:S,accept:"image/png",className:"hidden"})]}),i.jsxs("div",{className:"pt-4 flex justify-end gap-3 border-t border-gray-100",children:[i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg border border-gray-300 transition-all",children:"Hy b"}),i.jsx("button",{type:"submit",disabled:D,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 rounded-lg shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:D?i.jsxs(i.Fragment,{children:[i.jsx(Ni,{className:"h-4 w-4 animate-spin"})," ang lu..."]}):i.jsxs(i.Fragment,{children:[i.jsx(s0,{className:"h-4 w-4"})," Lu thay i"]})})]})]})})]})})},dO=()=>{const s=Ua(),e=ar(),{user:t,logout:a}=vs(),{notifications:o,unreadCount:u,markAllAsRead:d,markAsRead:p,removeNotification:x}=jr(),[g,b]=T.useState(!1),[w,N]=T.useState(!1),[R,D]=T.useState(!1),[q,L]=T.useState(!1),[W,re]=T.useState(""),[$,z]=T.useState(""),he=T.useRef(null),_e=T.useRef(null);if(T.useEffect(()=>{const I=O=>{he.current&&!he.current.contains(O.target)&&b(!1),_e.current&&!_e.current.contains(O.target)&&N(!1)};return document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[]),T.useEffect(()=>{(async()=>{try{const O=qe(Ae,"app_settings","system_logo"),E=await vr(O);E.exists()&&E.data().imageUrl&&re(E.data().imageUrl);const ve=qe(Ae,"app_settings","certification_logo"),Te=await vr(ve);Te.exists()&&Te.data().imageUrl&&z(Te.data().imageUrl)}catch(O){console.error("Error fetching logo:",O)}})()},[]),s.pathname==="/login")return null;const S=async()=>{await a(),e("/login")},C=I=>I?I.charAt(0).toUpperCase():"U",k=I=>{switch(I){case"admin":return"bg-red-500";case"head_teacher":return"bg-blue-500";case"office_head":return"bg-cyan-600";case"teacher":return"bg-emerald-500";case"staff":return"bg-purple-500";default:return"bg-gray-500"}},M=I=>{switch(I){case"admin":return"bg-blue-900";case"teacher":return"bg-orange-500";case"head_teacher":return"bg-indigo-600";case"office_head":return"bg-teal-700";case"staff":return"bg-teal-600";default:return"bg-blue-900"}};return i.jsxs("header",{className:`sticky top-0 z-50 w-full ${M(t==null?void 0:t.role)} text-white shadow-lg border-b border-white/10 transition-colors duration-500 animate-in slide-in-from-top-full`,children:[i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex justify-between items-center h-20",children:[i.jsxs("div",{onClick:()=>e("/"),className:"flex items-center gap-4 cursor-pointer group",children:[i.jsx("div",{className:"p-2 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl group-hover:bg-white group-hover:scale-105 transition-all duration-300 shadow-lg overflow-hidden",children:W?i.jsx("img",{src:W,alt:"Logo",className:"h-8 w-8 object-contain"}):i.jsx(n0,{className:"h-8 w-8 text-yellow-300 group-hover:text-yellow-600 transition-colors"})}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("h1",{className:"text-lg md:text-xl font-bold text-white tracking-tight drop-shadow-sm",children:d1}),i.jsx("span",{className:"text-xs text-white/80 font-medium uppercase tracking-wider opacity-90",children:"H thng qun l tp trung"})]}),$&&i.jsx("div",{className:"hidden lg:block ml-4 pl-4 border-l border-white/20",children:i.jsx("img",{src:$,alt:"Chng nhn",className:"h-10 w-auto object-contain drop-shadow-md hover:scale-110 transition-transform duration-300",title:"Trng t chun Quc gia"})})]}),i.jsxs("div",{className:"flex items-center gap-2 md:gap-6",children:[i.jsxs("div",{className:"hidden md:flex items-center bg-black/20 border border-white/10 rounded-full px-4 py-2 focus-within:ring-2 focus-within:ring-white/30 focus-within:bg-black/30 transition-all duration-300 w-64 backdrop-blur-sm",children:[i.jsx(Tl,{className:"h-5 w-5 text-white/70"}),i.jsx("input",{type:"text",placeholder:"Tm kim vn bn...",className:"ml-2 bg-transparent border-none outline-none text-sm text-white placeholder-white/60 w-full"})]}),i.jsxs("div",{className:"relative",ref:_e,children:[i.jsxs("button",{onClick:()=>N(!w),className:`relative p-2 text-white/80 hover:bg-white/10 hover:text-white rounded-full transition-all duration-200 group ${u>0?"animate-wiggle":""}`,children:[i.jsx(Fv,{className:`h-6 w-6 ${w?"text-white":""} group-hover:scale-110 transition-transform`}),u>0&&i.jsx("span",{className:"absolute top-1 right-2 h-4 w-4 bg-red-500 rounded-full ring-2 ring-white/20 shadow-lg shadow-red-500/50 flex items-center justify-center text-[10px] font-bold text-white",children:u})]}),w&&i.jsxs("div",{className:"absolute right-0 top-full mt-4 w-96 bg-white rounded-2xl shadow-2xl border border-gray-100 ring-1 ring-black/5 overflow-hidden z-50 origin-top-right animate-in fade-in zoom-in-95 duration-200",children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[i.jsx("h3",{className:"font-bold text-gray-800 text-sm",children:"Thng bo mi"}),u>0&&i.jsxs("button",{onClick:d,className:"text-xs font-medium text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[i.jsx(iu,{className:"h-3 w-3"})," nh du  c"]})]}),i.jsxs("div",{className:"max-h-[400px] overflow-y-auto",children:[o.map(I=>i.jsxs("div",{onClick:()=>{if(p(I.id),x(I.id),I.targetPath){const O=I.targetPath.includes("highlight=");let E=I.targetPath;if(!O){const ve=I.targetPath.includes("?")?"&":"?";E=`${I.targetPath}${ve}highlight=true`}e(E),N(!1)}},className:`p-4 border-b border-gray-100 last:border-0 hover:bg-gray-50 transition-colors cursor-pointer flex gap-3 ${I.isRead?"bg-white":"bg-blue-50/40"}`,children:[i.jsxs("div",{className:"flex-shrink-0 pt-1",children:[I.avatar?i.jsx("img",{src:I.avatar,alt:I.user,className:"h-10 w-10 rounded-full object-cover border border-gray-200"}):i.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center text-sm font-bold border border-gray-200 ${I.type==="system"?"bg-gray-800 text-white":"bg-blue-100 text-blue-700"}`,children:C(I.user)}),i.jsxs("div",{className:"absolute -mt-3 -ml-1 h-5 w-5 rounded-full border-2 border-white flex items-center justify-center bg-white shadow-sm",children:[I.type==="upload"&&i.jsx(Ze,{className:"h-3 w-3 text-emerald-500"}),I.type==="comment"&&i.jsx(Ea,{className:"h-3 w-3 text-blue-500"})]})]}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("p",{className:"text-sm text-gray-800 leading-snug",children:[i.jsx("span",{className:"font-bold",children:I.user})," ",I.content]}),i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[i.jsx("span",{className:"text-xs text-gray-400 font-medium",children:I.time}),I.fileType&&i.jsx("span",{className:"text-[10px] uppercase font-bold text-gray-500 bg-gray-100 px-1.5 rounded border border-gray-200",children:I.fileType}),!I.isRead&&i.jsx("span",{className:"h-2 w-2 rounded-full bg-blue-500"})]})]})]},I.id)),o.length===0&&i.jsxs("div",{className:"p-8 text-center text-gray-400",children:[i.jsx(Fv,{className:"h-10 w-10 mx-auto mb-2 opacity-20"}),i.jsx("p",{className:"text-sm",children:"Khng c thng bo mi"})]})]}),i.jsx("div",{className:"p-3 border-t border-gray-100 bg-gray-50 text-center",children:i.jsx("button",{className:"text-xs font-bold text-gray-500 hover:text-blue-600 transition-colors",children:"Xem tt c thng bo"})})]})]}),i.jsxs("div",{className:"relative pl-4 border-l border-white/20",ref:he,children:[i.jsxs("button",{onClick:()=>b(!g),className:`flex items-center gap-3 p-1.5 rounded-full md:rounded-xl transition-all duration-200 ${g?"bg-white/10 ring-1 ring-white/20":"hover:bg-white/5"}`,children:[i.jsxs("div",{className:"relative",children:[t!=null&&t.avatar?i.jsx("img",{src:t.avatar,alt:t.fullName,className:"h-9 w-9 rounded-full object-cover border-2 border-white/20 shadow-sm"}):i.jsx("div",{className:`h-9 w-9 rounded-full ${k(t==null?void 0:t.role)} text-white flex items-center justify-center text-sm font-bold border-2 border-white/20 shadow-sm`,children:t?C(t.fullName):i.jsx(NC,{className:"h-6 w-6"})}),i.jsx("div",{className:"absolute bottom-0 right-0 h-2.5 w-2.5 bg-green-500 rounded-full border-2 border-white/20"})]}),t?i.jsxs("div",{className:"hidden md:flex flex-col items-start text-left mr-1",children:[i.jsx("span",{className:"text-sm font-bold text-white leading-none mb-1",children:t.fullName}),i.jsx("span",{className:"text-[10px] text-white font-medium bg-black/20 px-1.5 py-0.5 rounded border border-white/10",children:t.roleLabel})]}):i.jsx("div",{className:"hidden md:flex flex-col items-start text-left mr-1",children:i.jsx("span",{className:"text-sm font-bold text-white",children:"Khch"})}),i.jsx(fg,{className:`hidden md:block h-4 w-4 text-white/70 transition-transform duration-200 ${g?"rotate-180":""}`})]}),g&&i.jsxs("div",{className:"absolute right-0 top-full mt-2 w-60 bg-white rounded-xl shadow-2xl border border-gray-100 ring-1 ring-black/5 overflow-hidden z-50 origin-top-right animate-in fade-in zoom-in-95 duration-200",children:[i.jsxs("div",{className:"px-4 py-4 border-b border-gray-100 bg-gray-50 md:hidden",children:[i.jsx("p",{className:"text-sm font-bold text-gray-900",children:(t==null?void 0:t.fullName)||"Khch"}),i.jsx("p",{className:"text-xs text-gray-500",children:t==null?void 0:t.roleLabel})]}),i.jsxs("div",{className:"p-1.5",children:[i.jsxs("button",{onClick:()=>{b(!1),L(!0)},className:"w-full flex items-center gap-3 px-3 py-2.5 text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-700 rounded-lg transition-colors",children:[i.jsx("div",{className:"p-1.5 bg-blue-100 text-blue-600 rounded-md",children:i.jsx(xr,{className:"h-4 w-4"})}),"Thng tin ti khon"]}),i.jsxs("button",{onClick:()=>{b(!1),D(!0)},className:"w-full flex items-center gap-3 px-3 py-2.5 text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-700 rounded-lg transition-colors",children:[i.jsx("div",{className:"p-1.5 bg-gray-100 text-gray-600 rounded-md",children:i.jsx(pA,{className:"h-4 w-4"})}),"i mt khu"]})]}),i.jsx("div",{className:"h-px bg-gray-100 my-0.5 mx-2"}),i.jsx("div",{className:"p-1.5",children:i.jsxs("button",{onClick:S,className:"w-full flex items-center gap-3 px-3 py-2.5 text-sm font-medium text-red-600 hover:bg-red-50 hover:text-red-700 rounded-lg transition-colors",children:[i.jsx("div",{className:"p-1.5 bg-red-100 text-red-500 rounded-md",children:i.jsx(XC,{className:"h-4 w-4"})}),"ng xut"]})})]})]})]})]})}),i.jsx(cO,{isOpen:R,onClose:()=>D(!1)}),i.jsx(uO,{isOpen:q,onClose:()=>L(!1)})]})},na=()=>{const[s,e]=T.useState(!1);return T.useEffect(()=>{const t=()=>{e(window.innerWidth<768)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),s},hO=({data:s,onClick:e})=>{const{id:t,title:a,description:o,icon:u,colorClass:d,bgClass:p,hoverClass:x,stats:g}=s,b=na();return i.jsxs("div",{onClick:()=>e(t),className:`
        group relative overflow-hidden ${b?"rounded-xl":"rounded-2xl"} border border-gray-100 bg-white ${b?"p-4":"p-8"} shadow-lg 
        transition-all duration-500 ease-out 
        cursor-pointer 
        hover:-translate-y-1 hover:shadow-xl
        ${x}
      `,children:[i.jsx("div",{className:`absolute -right-10 -top-10 h-40 w-40 rounded-full bg-gradient-to-br ${p} blur-3xl opacity-50 group-hover:opacity-100 transition-opacity duration-500`}),i.jsxs("div",{className:"relative z-10 flex flex-col h-full justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:`${b?"mb-3 h-10 w-10":"mb-6 h-16 w-16"} inline-flex items-center justify-center ${b?"rounded-xl":"rounded-2xl"} bg-gradient-to-br ${p} shadow-sm group-hover:scale-110 transition-transform duration-500`,children:i.jsx(u,{className:`${b?"h-5 w-5":"h-8 w-8"} ${d}`})}),i.jsx("h3",{className:`${b?"mb-1 text-base":"mb-3 text-2xl"} font-bold text-gray-800 group-hover:text-gray-900 tracking-tight`,children:a}),!b&&i.jsx("p",{className:"text-gray-500 leading-relaxed mb-6",children:o})]}),i.jsxs("div",{className:`flex items-center justify-between ${b?"pt-2":"pt-4"} border-t border-gray-50`,children:[g&&i.jsx("span",{className:`${b?"text-[10px] px-2 py-0.5":"text-xs px-3 py-1"} font-semibold rounded-full bg-gray-50 text-gray-600 group-hover:bg-white group-hover:shadow-sm transition-all`,children:g}),!b&&i.jsxs("div",{className:`flex items-center gap-2 text-sm font-bold ${d} opacity-0 transform translate-x-4 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300`,children:["Truy cp ",i.jsx(Ph,{className:"h-4 w-4"})]})]})]})]})},fO=({currentSchoolYear:s,classes:e})=>{const t=na(),[a,o]=T.useState({totalClasses:0,classStatuses:[],classesWithWeekPlan:0,classesWithMonthPlan:0,weekPlanStats:{approvedCount:0,pendingCount:0,revisionCount:0,respondedCount:0},monthPlanStats:{approvedCount:0,pendingCount:0,revisionCount:0,respondedCount:0}}),[u,d]=T.useState(!1),[p,x]=T.useState(!1),[g,b]=T.useState("week"),[w,N]=T.useState(!0),R=new Date,D=(R.getMonth()+1).toString().padStart(2,"0"),q=R.getFullYear(),[L,W]=T.useState(D),[re,$]=T.useState(q),[z,he]=T.useState({vicePrincipals:[],headTeachers:[],headTeacherScopes:[]});T.useEffect(()=>{const E=mn(Tt(Ae,"users"),bs("role","in",["vice_principal","head_teacher","vice_head_teacher"])),ve=zs(E,Te=>{const X=Te.docs.map(Pe=>Pe.data()),Z=X.filter(Pe=>Pe.role==="vice_principal"),Se=X.filter(Pe=>["head_teacher","vice_head_teacher"].includes(Pe.role)),Be=Se.map(Pe=>Pe.accessScope).filter(Boolean);he({vicePrincipals:Z,headTeachers:Se,headTeacherScopes:Be})});return()=>ve()},[]);const _e={"01":"Thng 1","02":"Thng 2","03":"Thng 3","04":"Thng 4","05":"Thng 5","06":"Thng 6","07":"Thng 7","08":"Thng 8","09":"Thng 9",10:"Thng 10",11:"Thng 11",12:"Thng 12"},S=E=>{let ve=parseInt(L),Te=re;E==="prev"?(ve--,ve<1&&(ve=12,Te--)):(ve++,ve>12&&(ve=1,Te++)),W(ve.toString().padStart(2,"0")),$(Te)};T.useEffect(()=>{if(!s||e.length===0){N(!1);return}const E=mn(Tt(Ae,"class_files"),bs("category","==","plan")),ve=zs(E,Te=>{const Se=Te.docs.map(de=>({id:de.id,...de.data()})).filter(de=>(de.schoolYear||"2025-2026")===s).filter(de=>String(de.month||"").replace("m","").padStart(2,"0")===L),Be=Se.filter(de=>de.planType==="week"),Pe=Se.filter(de=>de.planType==="month"),V=e.map(de=>{const ye=Be.filter(be=>be.classId===de.id),Y=Pe.filter(be=>be.classId===de.id);return{classId:de.id,className:de.name,hasWeekPlan:ye.length>0,hasMonthPlan:Y.length>0,weekPlanCount:ye.length,monthPlanCount:Y.length,weekApprovedCount:ye.filter(be=>{var B;return((B=be.approval)==null?void 0:B.status)==="approved"}).length,weekPendingCount:ye.filter(be=>{var B,ce;return!((B=be.approval)!=null&&B.status)||((ce=be.approval)==null?void 0:ce.status)==="pending"}).length,monthApprovedCount:Y.filter(be=>{var B;return((B=be.approval)==null?void 0:B.status)==="approved"}).length,monthPendingCount:Y.filter(be=>{var B,ce;return!((B=be.approval)!=null&&B.status)||((ce=be.approval)==null?void 0:ce.status)==="pending"}).length}}),oe=de=>{const ye=de.filter(K=>{var Ee;return((Ee=K.approval)==null?void 0:Ee.status)==="approved"}).length,Y=de.filter(K=>{var Ee,F;return!((Ee=K.approval)!=null&&Ee.status)||((F=K.approval)==null?void 0:F.status)==="pending"}).length,be=de.filter(K=>{var Ee;return((Ee=K.approval)==null?void 0:Ee.status)==="needs_revision"}),B=be.length,ce=be.filter(K=>{const Ee=K.comments||[],F=Ee.some(le=>le.type==="request"),je=Ee.some(le=>le.type==="response");return F&&je}).length;return{approvedCount:ye,pendingCount:Y,revisionCount:B,respondedCount:ce}};o({totalClasses:e.length,classStatuses:V,classesWithWeekPlan:V.filter(de=>de.hasWeekPlan).length,classesWithMonthPlan:V.filter(de=>de.hasMonthPlan).length,weekPlanStats:oe(Be),monthPlanStats:oe(Pe)}),N(!1)});return()=>ve()},[s,e,L]);const C=g==="week"?a.weekPlanStats:a.monthPlanStats,k=g==="week"?a.classesWithWeekPlan:a.classesWithMonthPlan,M=a.classStatuses.filter(E=>g==="week"?E.hasWeekPlan:E.hasMonthPlan),I=a.classStatuses.filter(E=>g==="week"?!E.hasWeekPlan:!E.hasMonthPlan);if(w)return i.jsx("div",{className:`group relative overflow-hidden ${t?"rounded-xl":"rounded-2xl"} border border-teal-100 bg-white shadow-lg p-6`,children:i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-500"})})});const O=(E,ve)=>ve==="month"?z.vicePrincipals.map(Te=>Te.fullName).join(", ")||"Cha c PHT":z.headTeacherScopes.includes(E)?z.vicePrincipals.map(X=>X.fullName).join(", ")||"Cha c PHT":z.headTeachers.map(X=>X.fullName).join(", ")||"Cha phn cng";return i.jsxs("div",{className:`group relative overflow-hidden ${t?"rounded-xl":"rounded-2xl"} border border-teal-100 bg-white shadow-lg transition-all duration-500 ease-out hover:-translate-y-1 hover:shadow-xl hover:shadow-teal-200 hover:border-teal-300`,children:[i.jsx("div",{className:"absolute -right-10 -top-10 h-40 w-40 rounded-full bg-gradient-to-br from-teal-50 to-cyan-100 blur-3xl opacity-50 group-hover:opacity-80 transition-opacity"}),i.jsx("div",{className:`${t?"p-3":"p-5"} relative z-10 bg-gradient-to-r from-teal-500 to-cyan-500`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`${t?"h-9 w-9":"h-11 w-11"} inline-flex items-center justify-center rounded-xl bg-white/20 backdrop-blur-sm text-white shadow-sm`,children:i.jsx(oC,{className:`${t?"h-5 w-5":"h-6 w-6"}`})}),i.jsx("h3",{className:`${t?"text-sm":"text-base"} font-bold text-white`,children:"THEO DI PH DUYT K HOCH"})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:()=>S("prev"),className:"p-1 bg-white/20 hover:bg-white/30 rounded-full transition-colors",children:i.jsx(mC,{className:`${t?"h-4 w-4":"h-5 w-5"} text-white`})}),i.jsx("div",{className:`${t?"px-2 py-0.5 min-w-[90px]":"px-3 py-1 min-w-[120px]"} bg-white rounded-full shadow-lg text-center`,children:i.jsxs("span",{className:`${t?"text-[10px]":"text-xs"} font-bold text-teal-700`,children:[_e[L]," ",re]})}),i.jsx("button",{onClick:()=>S("next"),className:"p-1 bg-white/20 hover:bg-white/30 rounded-full transition-colors",children:i.jsx(ps,{className:`${t?"h-4 w-4":"h-5 w-5"} text-white`})})]})]})}),i.jsx("div",{className:`${t?"px-3 pt-3":"px-5 pt-4"} relative z-10`,children:i.jsxs("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg",children:[i.jsxs("button",{onClick:()=>{b("week"),d(!1),x(!1)},className:`flex-1 flex items-center justify-center gap-1.5 ${t?"py-1.5 text-[10px]":"py-2 text-xs"} font-semibold rounded-md transition-all ${g==="week"?"bg-white text-teal-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[i.jsx(Da,{className:`${t?"h-3 w-3":"h-3.5 w-3.5"}`}),"K hoch Tun"]}),i.jsxs("button",{onClick:()=>{b("month"),d(!1),x(!1)},className:`flex-1 flex items-center justify-center gap-1.5 ${t?"py-1.5 text-[10px]":"py-2 text-xs"} font-semibold rounded-md transition-all ${g==="month"?"bg-white text-teal-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[i.jsx(sC,{className:`${t?"h-3 w-3":"h-3.5 w-3.5"}`}),"K hoch Thng"]})]})}),i.jsxs("div",{className:`${t?"p-3":"p-5 pt-4"} relative z-10`,children:[i.jsxs("div",{className:`grid ${t?"grid-cols-3 gap-2":"grid-cols-3 gap-4"}`,children:[i.jsxs("div",{onClick:()=>d(!u),className:`${t?"p-2":"p-4"} bg-gradient-to-br from-teal-50 to-teal-100/50 rounded-xl border border-teal-100 cursor-pointer hover:shadow-md transition-shadow`,children:[i.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[i.jsx(En,{className:`${t?"h-3.5 w-3.5":"h-4 w-4"} text-teal-600`}),i.jsx("span",{className:`${t?"text-[9px]":"text-xs"} font-medium text-teal-700 uppercase tracking-wide`,children:"Ti ln"})]}),i.jsxs("div",{className:`${t?"text-xl":"text-3xl"} font-bold text-teal-700`,children:[k,"/",a.totalClasses]}),i.jsxs("button",{className:`mt-1 flex items-center gap-1 ${t?"text-[9px]":"text-xs"} text-teal-600 hover:text-teal-800`,children:["Chi tit ",u?i.jsx(qv,{className:"h-3 w-3"}):i.jsx(fg,{className:"h-3 w-3"})]})]}),i.jsxs("div",{onClick:()=>x(!p),className:`${t?"p-2":"p-4"} bg-gradient-to-br from-emerald-50 to-emerald-100/50 rounded-xl border border-emerald-100 cursor-pointer hover:shadow-md transition-shadow`,children:[i.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[i.jsx(pr,{className:`${t?"h-3.5 w-3.5":"h-4 w-4"} text-emerald-600`}),i.jsx("span",{className:`${t?"text-[9px]":"text-xs"} font-medium text-emerald-700 uppercase tracking-wide`,children:"Ph duyt"})]}),i.jsx("div",{className:`${t?"text-xl":"text-3xl"} font-bold text-emerald-700`,children:C.approvedCount}),i.jsx("div",{className:"flex items-center gap-1 mt-1",children:C.pendingCount>0&&i.jsxs("span",{className:`flex items-center gap-0.5 ${t?"text-[9px]":"text-xs"} text-amber-600`,children:[i.jsx(gr,{className:"h-2.5 w-2.5"})," ",C.pendingCount," ch"]})}),i.jsxs("button",{className:`mt-1 flex items-center gap-1 ${t?"text-[9px]":"text-xs"} text-emerald-600 hover:text-emerald-800`,children:["Chi tit ",p?i.jsx(qv,{className:"h-3 w-3"}):i.jsx(fg,{className:"h-3 w-3"})]})]}),i.jsxs("div",{className:`${t?"p-2":"p-4"} bg-gradient-to-br from-orange-50 to-orange-100/50 rounded-xl border border-orange-100`,children:[i.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[i.jsx(Fr,{className:`${t?"h-3.5 w-3.5":"h-4 w-4"} text-orange-600`}),i.jsx("span",{className:`${t?"text-[9px]":"text-xs"} font-medium text-orange-700 uppercase tracking-wide`,children:"Yu cu sa"})]}),i.jsx("div",{className:`${t?"text-xl":"text-3xl"} font-bold text-orange-700`,children:C.revisionCount}),i.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[i.jsx(cA,{className:`${t?"h-2.5 w-2.5":"h-3 w-3"} text-blue-500`}),i.jsxs("span",{className:`${t?"text-[9px]":"text-xs"} text-blue-600`,children:[C.respondedCount,"  phn hi"]})]})]})]}),u&&i.jsxs("div",{className:`mt-3 ${t?"p-2":"p-3"} bg-gray-50 rounded-lg border border-gray-200`,children:[i.jsxs("p",{className:`${t?"text-[10px]":"text-xs"} font-semibold text-gray-700 mb-2`,children:["Chi tit ti ln ",g==="week"?"k hoch tun":"k hoch thng",":"]}),M.length>0&&i.jsxs("div",{className:"mb-2",children:[i.jsxs("p",{className:`${t?"text-[9px]":"text-[10px]"} text-emerald-700 font-medium mb-1 flex items-center gap-1`,children:[i.jsx(pr,{className:"h-3 w-3"}),"  np (",M.length,"):"]}),i.jsx("div",{className:"flex flex-wrap gap-1",children:M.map(E=>i.jsxs("span",{className:`${t?"text-[9px] px-1.5 py-0.5":"text-xs px-2 py-1"} bg-emerald-100 text-emerald-700 rounded border border-emerald-200 font-medium`,children:[E.className," (",g==="week"?E.weekPlanCount:E.monthPlanCount,")"]},E.classId))})]}),I.length>0&&i.jsxs("div",{children:[i.jsxs("p",{className:`${t?"text-[9px]":"text-[10px]"} text-amber-700 font-medium mb-1 flex items-center gap-1`,children:[i.jsx(Uh,{className:"h-3 w-3"})," Cha np (",I.length,"):"]}),i.jsx("div",{className:"flex flex-wrap gap-1",children:I.map(E=>i.jsx("span",{className:`${t?"text-[9px] px-1.5 py-0.5":"text-xs px-2 py-1"} bg-amber-100 text-amber-700 rounded border border-amber-200 font-medium`,children:E.className},E.classId))})]})]}),p&&i.jsxs("div",{className:`mt-3 ${t?"p-2":"p-3"} bg-gray-50 rounded-lg border border-gray-200`,children:[i.jsx("div",{className:"flex items-center justify-between mb-2",children:i.jsxs("p",{className:`${t?"text-[10px]":"text-xs"} font-semibold text-gray-700`,children:["Chi tit ph duyt ",g==="week"?"k hoch tun":"k hoch thng",":"]})}),i.jsx("div",{className:"space-y-1.5",children:a.classStatuses.map(E=>{const ve=g==="week"?E.weekApprovedCount:E.monthApprovedCount,Te=g==="week"?E.weekPendingCount:E.monthPendingCount,X=ve+Te,Z=g==="week"?E.hasWeekPlan:E.hasMonthPlan,Se=O(E.classId,g);return i.jsxs("div",{className:`flex items-center justify-between ${t?"py-1 px-1.5":"py-1.5 px-2"} ${Z?"bg-white":"bg-gray-100"} rounded border border-gray-100`,children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:`${t?"text-[9px]":"text-xs"} font-medium text-gray-700`,children:E.className}),i.jsxs("span",{className:`${t?"text-[8px]":"text-[10px]"} text-gray-500`,children:["Ngi duyt: ",i.jsx("span",{className:"font-semibold text-teal-600",children:Se})]})]}),Z?i.jsxs("div",{className:"flex items-center gap-2",children:[ve>0&&i.jsxs("span",{className:`flex items-center gap-0.5 ${t?"text-[9px]":"text-xs"} text-emerald-600`,children:[i.jsx(pr,{className:"h-3 w-3"})," ",ve," duyt"]}),Te>0&&i.jsxs("span",{className:`flex items-center gap-0.5 ${t?"text-[9px]":"text-xs"} text-amber-600`,children:[i.jsx(gr,{className:"h-3 w-3"})," ",Te," ch"]}),X===0&&i.jsx("span",{className:`${t?"text-[9px]":"text-xs"} text-gray-400`,children:"0 k hoch"})]}):i.jsx("span",{className:`${t?"text-[9px]":"text-xs"} text-gray-400 italic`,children:"Cha np"})]},E.classId)})})]})]})]})},NT=T.createContext(void 0),mO=({children:s})=>{const[e,t]=T.useState("2025-2026"),[a,o]=T.useState(["2025-2026"]),[u,d]=T.useState(!0);T.useEffect(()=>{const g=mn(Tt(Ae,"school_years")),b=zs(g,w=>{const N=w.docs.map(R=>R.id).sort().reverse();N.length===0?p():(o(N),N.includes(e)||t(N[0])),d(!1)});return()=>b()},[]);const p=async()=>{try{await Eo(qe(Ae,"school_years","2025-2026"),{createdAt:Bg(),name:"Nm hc 2025-2026"}),o(["2025-2026"]),t("2025-2026")}catch(g){console.error("Error initializing default school year:",g)}},x=async g=>{try{await Eo(qe(Ae,"school_years",g),{createdAt:Bg(),name:`Nm hc ${g}`}),t(g)}catch(b){throw console.error("Error creating school year:",b),b}};return i.jsx(NT.Provider,{value:{currentSchoolYear:e,setCurrentSchoolYear:t,schoolYears:a,isLoading:u,createNewSchoolYear:x},children:s})},Gu=()=>{const s=T.useContext(NT);if(s===void 0)throw new Error("useSchoolYear must be used within a SchoolYearProvider");return s},pO=()=>{var N,R;const s=ar(),{user:e,isAuthenticated:t}=vs(),{currentSchoolYear:a,setCurrentSchoolYear:o,schoolYears:u,createNewSchoolYear:d}=Gu(),[p,x]=vi.useState([]),g=na(),b=async()=>{const D=prompt("Nhp nm hc mi (VD: 2026-2027):");if(D){if(!D.match(/^\d{4}-\d{4}$/)){alert("nh dng nm hc khng hp l. Vui lng nhp dng YYYY-YYYY (VD: 2026-2027)");return}try{await d(D),alert(` khi to nm hc ${D} thnh cng!`)}catch{alert("C li xy ra khi to nm hc.")}}};if(T.useEffect(()=>{const D=mn(Tt(Ae,"classes")),q=zs(D,async L=>{const W=L.docs.map(S=>({id:S.id,...S.data()})),re=mn(Tt(Ae,"users"),bs("role","in",["teacher","head_teacher"])),z=(await wr(re)).docs.map(S=>S.data()),he=S=>S.toLowerCase().trim().replace(/\s+/g," "),_e=W.map(S=>{const C=new Set,k=he(S.id),M=he(S.name);z.forEach(O=>{if(!O.accessScope)return;const E=he(O.accessScope);(E===k||E===M||M.includes(E)||E.includes(M))&&C.add(O.fullName)});const I=Array.from(C);return{...S,teachers:I.length>0?I:["Cha phn cng"],teacher:I.length>0?I.join(", "):"Cha phn cng"}});_e.sort((S,C)=>S.name.localeCompare(C.name)),x(_e)});return()=>q()},[]),T.useEffect(()=>{t||s("/login")},[t,s]),!e)return null;const w=D=>{var q;if(D==="van-ban-chi-dao")s("/van-ban-chi-dao");else if(D==="van-ban-truong")s("/van-ban-truong");else if(D==="quan-tri-he-thong")s("/quan-tri-he-thong");else if(D==="to-van-phong-ke-hoach")s("/to-van-phong-ke-hoach");else if(D==="to-van-phong-thuc-don"){if(e.group==="T Chuyn Mn"&&e.role!=="admin"){alert("Bn khng c quyn truy cp phn h ny. Khu vc dnh ring cho Ban Gim Hiu v T Vn Phng.");return}s("/to-van-phong-thuc-don")}else if(D==="to-chuyen-mon-ke-hoach")s("/to-chuyen-mon-ke-hoach");else if(D.startsWith("class-")){const L=D.replace("class-","");if(e.role==="teacher"){const W=p.find($=>$.id===L),re=(q=e.accessScope)==null?void 0:q.toLowerCase().trim();if(W&&re!==L.toLowerCase()&&re!==W.name.toLowerCase()){alert("Bn ch c quyn truy cp vo lp ca mnh.");return}}s(`/class/${L}`)}else console.log(`Navigating to category: ${D}`),alert(`ang truy cp vo phn h: ${D} (ang pht trin)`)};return i.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[i.jsx("div",{className:`bg-white border-b border-gray-200 ${g?"pt-4 pb-4 mb-4":"pt-8 pb-8 mb-8"}`,children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[!g&&i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx(a1,{className:"h-5 w-5 text-yellow-500"}),i.jsx("span",{className:"text-sm font-semibold text-yellow-600 uppercase tracking-wider",children:"Bng iu khin qun tr"})]}),i.jsx("h2",{className:`${g?"text-xl":"text-3xl md:text-4xl"} font-bold text-gray-900 truncate`,children:g?`Cho c ${(N=e.fullName)==null?void 0:N.split(" ").pop()}`:`Xin cho c: ${e.fullName}`}),i.jsx("p",{className:`text-gray-500 ${g?"text-xs mt-0.5":"mt-1"}`,children:g?i.jsx("span",{className:"font-medium text-gray-700",children:e.roleLabel}):i.jsxs(i.Fragment,{children:["Vai tr: ",i.jsx("span",{className:"font-medium text-gray-800",children:e.roleLabel})," - ",i.jsx("span",{className:"font-medium text-gray-800",children:e.group})]})})]}),i.jsxs("div",{className:`flex items-center gap-2 bg-gray-50 ${g?"p-1.5":"p-2"} rounded-lg border border-gray-200 flex-shrink-0`,children:[!g&&i.jsx("span",{className:"text-sm font-medium text-gray-600 whitespace-nowrap px-2",children:"Nm hc:"}),i.jsx("select",{value:a,onChange:D=>o(D.target.value),className:`form-select ${g?"text-xs py-1 pl-2 pr-6":"text-sm py-1.5 pl-3 pr-8"} font-bold text-gray-800 bg-white border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500`,children:u.map(D=>i.jsx("option",{value:D,children:D},D))}),e.role==="admin"&&i.jsx("button",{onClick:b,className:`${g?"p-1":"ml-2 p-1.5"} text-blue-600 hover:bg-blue-100 rounded-md transition-colors`,title:"Khi to nm hc mi",children:i.jsx(Kv,{className:`${g?"h-3.5 w-3.5":"h-4 w-4"}`})})]})]})})}),i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 ${g?"gap-3":"gap-6 xl:gap-8"}`,children:[i.jsxs("div",{className:`group relative overflow-hidden ${g?"rounded-xl":"rounded-2xl"} border border-blue-100 bg-white shadow-lg transition-all duration-500 ease-out hover:-translate-y-1 hover:shadow-xl hover:shadow-blue-200 hover:border-blue-300 flex flex-col`,children:[i.jsx("div",{className:"absolute -right-10 -top-10 h-40 w-40 rounded-full bg-gradient-to-br from-blue-50 to-indigo-100 blur-3xl opacity-50"}),i.jsx("div",{className:`${g?"p-3":"p-5"} relative z-10 bg-gradient-to-r from-blue-500 to-indigo-500`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`${g?"h-9 w-9":"h-11 w-11"} inline-flex items-center justify-center rounded-xl bg-white/20 backdrop-blur-sm text-white shadow-sm`,children:i.jsx(Kv,{className:`${g?"h-5 w-5":"h-6 w-6"}`})}),i.jsxs("div",{children:[i.jsx("h3",{className:`${g?"text-sm":"text-base"} font-bold text-white`,children:"QUN L VN BN CHUNG"}),!g&&i.jsx("p",{className:"text-blue-100 text-xs mt-0.5",children:"Lu tr v qun l tp trung cc vn bn hnh chnh i v n."})]})]})}),i.jsxs("div",{className:`flex-1 grid grid-cols-2 gap-px bg-gray-100 border-t border-gray-100 ${g?"mt-1":"mt-2"}`,children:[i.jsxs("div",{onClick:()=>s("/van-ban-chi-dao"),className:`bg-white ${g?"p-3":"p-6"} cursor-pointer hover:bg-blue-50/50 transition-colors group/item relative`,children:[i.jsxs("div",{className:`flex items-center justify-between ${g?"mb-1.5":"mb-3"}`,children:[i.jsx("div",{className:`${g?"p-1.5":"p-2"} bg-blue-100 text-blue-600 rounded-lg`,children:i.jsx(qC,{className:`${g?"h-4 w-4":"h-6 w-6"}`})}),!g&&i.jsx(Ph,{className:"h-4 w-4 text-blue-400 opacity-0 -translate-x-2 group-hover/item:opacity-100 group-hover/item:translate-x-0 transition-all"})]}),i.jsx("h4",{className:`font-bold text-gray-800 ${g?"text-xs mb-0.5":"mb-1"} group-hover/item:text-blue-700`,children:"Vn bn Cp trn"}),i.jsxs("div",{className:"flex flex-wrap gap-0.5",children:[i.jsx("span",{className:`${g?"text-[8px] px-1 py-0":"text-[10px] px-1.5 py-0.5"} font-medium bg-gray-100 text-gray-500 rounded border border-gray-200`,children:"S/B GD"}),i.jsx("span",{className:`${g?"text-[8px] px-1 py-0":"text-[10px] px-1.5 py-0.5"} font-medium bg-gray-100 text-gray-500 rounded border border-gray-200`,children:"UBND"})]})]}),i.jsxs("div",{onClick:()=>s("/van-ban-truong"),className:`bg-white ${g?"p-3":"p-6"} cursor-pointer hover:bg-emerald-50/50 transition-colors group/item relative`,children:[i.jsxs("div",{className:`flex items-center justify-between ${g?"mb-1.5":"mb-3"}`,children:[i.jsx("div",{className:`${g?"p-1.5":"p-2"} bg-emerald-100 text-emerald-600 rounded-lg`,children:i.jsx(u1,{className:`${g?"h-4 w-4":"h-6 w-6"}`})}),!g&&i.jsx(Ph,{className:"h-4 w-4 text-emerald-400 opacity-0 -translate-x-2 group-hover/item:opacity-100 group-hover/item:translate-x-0 transition-all"})]}),i.jsx("h4",{className:`font-bold text-gray-800 ${g?"text-xs mb-0.5":"mb-1"} group-hover/item:text-emerald-700`,children:"Vn bn Ni b"}),i.jsxs("div",{className:"flex flex-wrap gap-0.5",children:[i.jsx("span",{className:`${g?"text-[8px] px-1 py-0":"text-[10px] px-1.5 py-0.5"} font-medium bg-gray-100 text-gray-500 rounded border border-gray-200`,children:"K hoch"}),i.jsx("span",{className:`${g?"text-[8px] px-1 py-0":"text-[10px] px-1.5 py-0.5"} font-medium bg-gray-100 text-gray-500 rounded border border-gray-200`,children:"Quyt nh"}),i.jsx("span",{className:`${g?"text-[8px] px-1 py-0":"text-[10px] px-1.5 py-0.5"} font-medium bg-gray-100 text-gray-500 rounded border border-gray-200`,children:"Bo co"})]})]})]})]}),(e.role==="admin"||e.role==="vice_principal"||e.role==="staff"||e.group==="T Vn Phng")&&i.jsxs("div",{className:`group relative overflow-hidden ${g?"rounded-xl":"rounded-2xl"} border border-indigo-100 bg-white shadow-lg transition-all duration-500 ease-out hover:-translate-y-1 hover:shadow-xl hover:shadow-indigo-200 hover:border-indigo-300 flex flex-col`,children:[i.jsx("div",{className:"absolute -right-10 -top-10 h-40 w-40 rounded-full bg-gradient-to-br from-indigo-50 to-purple-100 blur-3xl opacity-50 group-hover:opacity-80 transition-opacity"}),i.jsx("div",{className:`${g?"p-3":"p-5"} relative z-10 bg-gradient-to-r from-indigo-500 to-purple-500`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`${g?"h-9 w-9":"h-11 w-11"} inline-flex items-center justify-center rounded-xl bg-white/20 backdrop-blur-sm text-white shadow-sm`,children:i.jsx(Lh,{className:`${g?"h-5 w-5":"h-6 w-6"}`})}),i.jsxs("div",{children:[i.jsx("h3",{className:`${g?"text-sm":"text-base"} font-bold text-white`,children:"T VN PHNG"}),!g&&i.jsx("p",{className:"text-indigo-100 text-xs mt-0.5",children:"Qun l hnh chnh, nhn s, ti sn, y t, thc n v cc cng tc h tr khc."})]})]})}),i.jsxs("div",{className:`flex-1 grid grid-cols-2 gap-px bg-indigo-100/50 border-t border-indigo-50 ${g?"mt-1":"mt-4"}`,children:[i.jsxs("div",{onClick:()=>w("to-van-phong-ke-hoach"),className:`bg-white ${g?"p-3":"p-6"} cursor-pointer hover:bg-indigo-50/60 transition-colors group/item`,children:[i.jsx("div",{className:`${g?"mb-2":"mb-3"}`,children:i.jsx("div",{className:`${g?"p-1.5":"p-2"} bg-indigo-100 text-indigo-600 rounded-lg shadow-sm inline-block`,children:i.jsx(Ze,{className:`${g?"h-4 w-4":"h-5 w-5"}`})})}),i.jsx("h4",{className:`${g?"text-xs":"text-sm"} font-bold text-gray-800 mb-0.5 group-hover/item:text-indigo-700`,children:g?"K HOCH":"K HOCH & BO CO"}),i.jsx("p",{className:`${g?"text-[10px]":"text-xs"} text-gray-500 line-clamp-2`,children:g?"Ti chnh, Y t":"K hoch ti chnh, Y t, Hot ng chung"})]}),i.jsxs("div",{onClick:()=>w("to-van-phong-thuc-don"),className:`bg-white ${g?"p-3":"p-6"} cursor-pointer hover:bg-purple-50/60 transition-colors group/item`,children:[i.jsx("div",{className:`${g?"mb-2":"mb-3"}`,children:i.jsx("div",{className:`${g?"p-1.5":"p-2"} bg-purple-100 text-purple-600 rounded-lg shadow-sm inline-block`,children:i.jsx(gg,{className:`${g?"h-4 w-4":"h-5 w-5"}`})})}),i.jsx("h4",{className:`${g?"text-xs":"text-sm"} font-bold text-gray-800 mb-0.5 group-hover/item:text-purple-700`,children:g?"THC N":"THC N & BN TR"}),i.jsx("p",{className:`${g?"text-[10px]":"text-xs"} text-gray-500 line-clamp-2`,children:g?"V sinh ATTP":"Qun l thc n tun v V sinh ATTP"})]})]})]}),(e.role==="admin"||e.role==="vice_principal"||e.role==="head_teacher"||e.role==="vice_head_teacher"||e.role==="teacher")&&i.jsxs("div",{className:`group relative overflow-hidden ${g?"rounded-xl":"rounded-2xl"} border border-amber-100 bg-white shadow-lg transition-all duration-500 ease-out hover:-translate-y-1 hover:shadow-xl hover:shadow-amber-200 hover:border-amber-300 flex flex-col`,children:[i.jsx("div",{className:"absolute -right-10 -top-10 h-40 w-40 rounded-full bg-gradient-to-br from-amber-50 to-orange-100 blur-3xl opacity-50 group-hover:opacity-80 transition-opacity"}),i.jsx("div",{className:`${g?"p-3":"p-5"} relative z-10 bg-gradient-to-r from-amber-500 to-orange-500`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`${g?"h-9 w-9":"h-11 w-11"} inline-flex items-center justify-center rounded-xl bg-white/20 backdrop-blur-sm text-white shadow-sm`,children:i.jsx(n0,{className:`${g?"h-5 w-5":"h-6 w-6"}`})}),i.jsxs("div",{children:[i.jsx("h3",{className:`${g?"text-sm":"text-base"} font-bold text-white`,children:"T CHUYN MN"}),!g&&i.jsx("p",{className:"text-amber-100 text-xs mt-0.5",children:"K hoch ging dy, bi son, chuyn , d liu cc lp v ti liu tham kho."})]})]})}),i.jsx("div",{className:`${g?"px-4 pb-2":"px-6 pb-4"} relative z-10`,children:i.jsxs("div",{onClick:()=>w("to-chuyen-mon-ke-hoach"),className:`flex items-center justify-between ${g?"p-2":"p-3"} rounded-xl bg-amber-50 border border-amber-100 cursor-pointer hover:bg-amber-100 transition-colors group/plan`,children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`${g?"p-1.5":"p-2"} bg-white rounded-lg text-amber-600 shadow-sm`,children:i.jsx(ZS,{className:`${g?"h-4 w-4":"h-5 w-5"}`})}),i.jsx("div",{children:i.jsx("h4",{className:`${g?"text-xs":"text-sm"} font-bold text-gray-800 group-hover/plan:text-amber-700`,children:g?"K hoch T":"K hoch T & Bin bn"})})]}),!g&&i.jsx("div",{className:"text-xs font-bold text-amber-600 underline opacity-0 group-hover/plan:opacity-100 transition-opacity",children:"Xem chi tit"})]})}),i.jsxs("div",{className:`flex-1 bg-gray-50/50 border-t border-amber-100 ${g?"p-4 pt-3":"p-6 pt-4"}`,children:[i.jsx("div",{className:`${g?"mb-2":"mb-4"}`,children:i.jsx("h4",{className:`${g?"text-xs":"text-sm"} font-bold text-gray-700 uppercase tracking-wider border-l-4 border-amber-400 pl-2`,children:"LP HC CA TI"})}),i.jsx("div",{className:`grid ${g?"grid-cols-4 gap-1.5":"grid-cols-3 gap-2"}`,children:p.map(D=>{var q;if(e.role==="teacher"){const L=(q=e.accessScope)==null?void 0:q.toLowerCase().trim(),W=D.id.toLowerCase(),re=D.name.toLowerCase();if(L!==W&&L!==re)return null}return i.jsxs("button",{onClick:()=>w(`class-${D.id}`),className:`relative group/btn flex flex-col items-center justify-center ${g?"py-1.5 px-1":"py-2 px-1"} bg-white border border-gray-200 rounded-lg shadow-sm hover:border-amber-300 hover:shadow-md hover:bg-amber-50 transition-all`,children:[i.jsx("span",{className:`${g?"text-[10px]":"text-xs"} font-bold text-gray-700 group-hover/btn:text-amber-800`,children:D.name}),D.newFiles>0&&i.jsx("span",{className:"absolute -top-1 -right-1 h-2.5 w-2.5 bg-red-500 rounded-full border-2 border-white shadow-sm animate-pulse"})]},D.id)})})]})]}),e.role==="admin"&&i.jsx(fO,{currentSchoolYear:a,classes:p}),(e.role==="admin"||e.role==="vice_principal"&&((R=e.permissions)==null?void 0:R.includes("access_system_admin")))&&IA.map(D=>i.jsx(hO,{data:D,onClick:w},D.id))]})})]})},TT=s=>{try{const e=new URL(s),t=decodeURIComponent(e.pathname).toLowerCase();return[".doc",".docx",".xls",".xlsx",".ppt",".pptx"].some(o=>t.endsWith(o))}catch{const t=s.toLowerCase().split("?")[0];return[".doc",".docx",".xls",".xlsx",".ppt",".pptx"].some(o=>t.endsWith(o))}},gO=s=>{try{const e=new URL(s);return decodeURIComponent(e.pathname).toLowerCase().endsWith(".pdf")}catch{return s.toLowerCase().split("?")[0].endsWith(".pdf")}},Yu=(s,e=!1)=>!s||s==="#"?"#":s.toLowerCase().includes(".xls")?"EXCEL_NO_PREVIEW":TT(s)?`https://docs.google.com/viewer?url=${encodeURIComponent(s)}&embedded=true`:gO(s)&&e?`https://docs.google.com/viewer?url=${encodeURIComponent(s)}&embedded=true`:s,xO=()=>{var Ee;const s=ar(),{addToast:e}=jr(),[t,a]=T.useState([]),[o,u]=T.useState(""),[d,p]=T.useState("Tt c"),[x,g]=T.useState("newest"),{user:b}=vs(),w=na(),N=(Ee=b==null?void 0:b.permissions)==null?void 0:Ee.includes("manage_documents"),[R,D]=T.useState(null),[q,L]=T.useState(!1),[W,re]=T.useState(!1),[$,z]=T.useState(!1),[he,_e]=T.useState("preview"),[S,C]=T.useState(!1),[k,M]=T.useState(null),[I,O]=T.useState({}),[E,ve]=T.useState(null),[Te,X]=T.useState("");T.useEffect(()=>{const F=mn(Tt(Ae,"directive_documents"),Jo("ngayBanHanh","desc")),je=zs(F,le=>{const ke=[];le.forEach(Me=>{ke.push({id:Me.id,...Me.data()})}),a(ke)});return()=>je()},[]);const Z=T.useMemo(()=>{let F=t.filter(je=>{const le=je.trichYeu.toLowerCase().includes(o.toLowerCase())||je.soKyHieu.toLowerCase().includes(o.toLowerCase()),ke=d==="Tt c"||je.coQuanBanHanh===d;return le&&ke});return F.sort((je,le)=>{const ke=new Date(je.ngayBanHanh).getTime(),Me=new Date(le.ngayBanHanh).getTime();return x==="newest"?Me-ke:ke-Me}),F},[t,o,d,x]),Se=(F,je)=>{je.stopPropagation(),M(F),C(!0)},Be=async()=>{if(k){try{await Cl(qe(Ae,"directive_documents",k.id)),e(" xa ti liu thnh cng","D liu  c cp nht.","success")}catch(F){console.error("Error deleting document:",F),e("Li xa ti liu","Khng th xa ti liu ny.","error")}C(!1),M(null)}},Pe=F=>{D(F),_e("preview"),L(!0)},V=()=>{O({trichYeu:"",soKyHieu:"",coQuanBanHanh:"B GD&T",ngayBanHanh:new Date().toISOString().split("T")[0],loaiVanBan:"Cng vn",tomTatNoiDung:""}),ve(null),X(""),z(!1),re(!0)},oe=(F,je)=>{je.stopPropagation(),O({...F}),z(!0),ve(null),X(F.fileDinhKemUrl?"Van_ban_dinh_kem.pdf":""),re(!0)},de=F=>{if(F.target.files&&F.target.files[0]){const je=F.target.files[0];ve(je),X(je.name)}},ye=F=>{F.fileDinhKemUrl&&F.fileDinhKemUrl!=="#"?window.open(F.fileDinhKemUrl,"_blank"):e("Khng c file","Vn bn ny khng c file nh km.","warning")},Y=()=>{ve(null),X("")},be=async F=>{if(F.preventDefault(),!(!I.trichYeu||!I.soKyHieu))try{let je=I.fileDinhKemUrl||"#";if(E){const ke=rr(Ls,`directive_documents/${Date.now()}_${E.name}`),Me=await nr(ke,E);je=await sr(Me.ref)}else!Te&&!I.fileDinhKemUrl&&(je="#");const le={...I,fileDinhKemUrl:je,...$?{}:{createdAt:new Date().toISOString()}};$&&I.id?(await Qt(qe(Ae,"directive_documents",I.id),le),e("Cp nht thnh cng","Thng tin vn bn  c lu.","success")):(await Al(Tt(Ae,"directive_documents"),le),e("Thm mi thnh cng","Vn bn  c thm vo h thng.","success")),re(!1)}catch(je){console.error("Error saving document:",je),e("Li lu d liu","Khng th lu vn bn ny.","error")}},B=F=>{switch(F){case"B GD&T":return"bg-red-50 text-red-600 border-red-100";case"S GD&T":return"bg-blue-50 text-blue-600 border-blue-100";case"UBND Tnh":return"bg-emerald-50 text-emerald-600 border-emerald-100";default:return"bg-gray-50 text-gray-600 border-gray-100"}},ce=F=>{switch(F){case"Quyt nh":return i.jsx(ys,{className:"h-5 w-5 text-emerald-500"});case"K hoch":return i.jsx(Da,{className:"h-5 w-5 text-amber-500"});case"Thng bo":return i.jsx(Yn,{className:"h-5 w-5 text-blue-500"});default:return i.jsx(Ze,{className:"h-5 w-5 text-red-500"})}},K=F=>{const je=["bg-blue-100 text-blue-700 border-blue-200","bg-indigo-100 text-indigo-700 border-indigo-200","bg-purple-100 text-purple-700 border-purple-200","bg-fuchsia-100 text-fuchsia-700 border-fuchsia-200","bg-pink-100 text-pink-700 border-pink-200","bg-rose-100 text-rose-700 border-rose-200","bg-orange-100 text-orange-700 border-orange-200","bg-amber-100 text-amber-700 border-amber-200","bg-emerald-100 text-emerald-700 border-emerald-200","bg-teal-100 text-teal-700 border-teal-200","bg-cyan-100 text-cyan-700 border-cyan-200","bg-sky-100 text-sky-700 border-sky-200"],le=F.id.split("").reduce((Me,Xe)=>Me+Xe.charCodeAt(0),0),ke=je[le%je.length];return i.jsx("span",{className:`${ke} text-[10px] font-bold px-2.5 py-1 rounded-md uppercase tracking-wider shadow-sm border`,children:F.soKyHieu})};return i.jsxs("div",{className:"min-h-screen bg-[#F8FAFC] animate-in fade-in duration-500 pb-20",children:[i.jsx("div",{className:"bg-white sticky top-0 z-30 border-b border-gray-200 shadow-sm",children:i.jsx("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between h-auto md:h-16 py-3 md:py-0 gap-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[!w&&i.jsx("button",{onClick:()=>s("/"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors text-gray-500",children:i.jsx(cf,{className:"h-5 w-5"})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"bg-blue-600 p-1.5 rounded-lg text-white shadow-md shadow-blue-200",children:i.jsx(Ze,{className:"h-5 w-5"})}),i.jsx("h1",{className:"text-lg md:text-xl font-bold text-gray-900 tracking-tight",children:"VN BN CH O"})]})]}),i.jsx("div",{className:"flex-1 max-w-2xl px-0 md:px-8 w-full",children:i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:i.jsx(Tl,{className:"h-4 w-4 text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),i.jsx("input",{type:"text",className:"block w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-xl leading-5 placeholder-gray-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 sm:text-sm transition-all shadow-sm group-focus-within:shadow-md",placeholder:"Tm kim vn bn, quyt nh, thng bo...",value:o,onChange:F=>u(F.target.value)})]})}),i.jsxs("div",{className:"flex items-center justify-between md:justify-end w-full md:w-auto mt-2 md:mt-0 gap-3",children:[i.jsx("div",{className:"flex items-center gap-2 no-scrollbar overflow-x-auto w-full md:w-auto",children:["Tt c","B GD&T","S GD&T"].map(F=>i.jsx("button",{onClick:()=>p(F),className:`whitespace-nowrap px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${d===F?"bg-gray-900 text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-200"}`,children:F},F))}),N&&i.jsxs("button",{onClick:V,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700 transition-all shadow-md shadow-blue-200 active:scale-95 flex-shrink-0",children:[i.jsx(ko,{className:"h-4 w-4"}),i.jsx("span",{className:"text-sm font-semibold",children:w?"Thm":"Thm vn bn"})]})]})]})})}),i.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Vn bn mi nht"}),i.jsxs("div",{className:"flex items-center text-sm text-gray-500 cursor-pointer hover:text-blue-600 transition-colors select-none",onClick:()=>g(F=>F==="newest"?"oldest":"newest"),children:["Sp xp theo:",i.jsxs("span",{className:"font-semibold text-blue-600 ml-1 flex items-center gap-1",children:[x==="newest"?"Mi nht":"C nht",x==="newest"?i.jsx(s1,{className:"h-3.5 w-3.5"}):i.jsx(r1,{className:"h-3.5 w-3.5"})]})]})]}),Z.length>0?i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Z.map(F=>i.jsxs("div",{onClick:()=>Pe(F),className:"group bg-white rounded-2xl p-5 border border-gray-100 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300 cursor-pointer relative overflow-hidden flex flex-col h-full",children:[i.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-gray-50 to-white rounded-bl-[100px] -z-0 opacity-50 group-hover:opacity-100 transition-opacity pointer-events-none"}),i.jsxs("div",{className:"flex items-start justify-between mb-4 relative z-10",children:[i.jsx("div",{className:`p-2.5 rounded-xl ${F.fileDinhKemUrl&&F.fileDinhKemUrl.endsWith(".pdf")?"bg-red-50":"bg-blue-50"}`,children:ce(F.loaiVanBan)}),K(F)]}),i.jsxs("div",{className:"flex-1 relative z-10",children:[i.jsx("h3",{className:"text-base font-bold text-gray-900 mb-2 line-clamp-2 group-hover:text-blue-600 transition-colors",title:F.trichYeu,children:F.trichYeu}),i.jsx("p",{className:"text-xs text-gray-500 mb-4 line-clamp-3 leading-relaxed",children:F.tomTatNoiDung||"Cha c tm tt ni dung. Bm vo  xem chi tit vn bn y ."})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-50 relative z-10",children:[i.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[i.jsxs("span",{className:"text-[10px] px-2 py-1 rounded-md font-medium bg-gray-100 text-gray-600",children:["#",F.loaiVanBan]}),i.jsxs("span",{className:`text-[10px] px-2 py-1 rounded-md font-medium ${B(F.coQuanBanHanh)}`,children:["#",F.coQuanBanHanh]})]}),i.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(Da,{className:"h-3.5 w-3.5"}),new Date(F.ngayBanHanh).toLocaleDateString("vi-VN")]}),N&&i.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",onClick:je=>je.stopPropagation(),children:[i.jsx("button",{onClick:je=>oe(F,je),className:"p-1.5 hover:bg-amber-50 text-gray-400 hover:text-amber-600 rounded",children:i.jsx(Io,{className:"h-3.5 w-3.5"})}),i.jsx("button",{onClick:je=>Se(F,je),className:"p-1.5 hover:bg-red-50 text-gray-400 hover:text-red-600 rounded",children:i.jsx(hn,{className:"h-3.5 w-3.5"})})]})]})]})]},F.id))}):i.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white rounded-3xl border border-dashed border-gray-200",children:[i.jsx("div",{className:"bg-blue-50 p-4 rounded-full mb-4",children:i.jsx(Ze,{className:"h-8 w-8 text-blue-400"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Khng tm thy ti liu no"}),i.jsx("p",{className:"text-gray-500 text-sm",children:"Th thay i b lc hoc t kha tm kim"})]})]}),q&&R&&i.jsxs("div",{className:"fixed inset-0 z-[100] bg-gray-900 flex flex-col animate-in slide-in-from-bottom-5 duration-300",children:[i.jsxs("div",{className:"h-14 bg-[#1A1A1A] border-b border-gray-800 flex items-center justify-between px-4 lg:px-6 flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-4 overflow-hidden",children:[i.jsx("button",{onClick:()=>L(!1),className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:i.jsx(fn,{className:"h-5 w-5"})}),i.jsx("div",{className:"flex flex-col overflow-hidden",children:i.jsx("h3",{className:"text-sm md:text-base font-semibold text-white truncate max-w-xs md:max-w-md lg:max-w-xl",children:R.trichYeu})})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsxs("button",{onClick:()=>ye(R),className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs md:text-sm font-medium rounded-lg transition-colors",children:[i.jsx(Qn,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Ti xung"})]})})]}),i.jsxs("div",{className:"flex-1 flex overflow-hidden relative",children:[i.jsxs("div",{className:`flex-1 bg-[#2C2C2C] relative flex flex-col transition-all duration-300 ${w&&he==="info"?"hidden":"flex"}`,children:[i.jsxs("div",{className:"h-8 bg-[#2C2C2C] border-b border-white/5 flex items-center justify-between px-4",children:[i.jsxs("span",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-semibold flex items-center gap-1",children:[i.jsx(Ze,{className:"h-3 w-3"})," Xem trc"]}),R.fileDinhKemUrl&&R.fileDinhKemUrl!=="#"&&i.jsxs("button",{onClick:()=>window.open(R.fileDinhKemUrl,"_blank"),className:"text-[10px] text-gray-500 hover:text-gray-300 hover:underline flex items-center gap-1 transition-colors",children:["M tab mi ",i.jsx(df,{className:"h-3 w-3"})]})]}),i.jsx("div",{className:"flex-1 w-full h-full bg-white relative overflow-hidden",children:R.fileDinhKemUrl&&R.fileDinhKemUrl!=="#"?i.jsx("iframe",{src:Yu(R.fileDinhKemUrl,w),className:"w-full h-full border-0 block",title:"Preview"}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[i.jsx("div",{className:"bg-white/5 p-6 rounded-full mb-4",children:i.jsx(Ze,{className:"h-12 w-12 text-gray-300"})}),i.jsx("p",{className:"text-gray-400",children:"Khng c bn xem trc"})]})})]}),i.jsxs("div",{className:`w-full md:w-[320px] lg:w-[360px] bg-white border-l border-gray-200 flex flex-col h-full overflow-y-auto ${w?he==="info"?"block":"hidden":"block"}`,children:[i.jsxs("div",{className:"p-5 border-b border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400 font-medium text-[10px] uppercase tracking-wider mb-3",children:[i.jsx(yl,{className:"h-3.5 w-3.5"})," Thng tin vn bn"]}),i.jsx("h2",{className:"text-base font-bold text-gray-900 leading-snug mb-3",children:R.trichYeu}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-700 font-bold text-xs",children:R.coQuanBanHanh.charAt(0)}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-gray-900",children:R.coQuanBanHanh}),i.jsx("p",{className:"text-xs text-gray-500",children:new Date(R.ngayBanHanh).toLocaleDateString("vi-VN")})]})]})]}),i.jsxs("div",{className:"p-5 space-y-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Phn loi"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded bg-gray-100 text-gray-700 text-xs",children:[i.jsx(o1,{className:"h-3 w-3"}),R.loaiVanBan]}),i.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded bg-blue-50 text-blue-700 text-xs",children:[i.jsx(hg,{className:"h-3 w-3"}),R.coQuanBanHanh]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100",children:[i.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-semibold mb-1",children:"S k hiu"}),i.jsx("p",{className:"text-sm font-mono font-medium text-gray-900 truncate",title:R.soKyHieu,children:R.soKyHieu})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100",children:[i.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-semibold mb-1",children:"Ngy ban hnh"}),i.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(R.ngayBanHanh).toLocaleDateString("vi-VN")})]})]}),R.tomTatNoiDung&&i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Tm tt ni dung"}),i.jsx("div",{className:"text-sm text-gray-700 leading-relaxed bg-yellow-50/50 p-3 rounded-lg border border-yellow-100",children:R.tomTatNoiDung})]})]}),i.jsx("div",{className:"mt-auto p-4 border-t border-gray-100 bg-gray-50",children:i.jsxs("button",{onClick:()=>ye(R),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-white border border-gray-200 hover:border-blue-400 text-gray-700 hover:text-blue-600 rounded-lg shadow-sm transition-all text-sm font-medium",children:[i.jsx(Qn,{className:"h-4 w-4"})," Ti v my"]})})]}),w&&i.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-white border-t border-gray-200 flex text-xs font-medium safe-area-inset-bottom z-10 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)]",children:[i.jsxs("button",{onClick:()=>_e("preview"),className:`flex-1 py-3 flex flex-col items-center justify-center gap-1 ${he==="preview"?"text-blue-600 bg-blue-50/50":"text-gray-500"}`,children:[i.jsx(Ze,{className:"h-5 w-5"}),i.jsx("span",{children:"Vn bn"})]}),i.jsxs("button",{onClick:()=>_e("info"),className:`flex-1 py-3 flex flex-col items-center justify-center gap-1 ${he==="info"?"text-blue-600 bg-blue-50/50":"text-gray-500"}`,children:[i.jsx(yl,{className:"h-5 w-5"}),i.jsx("span",{children:"Thng tin"})]})]})]})]}),W&&i.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in zoom-in-95 duration-200",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"bg-gray-900 px-6 py-4 flex justify-between items-center text-white",children:[i.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[$?i.jsx(Io,{className:"h-5 w-5"}):i.jsx(ko,{className:"h-5 w-5"}),$?"Cp nht vn bn":"Thm vn bn mi"]}),i.jsx("button",{onClick:()=>re(!1),className:"text-gray-400 hover:text-white",children:i.jsx(fn,{className:"h-6 w-6"})})]}),i.jsx("div",{className:"p-6 overflow-y-auto custom-scrollbar",children:i.jsxs("form",{id:"documentForm",onSubmit:be,className:"space-y-5",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("label",{className:"text-sm font-semibold text-gray-700",children:["Trch yu vn bn ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{required:!0,rows:3,className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm",placeholder:"Nhp ni dung trch yu...",value:I.trichYeu||"",onChange:F=>O({...I,trichYeu:F.target.value})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("label",{className:"text-sm font-semibold text-gray-700",children:["S / K hiu ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",required:!0,className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm",value:I.soKyHieu||"",onChange:F=>O({...I,soKyHieu:F.target.value})})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("label",{className:"text-sm font-semibold text-gray-700",children:["Ngy ban hnh ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"date",required:!0,className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm",value:I.ngayBanHanh||"",onChange:F=>O({...I,ngayBanHanh:F.target.value})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"C quan ban hnh"}),i.jsx("select",{className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm bg-white",value:I.coQuanBanHanh||"B GD&T",onChange:F=>O({...I,coQuanBanHanh:F.target.value}),children:["B GD&T","S GD&T","UBND Tnh","UBND Phng","Khc"].map(F=>i.jsx("option",{value:F,children:F},F))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Loi vn bn"}),i.jsx("select",{className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm bg-white",value:I.loaiVanBan||"Cng vn",onChange:F=>O({...I,loaiVanBan:F.target.value}),children:["Cng vn","Quyt nh","Thng bo","K hoch","Ngh quyt","Khc"].map(F=>i.jsx("option",{value:F,children:F},F))})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Tm tt ni dung"}),i.jsx("textarea",{rows:4,className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm",placeholder:"Tm tt ngn gn ni dung vn bn...",value:I.tomTatNoiDung||"",onChange:F=>O({...I,tomTatNoiDung:F.target.value})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"File nh km"}),Te?i.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-xl",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"bg-white p-2 rounded-lg text-blue-600",children:i.jsx(Ze,{className:"h-5 w-5"})}),i.jsx("span",{className:"text-sm font-medium text-blue-900 truncate max-w-[200px]",children:Te})]}),i.jsx("button",{type:"button",onClick:Y,className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:i.jsx(hn,{className:"h-4 w-4"})})]}):i.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-6 flex flex-col items-center justify-center hover:bg-gray-50 hover:border-blue-400 transition-all cursor-pointer relative group",children:[i.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:de,accept:".pdf,.doc,.docx"}),i.jsx(En,{className:"h-8 w-8 text-gray-400 group-hover:text-blue-500 mb-2 transition-colors"}),i.jsx("p",{className:"text-sm text-gray-500 group-hover:text-blue-600 font-medium",children:"Bm  chn file hoc ko th"}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"H tr PDF, DOCX (Max 10MB)"})]})]})]})}),i.jsxs("div",{className:"p-4 border-t border-gray-100 bg-gray-50 flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>re(!1),className:"px-5 py-2.5 rounded-xl text-gray-600 hover:bg-gray-200 font-medium text-sm transition-colors",children:"Hy b"}),i.jsx("button",{type:"submit",form:"documentForm",className:"px-6 py-2.5 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-bold text-sm shadow-md shadow-blue-200 transition-all transform active:scale-95",children:$?"Lu thay i":"To vn bn"})]})]})}),S&&k&&i.jsx("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm p-6 text-center",children:[i.jsx("div",{className:"w-14 h-14 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(hn,{className:"h-7 w-7"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Xa vn bn ny?"}),i.jsxs("p",{className:"text-sm text-gray-500 mb-6 leading-relaxed",children:["Bn c chc chn mun xa vn bn ",i.jsxs("strong",{children:['"',k.trichYeu,'"']}),"? Hnh ng ny khng th hon tc."]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>C(!1),className:"flex-1 py-2.5 rounded-xl border border-gray-300 text-gray-700 font-medium hover:bg-gray-50",children:"Hy"}),i.jsx("button",{onClick:Be,className:"flex-1 py-2.5 rounded-xl bg-red-600 text-white font-bold shadow-md hover:bg-red-700",children:"Xa ngay"})]})]})})]})},yO=()=>{var je;const s=ar(),{addToast:e}=jr(),{currentSchoolYear:t}=Gu(),[a,o]=T.useState([]),[u,d]=T.useState(""),[p,x]=T.useState("Tt c"),[g,b]=T.useState("newest"),{user:w}=vs(),N=na(),R=(je=w==null?void 0:w.permissions)==null?void 0:je.includes("manage_documents"),[D,q]=T.useState(null),[L,W]=T.useState(!1),[re,$]=T.useState(!1),[z,he]=T.useState(!1),[_e,S]=T.useState("preview"),[C,k]=T.useState(!1),[M,I]=T.useState(null),[O,E]=T.useState({}),[ve,Te]=T.useState(null),[X,Z]=T.useState("");T.useEffect(()=>{const le=mn(Tt(Ae,"school_documents"),Jo("ngayBanHanh","desc")),ke=zs(le,Me=>{const Xe=[];Me.forEach(nt=>{const xt=nt.data();(xt.schoolYear||"2025-2026")===t&&Xe.push({id:nt.id,...xt})}),o(Xe)});return()=>ke()},[t]);const Se=T.useMemo(()=>{let le=a.filter(ke=>{const Me=ke.trichYeu.toLowerCase().includes(u.toLowerCase())||ke.soKyHieu.toLowerCase().includes(u.toLowerCase()),Xe=p==="Tt c"||ke.loaiVanBan===p;return Me&&Xe});return le.sort((ke,Me)=>{const Xe=new Date(ke.ngayBanHanh).getTime(),nt=new Date(Me.ngayBanHanh).getTime();return g==="newest"?nt-Xe:Xe-nt}),le},[a,u,p,g]),Be=(le,ke)=>{ke.stopPropagation(),I(le),k(!0)},Pe=async()=>{if(M){try{await Cl(qe(Ae,"school_documents",M.id)),e(" xa ti liu thnh cng","D liu  c cp nht.","success")}catch(le){console.error("Error deleting document:",le),e("Li xa ti liu","Khng th xa ti liu ny.","error")}k(!1),I(null)}},V=le=>{q(le),S("preview"),W(!0)},oe=()=>{E({trichYeu:"",soKyHieu:"",coQuanBanHanh:"Ban Gim Hiu",ngayBanHanh:new Date().toISOString().split("T")[0],loaiVanBan:"K hoch",tomTatNoiDung:""}),Te(null),Z(""),he(!1),$(!0)},de=(le,ke)=>{ke.stopPropagation(),E({...le}),he(!0),Te(null),Z(le.fileDinhKemUrl?"Van_ban_dinh_kem.pdf":""),$(!0)},ye=le=>{if(le.target.files&&le.target.files[0]){const ke=le.target.files[0];Te(ke),Z(ke.name)}},Y=le=>{le.fileDinhKemUrl&&le.fileDinhKemUrl!=="#"?window.open(le.fileDinhKemUrl,"_blank"):e("Khng c file","Vn bn ny khng c file nh km.","warning")},be=()=>{Te(null),Z("")},B=async le=>{if(le.preventDefault(),!(!O.trichYeu||!O.soKyHieu))try{let ke=O.fileDinhKemUrl||"#";if(ve){const Xe=rr(Ls,`school_documents/${Date.now()}_${ve.name}`),nt=await nr(Xe,ve);ke=await sr(nt.ref)}else!X&&!O.fileDinhKemUrl&&(ke="#");const Me={...O,fileDinhKemUrl:ke,schoolYear:t,...z?{}:{createdAt:new Date().toISOString()}};z&&O.id?(await Qt(qe(Ae,"school_documents",O.id),Me),e("Cp nht thnh cng","Thng tin vn bn  c lu.","success")):(await Al(Tt(Ae,"school_documents"),Me),e("Thm mi thnh cng","Vn bn  c thm vo h thng.","success")),$(!1)}catch(ke){console.error("Error saving document:",ke),e("Li lu d liu","Khng th lu vn bn ny.","error")}},ce=le=>{switch(le){case"K hoch":return"bg-emerald-50 text-emerald-600 border-emerald-100";case"Quyt nh":return"bg-amber-50 text-amber-600 border-amber-100";case"Thng bo":return"bg-blue-50 text-blue-600 border-blue-100";case"Bo co":return"bg-purple-50 text-purple-600 border-purple-100";default:return"bg-gray-50 text-gray-600 border-gray-100"}},K=le=>{switch(le){case"Quyt nh":return i.jsx(ys,{className:"h-5 w-5 text-emerald-500"});case"K hoch":return i.jsx(Da,{className:"h-5 w-5 text-amber-500"});case"Thng bo":return i.jsx(Yn,{className:"h-5 w-5 text-blue-500"});default:return i.jsx(Ze,{className:"h-5 w-5 text-emerald-500"})}},Ee=le=>{const ke=["bg-blue-100 text-blue-700 border-blue-200","bg-indigo-100 text-indigo-700 border-indigo-200","bg-purple-100 text-purple-700 border-purple-200","bg-fuchsia-100 text-fuchsia-700 border-fuchsia-200","bg-pink-100 text-pink-700 border-pink-200","bg-rose-100 text-rose-700 border-rose-200","bg-orange-100 text-orange-700 border-orange-200","bg-amber-100 text-amber-700 border-amber-200","bg-emerald-100 text-emerald-700 border-emerald-200","bg-teal-100 text-teal-700 border-teal-200","bg-cyan-100 text-cyan-700 border-cyan-200","bg-sky-100 text-sky-700 border-sky-200"],Me=le.id.split("").reduce((nt,xt)=>nt+xt.charCodeAt(0),0),Xe=ke[Me%ke.length];return i.jsx("span",{className:`${Xe} text-[10px] font-bold px-2.5 py-1 rounded-md uppercase tracking-wider shadow-sm border`,children:le.soKyHieu})},F=["Tt c","K hoch","Quyt nh","Thng bo","Bo co","Vn bn khc"];return i.jsxs("div",{className:"min-h-screen bg-[#F8FAFC] animate-in fade-in duration-500 pb-20",children:[i.jsx("div",{className:"bg-white sticky top-0 z-30 border-b border-gray-200 shadow-sm",children:i.jsx("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between h-auto md:h-16 py-3 md:py-0 gap-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[!N&&i.jsx("button",{onClick:()=>s("/"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors text-gray-500",children:i.jsx(cf,{className:"h-5 w-5"})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"bg-emerald-600 p-1.5 rounded-lg text-white shadow-md shadow-emerald-200",children:i.jsx(hg,{className:"h-5 w-5"})}),i.jsx("h1",{className:"text-lg md:text-xl font-bold text-gray-900 tracking-tight",children:"VN BN CA TRNG"})]})]}),i.jsx("div",{className:"flex-1 max-w-2xl px-0 md:px-8 w-full",children:i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:i.jsx(Tl,{className:"h-4 w-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors"})}),i.jsx("input",{type:"text",className:"block w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-xl leading-5 placeholder-gray-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 sm:text-sm transition-all shadow-sm group-focus-within:shadow-md",placeholder:"Tm kim vn bn, k hoch, quyt nh...",value:u,onChange:le=>d(le.target.value)})]})}),i.jsxs("div",{className:"flex items-center justify-between md:justify-end w-full md:w-auto mt-2 md:mt-0 gap-3",children:[i.jsx("div",{className:"flex items-center gap-2 no-scrollbar overflow-x-auto w-full md:w-auto",children:F.map(le=>i.jsx("button",{onClick:()=>x(le),className:`whitespace-nowrap px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${p===le?"bg-gray-900 text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-200"}`,children:le},le))}),R&&i.jsxs("button",{onClick:oe,className:"flex items-center gap-2 bg-emerald-600 text-white px-4 py-2 rounded-xl hover:bg-emerald-700 transition-all shadow-md shadow-emerald-200 active:scale-95 flex-shrink-0",children:[i.jsx(ko,{className:"h-4 w-4"}),i.jsx("span",{className:"text-sm font-semibold",children:N?"Thm":"Thm vn bn"})]})]})]})})}),i.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[i.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["Vn bn - ",t]}),i.jsxs("div",{className:"flex items-center text-sm text-gray-500 cursor-pointer hover:text-emerald-600 transition-colors select-none",onClick:()=>b(le=>le==="newest"?"oldest":"newest"),children:["Sp xp theo:",i.jsxs("span",{className:"font-semibold text-emerald-600 ml-1 flex items-center gap-1",children:[g==="newest"?"Mi nht":"C nht",g==="newest"?i.jsx(s1,{className:"h-3.5 w-3.5"}):i.jsx(r1,{className:"h-3.5 w-3.5"})]})]})]}),Se.length>0?i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Se.map(le=>i.jsxs("div",{onClick:()=>V(le),className:"group bg-white rounded-2xl p-5 border border-gray-100 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300 cursor-pointer relative overflow-hidden flex flex-col h-full",children:[i.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-emerald-50 to-white rounded-bl-[100px] -z-0 opacity-50 group-hover:opacity-100 transition-opacity pointer-events-none"}),i.jsxs("div",{className:"flex items-start justify-between mb-4 relative z-10",children:[i.jsx("div",{className:`p-2.5 rounded-xl ${le.fileDinhKemUrl&&le.fileDinhKemUrl.endsWith(".pdf")?"bg-red-50":"bg-emerald-50"}`,children:K(le.loaiVanBan)}),Ee(le)]}),i.jsxs("div",{className:"flex-1 relative z-10",children:[i.jsx("h3",{className:"text-base font-bold text-gray-900 mb-2 line-clamp-2 group-hover:text-emerald-600 transition-colors",title:le.trichYeu,children:le.trichYeu}),i.jsx("p",{className:"text-xs text-gray-500 mb-4 line-clamp-3 leading-relaxed",children:le.tomTatNoiDung||"Cha c tm tt ni dung. Bm xem chi tit."})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-50 relative z-10",children:[i.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[i.jsxs("span",{className:`text-[10px] px-2 py-1 rounded-md font-medium ${ce(le.loaiVanBan)}`,children:["#",le.loaiVanBan]}),i.jsxs("span",{className:"text-[10px] px-2 py-1 rounded-md font-medium bg-gray-100 text-gray-600",children:["#",le.coQuanBanHanh]})]}),i.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(Da,{className:"h-3.5 w-3.5"}),new Date(le.ngayBanHanh).toLocaleDateString("vi-VN")]}),R&&i.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",onClick:ke=>ke.stopPropagation(),children:[i.jsx("button",{onClick:ke=>de(le,ke),className:"p-1.5 hover:bg-amber-50 text-gray-400 hover:text-amber-600 rounded",children:i.jsx(Io,{className:"h-3.5 w-3.5"})}),i.jsx("button",{onClick:ke=>Be(le,ke),className:"p-1.5 hover:bg-red-50 text-gray-400 hover:text-red-600 rounded",children:i.jsx(hn,{className:"h-3.5 w-3.5"})})]})]})]})]},le.id))}):i.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white rounded-3xl border border-dashed border-gray-200",children:[i.jsx("div",{className:"bg-emerald-50 p-4 rounded-full mb-4",children:i.jsx(Ze,{className:"h-8 w-8 text-emerald-400"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Khng tm thy ti liu no"}),i.jsx("p",{className:"text-gray-500 text-sm",children:"Th thay i b lc hoc t kha tm kim"})]})]}),L&&D&&i.jsxs("div",{className:"fixed inset-0 z-[100] bg-gray-900 flex flex-col animate-in slide-in-from-bottom-5 duration-300",children:[i.jsxs("div",{className:"h-14 bg-[#1A1A1A] border-b border-gray-800 flex items-center justify-between px-4 lg:px-6 flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-4 overflow-hidden",children:[i.jsx("button",{onClick:()=>W(!1),className:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors",children:i.jsx(fn,{className:"h-5 w-5"})}),i.jsx("div",{className:"flex flex-col overflow-hidden",children:i.jsx("h3",{className:"text-sm md:text-base font-semibold text-white truncate max-w-xs md:max-w-md lg:max-w-xl",children:D.trichYeu})})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsxs("button",{onClick:()=>Y(D),className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white text-xs md:text-sm font-medium rounded-lg transition-colors",children:[i.jsx(Qn,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Ti xung"})]})})]}),i.jsxs("div",{className:"flex-1 flex overflow-hidden relative",children:[i.jsxs("div",{className:`flex-1 bg-[#2C2C2C] relative flex flex-col transition-all duration-300 ${N&&_e==="info"?"hidden":"flex"}`,children:[i.jsxs("div",{className:"h-8 bg-[#2C2C2C] border-b border-white/5 flex items-center justify-between px-4",children:[i.jsxs("span",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-semibold flex items-center gap-1",children:[i.jsx(Ze,{className:"h-3 w-3"})," Xem trc"]}),D.fileDinhKemUrl&&D.fileDinhKemUrl!=="#"&&i.jsxs("button",{onClick:()=>window.open(D.fileDinhKemUrl,"_blank"),className:"text-[10px] text-gray-500 hover:text-gray-300 hover:underline flex items-center gap-1 transition-colors",children:["M tab mi ",i.jsx(df,{className:"h-3 w-3"})]})]}),i.jsx("div",{className:"flex-1 w-full h-full bg-white relative overflow-hidden",children:D.fileDinhKemUrl&&D.fileDinhKemUrl!=="#"?i.jsx("iframe",{src:Yu(D.fileDinhKemUrl,N),className:"w-full h-full border-0 block",title:"Preview"}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[i.jsx("div",{className:"bg-white/5 p-6 rounded-full mb-4",children:i.jsx(Ze,{className:"h-12 w-12 text-gray-300"})}),i.jsx("p",{className:"text-gray-400",children:"Khng c bn xem trc"})]})})]}),i.jsxs("div",{className:`w-full md:w-[320px] lg:w-[360px] bg-white border-l border-gray-200 flex flex-col h-full overflow-y-auto ${N?_e==="info"?"block":"hidden":"block"}`,children:[i.jsxs("div",{className:"p-5 border-b border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-1.5 text-gray-400 font-medium text-[10px] uppercase tracking-wider mb-3",children:[i.jsx(yl,{className:"h-3.5 w-3.5"})," Thng tin vn bn"]}),i.jsx("h2",{className:"text-base font-bold text-gray-900 leading-snug mb-3",children:D.trichYeu}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"h-8 w-8 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-700 font-bold text-xs",children:D.coQuanBanHanh.charAt(0)}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-semibold text-gray-900",children:D.coQuanBanHanh}),i.jsx("p",{className:"text-xs text-gray-500",children:new Date(D.ngayBanHanh).toLocaleDateString("vi-VN")})]})]})]}),i.jsxs("div",{className:"p-5 space-y-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Phn loi"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded bg-gray-100 text-gray-700 text-xs",children:[i.jsx(o1,{className:"h-3 w-3"}),D.loaiVanBan]}),i.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded bg-emerald-50 text-emerald-700 text-xs",children:[i.jsx(hg,{className:"h-3 w-3"}),D.coQuanBanHanh]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100",children:[i.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-semibold mb-1",children:"S k hiu"}),i.jsx("p",{className:"text-sm font-mono font-medium text-gray-900 truncate",title:D.soKyHieu,children:D.soKyHieu})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100",children:[i.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-semibold mb-1",children:"Ngy ban hnh"}),i.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(D.ngayBanHanh).toLocaleDateString("vi-VN")})]})]}),D.tomTatNoiDung&&i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:"Tm tt ni dung"}),i.jsx("div",{className:"text-sm text-gray-700 leading-relaxed bg-yellow-50/50 p-3 rounded-lg border border-yellow-100",children:D.tomTatNoiDung})]})]}),i.jsx("div",{className:"mt-auto p-4 border-t border-gray-100 bg-gray-50",children:i.jsxs("button",{onClick:()=>Y(D),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-white border border-gray-200 hover:border-emerald-400 text-gray-700 hover:text-emerald-600 rounded-lg shadow-sm transition-all text-sm font-medium",children:[i.jsx(Qn,{className:"h-4 w-4"})," Ti v my"]})})]}),N&&i.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-white border-t border-gray-200 flex text-xs font-medium safe-area-inset-bottom z-10 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)]",children:[i.jsxs("button",{onClick:()=>S("preview"),className:`flex-1 py-3 flex flex-col items-center justify-center gap-1 ${_e==="preview"?"text-emerald-600 bg-emerald-50/50":"text-gray-500"}`,children:[i.jsx(Ze,{className:"h-5 w-5"}),i.jsx("span",{children:"Vn bn"})]}),i.jsxs("button",{onClick:()=>S("info"),className:`flex-1 py-3 flex flex-col items-center justify-center gap-1 ${_e==="info"?"text-emerald-600 bg-emerald-50/50":"text-gray-500"}`,children:[i.jsx(yl,{className:"h-5 w-5"}),i.jsx("span",{children:"Thng tin"})]})]})]})]}),re&&i.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in zoom-in-95 duration-200",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"bg-gray-900 px-6 py-4 flex justify-between items-center text-white",children:[i.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[z?i.jsx(Io,{className:"h-5 w-5"}):i.jsx(ko,{className:"h-5 w-5"}),z?"Cp nht vn bn":"Thm vn bn mi"]}),i.jsx("button",{onClick:()=>$(!1),className:"text-gray-400 hover:text-white",children:i.jsx(fn,{className:"h-6 w-6"})})]}),i.jsx("div",{className:"p-6 overflow-y-auto custom-scrollbar",children:i.jsxs("form",{id:"documentForm",onSubmit:B,className:"space-y-5",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("label",{className:"text-sm font-semibold text-gray-700",children:["Trch yu vn bn ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{required:!0,rows:3,className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all text-sm",placeholder:"Nhp ni dung trch yu...",value:O.trichYeu||"",onChange:le=>E({...O,trichYeu:le.target.value})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("label",{className:"text-sm font-semibold text-gray-700",children:["S / K hiu ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",required:!0,className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all text-sm",value:O.soKyHieu||"",onChange:le=>E({...O,soKyHieu:le.target.value})})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("label",{className:"text-sm font-semibold text-gray-700",children:["Ngy ban hnh ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"date",required:!0,className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all text-sm",value:O.ngayBanHanh||"",onChange:le=>E({...O,ngayBanHanh:le.target.value})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"C quan ban hnh"}),i.jsx("select",{className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all text-sm bg-white",value:O.coQuanBanHanh||"Ban Gim Hiu",onChange:le=>E({...O,coQuanBanHanh:le.target.value}),children:["Ban Gim Hiu","Hiu Trng","T Chuyn Mn","T Vn Phng","Hi ng TKT","Khc"].map(le=>i.jsx("option",{value:le,children:le},le))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Loi vn bn"}),i.jsx("select",{className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all text-sm bg-white",value:O.loaiVanBan||"K hoch",onChange:le=>E({...O,loaiVanBan:le.target.value}),children:["K hoch","Quyt nh","Thng bo","Bo co","Vn bn khc"].map(le=>i.jsx("option",{value:le,children:le},le))})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Tm tt ni dung"}),i.jsx("textarea",{rows:4,className:"w-full border border-gray-300 rounded-xl px-4 py-2.5 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all text-sm",placeholder:"Tm tt ngn gn ni dung vn bn...",value:O.tomTatNoiDung||"",onChange:le=>E({...O,tomTatNoiDung:le.target.value})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"File nh km"}),X?i.jsxs("div",{className:"flex items-center justify-between p-3 bg-emerald-50 border border-emerald-200 rounded-xl",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"bg-white p-2 rounded-lg text-emerald-600",children:i.jsx(Ze,{className:"h-5 w-5"})}),i.jsx("span",{className:"text-sm font-medium text-emerald-900 truncate max-w-[200px]",children:X})]}),i.jsx("button",{type:"button",onClick:be,className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:i.jsx(hn,{className:"h-4 w-4"})})]}):i.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-6 flex flex-col items-center justify-center hover:bg-gray-50 hover:border-emerald-400 transition-all cursor-pointer relative group",children:[i.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:ye,accept:".pdf,.doc,.docx"}),i.jsx(En,{className:"h-8 w-8 text-gray-400 group-hover:text-emerald-500 mb-2 transition-colors"}),i.jsx("p",{className:"text-sm text-gray-500 group-hover:text-emerald-600 font-medium",children:"Bm  chn file hoc ko th"}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"H tr PDF, DOCX (Max 10MB)"})]})]})]})}),i.jsxs("div",{className:"p-4 border-t border-gray-100 bg-gray-50 flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>$(!1),className:"px-5 py-2.5 rounded-xl text-gray-600 hover:bg-gray-200 font-medium text-sm transition-colors",children:"Hy b"}),i.jsx("button",{type:"submit",form:"documentForm",className:"px-6 py-2.5 rounded-xl bg-emerald-600 hover:bg-emerald-700 text-white font-bold text-sm shadow-md shadow-emerald-200 transition-all transform active:scale-95",children:z?"Lu thay i":"To vn bn"})]})]})}),C&&M&&i.jsx("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm p-6 text-center",children:[i.jsx("div",{className:"w-14 h-14 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(hn,{className:"h-7 w-7"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Xa vn bn ny?"}),i.jsxs("p",{className:"text-sm text-gray-500 mb-6 leading-relaxed",children:["Bn c chc chn mun xa vn bn ",i.jsxs("strong",{children:['"',M.trichYeu,'"']}),"? Hnh ng ny khng th hon tc."]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>k(!1),className:"flex-1 py-2.5 rounded-xl border border-gray-300 text-gray-700 font-medium hover:bg-gray-50",children:"Hy"}),i.jsx("button",{onClick:Pe,className:"flex-1 py-2.5 rounded-xl bg-red-600 text-white font-bold shadow-md hover:bg-red-700",children:"Xa ngay"})]})]})})]})},bO=()=>{const{user:s}=vs(),{addToast:e}=jr(),[t,a]=T.useState(""),[o,u]=T.useState(""),[d,p]=T.useState(null),[x,g]=T.useState(!1),[b,w]=T.useState(""),[N,R]=T.useState(""),[D,q]=T.useState(null),[L,W]=T.useState(!1),[re,$]=T.useState("/login-background.jpg"),[z,he]=T.useState(""),[_e,S]=T.useState(null),[C,k]=T.useState(!1),[M,I]=T.useState(!0),[O,E]=T.useState(!1),[ve,Te]=T.useState(null),[X,Z]=T.useState(!1),[Se,Be]=T.useState(null),Pe=async()=>{if(s){E(!0),Te(null);try{let F=0,je=0;const le=await wr(Tt(Ae,"plans")),ke=rg(Ae);le.forEach(nt=>{const xt=nt.data();if(!xt.approval||!xt.approval.status){const jt=qe(Ae,"plans",nt.id);ke.update(jt,{approval:{status:"pending"},uploaderRole:xt.uploaderRole||"teacher"}),F++}}),F>0&&await ke.commit();const Me=await wr(Tt(Ae,"class_files")),Xe=rg(Ae);Me.forEach(nt=>{const xt=nt.data();if(!xt.approval||!xt.approval.status){const jt=qe(Ae,"class_files",nt.id);Xe.update(jt,{approval:{status:"pending"},uploaderRole:xt.uploaderRole||"teacher"}),je++}}),je>0&&await Xe.commit(),Te({plans:F,classFiles:je}),F>0||je>0?e("Migration hon thnh!",` cp nht ${F} k hoch v ${je} h s lp.`,"success"):e("Khng c g  cp nht","Tt c ti liu  c trng thi duyt.","success")}catch(F){console.error("Migration error:",F),e("Li Migration","Khng th cp nht d liu. Xem console  bit chi tit.","error")}finally{E(!1)}}},V=async()=>{if(!(!s||!window.confirm("Bn c chc mun xa tt c thng bo c c ng dn sai (/professional-group-plans)?"))){Z(!0),Be(null);try{let F=0;const je=await wr(Tt(Ae,"notifications")),le=[];if(je.forEach(ke=>{const Me=ke.data();Me.targetPath&&Me.targetPath.includes("/professional-group-plans")&&le.push(ke.id)}),le.length>0){for(let Me=0;Me<le.length;Me+=450){const Xe=le.slice(Me,Me+450),nt=rg(Ae);Xe.forEach(xt=>{nt.delete(qe(Ae,"notifications",xt))}),await nt.commit(),F+=Xe.length,console.log(`Deleted chunk: ${F}/${le.length}`)}e("Dn dp hon tt!",` xa ${F} thng bo c sai ng dn.`,"success")}else e("Khng c thng bo li","Tt c thng bo hin ti u hp l.","success");Be(F)}catch(F){console.error("Cleanup error details:",F);const je=F.code==="permission-denied"?"Li dn dp: Quyn truy cp b t chi. Vui lng kim tra li quyn Admin.":`Li dn dp: ${F.message||"Khng th xa d liu c."}`;e("Li",je,"error")}finally{Z(!1)}}};T.useEffect(()=>{(async()=>{try{const je=qe(Ae,"app_settings","login_background"),le=await vr(je);le.exists()&&le.data().imageUrl&&$(le.data().imageUrl);const ke=qe(Ae,"app_settings","system_logo"),Me=await vr(ke);Me.exists()&&Me.data().imageUrl&&a(Me.data().imageUrl);const Xe=qe(Ae,"app_settings","certification_logo"),nt=await vr(Xe);nt.exists()&&nt.data().imageUrl&&w(nt.data().imageUrl)}catch(je){console.error("Error fetching settings:",je)}finally{I(!1)}})()},[]);const oe=F=>{if(F.target.files&&F.target.files[0]){const je=F.target.files[0];if(!je.type.startsWith("image/")){e("Vui lng chn file hnh nh","Ch chp nhn file nh (JPG, PNG, etc.)","error");return}if(je.size>2*1024*1024){e("File qu ln","Logo khng c vt qu 2MB","error");return}p(je),u(URL.createObjectURL(je))}},de=async()=>{if(!(!d||!s)){g(!0);try{const F=Date.now(),je=rr(Ls,`app_settings/system-logo-${F}.png`);await nr(je,d);const le=await sr(je);await Eo(qe(Ae,"app_settings","system_logo"),{imageUrl:le,updatedAt:new Date().toISOString(),updatedBy:s.id,updatedByName:s.fullName}),a(le),u(""),p(null),e("Thnh cng!"," cp nht logo h thng","success"),setTimeout(()=>window.location.reload(),1500)}catch(F){console.error("Error uploading logo:",F),e("Li ti ln","Khng th cp nht logo. Vui lng th li.","error")}finally{g(!1)}}},ye=()=>{u(""),p(null)},Y=F=>{if(F.target.files&&F.target.files[0]){const je=F.target.files[0];if(!je.type.startsWith("image/")){e("Vui lng chn file hnh nh","Ch chp nhn file nh (JPG, PNG, etc.)","error");return}if(je.size>2*1024*1024){e("File qu ln","Logo khng c vt qu 2MB","error");return}q(je),R(URL.createObjectURL(je))}},be=async()=>{if(!(!D||!s)){W(!0);try{const F=Date.now(),je=rr(Ls,`app_settings/cert-logo-${F}.png`);await nr(je,D);const le=await sr(je);await Eo(qe(Ae,"app_settings","certification_logo"),{imageUrl:le,updatedAt:new Date().toISOString(),updatedBy:s.id,updatedByName:s.fullName}),w(le),R(""),q(null),e("Thnh cng!"," cp nht logo chng nhn","success"),setTimeout(()=>window.location.reload(),1500)}catch(F){console.error("Error uploading cert logo:",F),e("Li ti ln","Khng th cp nht logo. Vui lng th li.","error")}finally{W(!1)}}},B=()=>{R(""),q(null)},ce=F=>{if(F.target.files&&F.target.files[0]){const je=F.target.files[0];if(!je.type.startsWith("image/")){e("Vui lng chn file hnh nh","Ch chp nhn file nh (JPG, PNG, etc.)","error");return}if(je.size>5*1024*1024){e("File qu ln","Kch thc file khng c vt qu 5MB","error");return}S(je),he(URL.createObjectURL(je))}},K=async()=>{if(!(!_e||!s)){k(!0);try{const F=Date.now(),je=rr(Ls,`app_settings/login-background-${F}.jpg`);await nr(je,_e);const le=await sr(je);await Eo(qe(Ae,"app_settings","login_background"),{imageUrl:le,updatedAt:new Date().toISOString(),updatedBy:s.id,updatedByName:s.fullName}),$(le),he(""),S(null),e("Thnh cng!"," cp nht hnh nn ng nhp","success")}catch(F){console.error("Error uploading:",F),e("Li ti ln","Khng th cp nht hnh nn. Vui lng th li.","error")}finally{k(!1)}}},Ee=()=>{he(""),S(null)};return M?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-slate-700 border-t-transparent rounded-full"})}):i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-xl p-6",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"p-3 bg-amber-600 rounded-lg",children:i.jsx($v,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Migration: Thm Trng Thi Duyt"}),i.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:['Cp nht cc ti liu c (K hoch T CM v H s Lp) vi trng thi "Ch duyt"  kch hot chc nng ph duyt mi.',i.jsx("br",{}),i.jsx("span",{className:"text-amber-700 font-medium font-sans",children:"Lu : Ch cn chy mt ln. Cc ti liu  c trng thi s khng b nh hng."})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:Pe,disabled:O,className:"flex items-center gap-2 px-6 py-2.5 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5",children:O?i.jsxs(i.Fragment,{children:[i.jsx(Ni,{className:"h-4 w-4 animate-spin"}),"ang x l..."]}):i.jsxs(i.Fragment,{children:[i.jsx($v,{className:"h-4 w-4"}),"Chy Migration"]})}),ve&&i.jsxs("div",{className:"text-sm text-green-700 bg-green-100 px-3 py-1.5 rounded-lg border border-green-200",children:["  cp nht: ",i.jsx("span",{className:"font-bold",children:ve.plans})," k hoch, ",i.jsx("span",{className:"font-bold",children:ve.classFiles})," h s lp"]})]})]})]})}),i.jsx("div",{className:"bg-gradient-to-r from-red-50 to-rose-50 border border-red-200 rounded-xl p-6",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"p-3 bg-red-600 rounded-lg",children:i.jsx(Yv,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Dn dp: Thng bo li ng dn"}),i.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:['Khc phc vn  "Trang trng" khi nhn vo thng bo c.',i.jsx("br",{}),i.jsx("span",{className:"text-red-700 font-medium font-sans",children:"Dn sch cc thng bo cha ng dn c (/professional-group-plans)."})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:V,disabled:X,className:"flex items-center gap-2 px-6 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5",children:X?i.jsxs(i.Fragment,{children:[i.jsx(Ni,{className:"h-4 w-4 animate-spin"}),"ang dn dp..."]}):i.jsxs(i.Fragment,{children:[i.jsx(hn,{className:"h-4 w-4"}),"Dn dp thng bo li"]})}),Se!==null&&i.jsxs("div",{className:"text-sm text-red-700 bg-red-100 px-3 py-1.5 rounded-lg border border-red-200",children:["  xa: ",i.jsx("span",{className:"font-bold",children:Se})," thng bo li"]})]})]})]})})]}),i.jsx("hr",{className:"border-gray-200"}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-100 rounded-xl p-6",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"p-3 bg-indigo-600 rounded-lg",children:i.jsx(qp,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Logo H thng"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Logo hin th trn Header v trang ng nhp. Nn dng nh PNG nn trong sut, kch thc vung (VD: 512x512px)."})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:i.jsxs("h3",{className:"text-sm font-bold text-gray-700 uppercase flex items-center gap-2",children:[i.jsx(iu,{className:"h-4 w-4 text-green-600"})," Logo hin ti"]})}),i.jsx("div",{className:"p-6 flex justify-center items-center bg-gray-100 min-h-[200px]",children:t?i.jsx("img",{src:t,alt:"Current Logo",className:"h-32 w-32 object-contain"}):i.jsx("div",{className:"text-gray-400 text-sm italic",children:"Cha c logo ty chnh (ang dng mc nh)"})})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:i.jsxs("h3",{className:"text-sm font-bold text-gray-700 uppercase flex items-center gap-2",children:[i.jsx(En,{className:"h-4 w-4 text-indigo-600"})," Ti ln Logo mi"]})}),i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"mb-4",children:i.jsx("input",{type:"file",accept:"image/*",onChange:oe,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 cursor-pointer"})}),o&&i.jsx("div",{className:"mb-4 flex justify-center p-4 border border-dashed border-indigo-200 rounded-lg bg-indigo-50/30",children:i.jsx("img",{src:o,alt:"Preview",className:"h-24 w-24 object-contain"})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:de,disabled:!d||x,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-all",children:x?"ang ti...":"Lu Logo"}),o&&i.jsx("button",{onClick:ye,disabled:x,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Hy"})]})]})]})]})]}),i.jsx("hr",{className:"border-gray-200"}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-100 rounded-xl p-6",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"p-3 bg-emerald-600 rounded-lg",children:i.jsx(qp,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Logo Chng Nhn (t Chun Quc Gia)"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Logo chng nhn trng t chun. S hin th  gc trang ng nhp v trn Header."})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:i.jsxs("h3",{className:"text-sm font-bold text-gray-700 uppercase flex items-center gap-2",children:[i.jsx(iu,{className:"h-4 w-4 text-green-600"})," Logo hin ti"]})}),i.jsx("div",{className:"p-6 flex justify-center items-center bg-gray-100 min-h-[200px]",children:b?i.jsx("img",{src:b,alt:"Certification Logo",className:"h-32 w-32 object-contain"}):i.jsx("div",{className:"text-gray-400 text-sm italic",children:"Cha c logo chng nhn"})})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:i.jsxs("h3",{className:"text-sm font-bold text-gray-700 uppercase flex items-center gap-2",children:[i.jsx(En,{className:"h-4 w-4 text-emerald-600"})," Ti ln Logo mi"]})}),i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"mb-4",children:i.jsx("input",{type:"file",accept:"image/*",onChange:Y,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-emerald-50 file:text-emerald-700 hover:file:bg-emerald-100 cursor-pointer"})}),N&&i.jsx("div",{className:"mb-4 flex justify-center p-4 border border-dashed border-emerald-200 rounded-lg bg-emerald-50/30",children:i.jsx("img",{src:N,alt:"Preview",className:"h-24 w-24 object-contain"})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:be,disabled:!D||L,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 transition-all",children:L?"ang ti...":"Lu Logo"}),N&&i.jsx("button",{onClick:B,disabled:L,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Hy"})]})]})]})]})]}),i.jsx("hr",{className:"border-gray-200"}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-xl p-6",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"p-3 bg-blue-600 rounded-lg",children:i.jsx(qp,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Hnh nn trang ng nhp"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Ty chnh hnh nn hin th trn trang ng nhp ca h thng. Hnh nh nn c kch thc ti thiu 1920x1080px  hin th tt nht."})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:i.jsxs("h3",{className:"text-sm font-bold text-gray-700 uppercase flex items-center gap-2",children:[i.jsx(iu,{className:"h-4 w-4 text-green-600"})," Hnh nn hin ti"]})}),i.jsx("div",{className:"p-6",children:i.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg overflow-hidden bg-gray-100",children:i.jsx("img",{src:re,alt:"Current Background",className:"w-full h-64 object-contain"})})})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:i.jsxs("h3",{className:"text-sm font-bold text-gray-700 uppercase flex items-center gap-2",children:[i.jsx(En,{className:"h-4 w-4 text-blue-600"})," Ti ln hnh nn mi"]})}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chn file hnh nh"}),i.jsx("input",{type:"file",accept:"image/*",onChange:ce,className:`block w-full text-sm text-gray-500\r
                file:mr-4 file:py-2 file:px-4\r
                file:rounded-lg file:border-0\r
                file:text-sm file:font-semibold\r
                file:bg-blue-50 file:text-blue-700\r
                hover:file:bg-blue-100\r
                cursor-pointer`}),i.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[i.jsx(Yn,{className:"h-3 w-3"}),"Kch thc ti a: 5MB. nh dng: JPG, PNG, WEBP"]})]}),z&&i.jsxs("div",{className:"mt-6 animate-in fade-in slide-in-from-bottom-4 duration-300",children:[i.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Xem trc hnh nn mi:"}),i.jsx("div",{className:"border-2 border-dashed border-blue-300 rounded-lg overflow-hidden bg-blue-50/30",children:i.jsx("img",{src:z,alt:"Preview",className:"w-full h-64 object-contain"})})]}),i.jsxs("div",{className:"mt-6 flex gap-3",children:[i.jsx("button",{onClick:K,disabled:!_e||C,className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5",children:C?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"ang ti ln..."]}):i.jsxs(i.Fragment,{children:[i.jsx(En,{className:"h-4 w-4"}),"Lu v p dng"]})}),z&&i.jsxs("button",{onClick:Ee,disabled:C,className:"flex items-center gap-2 px-6 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 transition-all",children:[i.jsx(Yv,{className:"h-4 w-4"}),"Hy b"]})]})]})]}),i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex gap-3",children:[i.jsx(Yn,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"text-sm text-amber-800",children:[i.jsx("p",{className:"font-semibold mb-1",children:"Lu  khi thay i hnh nn:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1 text-amber-700",children:[i.jsx("li",{children:"Hnh nn s c p dng ngay lp tc cho tt c ngi dng"}),i.jsx("li",{children:"Nn chn hnh nh c  phn gii cao (ti thiu 1920x1080px)"}),i.jsx("li",{children:"Hnh nh nn c ni dung ph hp vi mi trng trng hc"}),i.jsx("li",{children:"File c s c lu tr trn Firebase Storage"})]})]})]})})]})]})},vO=()=>{var oe,de,ye,Y,be;const s=ar(),{user:e}=vs(),{addToast:t}=jr(),[a,o]=T.useState("users"),[u,d]=vi.useState([]),[p,x]=vi.useState({}),[g,b]=vi.useState({});vi.useEffect(()=>{var B;e&&(e.role==="admin"||(B=e.permissions)!=null&&B.includes("access_system_admin")||(t("Bn khng c quyn truy cp khu vc ny.","error"),s("/")))},[e,s,t]);const[w,N]=T.useState([]),[R,D]=T.useState(""),[q,L]=T.useState("Tt c"),[W,re]=T.useState(!1),[$,z]=T.useState(!1),[he,_e]=T.useState(!1),[S,C]=T.useState({}),[k,M]=T.useState(""),[I,O]=T.useState(!1);vi.useEffect(()=>{const B=mn(Tt(Ae,"classes")),ce=zs(B,K=>{const Ee=K.docs.map(le=>({id:le.id,...le.data()}));Ee.sort((le,ke)=>le.name.localeCompare(ke.name)),d(Ee);const F={},je={};Ee.forEach(le=>{F[le.name]=le.id,je[le.id]=le.name}),x(F),b(je)});return()=>ce()},[]),vi.useEffect(()=>{const B=mn(Tt(Ae,"users")),ce=zs(B,K=>{const Ee=[];K.forEach(F=>{Ee.push({id:F.id,...F.data()})}),N(Ee)});return()=>ce()},[]);const E=T.useMemo(()=>w.filter(B=>{const ce=B.fullName.toLowerCase().includes(R.toLowerCase())||B.username.toLowerCase().includes(R.toLowerCase())||B.email.toLowerCase().includes(R.toLowerCase()),K=q==="Tt c"||B.group===q;return ce&&K}),[w,R,q]),ve=async B=>{if(window.confirm("Bn c chc chn mun xa ngi dng ny khng? Hnh ng ny khng th hon tc."))try{await Cl(qe(Ae,"users",B))}catch(ce){console.error("Error deleting user:",ce),t("Khng th xa ngi dng. Vui lng th li.","error")}},Te=()=>{C({status:"active",role:"teacher",roleLabel:"Gio vin",group:"T Chuyn Mn",accessScope:u.length>0?u[0].id:"choi",permissions:[]}),M(""),z(!1),_e(!1),re(!0)},X=B=>{C({...B}),z(!0),_e(!1),M(""),re(!0)},Z=B=>{const ce=B.target.value;let K="",Ee=S.group,F="teacher";ce==="Hiu Trng"?(K="Ton h thng",Ee="Ban Gim Hiu",F="admin"):ce==="Ph Hiu Trng"?(K="Ton trng",Ee="Ban Gim Hiu",F="vice_principal"):ce==="T trng chuyn mn"?(K="Ton b T chuyn mn",Ee="T Chuyn Mn",F="head_teacher"):ce==="T ph chuyn mn"?(K="Ton b T chuyn mn",Ee="T Chuyn Mn",F="vice_head_teacher"):ce==="Gio vin"?(K=u.length>0?u[0].id:"choi",Ee="T Chuyn Mn",F="teacher"):ce==="T trng t vn phng"?(K="Ton b T Vn phng",Ee="T Vn Phng",F="office_head"):["K ton","Vn th","Y t","Nhn vin"].includes(ce)&&(K="Khng gian T Vn phng",Ee="T Vn Phng",F="staff"),C({...S,role:F,roleLabel:ce,accessScope:K,group:Ee,permissions:S.permissions||[]})},Se=async B=>{if(B.preventDefault(),!(!S.username||!S.fullName||!S.email)){O(!0);try{if($&&S.id){const ce=Object.fromEntries(Object.entries(S).filter(([K,Ee])=>Ee!==void 0));if(await Qt(qe(Ae,"users",S.id),ce),he&&k)if(e&&S.id===e.id){const{updatePassword:K}=await lu(async()=>{const{updatePassword:F}=await Promise.resolve().then(()=>E6);return{updatePassword:F}},void 0),Ee=Tu();Ee.currentUser&&(await K(Ee.currentUser,k),t(" cp nht mt khu ca bn thnh cng!","success"))}else try{const{httpsCallable:K}=await lu(async()=>{const{httpsCallable:je}=await Promise.resolve().then(()=>nT);return{httpsCallable:je}},void 0),{functions:Ee}=await lu(async()=>{const{functions:je}=await Promise.resolve().then(()=>vT);return{functions:je}},void 0),F=K(Ee,"adminResetPassword");t("ang gi yu cu i mt khu...","info"),await F({targetUserId:S.id,newPassword:k}),t(` i mt khu cho user ${S.username} thnh cng!`,"success")}catch(K){console.error("Error calling adminResetPassword:",K),t(`Li i mt khu: ${K.message}`,"error")}else t("Cp nht thng tin h s thnh cng!","success")}else{let ce="";try{const K=l0(ax,"SecondaryApp"),Ee=Tu(K);ce=(await I2(Ee,S.email,k)).user.uid,await a4(K)}catch(K){console.error("Auth creation error:",K),K.code==="auth/email-already-in-use"?t("Email ny  c s dng bi ti khon khc.","error"):t(`Li to ti khon Auth: ${K.message}`,"error"),O(!1);return}await Eo(qe(Ae,"users",ce),{...S,id:ce,createdAt:new Date().toISOString()}),t(" to ti khon thnh cng! Ngi dng c th ng nhp ngay.","success")}re(!1)}catch(ce){console.error("Error saving user:",ce),t("Li khi lu d liu.","error")}finally{O(!1)}}},Be=async B=>{const ce=w.find(K=>K.id===B);if(ce)try{const K=ce.status==="active"?"inactive":"active";await Qt(qe(Ae,"users",B),{status:K}),t(` ${K==="active"?"m kha":"kha"} ti khon thnh cng.`,"success")}catch(K){console.error("Error updating status:",K),t("Khng th cp nht trng thi.","error")}},Pe=B=>B.includes("Hiu Trng")||B.includes("Admin")?"bg-red-100 text-red-700 border-red-200":B.includes("Ph Hiu")?"bg-orange-100 text-orange-700 border-orange-200":B.includes("T trng")||B.includes("T ph")||B.includes("K ton")?"bg-blue-100 text-blue-700 border-blue-200":"bg-emerald-100 text-emerald-700 border-emerald-200",V=()=>{const B=S.role||"";return B==="admin"?i.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-100 transition-all duration-300",children:[i.jsxs("h4",{className:"text-sm font-bold text-red-800 mb-2 flex items-center gap-2",children:[i.jsx(_o,{className:"h-4 w-4"})," Phm vi truy cp & Quyn hn"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-red-700 uppercase mb-1",children:"Phm vi d liu"}),i.jsx("input",{type:"text",disabled:!0,className:"w-full border border-red-200 rounded px-3 py-1.5 text-sm bg-red-100/50 text-red-900 font-medium cursor-not-allowed",value:"Ton h thng"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-600 bg-white/50 p-2 rounded border border-red-100",children:[i.jsx(Yn,{className:"h-4 w-4"}),"C quyn truy cp v qun l tt c cc t/lp."]})]})]}):B==="vice_principal"?i.jsxs("div",{className:"bg-teal-50 p-4 rounded-lg border border-teal-100 transition-all duration-300",children:[i.jsxs("h4",{className:"text-sm font-bold text-teal-800 mb-2 flex items-center gap-2",children:[i.jsx(_o,{className:"h-4 w-4"})," Phm vi truy cp & Quyn hn"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-teal-700 uppercase mb-1",children:"Phm vi d liu"}),i.jsx("input",{type:"text",disabled:!0,className:"w-full border border-teal-200 rounded px-3 py-1.5 text-sm bg-teal-100/50 text-teal-900 font-medium cursor-not-allowed",value:"Ton trng (Theo phn quyn)"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-teal-600 bg-white/50 p-2 rounded border border-teal-100",children:[i.jsx(Yn,{className:"h-4 w-4"}),'Truy cp d liu ton trng. Cc quyn qun tr h thng chu nh hng bi ci t "Quyn hn b sung" t Admin.']})]})]}):B==="head_teacher"?i.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 transition-all duration-300",children:[i.jsxs("h4",{className:"text-sm font-bold text-blue-800 mb-2 flex items-center gap-2",children:[i.jsx(xo,{className:"h-4 w-4"})," Phm vi truy cp & Quyn hn"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-blue-700 uppercase mb-1",children:"Phm vi d liu (Lp ph trch)"}),i.jsxs("select",{className:"w-full border border-blue-300 rounded px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white",value:S.accessScope||"",onChange:ce=>C({...S,accessScope:ce.target.value}),children:[i.jsx("option",{value:"Ton b T chuyn mn",children:"Ton b T chuyn mn (Khng dy lp)"}),u.map(ce=>i.jsx("option",{value:ce.id,children:ce.name},ce.id))]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600",children:[i.jsx(ys,{className:"h-3 w-3"}),"Qun l chung T chuyn mn V qun l lp c chn."]})]})]}):B==="vice_head_teacher"?i.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 transition-all duration-300",children:[i.jsxs("h4",{className:"text-sm font-bold text-blue-800 mb-2 flex items-center gap-2",children:[i.jsx(xo,{className:"h-4 w-4"})," Phm vi truy cp & Quyn hn"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-blue-700 uppercase mb-1",children:"Phm vi d liu (Lp ph trch)"}),i.jsxs("select",{className:"w-full border border-blue-300 rounded px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white",value:S.accessScope||"",onChange:ce=>C({...S,accessScope:ce.target.value}),children:[i.jsx("option",{value:"Ton b T chuyn mn",children:"Ton b T chuyn mn (Khng dy lp)"}),u.map(ce=>i.jsx("option",{value:ce.id,children:ce.name},ce.id))]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600",children:[i.jsx(ys,{className:"h-3 w-3"}),"Quyn hn tng ng T trng: Qun l chung T chuyn mn V qun l lp c chn."]})]})]}):B==="teacher"?i.jsxs("div",{className:"bg-emerald-50 p-4 rounded-lg border border-emerald-100 transition-all duration-300",children:[i.jsxs("h4",{className:"text-sm font-bold text-emerald-800 mb-2 flex items-center gap-2",children:[i.jsx(u1,{className:"h-4 w-4"})," Phm vi truy cp & Quyn hn"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-emerald-700 uppercase mb-1",children:"Phm vi d liu (Chn lp)"}),i.jsx("select",{className:"w-full border border-emerald-300 rounded px-3 py-1.5 text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none bg-white",value:S.accessScope||"",onChange:ce=>C({...S,accessScope:ce.target.value}),children:u.map(ce=>i.jsx("option",{value:ce.id,children:ce.name},ce.id))})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("p",{className:"text-xs font-semibold text-emerald-700 mb-1",children:"Quyn hn:"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 border border-emerald-200 rounded text-[10px] font-medium",children:"Upload file"}),i.jsx("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 border border-emerald-200 rounded text-[10px] font-medium",children:"Chnh sa k hoch lp"})]})]})]})]}):B==="office_head"?i.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 transition-all duration-300",children:[i.jsxs("h4",{className:"text-sm font-bold text-blue-800 mb-2 flex items-center gap-2",children:[i.jsx(xo,{className:"h-4 w-4"})," Phm vi truy cp & Quyn hn"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-blue-700 uppercase mb-1",children:"Phm vi d liu"}),i.jsx("input",{type:"text",disabled:!0,className:"w-full border border-blue-200 rounded px-3 py-1.5 text-sm bg-blue-100/50 text-blue-900 font-medium cursor-not-allowed",value:"Ton b T Vn phng"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600",children:[i.jsx(ys,{className:"h-3 w-3"}),"Qun l chung T Vn phng (Bao gm Y t, K ton, Vn th...)."]})]})]}):i.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-100 transition-all duration-300",children:[i.jsxs("h4",{className:"text-sm font-bold text-purple-800 mb-2 flex items-center gap-2",children:[i.jsx(Lh,{className:"h-4 w-4"})," Phm vi truy cp & Quyn hn"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold text-purple-700 uppercase mb-1",children:"Phm vi d liu"}),i.jsx("input",{type:"text",readOnly:!0,className:"w-full border border-purple-200 rounded px-3 py-1.5 text-sm bg-purple-100/50 text-purple-900 font-medium focus:outline-none",value:"Khng gian T Vn phng"})]}),i.jsxs("div",{className:"space-y-2 mt-2 bg-white/60 p-3 rounded border border-purple-100",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Kp,{className:"h-4 w-4 text-purple-600"}),i.jsx("span",{className:"text-xs text-gray-600",children:"Vn bn chung (B/S)"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Kp,{className:"h-4 w-4 text-purple-600"}),i.jsx("span",{className:"text-xs text-gray-600",children:"K hoch & Thc n (Ni b VP)"})]})]})]})]})};return i.jsxs("div",{className:"min-h-screen bg-gray-50 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[i.jsx("div",{className:"bg-white border-b border-gray-200",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[i.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:i.jsxs("div",{children:[i.jsxs("button",{onClick:()=>s("/"),className:"flex items-center text-sm text-gray-500 hover:text-slate-600 transition-colors mb-2",children:[i.jsx(cf,{className:"h-4 w-4 mr-1"})," Quay li Dashboard"]}),i.jsxs("div",{className:"flex items-center gap-3 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>s("/"),children:[i.jsx("div",{className:"p-2 bg-slate-100 rounded-lg",children:i.jsx(_o,{className:"h-6 w-6 text-slate-700"})}),i.jsx("h1",{className:"text-2xl font-bold text-gray-900 uppercase",children:"QUN TR H THNG"})]})]})}),i.jsx("div",{className:"mt-6 border-b border-gray-200",children:i.jsxs("div",{className:"flex gap-1",children:[i.jsxs("button",{onClick:()=>o("users"),className:`px-6 py-3 text-sm font-semibold transition-all border-b-2 ${a==="users"?"border-slate-700 text-slate-700":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[i.jsx(xo,{className:"inline h-4 w-4 mr-2"}),"Qun l Ngi dng"]}),i.jsxs("button",{onClick:()=>o("settings"),className:`px-6 py-3 text-sm font-semibold transition-all border-b-2 ${a==="settings"?"border-slate-700 text-slate-700":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[i.jsx(_o,{className:"inline h-4 w-4 mr-2"}),"Ci t ng dng"]})]})}),a==="users"&&i.jsxs("div",{className:"mt-6 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[i.jsx("div",{className:"flex overflow-x-auto pb-1 lg:pb-0 gap-2 w-full lg:w-auto no-scrollbar",children:["Tt c","Ban Gim Hiu","T Chuyn Mn","T Vn Phng"].map(B=>i.jsx("button",{onClick:()=>L(B),className:`
                    whitespace-nowrap px-4 py-2 rounded-full text-sm font-medium transition-all
                    ${q===B?"bg-slate-700 text-white shadow-md shadow-slate-300":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-200"}
                  `,children:B},B))}),i.jsxs("div",{className:"flex w-full lg:w-auto gap-3",children:[i.jsxs("div",{className:"relative flex-grow lg:w-72 group",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Tl,{className:"h-5 w-5 text-gray-400 group-focus-within:text-slate-500 transition-colors"})}),i.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500 sm:text-sm transition-shadow",placeholder:"Tm tn, email hoc ti khon...",value:R,onChange:B=>D(B.target.value)})]}),i.jsxs("button",{onClick:Te,className:"flex items-center gap-2 px-4 py-2 bg-slate-700 text-white rounded-lg hover:bg-slate-800 shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5",children:[i.jsx(ko,{className:"h-5 w-5"}),i.jsx("span",{className:"hidden sm:inline",children:"To ti khon"})]})]})]})]})}),i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a==="users"?i.jsx(i.Fragment,{children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Ngi dng"}),i.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Vai tr & Nhm"}),i.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Phm vi truy cp"}),i.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Trng thi"}),i.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Thao tc"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.length>0?E.map(B=>i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:i.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 border border-slate-200",children:i.jsx(xr,{className:"h-6 w-6"})})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:B.fullName}),i.jsxs("div",{className:"text-xs text-gray-500 flex flex-col sm:flex-row sm:gap-3",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(xr,{className:"h-3 w-3"})," ",B.username]}),i.jsx("span",{className:"hidden sm:inline text-gray-300",children:"|"}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(i1,{className:"h-3 w-3"})," ",B.email]})]})]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex flex-col items-start gap-1.5",children:[i.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${Pe(B.roleLabel)}`,children:B.roleLabel}),i.jsxs("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[i.jsx(xo,{className:"h-3 w-3"})," ",B.group]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm text-gray-700 flex items-center gap-2",children:[i.jsx(Lh,{className:"h-4 w-4 text-gray-400"}),g[B.accessScope]||B.accessScope]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:i.jsx("button",{onClick:()=>Be(B.id),className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors ${B.status==="active"?"bg-green-100 text-green-800 hover:bg-green-200":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,children:B.status==="active"?i.jsxs(i.Fragment,{children:[i.jsx(ys,{className:"w-3 h-3 mr-1"})," ang hot ng"]}):i.jsxs(i.Fragment,{children:[i.jsx(Uh,{className:"w-3 h-3 mr-1"}),"  kha"]})})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:i.jsxs("div",{className:"flex justify-center items-center gap-2",children:[i.jsx("button",{onClick:()=>X(B),className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Chnh sa",children:i.jsx(Io,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>ve(B.id),className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa ti khon",children:i.jsx(hn,{className:"h-4 w-4"})})]})})]},B.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx(xr,{className:"h-12 w-12 text-gray-300 mb-3"}),i.jsx("p",{className:"text-base font-medium",children:"Khng tm thy ngi dng no"}),i.jsx("p",{className:"text-sm mt-1",children:"Th thay i b lc hoc to mi"})]})})})})]})}),i.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex items-center justify-between text-sm text-gray-500",children:i.jsxs("span",{children:["Tng s ",E.length," ngi dng"]})})]})}):i.jsx(bO,{})}),W&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[i.jsxs("div",{className:"bg-slate-800 px-6 py-4 flex justify-between items-center flex-shrink-0",children:[i.jsxs("h3",{className:"text-white font-semibold text-lg flex items-center gap-2",children:[$?i.jsx(Io,{className:"h-5 w-5"}):i.jsx(ko,{className:"h-5 w-5"}),$?"Cp nht thng tin":"To ti khon mi"]}),i.jsx("button",{onClick:()=>re(!1),className:"text-gray-400 hover:text-white transition-colors",children:i.jsx(fn,{className:"h-6 w-6"})})]}),i.jsx("div",{className:"p-6 overflow-y-auto",children:i.jsxs("form",{id:"userForm",onSubmit:Se,className:"space-y-6",children:[i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[i.jsxs("h4",{className:"text-sm font-bold text-gray-700 uppercase mb-3 flex items-center gap-2",children:[i.jsx(xr,{className:"h-4 w-4"})," Thng tin ti khon"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn ng nhp ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",required:!0,disabled:$,className:`w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-slate-500 focus:border-slate-500 outline-none transition-all ${$?"bg-gray-100 text-gray-500":""}`,placeholder:"VD: nguyenvanan",value:S.username||"",onChange:B=>C({...S,username:B.target.value})})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",required:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-slate-500 focus:border-slate-500 outline-none transition-all",placeholder:"VD: an@truong.edu.vn",value:S.email||"",onChange:B=>C({...S,email:B.target.value})})]})]}),$?i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Mt khu"}),i.jsx("button",{type:"button",onClick:()=>_e(!he),className:"text-xs text-blue-600 hover:underline font-medium",children:he?"Hy i mt khu":"Reset mt khu"})]}),he&&i.jsxs("div",{className:"mt-2 animate-in fade-in slide-in-from-top-2",children:[i.jsx("input",{type:"password",className:"w-full border border-blue-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all bg-blue-50",placeholder:"Nhp mt khu mi...",value:k,onChange:B=>M(B.target.value)}),i.jsx("p",{className:"text-xs text-blue-600 mt-1 italic",children:"Nhp mt khu mi  thay i cho ngi dng ny."})]})]}):i.jsxs("div",{className:"mt-4",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Mt khu khi to ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"password",required:!$,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-slate-500 focus:border-slate-500 outline-none transition-all",placeholder:"Nhp mt khu...",value:k,onChange:B=>M(B.target.value)}),i.jsx(Ro,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-400"})]})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["H v tn hin th ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",required:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-slate-500 focus:border-slate-500 outline-none transition-all",placeholder:"VD: Nguyn Vn An",value:S.fullName||"",onChange:B=>C({...S,fullName:B.target.value})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nhm ngi dng ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-slate-500 focus:border-slate-500 outline-none transition-all bg-white",value:S.group||"T Chuyn Mn",onChange:B=>C({...S,group:B.target.value}),children:[i.jsx("option",{value:"Ban Gim Hiu",children:"Ban Gim Hiu"}),i.jsx("option",{value:"T Chuyn Mn",children:"T Chuyn Mn"}),i.jsx("option",{value:"T Vn Phng",children:"T Vn Phng"}),i.jsx("option",{value:"Khc",children:"Khc"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vai tr c th ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-slate-500 focus:border-slate-500 outline-none transition-all bg-white",value:S.roleLabel||"Gio vin",onChange:Z,children:[i.jsx("option",{value:"Hiu Trng",children:"Hiu Trng"}),i.jsx("option",{value:"Ph Hiu Trng",children:"Ph Hiu Trng"}),i.jsx("option",{value:"T trng chuyn mn",children:"T trng chuyn mn"}),i.jsx("option",{value:"T ph chuyn mn",children:"T ph chuyn mn"}),i.jsx("option",{value:"Gio vin",children:"Gio vin"}),i.jsx("option",{value:"T trng t vn phng",children:"T trng t vn phng"}),i.jsx("option",{value:"K ton",children:"K ton"}),i.jsx("option",{value:"Vn th",children:"Vn th"}),i.jsx("option",{value:"Y t",children:"Y t"}),i.jsx("option",{value:"Nhn vin",children:"Nhn vin"})]})]})]}),V(),i.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-100 mt-4",children:[i.jsxs("h4",{className:"text-sm font-bold text-orange-800 mb-2 flex items-center gap-2",children:[i.jsx(Kp,{className:"h-4 w-4"})," Quyn hn b sung"]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("div",{className:"relative flex items-center",children:i.jsx("input",{type:"checkbox",className:"peer h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded transition-all cursor-pointer",checked:((oe=S.permissions)==null?void 0:oe.includes("manage_documents"))||!1,onChange:B=>{const ce=S.permissions||[];B.target.checked?C({...S,permissions:[...ce,"manage_documents"]}):C({...S,permissions:ce.filter(K=>K!=="manage_documents")})}})}),i.jsx("span",{className:"text-sm text-gray-700 group-hover:text-orange-700 transition-colors",children:"c php qun l vn bn (Upload, Chnh sa, Xa)"})]}),i.jsx("p",{className:"text-xs text-orange-600 pl-6 mb-3",children:"* Cho php ngi dng ny ng ti v qun l cc vn bn chung ca trng."}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("div",{className:"relative flex items-center",children:i.jsx("input",{type:"checkbox",className:"peer h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded transition-all cursor-pointer",checked:((de=S.permissions)==null?void 0:de.includes("manage_office_docs"))||!1,onChange:B=>{const ce=S.permissions||[];B.target.checked?C({...S,permissions:[...ce,"manage_office_docs"]}):C({...S,permissions:ce.filter(K=>K!=="manage_office_docs")})}})}),i.jsx("span",{className:"text-sm text-gray-700 group-hover:text-purple-700 transition-colors",children:"Qun l vn bn T Vn phng"})]}),i.jsx("p",{className:"text-xs text-purple-600 pl-6 mb-3",children:"* Cho php upload, sa, xa vn bn trong khu vc T Vn phng."}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("div",{className:"relative flex items-center",children:i.jsx("input",{type:"checkbox",className:"peer h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded transition-all cursor-pointer",checked:((ye=S.permissions)==null?void 0:ye.includes("manage_boarding_docs"))||!1,onChange:B=>{const ce=S.permissions||[];B.target.checked?C({...S,permissions:[...ce,"manage_boarding_docs"]}):C({...S,permissions:ce.filter(K=>K!=="manage_boarding_docs")})}})}),i.jsx("span",{className:"text-sm text-gray-700 group-hover:text-indigo-700 transition-colors",children:"Qun l ti liu Bn tr"})]}),i.jsx("p",{className:"text-xs text-indigo-600 pl-6 mb-3",children:"* Cho php upload, sa, xa ti liu bn tr (thc n, an ton thc phm)."}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("div",{className:"relative flex items-center",children:i.jsx("input",{type:"checkbox",className:"peer h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded transition-all cursor-pointer",checked:((Y=S.permissions)==null?void 0:Y.includes("manage_plans"))||!1,onChange:B=>{const ce=S.permissions||[];B.target.checked?C({...S,permissions:[...ce,"manage_plans"]}):C({...S,permissions:ce.filter(K=>K!=="manage_plans")})}})}),i.jsx("span",{className:"text-sm text-gray-700 group-hover:text-blue-700 transition-colors",children:"Qun l k hoch T Chuyn mn"})]}),i.jsx("p",{className:"text-xs text-blue-600 pl-6 mb-3",children:"* Cho php upload, sa, xa k hoch dy hc (Ch dnh cho Admin/Head Teacher)."}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("div",{className:"relative flex items-center",children:i.jsx("input",{type:"checkbox",className:"peer h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded transition-all cursor-pointer",checked:((be=S.permissions)==null?void 0:be.includes("access_system_admin"))||!1,onChange:B=>{const ce=S.permissions||[];B.target.checked?C({...S,permissions:[...ce,"access_system_admin"]}):C({...S,permissions:ce.filter(K=>K!=="access_system_admin")})}})}),i.jsx("span",{className:"text-sm text-gray-700 group-hover:text-red-700 transition-colors",children:"c php truy cp Qun tr h thng"})]}),i.jsx("p",{className:"text-xs text-red-600 pl-6",children:"* CP QUYN CAO NHT: Cho php truy cp vo trang qun tr h thng (Dnh cho Ph Hiu trng hoc Th k)."})]})]})]})}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-3 flex-shrink-0",children:[i.jsx("button",{onClick:()=>re(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-white hover:shadow-sm rounded-lg border border-transparent hover:border-gray-300 transition-all",children:"Hy b"}),i.jsx("button",{type:"submit",form:"userForm",disabled:I,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-slate-700 hover:bg-slate-800 rounded-lg shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:I?i.jsxs(i.Fragment,{children:[i.jsx(Ni,{className:"h-4 w-4 animate-spin"})," ang x l..."]}):i.jsxs(i.Fragment,{children:[i.jsx(s0,{className:"h-4 w-4"})," ",$?"Lu thay i":"To ti khon"]})})]})]})})]})},wO={admin:"Ban Gim Hiu",vice_principal:"Ph Hiu Trng",head_teacher:"T Trng Chuyn Mn",vice_head_teacher:"T Ph Chuyn Mn",teacher:"Gio Vin",staff:"Nhn Vin",office_head:"T Trng Vn Phng"},_O=async()=>{const s=mn(Tt(Ae,"users"),bs("role","==","admin"));return(await wr(s)).docs.map(t=>t.id)},NO=async()=>{const s=mn(Tt(Ae,"users"),bs("role","==","head_teacher"));return(await wr(s)).docs.map(t=>t.id)},TO=async s=>{const e=mn(Tt(Ae,"users"),bs("role","==","teacher"),bs("group","==",s));return(await wr(e)).docs.map(a=>a.id)},jO=async s=>{const e=mn(Tt(Ae,"users"),bs("role","==","teacher"),bs("accessScope","==",s));return(await wr(e)).docs.map(a=>a.id)},br=async(s,e,t)=>{var a,o,u,d;try{let p=[];const x=await _O();if(t.type==="office"){if(s==="upload"&&e.role==="staff"&&(p=[...x]),s==="comment"){const w=(a=t.extraInfo)==null?void 0:a.uploaderId;w&&p.push(w),p=[...p,...x]}}else if(t.type==="class"){const w=(o=t.extraInfo)==null?void 0:o.classId;if(s==="upload"&&e.role==="teacher"){const N=await NO();p=[...x,...N]}else s==="comment"&&((u=t.extraInfo)!=null&&u.uploaderId?p=[t.extraInfo.uploaderId]:(e.role==="admin"||e.role==="head_teacher"||e.role==="vice_head_teacher")&&w&&(p=[...await jO(w)]))}else if(t.type==="group")if(s==="upload"&&e.role==="head_teacher")if(e.group){const w=await TO(e.group);p=[...x,...w]}else p=[...x];else(s==="comment"||s==="system")&&(d=t.extraInfo)!=null&&d.uploaderId&&p.push(t.extraInfo.uploaderId);else t.type==="boarding"&&e.role==="staff"&&(p=[...x]);if(p=p.filter(w=>w!==e.id),p=[...new Set(p)],p.length===0){console.log("No receivers for this notification. Skipping.");return}let g=e.fullName||e.name;(!g||g===e.role||g==="head_teacher"||g==="vice_head_teacher")&&(g=wO[e.role]||e.role);const b={senderId:e.id,senderName:g,senderAvatar:e.avatar||"",targetPath:t.targetPath,message:`${s==="upload"?" ti ln":" gp  vo"} ${t.name||"ti liu"}`,type:s,isRead:!1,createdAt:new Date().toISOString(),receivers:p,metadata:{fileName:t.name}};await Al(Tt(Ae,"notifications"),b),console.log(`Notification sent to ${p.length} users.`)}catch(p){console.error("Error creating notification:",p)}},O_=s=>{switch(s){case"excel":return i.jsx(t0,{className:"h-6 w-6 text-green-600"});case"word":return i.jsx(Ze,{className:"h-6 w-6 text-blue-600"});case"pdf":return i.jsx(hf,{className:"h-6 w-6 text-red-600"});default:return i.jsx(Ze,{className:"h-6 w-6 text-gray-500"})}},EO=()=>{var B,ce;const s=ar(),{user:e}=vs(),{currentSchoolYear:t}=Gu(),{addToast:a}=jr(),o=na(),[u,d]=T.useState([]),[p,x]=T.useState("all"),[g,b]=T.useState(""),[w,N]=T.useState(null),[R,D]=T.useState(!1),[q,L]=T.useState(""),[W,re]=T.useState(!1),$=T.useRef(null),[z,he]=T.useState(!1),[_e,S]=T.useState(null),[C,k]=T.useState({name:"",category:"general",note:""}),[M,I]=T.useState(!1),[O,E]=T.useState(null),ve=e,Te=T.useMemo(()=>w?u.find(K=>K.id===w.id)||w:null,[u,w]);T.useEffect(()=>{const K=mn(Tt(Ae,"office_docs"),Jo("uploadDate","desc")),Ee=zs(K,F=>{const je=[];F.forEach(le=>{const ke=le.data();(ke.schoolYear||"2025-2026")===t&&je.push({id:le.id,...ke,comments:ke.comments||[]})}),d(je)});return()=>Ee()},[t]);const X=u.filter(K=>{const Ee=p==="all"||K.category===p,F=K.name.toLowerCase().includes(g.toLowerCase())||K.uploader.name.toLowerCase().includes(g.toLowerCase());return Ee&&F});T.useEffect(()=>{var K;R&&((K=$.current)==null||K.scrollIntoView({behavior:"smooth"}))},[Te==null?void 0:Te.comments,R]);const Z=K=>{N(K),D(!0)},Se=(K,Ee)=>{Ee.stopPropagation(),E(K),I(!0)},Be=async()=>{if(O)try{await Cl(qe(Ae,"office_docs",O.id)),a(" xa ti liu thnh cng","H s  c loi b khi danh sch.","success"),I(!1),E(null),(w==null?void 0:w.id)===O.id&&(D(!1),N(null))}catch(K){console.error("Error deleting document: ",K),a("Li","Khng th xa h s.","error")}},Pe=async K=>{if(K.preventDefault(),!q.trim()||!Te||!ve)return;const Ee={id:Date.now().toString(),userId:ve.id,userName:ve.fullName,userRole:ve.role,content:q,timestamp:new Date().toISOString()};try{const F=qe(Ae,"office_docs",Te.id);await Qt(F,{comments:Bo(Ee)}),L(""),a(" gi gp ","Ni dung ca bn  c ghi nhn.","success"),ve&&await br("comment",ve,{type:"office",name:Te.name,targetPath:"/office-documents",extraInfo:{uploaderId:Te.uploader.id}})}catch(F){console.error("Error adding comment: ",F),a("Li","Khng th gi bnh lun.","error")}},V=K=>{switch(K){case"finance":return"Ti chnh & K ton";case"medical":return"Y t & Bn tr";case"general":return"Hnh chnh chung";default:return"Tt c h s"}},oe=()=>{k({name:"",category:p==="all"?"general":p,note:""}),S(null),he(!0)},de=K=>{if(K.preventDefault(),K.dataTransfer.files&&K.dataTransfer.files[0]){const Ee=K.dataTransfer.files[0];S(Ee),C.name||k(F=>({...F,name:Ee.name.split(".")[0]}))}},ye=K=>{if(K.target.files&&K.target.files[0]){const Ee=K.target.files[0];S(Ee),C.name||k(F=>({...F,name:Ee.name.split(".")[0]}))}},Y=async()=>{if(_e)try{let K="#";const Ee=rr(Ls,`office_docs/${Date.now()}_${_e.name}`);await nr(Ee,_e),K=await sr(Ee);const F={...C,uploader:{id:(ve==null?void 0:ve.id)||"unknown",name:(ve==null?void 0:ve.fullName)||"n danh",avatar:(ve==null?void 0:ve.avatar)||"",role:(ve==null?void 0:ve.roleLabel)||"Nhn vin"},uploadDate:new Date().toISOString(),schoolYear:t,comments:[],type:_e.name.split(".").pop()||"file",fileType:_e.name.split(".").pop()||"file",fileUrl:K};await Al(Tt(Ae,"office_docs"),F),a("Ti ln thnh cng!",` lu h s: ${C.name}`,"success"),he(!1)}catch(K){console.error("Error adding document: ",K),a("Li","Khng th ti ln h s.","error")}},be=(K=!1)=>{if(!Te)return null;const Ee=Te.fileUrl;if(Ee&&Ee!=="#"){const F=Yu(Ee,o);return F==="EXCEL_NO_PREVIEW"?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-600 bg-gray-50 rounded-lg p-8",children:[i.jsx("div",{className:"p-4 bg-green-100 rounded-full mb-4",children:i.jsx(Ze,{className:"h-16 w-16 text-green-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:"File Excel"}),i.jsx("p",{className:"text-sm text-gray-500 mb-6 text-center max-w-md",children:"File Excel khng th xem trc trc tip. Vui lng ti xung  xem ni dung."}),i.jsxs("a",{href:Ee,download:!0,className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg shadow-md transition-all font-bold",children:[i.jsx(Qn,{className:"h-5 w-5"}),"Ti xung file"]})]}):i.jsx("div",{className:"w-full h-full",children:i.jsx("iframe",{src:F,className:"w-full h-full border-0",title:"Document Preview"})})}else return i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 bg-gray-50",children:[i.jsx(Ze,{className:"h-16 w-16 mb-4 text-gray-400"}),i.jsx("p",{className:"text-lg font-medium",children:"Khng c bn xem trc"}),i.jsx("p",{className:"text-sm",children:"Ti liu ny cha c file nh km hoc file khng h tr xem trc."})]})};return i.jsxs("div",{className:"flex flex-col h-screen bg-gray-50 overflow-hidden font-sans",children:[i.jsx("div",{className:`bg-white border-b border-teal-100 ${o?"px-4 py-3":"px-6 py-4"} flex-shrink-0 z-20 shadow-sm`,children:i.jsxs("div",{className:"max-w-7xl mx-auto w-full",children:[!o&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-2",children:[i.jsx("span",{className:"cursor-pointer hover:text-teal-600",onClick:()=>s("/"),children:"Dashboard"}),i.jsx(ps,{className:"h-3 w-3"}),i.jsx("span",{children:"T Vn phng"}),i.jsx(ps,{className:"h-3 w-3"}),i.jsx("span",{className:"font-semibold text-teal-700",children:"K hoch & Bo co"})]}),i.jsxs("div",{className:"flex justify-between items-center gap-3",children:[i.jsxs("h1",{className:`${o?"text-lg":"text-2xl"} font-bold text-gray-900 flex items-center gap-2 cursor-pointer hover:opacity-80 transition-opacity`,onClick:()=>s("/"),children:[i.jsx("span",{className:`${o?"p-1.5":"p-2"} bg-teal-100 rounded-lg text-teal-700`,children:i.jsx(Ze,{className:`${o?"h-5 w-5":"h-6 w-6"}`})}),"Kho K hoch & Bo co"]}),(((B=e==null?void 0:e.permissions)==null?void 0:B.includes("manage_documents"))||((ce=e==null?void 0:e.permissions)==null?void 0:ce.includes("manage_office_docs")))&&i.jsxs("button",{onClick:oe,className:`flex items-center gap-2 bg-teal-600 hover:bg-teal-700 text-white ${o?"px-3 py-2 text-sm":"px-4 py-2"} rounded-lg shadow-md transition-colors font-medium`,children:[i.jsx(En,{className:"h-4 w-4"}),i.jsx("span",{children:"Ti ln k hoch mi"})]})]})]})}),i.jsxs("div",{className:"flex flex-1 overflow-hidden max-w-7xl mx-auto w-full",children:[i.jsx("div",{className:"w-64 bg-white border-r border-gray-200 flex-shrink-0 overflow-y-auto hidden md:block",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Danh mc h s"}),i.jsxs("nav",{className:"space-y-1",children:[i.jsxs("button",{onClick:()=>x("all"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-lg transition-all ${p==="all"?"bg-teal-50 text-teal-700 shadow-sm":"text-gray-600 hover:bg-gray-50"}`,children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${p==="all"?"bg-teal-500":"bg-gray-300"}`}),"Tt c h s"]}),i.jsxs("button",{onClick:()=>x("finance"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-lg transition-all ${p==="finance"?"bg-teal-50 text-teal-700 shadow-sm":"text-gray-600 hover:bg-gray-50"}`,children:[i.jsx(XS,{className:"h-4 w-4"}),"Ti chnh & K ton"]}),i.jsxs("button",{onClick:()=>x("medical"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-lg transition-all ${p==="medical"?"bg-teal-50 text-teal-700 shadow-sm":"text-gray-600 hover:bg-gray-50"}`,children:[i.jsx(vA,{className:"h-4 w-4"}),"Y t & Bn tr"]}),i.jsxs("button",{onClick:()=>x("general"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-lg transition-all ${p==="general"?"bg-teal-50 text-teal-700 shadow-sm":"text-gray-600 hover:bg-gray-50"}`,children:[i.jsx(Ze,{className:"h-4 w-4"}),"Hnh chnh chung"]})]})]})}),i.jsxs("div",{className:`flex-1 bg-gray-50 overflow-y-auto ${o?"p-4":"p-6"}`,children:[o&&i.jsx("div",{className:"flex gap-2 overflow-x-auto pb-3 mb-4 no-scrollbar",children:[{id:"all",label:"Tt c"},{id:"finance",label:"Ti chnh"},{id:"medical",label:"Y t"},{id:"general",label:"Hnh chnh"}].map(K=>i.jsx("button",{onClick:()=>x(K.id),className:`flex-shrink-0 px-3 py-1.5 text-xs font-bold rounded-full transition-all ${p===K.id?"bg-teal-600 text-white shadow-md":"bg-white text-gray-600 border border-gray-200"}`,children:K.label},K.id))}),i.jsxs("div",{className:`${o?"mb-4":"mb-6"} flex items-center bg-white border border-gray-200 rounded-lg px-3 py-2 ${o?"":"max-w-md"} shadow-sm focus-within:ring-2 focus-within:ring-teal-500 transition-all`,children:[i.jsx(Tl,{className:"h-5 w-5 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Tm kim ti liu...",className:"ml-2 bg-transparent border-none outline-none text-sm w-full text-gray-700",value:g,onChange:K=>b(K.target.value)})]}),o?i.jsxs("div",{className:"space-y-3",children:[X.map(K=>i.jsxs("div",{onClick:()=>Z(K),className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm hover:shadow-md hover:border-teal-300 transition-all cursor-pointer",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10 flex items-center justify-center bg-gray-100 rounded-lg",children:O_(K.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"text-sm font-bold text-gray-900 truncate",children:K.name}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:V(K.category)})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"h-6 w-6 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 font-bold text-[10px]",children:K.uploader.name.charAt(0)}),i.jsx("span",{className:"text-xs text-gray-600",children:K.uploader.name}),i.jsxs("span",{className:"text-[10px] text-gray-400",children:[" ",new Date(K.uploadDate).toLocaleDateString("vi-VN")]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[(K.comments||[]).length>0&&i.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-[10px] font-medium bg-blue-100 text-blue-700",children:[i.jsx(Fr,{className:"w-2.5 h-2.5 mr-0.5"}),(K.comments||[]).length]}),i.jsx("button",{onClick:Ee=>Se(K,Ee),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-all",children:i.jsx(hn,{className:"h-4 w-4"})})]})]})]},K.id)),X.length===0&&i.jsxs("div",{className:"text-center py-10 text-gray-400",children:[i.jsx(Ze,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),i.jsx("p",{className:"text-sm",children:"Khng c ti liu no"})]})]}):i.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn ti liu"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngi ng"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngy ng"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gp "}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"Thao tc"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:X.map(K=>i.jsxs("tr",{onClick:()=>Z(K),className:"hover:bg-teal-50/40 cursor-pointer transition-colors group",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10 flex items-center justify-center bg-gray-100 rounded-lg",children:O_(K.type)}),i.jsxs("div",{className:"ml-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900 group-hover:text-teal-700 transition-colors",children:K.name}),i.jsx("div",{className:"text-xs text-gray-500",children:V(K.category)})]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"h-8 w-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 font-bold text-xs",children:K.uploader.name.charAt(0)}),i.jsxs("div",{className:"ml-3",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:K.uploader.name}),i.jsx("div",{className:"text-xs text-gray-500",children:K.uploader.role})]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(K.uploadDate).toLocaleDateString("vi-VN")}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(K.comments||[]).length>0?i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 animate-pulse",children:[i.jsx(Fr,{className:"w-3 h-3 mr-1"}),(K.comments||[]).length," Gp  mi"]}):i.jsx("span",{className:"text-xs text-gray-400",children:"Cha c gp "})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",onClick:Ee=>Ee.stopPropagation(),children:[i.jsx("button",{className:"p-2 text-gray-400 hover:text-teal-600 hover:bg-teal-50 rounded-full transition-all",children:i.jsx(Qn,{className:"h-4 w-4"})}),i.jsx("button",{onClick:Ee=>Se(K,Ee),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-all",children:i.jsx(hn,{className:"h-4 w-4"})})]})})]},K.id))})]})})]})]}),M&&O&&i.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-in zoom-in-95 duration-200",children:i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Yn,{className:"h-8 w-8 text-red-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Xc nhn xa ti liu?"}),i.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Bn c chc chn mun xa h s ",i.jsxs("span",{className:"font-semibold text-gray-800",children:['"',O.name,'"']})," khng? Hnh ng ny khng th hon tc."]}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hy b"}),i.jsx("button",{onClick:Be,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 shadow-md transition-colors",children:"Xa vnh vin"})]})]})})}),R&&Te&&(o?i.jsxs("div",{className:"fixed inset-0 z-50 bg-white flex flex-col animate-in fade-in duration-200",children:[i.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-gray-200 bg-white flex-shrink-0 safe-area-inset-top",children:[i.jsx("button",{onClick:()=>D(!1),className:"p-2 -ml-2 text-gray-600 hover:bg-gray-100 rounded-full",children:i.jsx(cf,{className:"h-5 w-5"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-sm font-bold text-gray-900 truncate",children:Te.name}),i.jsxs("p",{className:"text-[10px] text-gray-500",children:[V(Te.category),"  ",new Date(Te.uploadDate).toLocaleDateString("vi-VN")]})]})]}),i.jsx("div",{className:"flex-1 bg-gray-100 overflow-hidden",children:be(!1)}),i.jsx("div",{className:"flex-shrink-0 bg-white border-t border-gray-200 px-4 py-3 safe-area-inset-bottom",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx("div",{className:"h-7 w-7 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 font-bold text-[10px] flex-shrink-0",children:Te.uploader.name.charAt(0)}),i.jsx("span",{className:"text-xs text-gray-600 truncate",children:Te.uploader.name}),(Te.comments||[]).length>0&&i.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-[10px] font-medium bg-blue-100 text-blue-700",children:[i.jsx(Fr,{className:"w-2.5 h-2.5 mr-0.5"}),(Te.comments||[]).length]})]}),i.jsxs("a",{href:Te.fileUrl,download:!0,className:"flex items-center gap-1.5 px-4 py-2 bg-teal-600 text-white rounded-lg text-sm font-medium shadow-md",onClick:K=>K.stopPropagation(),children:[i.jsx(Qn,{className:"h-4 w-4"}),"Ti v"]})]})})]}):i.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden flex justify-end",children:[i.jsx("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-sm transition-opacity",onClick:()=>D(!1)}),i.jsxs("div",{className:"relative w-full max-w-6xl bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-teal-100 flex justify-between items-start bg-teal-50/30 flex-shrink-0",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-[10px] font-bold text-teal-600 uppercase tracking-wider mb-1 block",children:V(Te.category)}),i.jsx("h2",{className:"text-lg font-bold text-gray-900 leading-tight",children:Te.name})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"p-2 text-gray-500 hover:text-teal-600 hover:bg-teal-50 rounded-lg transition-colors",title:"Ti xung",children:i.jsx(Qn,{className:"h-5 w-5"})}),i.jsx("button",{onClick:()=>D(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:i.jsx(fn,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row",children:[i.jsxs("div",{className:"flex-1 overflow-hidden bg-gray-100 border-b md:border-b-0 md:border-r border-gray-200 relative flex flex-col",children:[i.jsx("div",{className:"absolute top-4 right-6 flex gap-2 z-10",children:i.jsx("button",{onClick:()=>re(!0),className:"bg-white/80 backdrop-blur p-1.5 rounded-md shadow-sm text-gray-600 hover:text-teal-600 border border-gray-200 hover:scale-110 transition-all",title:"Phng to ton mn hnh",children:i.jsx(l1,{className:"h-4 w-4"})})}),i.jsx("div",{className:"flex-1 w-full h-full",children:be(!1)})]}),i.jsxs("div",{className:"w-full md:w-72 lg:w-80 bg-white flex flex-col h-1/2 md:h-full flex-shrink-0",children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 bg-white",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Ngi ng"}),i.jsx("span",{className:"text-xs font-bold text-gray-800",children:Te.uploader.name})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Ngy ti ln"}),i.jsx("span",{className:"text-xs font-bold text-gray-800",children:new Date(Te.uploadDate).toLocaleDateString("vi-VN")})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 bg-white",children:[i.jsxs("h3",{className:"text-sm font-bold text-gray-800 mb-4 flex items-center gap-2 sticky top-0 bg-white pb-2 z-10",children:[i.jsx(Fr,{className:"h-4 w-4 text-teal-500"}),"  kin & Gp "]}),i.jsxs("div",{className:"space-y-4 mb-4",children:[(Te.comments||[]).length>0?(Te.comments||[]).map(K=>i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"h-8 w-8 rounded-full bg-teal-100 text-teal-700 border border-teal-200 flex items-center justify-center text-xs font-bold flex-shrink-0",children:K.userName.charAt(0)}),i.jsxs("div",{className:"bg-gray-100 rounded-xl rounded-tl-none p-3 flex-1",children:[i.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-900",children:K.userName}),i.jsx("span",{className:"text-[10px] text-gray-500",children:K.userRole})]}),i.jsx("p",{className:"text-sm text-gray-800",children:K.content})]})]},K.id)):i.jsx("div",{className:"text-center py-6 text-gray-400 text-xs italic",children:"Cha c gp  no."}),i.jsx("div",{ref:$})]})]}),i.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:i.jsxs("form",{onSubmit:Pe,className:"relative",children:[i.jsx("input",{type:"text",className:"w-full pl-4 pr-12 py-3 bg-white border border-gray-300 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent shadow-sm",placeholder:"Nhp ni dung gp ...",value:q,onChange:K=>L(K.target.value)}),i.jsx("button",{type:"submit",disabled:!q.trim(),className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-1.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700 disabled:opacity-50 disabled:bg-gray-300 transition-all",children:i.jsx(Cu,{className:"h-4 w-4"})})]})})]})]})]})]})),z&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-white",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(En,{className:"h-5 w-5 text-teal-600"}),"Ti ln Ti liu"]}),i.jsx("button",{onClick:()=>he(!1),className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",children:i.jsx(fn,{className:"h-6 w-6"})})]}),i.jsxs("div",{className:"p-6 space-y-5",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn h s ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none transition-all",placeholder:"VD: K hoch thu chi thng 11...",value:C.name,onChange:K=>k({...C,name:K.target.value})})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phn loi h s ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none transition-all bg-white",value:C.category,onChange:K=>k({...C,category:K.target.value}),children:[i.jsx("option",{value:"general",children:"Hnh chnh chung"}),i.jsx("option",{value:"finance",children:"Ti chnh & K ton"}),i.jsx("option",{value:"medical",children:"Y t & Bn tr"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tp nh km"}),i.jsxs("div",{onDrop:de,onDragOver:K=>K.preventDefault(),className:`border-2 border-dashed rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer transition-all group relative ${_e?"border-teal-500 bg-teal-50":"border-gray-300 hover:bg-gray-50 hover:border-teal-400"}`,children:[i.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:ye}),_e?i.jsxs("div",{className:"flex flex-col items-center text-center animate-in zoom-in duration-300",children:[i.jsx(ys,{className:"h-10 w-10 text-teal-600 mb-2"}),i.jsx("p",{className:"text-sm font-bold text-teal-800 truncate max-w-[250px]",children:_e.name}),i.jsxs("p",{className:"text-xs text-teal-600 mt-1",children:[(_e.size/1024).toFixed(0)," KB -  sn sng"]})]}):i.jsxs("div",{className:"flex flex-col items-center text-center",children:[i.jsx("div",{className:`p-3 rounded-full mb-3 transition-colors ${C.category==="finance"?"bg-green-100 text-green-600":C.category==="medical"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:i.jsx(uf,{className:"h-8 w-8"})}),i.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Ko th file vo y hoc ",i.jsx("span",{className:"text-teal-600 underline",children:"Bm  chn"})]}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"H tr PDF, Excel, Word (Ti a 10MB)"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch thm"}),i.jsx("textarea",{rows:3,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none transition-all text-sm",placeholder:"M t ngn gn ni dung...",value:C.note,onChange:K=>k({...C,note:K.target.value})})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>he(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-white hover:shadow-sm rounded-lg border border-transparent hover:border-gray-300 transition-all",children:"Hy b"}),i.jsxs("button",{onClick:Y,disabled:!_e,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 rounded-lg shadow-md transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(En,{className:"h-4 w-4"})," Lu h s"]})]})]})})]})},SO=({type:s})=>{const e="h-12 w-12 mb-4 transition-transform group-hover:scale-110 duration-300";switch(s){case"excel":return i.jsx(t0,{className:`${e} text-green-600`});case"pdf":return i.jsx(hf,{className:`${e} text-red-500`});case"word":return i.jsx(Ze,{className:`${e} text-blue-600`});default:return i.jsx(Ze,{className:`${e} text-gray-400`})}},CO=()=>{const s=ar(),{user:e}=vs(),{addToast:t}=jr(),a=na(),[o,u]=T.useState([]),[d,p]=T.useState("menu"),[x,g]=T.useState(""),[b,w]=T.useState(null),[N,R]=T.useState(!1),[D,q]=T.useState(""),L=T.useRef(null),[W,re]=T.useState(!1),[$,z]=T.useState(null),[he,_e]=T.useState({type:"menu",startDate:"",endDate:"",name:""}),[S,C]=T.useState(!1),[k,M]=T.useState(null),[I,O]=T.useState(!1),E=e;T.useEffect(()=>{const Y=mn(Tt(Ae,"boarding_docs"),Jo("uploadDate","desc")),be=zs(Y,B=>{const ce=[];B.forEach(K=>{ce.push({id:K.id,...K.data()})}),u(ce)});return()=>be()},[]);const ve=o.filter(Y=>{const be=Y.category===d,B=Y.name.toLowerCase().includes(x.toLowerCase());return be&&B});T.useEffect(()=>{var Y;N&&((Y=L.current)==null||Y.scrollIntoView({behavior:"smooth"}))},[b==null?void 0:b.comments,N]),T.useEffect(()=>{if(he.type==="menu"&&he.startDate&&he.endDate){const Y=new Date(he.startDate);new Date(he.endDate);const be=new Date(Y.getFullYear(),0,1),B=Math.floor((Y.getTime()-be.getTime())/(1440*60*1e3)),ce=Math.ceil((Y.getDay()+1+B)/7);_e(K=>({...K,name:`Thc n Tun ${ce} - Thng ${Y.getMonth()+1}`}))}},[he.startDate,he.endDate,he.type]);const Te=Y=>{w(Y),R(!0)},X=(Y,be)=>{be&&be.stopPropagation(),M(Y),C(!0)},Z=async()=>{if(k)try{await Cl(qe(Ae,"boarding_docs",k.id)),t(" xa ti liu thnh cng","H s  c xa khi h thng.","success"),C(!1),M(null),(b==null?void 0:b.id)===k.id&&(R(!1),w(null))}catch(Y){console.error("Error deleting document: ",Y),t("Li","Khng th xa h s.","error")}},Se=async Y=>{if(Y.preventDefault(),!D.trim()||!b||!E)return;const be={id:Date.now().toString(),userId:E.id,userName:E.fullName,userRole:E.role,content:D,timestamp:new Date().toISOString()};try{const B=qe(Ae,"boarding_docs",b.id);await Qt(B,{comments:Bo(be)});const ce={...b,comments:[...b.comments,be]};w(ce),q(""),t(" gi bnh lun"," kin ca bn  c ghi nhn.","success"),await br("comment",E,{type:"boarding",name:b.name,targetPath:"/boarding-menu"})}catch(B){console.error("Error adding comment: ",B),t("Li","Khng th gi bnh lun.","error")}},Be=Y=>{switch(Y){case"menu":return"Thc n Tun";case"food_safety":return"H s V sinh ATTP";case"nutrition":return"Bo co Dinh dng";default:return""}},Pe=()=>{_e({type:d==="menu"?"menu":d==="food_safety"?"food_safety":"nutrition",startDate:"",endDate:"",name:""}),z(null),re(!0)},V=Y=>{if(Y.preventDefault(),Y.dataTransfer.files&&Y.dataTransfer.files[0]){const be=Y.dataTransfer.files[0];z(be),!he.name&&he.type!=="menu"&&_e(B=>({...B,name:be.name.split(".")[0]}))}},oe=Y=>{if(Y.target.files&&Y.target.files[0]){const be=Y.target.files[0];z(be),!he.name&&he.type!=="menu"&&_e(B=>({...B,name:be.name.split(".")[0]}))}},de=async()=>{if($)try{const Y=rr(Ls,`boarding_docs/${Date.now()}_${$.name}`),be=await nr(Y,$),B=await sr(be.ref),ce={...he,uploader:{id:(E==null?void 0:E.id)||"unknown",name:(E==null?void 0:E.fullName)||"n danh",avatar:(E==null?void 0:E.avatar)||""},uploadDate:new Date().toISOString(),comments:[],fileType:$.name.split(".").pop()||"file",category:d,fileUrl:B};await Al(Tt(Ae,"boarding_docs"),ce),t("Ti ln thnh cng!",` lu h s: ${he.name}`,"success"),re(!1),E&&await br("upload",E,{type:"boarding",name:he.name,targetPath:"/boarding-menu"})}catch(Y){console.error("Error adding document: ",Y),t("Li","Khng th ti ln h s.","error")}},ye=(Y=!1)=>{if(!b)return null;if(b.fileUrl&&b.fileUrl!=="#"){const be=Yu(b.fileUrl,a);return be==="EXCEL_NO_PREVIEW"?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-600 bg-gray-50 rounded-lg p-8",children:[i.jsx("div",{className:"p-4 bg-green-100 rounded-full mb-4",children:i.jsx(Ze,{className:"h-16 w-16 text-green-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:"File Excel"}),i.jsx("p",{className:"text-sm text-gray-500 mb-6 text-center max-w-md",children:"File Excel khng th xem trc trc tip. Vui lng ti xung  xem ni dung."}),i.jsxs("a",{href:b.fileUrl,download:!0,className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg shadow-md transition-all font-bold",children:[i.jsx(Qn,{className:"h-5 w-5"}),"Ti xung file"]})]}):i.jsx("div",{className:"w-full h-full",children:i.jsx("iframe",{src:be,className:"w-full h-full border-0",title:"Document Preview"})})}else return i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 bg-gray-50 rounded-lg",children:[i.jsx(Ze,{className:"h-16 w-16 mb-4 text-gray-400"}),i.jsx("p",{className:"text-lg font-medium",children:"Khng c bn xem trc"}),i.jsx("p",{className:"text-sm",children:"Ti liu ny cha c file nh km hoc file khng h tr xem trc."})]})};return i.jsxs("div",{className:"flex flex-col h-screen bg-gray-50 overflow-hidden font-sans",children:[i.jsx("div",{className:`bg-white border-b border-emerald-100 ${a?"px-4 py-3":"px-6 py-4"} flex-shrink-0 z-20 shadow-sm`,children:i.jsxs("div",{className:"max-w-7xl mx-auto w-full",children:[!a&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-2",children:[i.jsx("span",{className:"cursor-pointer hover:text-emerald-600",onClick:()=>s("/"),children:"Dashboard"}),i.jsx(ps,{className:"h-3 w-3"}),i.jsx("span",{children:"T Vn phng"}),i.jsx(ps,{className:"h-3 w-3"}),i.jsx("span",{className:"font-semibold text-emerald-700",children:"Bn tr"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:`${a?"text-lg":"text-2xl"} font-bold text-gray-900 flex items-center gap-2 cursor-pointer hover:opacity-80 transition-opacity`,onClick:()=>s("/"),children:[i.jsx("span",{className:`${a?"p-1.5":"p-2"} bg-emerald-100 rounded-lg text-emerald-700`,children:i.jsx(gg,{className:`${a?"h-5 w-5":"h-6 w-6"}`})}),"Qun l Bn tr & Dinh dng"]}),!a&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1 ml-12 flex items-center gap-1",children:[i.jsx(Ro,{className:"h-3 w-3"})," Ch dnh cho BGH, Y t & K ton"]})]}),i.jsxs("button",{onClick:Pe,className:`flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white ${a?"px-3 py-2 text-sm":"px-5 py-2.5"} rounded-lg shadow-md hover:shadow-lg transition-all font-medium transform hover:-translate-y-0.5`,children:[i.jsx(En,{className:"h-4 w-4"}),i.jsx("span",{children:"Ti ln h s mi"})]})]})]})}),i.jsxs("div",{className:"flex flex-1 overflow-hidden max-w-7xl mx-auto w-full",children:[i.jsx("div",{className:"w-64 bg-white border-r border-gray-200 flex-shrink-0 overflow-y-auto hidden md:block",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-4",children:"Nghip v Bn tr"}),i.jsxs("nav",{className:"space-y-2",children:[i.jsxs("button",{onClick:()=>p("menu"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-xl transition-all ${d==="menu"?"bg-emerald-50 text-emerald-700 shadow-sm ring-1 ring-emerald-100":"text-gray-600 hover:bg-gray-50"}`,children:[i.jsx(gg,{className:"h-4 w-4"}),"Thc n Tun"]}),i.jsxs("button",{onClick:()=>p("food_safety"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-xl transition-all ${d==="food_safety"?"bg-emerald-50 text-emerald-700 shadow-sm ring-1 ring-emerald-100":"text-gray-600 hover:bg-gray-50"}`,children:[i.jsx(_o,{className:"h-4 w-4"}),"H s V sinh ATTP"]}),i.jsxs("button",{onClick:()=>p("nutrition"),className:`w-full flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-xl transition-all ${d==="nutrition"?"bg-emerald-50 text-emerald-700 shadow-sm ring-1 ring-emerald-100":"text-gray-600 hover:bg-gray-50"}`,children:[i.jsx(uC,{className:"h-4 w-4"}),"Bo co Dinh dng"]})]})]})}),i.jsxs("div",{className:`flex-1 bg-gray-50 overflow-y-auto ${a?"p-4":"p-6"}`,children:[a&&i.jsx("div",{className:"flex gap-2 overflow-x-auto pb-3 mb-4 no-scrollbar",children:[{id:"menu",label:"Thc n Tun"},{id:"food_safety",label:"V sinh ATTP"},{id:"nutrition",label:"Dinh dng"}].map(Y=>i.jsx("button",{onClick:()=>p(Y.id),className:`flex-shrink-0 px-3 py-1.5 text-xs font-bold rounded-full transition-all ${d===Y.id?"bg-emerald-600 text-white shadow-md":"bg-white text-gray-600 border border-gray-200"}`,children:Y.label},Y.id))}),i.jsxs("div",{className:`flex items-center justify-between ${a?"mb-4":"mb-8"}`,children:[i.jsx("h2",{className:`${a?"text-base":"text-lg"} font-bold text-gray-800`,children:Be(d)}),i.jsxs("div",{className:"relative",children:[i.jsx(Tl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Tm kim h s...",value:x,onChange:Y=>g(Y.target.value),className:`pl-9 pr-4 py-2 border border-gray-200 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 ${a?"w-40":"w-64"} bg-white shadow-sm`})]})]}),i.jsxs("div",{className:`grid ${a?"grid-cols-2 gap-3":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"}`,children:[ve.map(Y=>i.jsxs("div",{onClick:()=>Te(Y),className:`group bg-white rounded-2xl border border-gray-100 ${a?"p-4":"p-6"} shadow-sm hover:shadow-lg hover:border-emerald-200 cursor-pointer transition-all duration-300 flex flex-col items-center text-center relative overflow-hidden`,children:[i.jsx("div",{className:"absolute inset-0 bg-emerald-50 opacity-0 group-hover:opacity-10 transition-opacity duration-300"}),i.jsx("div",{className:`${a?"mb-2":"mb-4"}`,children:a?i.jsxs("div",{className:"h-10 w-10 flex items-center justify-center bg-gray-100 rounded-lg",children:[Y.type==="excel"&&i.jsx(t0,{className:"h-5 w-5 text-green-600"}),Y.type==="pdf"&&i.jsx(hf,{className:"h-5 w-5 text-red-500"}),Y.type==="word"&&i.jsx(Ze,{className:"h-5 w-5 text-blue-600"}),!["excel","pdf","word"].includes(Y.type)&&i.jsx(Ze,{className:"h-5 w-5 text-gray-400"})]}):i.jsx(SO,{type:Y.type})}),i.jsx("h3",{className:`${a?"text-xs":"text-sm"} font-bold text-gray-800 mb-1 line-clamp-2 group-hover:text-emerald-700 transition-colors`,children:Y.name}),i.jsxs("p",{className:`${a?"text-[10px]":"text-xs"} text-gray-500 ${a?"mb-2":"mb-4"}`,children:["ng bi ",i.jsx("span",{className:"font-medium text-gray-700",children:Y.uploader.name})]}),i.jsxs("div",{className:`w-full ${a?"pt-2":"pt-4"} border-t border-gray-50 flex items-center justify-between mt-auto relative z-10`,children:[i.jsxs("span",{className:"text-[10px] text-gray-400 flex items-center gap-1",children:[i.jsx(Da,{className:"h-3 w-3"}),new Date(Y.uploadDate).toLocaleDateString("vi-VN")]}),i.jsxs("div",{className:"flex items-center gap-1",children:[Y.comments.length>0&&i.jsxs("div",{className:"flex items-center gap-0.5 text-[10px] font-bold text-red-500 bg-red-50 px-1 py-0.5 rounded-full",children:[i.jsx(Ea,{className:"h-2.5 w-2.5"}),Y.comments.length]}),!a&&i.jsx("button",{onClick:be=>X(Y,be),className:"text-gray-400 hover:text-red-600 p-1.5 rounded-full hover:bg-red-50 transition-colors",title:"Xa ti liu",children:i.jsx(hn,{className:"h-4 w-4"})})]})]})]},Y.id)),ve.length===0&&i.jsxs("div",{className:"col-span-full py-12 flex flex-col items-center text-gray-400",children:[i.jsx("div",{className:"bg-gray-100 p-4 rounded-full mb-3",children:i.jsx(Ze,{className:"h-8 w-8 text-gray-300"})}),i.jsx("p",{children:"Khng tm thy h s no."})]})]})]})]}),S&&k&&i.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-in zoom-in-95 duration-200",children:i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Yn,{className:"h-8 w-8 text-red-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Xc nhn xa ti liu?"}),i.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Bn c chc chn mun xa h s ",i.jsxs("span",{className:"font-semibold text-gray-800",children:['"',k.name,'"']})," khng? Hnh ng ny khng th hon tc."]}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsx("button",{onClick:()=>C(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hy b"}),i.jsx("button",{onClick:Z,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 shadow-md transition-colors",children:"Xa vnh vin"})]})]})})}),N&&b&&(a?i.jsxs("div",{className:"fixed inset-0 z-50 bg-white flex flex-col animate-in fade-in duration-200",children:[i.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-gray-200 bg-white flex-shrink-0 safe-area-inset-top",children:[i.jsx("button",{onClick:()=>R(!1),className:"p-2 -ml-2 text-gray-600 hover:bg-gray-100 rounded-full",children:i.jsx(ps,{className:"h-5 w-5 rotate-180"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"text-sm font-bold text-gray-900 truncate",children:b.name}),i.jsxs("p",{className:"text-[10px] text-gray-500",children:[Be(d),"  ",new Date(b.uploadDate).toLocaleDateString("vi-VN")]})]})]}),i.jsx("div",{className:"flex-1 bg-gray-100 overflow-hidden",children:ye(!1)}),i.jsx("div",{className:"flex-shrink-0 bg-white border-t border-gray-200 px-4 py-3 safe-area-inset-bottom",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx("div",{className:"h-7 w-7 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-700 font-bold text-[10px] flex-shrink-0",children:b.uploader.name.charAt(0)}),i.jsx("span",{className:"text-xs text-gray-600 truncate",children:b.uploader.name}),b.comments.length>0&&i.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-[10px] font-medium bg-blue-100 text-blue-700",children:[i.jsx(Ea,{className:"w-2.5 h-2.5 mr-0.5"}),b.comments.length]})]}),i.jsx("button",{onClick:Y=>X(b,Y),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",children:i.jsx(hn,{className:"h-4 w-4"})}),i.jsxs("a",{href:b.fileUrl,download:!0,className:"flex items-center gap-1.5 px-4 py-2 bg-emerald-600 text-white rounded-lg text-sm font-medium shadow-md",onClick:Y=>Y.stopPropagation(),children:[i.jsx(Qn,{className:"h-4 w-4"}),"Ti v"]})]})})]}):i.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden flex justify-end",children:[i.jsx("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-sm transition-opacity",onClick:()=>R(!1)}),i.jsxs("div",{className:"relative w-full max-w-6xl bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-emerald-50 flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-white rounded-lg border border-emerald-100 shadow-sm",children:i.jsx(Ze,{className:"h-5 w-5 text-emerald-600"})}),i.jsxs("div",{children:[i.jsx("span",{className:"text-[10px] font-bold text-emerald-600 uppercase tracking-wider mb-0.5 block",children:"Chi tit h s"}),i.jsx("h2",{className:"text-lg font-bold text-gray-900 leading-tight line-clamp-1",children:b.name})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{b.fileUrl&&b.fileUrl!=="#"?window.open(b.fileUrl,"_blank"):t("Khng c file","Ti liu ny khng c file nh km.","error")},className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Ti xung",children:i.jsx(Qn,{className:"h-5 w-5"})}),i.jsx("button",{onClick:()=>R(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-200 transition-colors",children:i.jsx(fn,{className:"h-6 w-6"})})]})]}),i.jsxs("div",{className:"flex-1 overflow-hidden flex flex-row",children:[i.jsxs("div",{className:"flex-1 overflow-hidden bg-gray-100 border-r border-gray-200 relative flex flex-col",children:[i.jsx("div",{className:"absolute top-4 right-6 flex gap-2 z-10",children:i.jsx("button",{onClick:()=>O(!0),className:"bg-white/80 backdrop-blur p-1.5 rounded-md shadow-sm text-gray-600 hover:text-emerald-600 border border-gray-200 hover:scale-110 transition-all",title:"Phng to ton mn hnh",children:i.jsx(l1,{className:"h-4 w-4"})})}),i.jsx("div",{className:"flex-1 w-full h-full",children:ye(!1)})]}),i.jsxs("div",{className:"w-72 lg:w-80 bg-white flex flex-col h-full flex-shrink-0",children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 bg-white",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Ngi ng"}),i.jsx("span",{className:"text-xs font-bold text-gray-800",children:b.uploader.name})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Ngy ti ln"}),i.jsx("span",{className:"text-xs font-bold text-gray-800",children:new Date(b.uploadDate).toLocaleDateString("vi-VN")})]}),b.category==="menu"&&b.startDate&&b.endDate&&i.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100",children:[i.jsx("span",{className:"text-xs text-gray-500 block mb-1",children:"Thi gian p dng"}),i.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-700",children:[i.jsx(Da,{className:"h-3 w-3"}),i.jsx("span",{children:new Date(b.startDate).toLocaleDateString("vi-VN")}),i.jsx("span",{children:""}),i.jsx("span",{children:new Date(b.endDate).toLocaleDateString("vi-VN")})]})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 bg-white",children:[i.jsxs("h3",{className:"text-sm font-bold text-gray-800 mb-4 flex items-center gap-2 sticky top-0 bg-white pb-2 z-10",children:[i.jsx(Ea,{className:"h-4 w-4 text-emerald-500"}),"Gp  chuyn mn"]}),i.jsxs("div",{className:"space-y-4",children:[b.comments&&b.comments.length>0?b.comments.map(Y=>i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"h-8 w-8 rounded-full bg-emerald-100 text-emerald-700 border border-emerald-200 flex items-center justify-center text-xs font-bold flex-shrink-0",children:Y.userName.charAt(0)}),i.jsxs("div",{className:"bg-gray-50 rounded-xl rounded-tl-none p-3 flex-1 border border-gray-100",children:[i.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-900",children:Y.userName}),i.jsx("span",{className:"text-[10px] text-gray-500",children:Y.userRole})]}),i.jsx("p",{className:"text-sm text-gray-800 leading-relaxed",children:Y.content}),i.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:new Date(Y.timestamp).toLocaleString("vi-VN")})]})]},Y.id)):i.jsxs("div",{className:"text-center py-12 flex flex-col items-center text-gray-300",children:[i.jsx(Ea,{className:"h-10 w-10 mb-2 opacity-50"}),i.jsx("span",{className:"text-xs italic",children:"Cha c gp  no."})]}),i.jsx("div",{ref:L})]})]}),i.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:[i.jsxs("form",{onSubmit:Se,className:"relative",children:[i.jsx("input",{type:"text",className:"w-full pl-4 pr-12 py-3 bg-white border border-gray-300 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent shadow-sm",placeholder:"Nhp  kin ch o...",value:D,onChange:Y=>q(Y.target.value)}),i.jsx("button",{type:"submit",disabled:!D.trim(),className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-1.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 transition-all",children:i.jsx(Cu,{className:"h-4 w-4"})})]}),i.jsxs("p",{className:"text-[10px] text-gray-400 mt-2 text-center flex items-center justify-center gap-1",children:[i.jsx(Ro,{className:"h-2.5 w-2.5"})," Ch ni b BGH xem c."]})]})]})]})]})]})),I&&b&&i.jsxs("div",{className:"fixed inset-0 z-[60] bg-black/90 backdrop-blur-sm flex flex-col animate-in fade-in duration-200",children:[i.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-black/50 text-white backdrop-blur-md z-10",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-2 bg-white/10 rounded-lg backdrop-blur-sm",children:i.jsx(Ze,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-bold text-white leading-none",children:b.name}),i.jsx("p",{className:"text-xs text-white/60 mt-1",children:"Ch  xem ton mn hnh"})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{className:"p-2 hover:bg-white/20 rounded-full transition-colors",title:"Thu nh",children:i.jsx(kA,{className:"h-5 w-5"})}),i.jsx("button",{className:"p-2 hover:bg-white/20 rounded-full transition-colors",title:"Phng to",children:i.jsx(AA,{className:"h-5 w-5"})}),i.jsx("div",{className:"w-px h-6 bg-white/20 mx-1"}),i.jsx("button",{onClick:()=>O(!1),className:"p-2 hover:bg-red-500/80 hover:text-white bg-white/10 rounded-full transition-colors",children:i.jsx(fn,{className:"h-6 w-6"})})]})]}),i.jsx("div",{className:"flex-1 overflow-auto p-8 flex justify-center custom-scrollbar bg-neutral-900/50",children:ye(!0)})]}),W&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-white",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(En,{className:"h-5 w-5 text-emerald-600"}),"Ti ln Bn tr"]}),i.jsx("button",{onClick:()=>re(!1),className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",children:i.jsx(fn,{className:"h-6 w-6"})})]}),i.jsxs("div",{className:"p-6 space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loi d liu"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:[{id:"menu",label:"Thc n Tun"},{id:"food_safety",label:"H s V sinh ATTP"},{id:"nutrition",label:"Bo co Dinh dng"}].map(Y=>i.jsx("button",{onClick:()=>_e(be=>({...be,type:Y.id})),className:`px-3 py-1.5 text-sm font-medium rounded-full border transition-all ${he.type===Y.id?"bg-emerald-50 text-emerald-700 border-emerald-200 ring-1 ring-emerald-100":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:Y.label},Y.id))})]}),he.type==="menu"&&i.jsxs("div",{className:"grid grid-cols-2 gap-4 animate-in fade-in slide-in-from-top-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none transition-all text-sm",value:he.startDate,onChange:Y=>_e({...he,startDate:Y.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none transition-all text-sm",value:he.endDate,onChange:Y=>_e({...he,endDate:Y.target.value})})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn hin th ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none transition-all",placeholder:he.type==="menu"?"T ng in khi chn ngy...":"Nhp tn h s...",value:he.name,onChange:Y=>_e({...he,name:Y.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tp nh km"}),i.jsxs("div",{onDrop:V,onDragOver:Y=>Y.preventDefault(),className:`border-2 border-dashed rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer transition-all group relative ${$?"border-emerald-500 bg-emerald-50":"border-gray-300 hover:bg-gray-50 hover:border-emerald-400"}`,children:[i.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:oe}),$?i.jsxs("div",{className:"flex flex-col items-center text-center animate-in zoom-in duration-300",children:[i.jsx(ys,{className:"h-10 w-10 text-emerald-600 mb-2"}),i.jsx("p",{className:"text-sm font-bold text-emerald-800 truncate max-w-[250px]",children:$.name}),i.jsxs("p",{className:"text-xs text-emerald-600 mt-1",children:[($.size/1024).toFixed(0)," KB -  sn sng"]})]}):i.jsxs("div",{className:"flex flex-col items-center text-center",children:[i.jsx("div",{className:"p-3 rounded-full mb-3 bg-emerald-100 text-emerald-600 transition-colors",children:i.jsx(uf,{className:"h-8 w-8"})}),i.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Ko th file vo y hoc ",i.jsx("span",{className:"text-emerald-600 underline",children:"Bm  chn"})]}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"H tr PDF, Excel, Word (Ti a 10MB)"})]})]})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>re(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-white hover:shadow-sm rounded-lg border border-transparent hover:border-gray-300 transition-all",children:"Hy b"}),i.jsxs("button",{onClick:de,disabled:!$,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-lg shadow-md transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(En,{className:"h-4 w-4"})," Lu h s"]})]})]})})]})},jT=({file:s,onClose:e,onSaveSuccess:t,onFileUpdate:a,collectionName:o,storageFolder:u="files",canEdit:d=!1,canApprove:p=!1,canComment:x=!1,canRespond:g=!1,onApprove:b,onRequestRevision:w,onPostComment:N,onEditComment:R,onDeleteComment:D,canManageComment:q})=>{var Bs,Bn;const[L,W]=T.useState(!0),[re,$]=T.useState(!1),[z,he]=T.useState(null),[_e,S]=T.useState(null),[C,k]=T.useState(!1),[M,I]=T.useState(null),[O,E]=T.useState(!1),[ve,Te]=T.useState(null),[X,Z]=T.useState(""),[Se,Be]=T.useState(!1),[Pe,V]=T.useState(""),[oe,de]=T.useState(null),[ye,Y]=T.useState(null),[be,B]=T.useState(null),[ce,K]=T.useState(null),{user:Ee}=vs(),F=na(),[je,le]=T.useState(!1),ke=T.useRef(null),Me=T.useRef(Date.now()),Xe=(gt,Qe="info")=>{Te({message:gt,type:Qe}),setTimeout(()=>Te(null),3e3)},nt=()=>{var Qe,Ct,Zt;return s.type?s.type.toLowerCase():((Zt=(Ct=(Qe=s.url)==null?void 0:Qe.split(".").pop())==null?void 0:Ct.split("?")[0])==null?void 0:Zt.toLowerCase())||""},xt=()=>{const gt=nt(),Qe=s.name.replace(/\.[^/.]+$/,"");return["xlsx","xls","csv"].includes(gt)?`${Qe}.xlsx`:["pptx","ppt"].includes(gt)?`${Qe}.pptx`:gt==="pdf"?`${Qe}.pdf`:`${Qe}.docx`},jt=()=>{const gt=nt();return!["pdf"].includes(gt)};T.useEffect(()=>{s.url&&(he(s.url),de(null))},[s.url]),T.useEffect(()=>{(async()=>{if(!d||!s.uploaderId){I(null);return}try{const Qe=qe(Ae,"users",s.uploaderId),Ct=await vr(Qe);if(Ct.exists()){const Zt=Ct.data();I(Zt.signatureUrl||null)}}catch(Qe){console.error("Error fetching author signature:",Qe),I(null)}})()},[d,s.uploaderId]);const zt=()=>{var Zt;if(!M)return;const Qe=`chu_ky_${((Zt=s.uploader)==null?void 0:Zt.replace(/\s+/g,"_"))||"author"}.png`,Ct=new Image;Ct.crossOrigin="anonymous",Ct.onload=()=>{const Dt=document.createElement("canvas");Dt.width=Ct.naturalWidth,Dt.height=Ct.naturalHeight;const vt=Dt.getContext("2d");vt&&(vt.drawImage(Ct,0,0),Dt.toBlob(Xt=>{if(Xt){const wt=URL.createObjectURL(Xt),an=document.createElement("a");an.href=wt,an.download=Qe,document.body.appendChild(an),an.click(),document.body.removeChild(an),URL.revokeObjectURL(wt),Xe(" ti ch k thnh cng!","success")}},"image/png"))},Ct.onerror=()=>{console.error("Error loading signature image"),Xe("Li khi ti ch k","error")},Ct.src=M};T.useEffect(()=>{const gt=async Qe=>{if(Qe.data.type==="FILE_SAVED"&&Qe.data.base64&&await ws(Qe.data.base64),Qe.data.type==="FILE_LOAD_ERROR"){console.error("File load error from iframe:",Qe.data);const Ct=Qe.data.code==="88"?"Ti liu c nh dng phc tp hoc qu ln, khng th xem trc trc tip.":`Li ti ti liu: ${Qe.data.message}`;de(Ct),W(!1)}Qe.data.type==="SAVE_NOT_ALLOWED"&&Xe(Qe.data.message||"Bn khng phi l tc gi ca file, vui lng lin h tc gi  yu cu chnh sa.","error"),Qe.data.type==="SAVE_ERROR"&&(console.error("Save error from editor:",Qe.data.message),Qe.data.message&&(Qe.data.message.includes("code: 88")||Qe.data.message.includes("code 88"))?console.log("Ignored error code 88 toast"):Xe("Li khi lu: "+(Qe.data.message||"Unknown error"),"error"),$(!1))};return window.addEventListener("message",gt),()=>window.removeEventListener("message",gt)},[s,u,o]);const ws=async gt=>{if(d){$(!0);try{const Qe=atob(gt.split(",")[1]),Ct=new ArrayBuffer(Qe.length),Zt=new Uint8Array(Ct);for(let At=0;At<Qe.length;At++)Zt[At]=Qe.charCodeAt(At);const Dt=nt();let vt="application/vnd.openxmlformats-officedocument.wordprocessingml.document";["xlsx","xls"].includes(Dt)&&(vt="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),["pptx","ppt"].includes(Dt)&&(vt="application/vnd.openxmlformats-officedocument.presentationml.presentation");const Xt=new Blob([Ct],{type:vt}),wt=Date.now(),an=s.name.replace(/[^a-zA-Z0-9]/g,"_"),as=`${u}/${wt}_${an}.${Dt==="docx"||Dt==="doc"?"docx":Dt}`,Ts=rr(Ls,as);await nr(Ts,Xt,{contentType:vt});const Tn=await sr(Ts),js=qe(Ae,o,s.id);await Qt(js,{url:Tn,lastModified:new Date().toISOString()}),t==null||t(Tn),Xe(" lu thnh cng!","success")}catch(Qe){console.error("Error saving:",Qe),Xe("Li khi lu: "+Qe.message,"error")}finally{$(!1)}}},ir=()=>{if(!X.trim())return;const gt=x?"comment":"response";N==null||N(X.trim(),gt),Z(""),K(null)},In=()=>{b==null||b()},Bt=()=>{Be(!0)},_s=()=>{Pe.trim()&&(w==null||w(Pe.trim()),Be(!1),V(""))},Ns=()=>{if(!s.approval)return null;const gt=s.approval.status;return gt==="approved"?i.jsxs("span",{className:"px-2 py-1 text-xs font-bold rounded-full bg-green-100 text-green-700 flex items-center gap-1",children:[i.jsx(ys,{className:"h-3 w-3"}),"  duyt"]}):gt==="needs_revision"?i.jsxs("span",{className:"px-2 py-1 text-xs font-bold rounded-full bg-amber-100 text-amber-700 flex items-center gap-1",children:[i.jsx(Yn,{className:"h-3 w-3"})," Cn sa"]}):i.jsx("span",{className:"px-2 py-1 text-xs font-bold rounded-full bg-blue-100 text-blue-700",children:"Ch duyt"})};return i.jsxs("div",{className:"fixed inset-0 z-[70] flex bg-gray-900",children:[i.jsxs("div",{className:"flex-1 flex flex-col bg-white",children:[i.jsxs("div",{className:`flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-md flex-shrink-0 ${F?"py-2":""}`,children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"bg-white/20 p-2 rounded-lg",children:i.jsx(Ze,{className:"h-5 w-5"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h2",{className:"font-semibold text-base truncate pr-2",children:s.name}),!F&&i.jsx("p",{className:"text-xs text-blue-100 opacity-80",children:jt()?"Chnh sa trc tip":"Ch xem"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[!F&&d&&M&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsxs("button",{onClick:zt,className:"flex items-center gap-2 px-3 py-2 bg-indigo-500 hover:bg-indigo-600 rounded-lg transition-colors text-sm font-medium",title:"Ti ch k",children:[i.jsx(Ms,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Ti ch k"})]}),i.jsx("button",{onClick:()=>E(!0),className:"p-2 hover:bg-blue-500 rounded-lg transition-colors",title:"Hng dn chn ch k",children:i.jsx(wC,{className:"h-5 w-5"})})]}),!F&&i.jsx("div",{className:"text-xs bg-blue-800 px-2 py-1 rounded text-blue-200",children:re?"ang lu...":"T ng lu khi Save"}),i.jsx("a",{href:s.url,download:s.name,className:"p-2 hover:bg-blue-500 rounded-lg transition-colors",title:"Ti xung",children:i.jsx(Qn,{className:"h-5 w-5"})}),i.jsx("button",{onClick:e,className:"p-2 hover:bg-blue-500 rounded-full transition-colors",children:i.jsx(fn,{className:"h-5 w-5"})})]})]}),i.jsx("div",{className:"flex-1 relative bg-gray-100",children:oe?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:i.jsx(Yn,{className:"h-8 w-8 text-red-600"})}),i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Khng th xem trc ti liu"}),i.jsx("p",{className:"text-gray-600 max-w-md mb-6",children:oe}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsxs("a",{href:s.url,download:s.name,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg flex items-center justify-center gap-2 transition-colors shadow-lg hover:shadow-xl",children:[i.jsx(Qn,{className:"h-5 w-5"}),"Ti xung"]}),i.jsxs("a",{href:`https://docs.google.com/viewer?url=${encodeURIComponent(s.url)}&embedded=true`,target:"_blank",rel:"noopener noreferrer",className:"px-6 py-3 bg-white text-gray-700 border border-gray-300 font-bold rounded-lg flex items-center justify-center gap-2 hover:bg-gray-50 transition-colors shadow-lg hover:shadow-xl",children:[i.jsx(df,{className:"h-5 w-5"}),"Xem bng Google Viewer"]})]})]}):i.jsxs(i.Fragment,{children:[s.url&&(F?i.jsx("iframe",{ref:ke,src:`https://docs.google.com/viewer?url=${encodeURIComponent(s.url)}&embedded=true`,className:"w-full h-full border-none",title:"Document Viewer",onLoad:()=>W(!1),sandbox:"allow-scripts allow-same-origin allow-popups"}):i.jsx("iframe",{ref:ke,src:`/office/index.html?t=${Me.current}&src=${encodeURIComponent(s.url)}&filename=${encodeURIComponent(xt())}&locale=en&mode=edit&canSave=${d&&jt()?"true":"false"}`,className:"w-full h-full border-none",title:"Document Editor",onLoad:()=>W(!1)})),L&&i.jsxs("div",{className:"absolute inset-0 flex items-center justify-center bg-white z-10",children:[i.jsx(Ni,{className:"h-10 w-10 animate-spin text-blue-600"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"ang ti ti liu..."})]})]})}),F&&i.jsxs("div",{className:"bg-white border-t border-gray-200 p-3 pb-safe flex flex-col gap-2 shadow-[0_-2px_10px_rgba(0,0,0,0.05)] z-20",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[Ns(),i.jsxs("button",{onClick:()=>le(!0),className:"flex items-center gap-1 text-xs text-gray-500 hover:text-blue-600 bg-gray-100 px-2 py-1 rounded-full",children:[i.jsx(yl,{className:"h-3 w-3"})," Chi tit & LS",s.commentCount?i.jsx("span",{className:"ml-1 bg-red-500 text-white text-[9px] px-1 rounded-full",children:s.commentCount}):null]})]}),d&&M&&i.jsx("button",{onClick:zt,className:"text-indigo-600 p-1.5 bg-indigo-50 rounded-lg",title:"Ti ch k",children:i.jsx(Ms,{className:"h-4 w-4"})})]}),p&&((Bs=s.approval)==null?void 0:Bs.status)!=="approved"&&i.jsxs("div",{className:"flex gap-2 mt-1",children:[i.jsxs("button",{onClick:In,className:"flex-1 px-3 py-2.5 bg-green-600 active:bg-green-700 text-white text-sm font-bold rounded-lg flex items-center justify-center gap-1 shadow-sm",children:[i.jsx(ys,{className:"h-4 w-4"})," Duyt"]}),i.jsxs("button",{onClick:Bt,className:"flex-1 px-3 py-2.5 bg-amber-500 active:bg-amber-600 text-white text-sm font-bold rounded-lg flex items-center justify-center gap-1 shadow-sm",children:[i.jsx(Yn,{className:"h-4 w-4"})," Yu cu sa"]})]})]})]}),F&&je&&i.jsx("div",{className:"fixed inset-0 z-[80] flex items-end justify-center bg-black/50 animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white w-full max-h-[80vh] rounded-t-2xl flex flex-col animate-in slide-in-from-bottom duration-300",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[i.jsx("h3",{className:"font-bold text-gray-800",children:"Thng tin & Trao i"}),i.jsx("button",{onClick:()=>le(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:i.jsx(fn,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(xr,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{className:"font-medium",children:s.uploader||"Khng r"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(gr,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{children:s.date?new Date(s.date).toLocaleDateString("vi-VN"):"Khng r"})]})]}),i.jsxs("h4",{className:"font-bold text-gray-800 text-sm mb-2 flex items-center gap-2",children:[i.jsx(Fr,{className:"h-4 w-4"})," Lch s trao i"]}),i.jsx(M_,{comments:s.comments||[],canManageComment:q,onEdit:Y,onDelete:B,canRespond:g,replyingToId:ce,setReplyingToId:K,newComment:X,setNewComment:Z,handleSubmitComment:ir})]}),i.jsx("div",{className:"p-3 border-t border-gray-100",children:i.jsx("button",{onClick:()=>le(!1),className:"w-full py-3 bg-gray-100 text-gray-700 font-bold rounded-lg",children:"ng"})})]})}),!F&&i.jsxs("div",{className:"w-80 bg-white border-l border-gray-200 flex flex-col flex-shrink-0",children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"font-bold text-gray-800 text-sm",children:"Thng tin file"}),Ns()]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(xr,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{className:"font-medium",children:s.uploader||"Khng r"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(gr,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{children:s.date?new Date(s.date).toLocaleDateString("vi-VN"):"Khng r"})]})]})]}),p&&((Bn=s.approval)==null?void 0:Bn.status)!=="approved"&&i.jsxs("div",{className:"p-4 border-b border-gray-100 bg-blue-50 flex gap-2",children:[i.jsxs("button",{onClick:In,className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-bold rounded-lg flex items-center justify-center gap-1 transition-colors",children:[i.jsx(ys,{className:"h-4 w-4"})," Duyt"]}),i.jsxs("button",{onClick:Bt,className:"flex-1 px-3 py-2 bg-amber-500 hover:bg-amber-600 text-white text-sm font-bold rounded-lg flex items-center justify-center gap-1 transition-colors",children:[i.jsx(Yn,{className:"h-4 w-4"})," Yu cu sa"]})]}),i.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[i.jsxs("div",{className:"p-3 bg-white border-b border-gray-100 flex items-center gap-2",children:[i.jsx(Fr,{className:"h-4 w-4 text-gray-500"}),i.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:"Lch s trao i"})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:i.jsx(M_,{comments:s.comments||[],canManageComment:q,onEdit:Y,onDelete:B,canRespond:g,replyingToId:ce,setReplyingToId:K,newComment:X,setNewComment:Z,handleSubmitComment:ir})})]})]}),Se&&i.jsx("div",{className:"fixed inset-0 z-[90] flex items-center justify-center bg-black/50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-96 max-w-[90vw]",children:[i.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Yu cu sa li"}),i.jsx("textarea",{value:Pe,onChange:gt=>V(gt.target.value),placeholder:"Nhp l do yu cu sa...",className:"w-full p-3 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400 resize-none h-24 text-gray-800"}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{onClick:()=>{Be(!1),V("")},className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium",children:"Hy"}),i.jsx("button",{onClick:_s,disabled:!Pe.trim(),className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-lg text-sm font-bold disabled:opacity-50",children:"Gi yu cu"})]})]})}),ye&&i.jsx("div",{className:"fixed inset-0 z-[90] flex items-center justify-center bg-black/50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-96 max-w-[90vw]",children:[i.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Chnh sa gp "}),i.jsx("textarea",{value:ye.content,onChange:gt=>Y({...ye,content:gt.target.value}),placeholder:"Nhp ni dung gp ...",className:"w-full p-3 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 resize-none h-24 text-gray-800"}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{onClick:()=>Y(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium",children:"Hy"}),i.jsx("button",{onClick:()=>{ye.content.trim()&&R&&(R(ye.id,ye.content.trim()),Y(null))},disabled:!ye.content.trim(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-bold disabled:opacity-50",children:"Lu thay i"})]})]})}),be&&i.jsx("div",{className:"fixed inset-0 z-[90] flex items-center justify-center bg-black/50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-96 max-w-[90vw]",children:[i.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:"Xc nhn xa"}),i.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Bn c chc chn mun xa gp  ny? Thao tc ny khng th hon tc."}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{onClick:()=>B(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium",children:"Hy"}),i.jsx("button",{onClick:()=>{D&&(D(be),B(null))},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-bold",children:"Xa"})]})]})}),O&&i.jsx("div",{className:"fixed inset-0 z-[90] flex items-center justify-center bg-black/50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-[500px] max-w-[90vw] max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[i.jsx(yl,{className:"h-5 w-5 text-blue-600"}),"Hng dn chn ch k vo ti liu"]}),i.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:i.jsx(fn,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"space-y-4 text-sm text-gray-700",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("p",{className:"font-semibold text-blue-800 mb-2",children:" Lu  quan trng:"}),i.jsx("p",{className:"text-blue-700",children:"Bn va ti xung file ch k. Hy lm theo cc bc di y  chn ch k vo ti liu Word ca bn."})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold",children:"1"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-800 mb-1",children:"M ti liu Word"}),i.jsx("p",{className:"text-gray-600",children:"M ti liu cn chn ch k bng Microsoft Word hoc ng dng son tho vn bn."})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold",children:"2"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-800 mb-1",children:"t con tr ti v tr mun chn"}),i.jsx("p",{className:"text-gray-600",children:"Click vo v tr trong ti liu ni bn mun t ch k (thng l cui trang hoc di vn bn)."})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold",children:"3"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-800 mb-1",children:"Vo menu Insert (Chn)"}),i.jsxs("p",{className:"text-gray-600",children:["Trn thanh menu, chn tab ",i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded",children:"Insert"})," (hoc ",i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded",children:"Chn"}),")."]})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold",children:"4"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-800 mb-1",children:"Chn Image  Image From File"}),i.jsxs("p",{className:"text-gray-600",children:["Click vo ",i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded",children:"Picture"})," (hoc ",i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded",children:"Hnh nh"}),"), sau  chn ",i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded",children:"This Device"})," hoc ",i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded",children:"From File"}),"."]})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold",children:"5"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-800 mb-1",children:"Chn file ch k va ti"}),i.jsxs("p",{className:"text-gray-600",children:["Tm v chn file ch k ",i.jsx("span",{className:"font-mono bg-gray-100 px-2 py-0.5 rounded text-xs",children:"chu_ky_[tn_ca_bn].png"})," trong th mc Downloads."]})]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold",children:"6"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-gray-800 mb-1",children:"iu chnh kch thc v v tr"}),i.jsx("p",{className:"text-gray-600",children:"Sau khi chn, bn c th ko gc nh  thay i kch thc v di chuyn n v tr mong mun."})]})]})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mt-4",children:[i.jsx("p",{className:"font-semibold text-green-800 mb-1",children:" Hon thnh!"}),i.jsx("p",{className:"text-green-700 text-xs",children:"Ch k ca bn  c chn vo ti liu. Bn c th lu v chia s ti liu ny."})]})]}),i.jsx("div",{className:"flex justify-end mt-6",children:i.jsx("button",{onClick:()=>E(!1),className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:" hiu"})})]})}),ve&&i.jsxs("div",{className:`fixed bottom-4 left-1/2 -translate-x-1/2 z-[100] px-6 py-3 rounded-lg shadow-lg text-white font-medium flex items-center gap-2
                    ${ve.type==="success"?"bg-green-600":ve.type==="error"?"bg-red-600":"bg-blue-600"}`,children:[ve.type==="success"&&i.jsx("span",{children:""}),ve.type==="error"&&i.jsx("span",{children:""}),ve.message]})]})},M_=({comments:s,canManageComment:e,onEdit:t,onDelete:a,canRespond:o,replyingToId:u,setReplyingToId:d,newComment:p,setNewComment:x,handleSubmitComment:g})=>i.jsx("div",{className:"space-y-3",children:!s||s.length===0?i.jsx("p",{className:"text-sm text-gray-400 italic text-center py-4",children:"Cha c trao i no"}):s.map(b=>{var w;return i.jsxs("div",{className:`flex gap-2 ${b.type==="response"?"flex-row-reverse":""}`,children:[i.jsx("div",{className:`h-7 w-7 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 text-white
                            ${b.type==="request"?"bg-amber-500":b.type==="response"?"bg-blue-500":"bg-gray-400"}`,children:((w=b.userName)==null?void 0:w.charAt(0))||"U"}),i.jsxs("div",{className:`flex-1 p-2 rounded-lg text-sm ${b.type==="response"?"bg-blue-50":"bg-gray-100"}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("span",{className:"font-semibold text-gray-700 text-xs",children:b.userName}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"text-[10px] text-gray-400",children:new Date(b.timestamp).toLocaleDateString("vi-VN")}),(e==null?void 0:e(b))&&i.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[i.jsx("button",{onClick:()=>t({id:b.id,content:b.content}),className:"p-1 text-gray-400 hover:text-blue-500 hover:bg-blue-50 rounded transition-colors",title:"Sa",children:i.jsx(Ms,{className:"h-3 w-3"})}),i.jsx("button",{onClick:()=>a(b.id),className:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Xa",children:i.jsx(hn,{className:"h-3 w-3"})})]})]})]}),i.jsx("p",{className:"text-gray-600",children:b.content}),o&&b.type==="request"&&i.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:!u||u!==b.id?i.jsxs("button",{onClick:()=>d(b.id),className:"text-xs text-blue-600 hover:text-blue-800 font-bold flex items-center gap-1 transition-colors",children:[i.jsx(Fr,{className:"h-3 w-3"}),"Phn hi yu cu ny"]}):i.jsx("div",{className:"animate-in fade-in slide-in-from-top-1 duration-200",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",autoFocus:!0,value:p,onChange:N=>x(N.target.value),placeholder:"Nhp ni dung phn hi...",className:"flex-1 px-3 py-2 text-sm border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",onKeyDown:N=>N.key==="Enter"&&g()}),i.jsx("button",{onClick:g,disabled:!p.trim(),className:"px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg disabled:opacity-50 shadow-sm",children:i.jsx(Cu,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>{d(null),x("")},className:"px-2 py-2 text-gray-400 hover:bg-gray-100 rounded-lg",children:i.jsx(fn,{className:"h-4 w-4"})})]})})})]})]},b.id)})}),AO=()=>{var ne,pe,Ce;const s=ar(),{user:e}=vs(),{addToast:t}=jr(),[a,o]=t1(),{currentSchoolYear:u}=Gu(),d=na(),[p,x]=T.useState(!1),[g,b]=T.useState(null),[w,N]=T.useState(!1),[R,D]=T.useState(null),[q,L]=T.useState([]),[W,re]=T.useState([]);T.useEffect(()=>{const U=mn(Tt(Ae,"plans"),Jo("uploadDate","desc")),Q=zs(U,we=>{const Ne=[],Ue=[];we.forEach(Le=>{const Ke=Le.data(),tt={id:Le.id,...Ke};(Ke.schoolYear||"2025-2026")===u&&(Ke.type==="plan"?Ne.push(tt):Ue.push(tt))}),L(Ne),re(Ue)});return()=>Q()},[u]);const $=T.useRef(null);T.useEffect(()=>{const U=a.get("fileId"),Q=a.get("highlight");if(!U||Q!=="true"||q.length===0&&W.length===0||$.current===U)return;const we=q.find(Le=>Le.id===U),Ne=W.find(Le=>Le.id===U),Ue=we||Ne;if(Ue){$.current=U,b(U),o({},{replace:!0});const Le=document.getElementById(`file-${U}`);Le&&Le.scrollIntoView({behavior:"smooth",block:"center"});const Ke=setTimeout(()=>{he(Ue),S(!0)},300),tt=setTimeout(()=>{b(null),$.current=null},5e3);return()=>{clearTimeout(Ke),clearTimeout(tt)}}},[a,q,W,o]);const[z,he]=T.useState(null),[_e,S]=T.useState(!1),[C,k]=T.useState(!1),[M,I]=T.useState(!1),[O,E]=T.useState(""),ve=T.useRef(null),[Te,X]=T.useState(null),[Z,Se]=T.useState(""),[Be,Pe]=T.useState(!1),[V,oe]=T.useState(null),[de,ye]=T.useState(!1),[Y,be]=T.useState(null),[B,ce]=T.useState({type:"plan",name:"",date:"",status:"draft"}),[K,Ee]=T.useState(!1),[F,je]=T.useState(null),[le,ke]=T.useState(!1),[Me,Xe]=T.useState(null),[nt,xt]=T.useState(""),[jt,zt]=T.useState(!1),[ws,ir]=T.useState(null),In=(e==null?void 0:e.role)==="head_teacher"||(e==null?void 0:e.role)==="vice_head_teacher"||(e==null?void 0:e.role)==="teacher",Bt=U=>{if(!e)return!1;const Q=U,we=Q.uploaderId&&Q.uploaderId===e.id,Ne=U.uploader===e.fullName;return we||Ne},_s=U=>{var we;return!e||((we=U.approval)==null?void 0:we.status)==="approved"?!1:["principal","admin"].includes(e.role)},Ns=U=>{var Ue;if(!e)return!1;const Q=(Ue=U.approval)==null?void 0:Ue.status;return Q==="approved"?!1:Bt(U)&&Q==="needs_revision"},Bs=U=>e?U.userId===e.id:!1,Bn=U=>{const Q=U,we=Q.fileType,Ne=Q.url||"",Ue=Ne.includes(".docx")||Ne.includes(".doc"),Le=we==="word"||we==="docx"||Ue;return console.log("[isWordFile] Checking:",{fileType:we,url:Ne.substring(0,50)+"...",hasWordExtension:Ue,result:Le}),Le},gt=(U,Q)=>{Q.stopPropagation(),ir(U),zt(!0)},Qe=()=>{t("Lu thnh cng","Ti liu  c cp nht.","success")},Ct=U=>e?["principal","admin"].includes(e.role):!1,Zt=async U=>{if(e)try{const Q=qe(Ae,"plans",U.id);await Qt(Q,{approval:{status:"approved",reviewerId:e.id,reviewerName:e.fullName,reviewerRole:e.role,reviewedAt:new Date().toISOString()}}),t(" duyt",` duyt h s "${U.title}".`,"success"),await br("system",e,{type:"group",name:` duyt: ${U.title}`,targetPath:"/to-chuyen-mon-ke-hoach",extraInfo:{uploaderId:U.uploaderId}})}catch(Q){console.error("Error approving plan:",Q),t("Li","Khng th duyt h s. Vui lng th li.","error")}},Dt=async U=>{if(!(!e||U.uploaderId!==e.id)&&window.confirm("Bn c chc chn mun CHT bin bn ny? Sau khi cht s hin th trng thi ' cht'."))try{const Q=qe(Ae,"plans",U.id);await Qt(Q,{status:"finalized"}),t(" cht bin bn","Bin bn hp  c chuyn sang trng thi  cht.","success")}catch(Q){console.error("Error finalizing minute:",Q),t("Li","Khng th cht bin bn. Vui lng th li.","error")}},vt=U=>{Xe(U),xt(""),ke(!0)},Xt=async()=>{if(!(!e||!Me))try{const U=qe(Ae,"plans",Me.id),Q={id:Date.now().toString(),userId:e.id,userName:e.fullName,userRole:e.role,content:nt||"Yu cu chnh sa li.",timestamp:new Date().toISOString(),type:"request"},we={status:"needs_revision",reviewerId:e.id,reviewerName:e.fullName,reviewerRole:e.role,reviewedAt:new Date().toISOString(),rejectionReason:nt};await Qt(U,{approval:we,comments:Bo(Q),commentCount:(Me.commentCount||0)+1}),z&&z.id===Me.id&&he({...z,approval:we,comments:[...z.comments||[],Q],commentCount:(z.commentCount||0)+1}),t(" gi yu cu sa",` yu cu sa li h s "${Me.title}".`,"success"),await br("comment",e,{type:"group",name:`Yu cu sa: ${Me.title}`,targetPath:`/to-chuyen-mon-ke-hoach?fileId=${Me.id}&highlight=true`,extraInfo:{uploaderId:Me.uploaderId}}),ke(!1),Xe(null),xt("")}catch(U){console.error("Error requesting revision:",U),t("Li","Khng th gi yu cu sa. Vui lng th li.","error")}};T.useEffect(()=>{var U;C&&((U=ve.current)==null||U.scrollIntoView({behavior:"smooth"}))},[C,z]);const wt=U=>{he(U),S(!0)},an=U=>{if(!e)return!1;const Q=U,we=Q.uploaderId&&Q.uploaderId===e.id,Ne=U.uploader===e.fullName;return we||Ne},as=(U,Q)=>{Q.stopPropagation(),je(U),Ee(!0)},Ts=async()=>{if(F&&!an(F)){t("Khng c quyn","Bn khng th xa ti liu ca ngi khc.","error"),Ee(!1);return}if(F)try{await Cl(qe(Ae,"plans",F.id)),t(" xa ti liu thnh cng","H s  c xa khi danh sch.","success"),Ee(!1),je(null),(z==null?void 0:z.id)===F.id&&(k(!1),he(null))}catch(U){console.error("Error deleting document: ",U),t("Li","Khng th xa h s. Vui lng th li.","error")}},Tn=async U=>{var we;if(!O.trim()||!z||!e||!Ns(z))return;const Q={id:Date.now().toString(),userId:e.id,userName:e.fullName,userRole:e.role,content:O,timestamp:new Date().toISOString(),type:"response"};try{const Ne=qe(Ae,"plans",z.id);await Qt(Ne,{approval:{...z.approval,status:"pending",reviewedAt:new Date().toISOString()},comments:Bo(Q),commentCount:(z.commentCount||0)+1}),E(""),t(" gi phn hi","Phn hi ca bn  c gi. H s chuyn sang trng thi ch duyt.","success");const Ue=(we=z.approval)==null?void 0:we.reviewerId;Ue&&Ue!==e.id&&await br("comment",e,{type:"group",name:`Phn hi t ${e.fullName}: ${z.title}`,targetPath:`/to-chuyen-mon-ke-hoach?fileId=${z.id}&highlight=true`,extraInfo:{uploaderId:Ue}})}catch(Ne){console.error("Error adding response: ",Ne),t("Li","Khng th gi phn hi.","error")}},js=async()=>{var U,Q;if(!(!e||!V||!z))try{const we=qe(Ae,"plans",z.id),Ne=z.comments.filter(tt=>tt.id!==V.id),Ue={comments:Ne,commentCount:Ne.length};let Le=(U=z.approval)==null?void 0:U.status,Ke=(Q=z.approval)==null?void 0:Q.rejectionReason;V.type==="request"&&Le==="needs_revision"&&(Le="pending",Ke=void 0,Ue["approval.status"]="pending",Ue["approval.rejectionReason"]=No(),Ue["approval.rejectionReason"]=No(),t(" hon tc","Yu cu sa  b xa. Trng thi h s tr v 'Ch duyt'.","success")),await Qt(we,Ue),z&&he({...z,comments:Ne,commentCount:Ne.length,approval:{...z.approval,status:Le,rejectionReason:Ke}}),t(" xa","Ni dung  c xa.","success"),Pe(!1),oe(null)}catch(we){console.error("Error deleting comment:",we),t("Li","Khng th xa ni dung.","error")}},At=async()=>{if(R)try{const U=qe(Ae,"plans",R.id);await Qt(U,{"approval.status":"pending","approval.rejectionReason":No(),"approval.reviewedAt":new Date().toISOString()}),z&&z.id===R.id&&he({...z,approval:{...z.approval,status:"pending",rejectionReason:void 0}}),t(" hon tc","Yu cu sa  c xa.","success"),N(!1),D(null)}catch(U){console.error("Error deleting active revision:",U),t("Li","Khng th xa yu cu.","error")}},Hn=()=>{ce({type:"plan",name:"",date:new Date().toISOString().split("T")[0],status:"draft"}),be(null),ye(!0)},is=U=>{if(U.preventDefault(),U.dataTransfer.files&&U.dataTransfer.files[0]){const Q=U.dataTransfer.files[0];be(Q),B.name||ce(we=>({...we,name:Q.name.split(".")[0]}))}},Wn=U=>{if(U.target.files&&U.target.files[0]){const Q=U.target.files[0];be(Q),B.name||ce(we=>({...we,name:Q.name.split(".")[0]}))}},Hi=async()=>{if(!(!Y&&!B.name))try{let U="#",Q="word";if(Y){const Ne=rr(Ls,`plans/${Date.now()}_${Y.name}`);await nr(Ne,Y),U=await sr(Ne),Q=Y.name.endsWith("pdf")?"pdf":"word"}const we={...B,title:B.name,uploader:(e==null?void 0:e.fullName)||"n danh",uploaderId:(e==null?void 0:e.id)||"",uploaderRole:(e==null?void 0:e.role)||"teacher",uploadDate:new Date().toISOString(),schoolYear:u,viewers:[],commentCount:0,comments:[],fileType:Q,url:U,approval:{status:"pending"}};await Al(Tt(Ae,"plans"),we),t("Ti ln thnh cng",` lu h s: ${B.name} (${B.type==="plan"?"K hoch":"Bin bn"})`,"success"),ye(!1),e&&await br("upload",e,{type:"group",name:B.name,targetPath:"/to-chuyen-mon-ke-hoach"})}catch(U){console.error("Error adding document: ",U),t("Li","Khng th lu h s. Vui lng th li.","error")}},Ba=(U=!1)=>{if(!z)return null;const Q=z.url;if(Q&&Q!=="#"){const we=Yu(Q,d);return we==="EXCEL_NO_PREVIEW"?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-600 bg-gray-50 rounded-lg p-8",children:[i.jsx("div",{className:"p-4 bg-green-100 rounded-full mb-4",children:i.jsx(Ze,{className:"h-16 w-16 text-green-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:"File Excel"}),i.jsx("p",{className:"text-sm text-gray-500 mb-6 text-center max-w-md",children:"File Excel khng th xem trc trc tip. Vui lng ti xung  xem ni dung."}),i.jsxs("a",{href:Q,download:!0,className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg shadow-md transition-all font-bold",children:[i.jsx(Qn,{className:"h-5 w-5"}),"Ti xung file"]})]}):i.jsxs("div",{className:"w-full h-full relative group",children:[i.jsx("iframe",{src:we,className:"w-full h-full border-0",title:"Document Preview",sandbox:"allow-scripts allow-same-origin allow-popups"}),d&&TT(Q)&&i.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-10 w-full px-4",children:i.jsxs("a",{href:we,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full py-3 bg-white/90 backdrop-blur-sm text-gray-800 border border-gray-200 font-bold rounded-xl shadow-lg hover:bg-gray-50 transition-all font-sans",children:[i.jsx(df,{className:"h-4 w-4"}),"M trong ca s mi"]})})]})}else return i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 bg-gray-50",children:[i.jsx(Ze,{className:"h-16 w-16 mb-4 text-gray-400"}),i.jsx("p",{className:"text-lg font-medium",children:"Khng c bn xem trc"}),i.jsx("p",{className:"text-sm",children:"Ti liu ny cha c file nh km hoc file khng h tr xem trc."})]})},Fn=()=>{var U,Q,we;return z?i.jsxs("div",{className:"flex-1 flex flex-col h-full bg-gray-50",children:[i.jsxs("div",{className:"p-4 border-b border-gray-100 bg-white",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Ngi ng"}),i.jsx("span",{className:"text-xs font-bold text-gray-800",children:z.uploader||"Khng r"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Ngy ti ln"}),i.jsx("span",{className:"text-xs font-bold text-gray-800",children:new Date(z.uploadDate||z.date||z.createdAt||Date.now()).toLocaleDateString("vi-VN")})]})]}),i.jsxs("div",{className:"p-4 bg-white border-b border-gray-100 shadow-sm flex items-center gap-2",children:[i.jsx(Fr,{className:"h-5 w-5 text-gray-500"}),i.jsx("h3",{className:"font-bold text-gray-800",children:"Lch s Yu cu & Phn hi"})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 font-sans",children:[((U=z.approval)==null?void 0:U.status)==="needs_revision"&&((Q=z.approval)==null?void 0:Q.rejectionReason)&&!((we=z.comments)!=null&&we.length&&z.comments[z.comments.length-1].type==="request"&&z.comments[z.comments.length-1].content===z.approval.rejectionReason)&&i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4 group relative",children:i.jsx("div",{className:"flex justify-between items-start",children:i.jsxs("div",{children:[i.jsxs("h4",{className:"text-xs font-bold text-amber-800 uppercase mb-1 flex items-center gap-1",children:[i.jsx(Yn,{className:"h-3 w-3"})," Yu cu sa hin ti"]}),i.jsx("p",{className:"text-sm text-amber-900",children:z.approval.rejectionReason})]})})}),!z.comments||z.comments.length===0?i.jsxs("div",{className:"text-center py-10 text-gray-400",children:[i.jsx("div",{className:"bg-gray-100 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-3",children:i.jsx(ys,{className:"h-6 w-6 text-gray-300"})}),i.jsx("p",{className:"text-sm",children:"Cha c lch s chnh sa no."})]}):z.comments.map(Ne=>i.jsxs("div",{className:`flex gap-3 ${Ne.type==="response"?"flex-row-reverse":""}`,children:[i.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 text-xs font-bold text-white shadow-sm
                           ${Ne.type==="request"?"bg-amber-500":"bg-blue-500"}
                        `,children:Ne.userName.charAt(0)}),i.jsxs("div",{className:"flex-1 max-w-[85%] space-y-1",children:[i.jsx("div",{className:`p-3 rounded-2xl shadow-sm text-sm relative group
                              ${Ne.type==="request"?"bg-amber-50 border border-amber-100 text-gray-800 rounded-tl-none":Ne.type==="response"?"bg-blue-50 border border-blue-100 text-gray-800 rounded-tr-none":"bg-white border border-gray-200 text-gray-600"}
                           `,children:i.jsx("p",{children:Ne.content})}),i.jsx("div",{className:`text-[10px] text-gray-400 flex items-center gap-1 ${Ne.type==="response"?"justify-end":""}`,children:i.jsx("span",{children:new Date(Ne.timestamp||Ne.createdAt).toLocaleString("vi-VN")})})]})]},Ne.id))]})]}):null};return i.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans",children:[i.jsx("div",{className:"bg-white border-b border-orange-100 sticky top-0 z-30 shadow-sm",children:i.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-3 md:py-4",children:[!d&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-3",children:[i.jsx("span",{className:"cursor-pointer hover:text-orange-600",onClick:()=>s("/"),children:"Dashboard"}),i.jsx(ps,{className:"h-3 w-3"}),i.jsx("span",{className:"cursor-pointer hover:text-orange-600",children:"T Chuyn Mn"}),i.jsx(ps,{className:"h-3 w-3"}),i.jsx("span",{className:"font-semibold text-orange-700",children:"K hoch T"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 md:gap-4",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:`${d?"text-lg":"text-2xl"} font-bold text-gray-900 flex items-center gap-2 md:gap-3 cursor-pointer hover:opacity-80 transition-opacity`,onClick:()=>s("/"),children:[d?i.jsx("button",{onClick:U=>{U.stopPropagation(),s("/")},className:"mr-1",children:i.jsx(ps,{className:"h-5 w-5 rotate-180 text-gray-500"})}):i.jsx("span",{className:"p-2 bg-orange-100 rounded-lg text-orange-600",children:i.jsx(Ze,{className:"h-6 w-6"})}),i.jsx("span",{children:"H s T Chuyn Mn"})]}),!d&&i.jsx("p",{className:"text-sm text-gray-500 mt-1 ml-12",children:"Qun l k hoch hot ng v lu tr bin bn hp nh k."})]}),In&&i.jsxs("button",{onClick:Hn,className:`flex items-center justify-center gap-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg shadow-md transition-all font-medium ${d?"w-full py-2 text-sm":"px-5 py-2.5"}`,children:[i.jsx(En,{className:"h-4 w-4"}),i.jsx("span",{children:d?"Ti ln mi":"Ti ln Bin bn/K hoch"})]})]})]})}),i.jsxs("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-4 md:py-8 space-y-6 md:space-y-10 pb-24 md:pb-20",children:[i.jsxs("section",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4",children:[i.jsx("h2",{className:"text-base md:text-lg font-bold text-gray-800 uppercase tracking-tight border-l-4 border-orange-500 pl-3",children:"K hoch Hot ng"}),i.jsxs("button",{className:"text-xs font-medium text-gray-500 hover:text-orange-600 flex items-center gap-1",children:["Xem tt c ",i.jsx(ps,{className:"h-3 w-3"})]})]}),i.jsxs("div",{className:"grid gap-3 md:gap-4 grid-cols-1",children:[q.map(U=>{var Q,we,Ne,Ue,Le;return i.jsx("div",{id:`file-${U.id}`,onClick:()=>wt(U),className:`bg-white rounded-xl p-4 md:p-5 border shadow-sm hover:shadow-md transition-all cursor-pointer group
                           ${g===U.id?"ring-2 ring-orange-500 bg-orange-50 animate-pulse":"border-gray-100 hover:border-orange-200"}
                        `,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3 md:gap-4",children:[i.jsxs("div",{className:"flex items-start gap-3 md:gap-4",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10 md:h-12 md:w-12 bg-blue-50 rounded-lg flex items-center justify-center text-blue-600 group-hover:bg-blue-100 transition-colors",children:i.jsx(Ze,{className:"h-5 w-5 md:h-6 md:w-6"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-1 md:gap-2 mb-1",children:[i.jsx("h3",{className:"text-sm md:text-base font-bold text-gray-900 group-hover:text-orange-700 transition-colors leading-tight line-clamp-2",children:U.title}),i.jsxs("div",{className:"flex flex-wrap gap-1",children:[((Q=U.approval)==null?void 0:Q.status)==="pending"&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[10px] font-bold bg-amber-100 text-amber-700 uppercase whitespace-nowrap",children:[i.jsx(gr,{className:"h-3 w-3"})," Ch duyt"]}),((we=U.approval)==null?void 0:we.status)==="approved"&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[10px] font-bold bg-green-100 text-green-700 uppercase whitespace-nowrap",children:[i.jsx(pr,{className:"h-3 w-3"}),"  duyt"]}),(((Ne=U.approval)==null?void 0:Ne.status)==="rejected"||((Ue=U.approval)==null?void 0:Ue.status)==="needs_revision")&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[10px] font-bold bg-orange-100 text-orange-700 uppercase whitespace-nowrap",title:U.approval.rejectionReason,children:[i.jsx(Ms,{className:"h-3 w-3"})," Cn sa"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 md:gap-3 mt-1 text-[10px] md:text-xs text-gray-500",children:[i.jsxs("span",{className:"flex items-center gap-1 truncate max-w-[100px] md:max-w-none",children:[i.jsx(xo,{className:"h-3 w-3"})," ",U.uploader]}),i.jsx("span",{className:"w-1 h-1 bg-gray-300 rounded-full flex-shrink-0"}),i.jsxs("span",{className:"flex items-center gap-1 flex-shrink-0",children:[i.jsx(gr,{className:"h-3 w-3"})," ",new Date(U.uploadDate).toLocaleDateString("vi-VN")]})]})]})]}),i.jsxs("div",{className:"flex items-center gap-3 md:gap-4 justify-between md:justify-end w-full md:w-auto mt-1 md:mt-0 border-t md:border-t-0 border-gray-100 md:border-transparent pt-3 md:pt-0",children:[Ct()&&((Le=U.approval)==null?void 0:Le.status)==="pending"&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsxs("button",{onClick:Ke=>{Ke.stopPropagation(),Zt(U)},className:"px-2 md:px-3 py-1.5 text-xs font-bold text-white bg-green-500 hover:bg-green-600 rounded-lg transition-colors shadow-sm flex items-center gap-1",children:[i.jsx(pr,{className:"h-3.5 w-3.5"})," ",i.jsx("span",{className:"hidden sm:inline",children:"Duyt"})]}),i.jsxs("button",{onClick:Ke=>{Ke.stopPropagation(),vt(U)},className:"px-2 md:px-3 py-1.5 text-xs font-bold text-white bg-amber-500 hover:bg-amber-600 rounded-lg transition-colors shadow-sm flex items-center gap-1",children:[i.jsx(Ms,{className:"h-3.5 w-3.5"})," ",i.jsx("span",{className:"hidden sm:inline",children:"Sa"})]})]}),i.jsxs("div",{className:"flex items-center gap-3 ml-auto md:ml-0",children:[i.jsxs("div",{className:"flex -space-x-2",children:[U.viewers.map((Ke,tt)=>i.jsx("div",{className:"h-6 w-6 md:h-8 md:w-8 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center text-[10px] md:text-xs font-medium text-gray-600",children:Ke},tt)),U.viewers.length>0&&i.jsx("div",{className:"h-6 w-6 md:h-8 md:w-8 rounded-full bg-gray-50 border-2 border-white flex items-center justify-center text-[8px] md:text-[10px] text-gray-400",children:"+"})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsxs("div",{className:"flex items-center gap-1 text-gray-400 bg-gray-50 px-2 py-1 rounded-md",children:[i.jsx(Fr,{className:"h-3 w-3 md:h-4 md:w-4"}),i.jsx("span",{className:"text-xs font-medium",children:U.commentCount})]})})]})]})]})},U.id)}),q.length===0&&i.jsxs("div",{className:"text-center py-8 md:py-12 bg-white rounded-xl border border-dashed border-gray-300",children:[i.jsx(Ze,{className:"h-10 w-10 md:h-12 md:w-12 text-gray-300 mx-auto mb-3"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Cha c k hoch no c ti ln."})]})]})]}),i.jsx("div",{className:"border-t border-gray-200"}),i.jsxs("section",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4",children:[i.jsx("h2",{className:"text-base md:text-lg font-bold text-gray-800 uppercase tracking-tight border-l-4 border-orange-500 pl-3",children:"Bin bn Hp t"}),i.jsx("button",{className:"p-1 text-gray-400 hover:text-orange-600 rounded-lg hover:bg-orange-50",children:i.jsx(UC,{className:"h-4 w-4"})})]}),i.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:i.jsxs("div",{className:"relative pl-4 md:pl-8 py-4 md:py-8 space-y-6 md:space-y-8 before:absolute before:inset-y-0 before:left-4 md:before:left-8 before:w-0.5 before:bg-gray-200",children:[W.map(U=>{var Q,we,Ne,Ue;return i.jsxs("div",{className:"relative pl-6 md:pl-8 pr-4 md:pr-6",children:[i.jsx("div",{className:`absolute left-[-5px] md:left-[-6px] top-1 h-3 w-3 md:h-4 md:w-4 rounded-full border-2 md:border-4 border-white ${U.status==="finalized"?"bg-green-500 ring-2 ring-green-100":"bg-orange-400 ring-2 ring-orange-100"} z-10`}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-1 md:gap-4 mb-2",children:[i.jsx("span",{className:"text-xs font-bold text-gray-500 font-mono",children:U.date}),i.jsxs("div",{className:"flex items-center gap-2",children:[U.status==="draft"&&i.jsxs("span",{className:"px-2 py-0.5 text-[10px] font-bold bg-orange-100 text-orange-700 rounded-full uppercase border border-orange-200",children:[i.jsx(gr,{className:"h-2.5 w-2.5 inline mr-1"})," ang tho lun"]}),((Q=U.approval)==null?void 0:Q.status)==="pending"&&i.jsxs("span",{className:"px-2 py-0.5 text-[10px] font-bold bg-amber-100 text-amber-700 rounded-full uppercase border border-amber-200",children:[i.jsx(gr,{className:"h-2.5 w-2.5 inline mr-1"})," Ch duyt"]}),((we=U.approval)==null?void 0:we.status)==="approved"&&i.jsxs("span",{className:"px-2 py-0.5 text-[10px] font-bold bg-green-100 text-green-700 rounded-full uppercase border border-green-200",children:[i.jsx(pr,{className:"h-2.5 w-2.5 inline mr-1"})," Duyt"]}),(((Ne=U.approval)==null?void 0:Ne.status)==="rejected"||((Ue=U.approval)==null?void 0:Ue.status)==="needs_revision")&&i.jsxs("span",{className:"px-2 py-0.5 text-[10px] font-bold bg-orange-100 text-orange-700 rounded-full uppercase border border-orange-200",children:[i.jsx(Ms,{className:"h-2.5 w-2.5 inline mr-1"})," Yu cu sa"]})]})]}),i.jsxs("div",{onClick:()=>wt(U),className:`group p-3 md:p-4 rounded-xl border-2 transition-all cursor-pointer bg-gray-50 hover:bg-white hover:shadow-md
                                 ${g===U.id?"border-orange-500 ring-2 ring-orange-200":"border-transparent hover:border-orange-100"}
                              `,children:[i.jsx("h3",{className:"text-sm md:text-base font-bold text-gray-800 mb-2 md:mb-3 group-hover:text-orange-700 transition-colors",children:U.title}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-white border border-gray-200 rounded-lg text-xs md:text-sm text-gray-600 group-hover:border-orange-300 transition-colors flex-1 w-full truncate",children:[U.fileType==="word"?i.jsx(Ze,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}):i.jsx(hf,{className:"h-4 w-4 text-red-600 flex-shrink-0"}),i.jsx("span",{className:"truncate flex-1",children:"Xem bin bn chi tit..."})]})})]})]},U.id)}),W.length===0&&i.jsx("div",{className:"pl-6 md:pl-8 text-sm text-gray-400 italic",children:"Cha c bin bn hp no."})]})})]})]}),K&&F&&i.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-in zoom-in-95 duration-200",children:i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Yn,{className:"h-8 w-8 text-red-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Xc nhn xa ti liu?"}),i.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Bn c chc chn mun xa file ",i.jsxs("span",{className:"font-semibold text-gray-800",children:['"',F.title,'"']})," khng? Hnh ng ny khng th hon tc."]}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsx("button",{onClick:()=>Ee(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hy b"}),i.jsx("button",{onClick:Ts,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 shadow-md transition-colors",children:"Xa vnh vin"})]})]})})}),le&&Me&&i.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden animate-in zoom-in-95 duration-200",children:i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Ms,{className:"h-8 w-8 text-amber-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2 text-center",children:"Yu cu sa li?"}),i.jsxs("p",{className:"text-sm text-gray-500 mb-4 text-center",children:["Bn ang yu cu chnh sa cho ",i.jsxs("span",{className:"font-semibold text-gray-800",children:['"',Me.title,'"']})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Ni dung cn chnh sa ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{className:"w-full border border-amber-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none transition-all resize-none",rows:4,placeholder:"Nhp chi tit cc im cn sa...",value:nt,onChange:U=>xt(U.target.value)})]}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsx("button",{onClick:()=>{ke(!1),Xe(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hy b"}),i.jsxs("button",{onClick:Xt,disabled:!nt.trim(),className:"px-4 py-2 text-sm font-bold text-white bg-amber-500 rounded-lg hover:bg-amber-600 shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(Cu,{className:"h-4 w-4 mr-1 inline"})," Gi yu cu"]})]})]})})}),C&&z&&i.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden flex justify-end",children:[i.jsx("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-sm transition-opacity",onClick:()=>k(!1)}),i.jsxs("div",{className:`relative w-full ${d?"h-full":"max-w-6xl h-full"} bg-white shadow-2xl flex flex-col animate-in slide-in-from-right duration-300`,children:[i.jsxs("div",{className:`px-4 py-3 border-b border-orange-100 flex items-center gap-3 bg-orange-50/30 flex-shrink-0 safe-area-inset-top ${d?"justify-start":"justify-between"}`,children:[d&&i.jsx("button",{onClick:()=>k(!1),className:"p-2 -ml-2 text-gray-600 hover:bg-gray-100 rounded-full",children:i.jsx(ps,{className:"h-5 w-5 rotate-180"})}),i.jsxs("div",{className:"flex-1 min-w-0 mr-2",children:[i.jsx("span",{className:"text-[10px] font-bold text-orange-600 uppercase tracking-wider mb-0.5 block",children:z.type==="plan"?"K hoch":"Bin bn hp"}),i.jsx("h2",{className:`font-bold text-gray-900 leading-tight truncate ${d?"text-sm":"text-lg"}`,children:z.title})]}),i.jsx("div",{className:"flex items-center gap-1",children:!d&&i.jsxs(i.Fragment,{children:[z&&Bn(z)&&Bt(z)&&i.jsxs("button",{onClick:U=>gt(z,U),className:"p-2 text-gray-500 hover:text-orange-600 hover:bg-orange-50 rounded-lg transition-colors flex items-center gap-1",title:"Chnh sa file Word",children:[i.jsx(Ms,{className:"h-5 w-5"}),i.jsx("span",{className:"text-xs font-medium hidden lg:inline",children:"Sa"})]}),i.jsx("button",{className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Ti xung",children:i.jsx(Qn,{className:"h-5 w-5"})}),an(z)&&i.jsx("button",{onClick:U=>as(z,U),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa ti liu",children:i.jsx(hn,{className:"h-5 w-5"})}),i.jsx("button",{onClick:()=>k(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:i.jsx(fn,{className:"h-6 w-6"})})]})})]}),i.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row relative",children:[i.jsx("div",{className:"flex-1 overflow-hidden bg-gray-100 border-b md:border-b-0 md:border-r border-gray-200 relative flex flex-col",children:i.jsx("div",{className:"flex-1 w-full h-full",children:Ba(!1)})}),!d&&i.jsx("div",{className:"w-80 bg-gray-50 border-l border-gray-200 flex flex-col h-full flex-shrink-0",children:Fn()})]}),d&&i.jsxs("div",{className:"bg-white border-t border-gray-200 p-3 pb-safe flex flex-col gap-2 shadow-[0_-2px_10px_rgba(0,0,0,0.05)] z-20",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[((ne=z.approval)==null?void 0:ne.status)==="approved"&&i.jsxs("span",{className:"text-xs font-bold text-green-600 flex items-center gap-1",children:[i.jsx(pr,{className:"h-3 w-3"}),"  duyt"]}),((pe=z.approval)==null?void 0:pe.status)==="pending"&&i.jsxs("span",{className:"text-xs font-bold text-amber-600 flex items-center gap-1",children:[i.jsx(gr,{className:"h-3 w-3"})," Ch duyt"]}),i.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-1 text-xs text-gray-500 hover:text-blue-600 bg-gray-100 px-3 py-1.5 rounded-full",children:[i.jsx(yl,{className:"h-3 w-3"})," Chi tit & LS",z.commentCount?i.jsx("span",{className:"ml-1 bg-red-500 text-white text-[9px] px-1.5 rounded-full",children:z.commentCount}):null]})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{className:"p-2 text-gray-500 bg-gray-50 rounded-lg",children:i.jsx(Qn,{className:"h-4 w-4"})}),an(z)&&i.jsx("button",{onClick:U=>as(z,U),className:"p-2 text-red-500 bg-red-50 rounded-lg",children:i.jsx(hn,{className:"h-4 w-4"})})]})]}),Ct()&&((Ce=z.approval)==null?void 0:Ce.status)==="pending"&&i.jsxs("div",{className:"flex gap-2 mt-1",children:[i.jsxs("button",{onClick:()=>Zt(z),className:"flex-1 px-3 py-2.5 bg-green-600 active:bg-green-700 text-white text-sm font-bold rounded-lg flex items-center justify-center gap-1 shadow-sm",children:[i.jsx(pr,{className:"h-4 w-4"})," Duyt"]}),i.jsxs("button",{onClick:()=>vt(z),className:"flex-1 px-3 py-2.5 bg-amber-500 active:bg-amber-600 text-white text-sm font-bold rounded-lg flex items-center justify-center gap-1 shadow-sm",children:[i.jsx(Ms,{className:"h-4 w-4"})," Yu cu sa"]})]}),z.type==="minute"&&an(z)&&z.status!=="finalized"&&i.jsxs("button",{onClick:()=>Dt(z),className:"w-full mt-1 px-3 py-2.5 bg-blue-600 active:bg-blue-700 text-white text-sm font-bold rounded-lg flex items-center justify-center gap-1 shadow-sm",children:[i.jsx(Ro,{className:"h-4 w-4"})," Cht bin bn"]})]}),d&&p&&i.jsx("div",{className:"fixed inset-0 z-[80] flex items-end justify-center bg-black/50 animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white w-full max-h-[85vh] rounded-t-2xl flex flex-col animate-in slide-in-from-bottom duration-300",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[i.jsx("h3",{className:"font-bold text-gray-800",children:"Thng tin & Lch s"}),i.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:i.jsx(fn,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:Fn()})]})})]})]}),de&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-orange-100 flex justify-between items-center bg-white",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(En,{className:"h-5 w-5 text-orange-600"}),"Thm mi H s Chuyn Mn"]}),i.jsx("button",{onClick:()=>ye(!1),className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",children:i.jsx(fn,{className:"h-6 w-6"})})]}),i.jsxs("div",{className:"p-6 space-y-5",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Loi h s ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg",children:[i.jsx("button",{onClick:()=>ce({...B,type:"plan"}),className:`flex-1 py-2 px-4 text-sm font-medium rounded-md transition-all ${B.type==="plan"?"bg-white text-orange-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"K hoch hot ng"}),i.jsx("button",{onClick:()=>ce({...B,type:"minute"}),className:`flex-1 py-2 px-4 text-sm font-medium rounded-md transition-all ${B.type==="minute"?"bg-white text-orange-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Bin bn hp t"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn vn bn ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{autoFocus:!0,type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all",placeholder:"VD: K hoch chuyn mn Thng 11...",value:B.name,onChange:U=>ce({...B,name:U.target.value})})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:B.type==="minute"?"Ngy hp":"Thi gian p dng"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all text-sm",value:B.date,onChange:U=>ce({...B,date:U.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),i.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none transition-all bg-white text-sm",value:B.status,onChange:U=>ce({...B,status:U.target.value}),children:[i.jsx("option",{value:"draft",children:" ang tho lun"}),i.jsx("option",{value:"finalized",children:"  cht / Ban hnh"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tp nh km"}),i.jsxs("div",{onDrop:is,onDragOver:U=>U.preventDefault(),className:`border-2 border-dashed rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer transition-all group relative ${Y?"border-orange-500 bg-orange-50":"border-gray-300 hover:bg-gray-50 hover:border-orange-400"}`,children:[i.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:Wn,accept:".pdf,.doc,.docx"}),Y?i.jsxs("div",{className:"flex flex-col items-center text-center animate-in zoom-in duration-300",children:[i.jsx(ys,{className:"h-10 w-10 text-orange-600 mb-2"}),i.jsx("p",{className:"text-sm font-bold text-orange-800 truncate max-w-[250px]",children:Y.name}),i.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:[(Y.size/1024).toFixed(0)," KB -  sn sng"]})]}):i.jsxs("div",{className:"flex flex-col items-center text-center",children:[i.jsx("div",{className:"p-3 rounded-full mb-3 bg-orange-100 text-orange-600 transition-colors",children:i.jsx(uf,{className:"h-8 w-8"})}),i.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Ko th file vo y hoc ",i.jsx("span",{className:"text-orange-600 underline",children:"Bm  chn"})]}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"H tr PDF, Word (Ti a 10MB)"})]})]})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>ye(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-white hover:shadow-sm rounded-lg border border-transparent hover:border-gray-300 transition-all",children:"Hy b"}),i.jsxs("button",{onClick:Hi,className:"flex items-center gap-2 px-6 py-2 text-sm font-bold text-white bg-orange-600 hover:bg-orange-700 rounded-lg shadow-md transition-all",children:[i.jsx(En,{className:"h-4 w-4"})," Lu h s"]})]})]})}),_e&&z&&i.jsx(jT,{file:{id:z.id,name:z.title,url:z.url||"",type:z.fileType,uploader:z.uploader,uploaderId:z.uploaderId,uploaderRole:z.uploaderRole,date:z.uploadDate,comments:z.comments||[],commentCount:z.commentCount||0,approval:z.approval},onClose:()=>{S(!1),he(null)},onSaveSuccess:Qe,collectionName:"plans",storageFolder:"plans",canEdit:Bt(z),canApprove:Ct(),canComment:_s(z),canRespond:Ns(z),onApprove:()=>Zt(z),onRequestRevision:U=>{Xe(z),xt(U),Xt()},onPostComment:(U,Q)=>{Q==="response"&&(E(U),Tn())},canManageComment:Bs,onEditComment:async(U,Q)=>{if(!(!z||!e))try{const we=(z.type==="plan","plans"),Ne=qe(Ae,we,z.id),Le=(z.comments||[]).map(Ke=>Ke.id===U?{...Ke,content:Q,editedAt:new Date().toISOString()}:Ke);await Qt(Ne,{comments:Le}),he({...z,comments:Le}),t(" cp nht gp ","Ni dung gp   c lu.","success")}catch(we){console.error("Error editing comment:",we),t("Li","Khng th cp nht gp .","error")}},onDeleteComment:async U=>{var we,Ne,Ue;if(!z||!e)return;const Q=(we=z.comments)==null?void 0:we.find(Le=>Le.id===U);if(Q)try{const Le=(z.type==="plan","plans"),Ke=qe(Ae,Le,z.id),it=(z.comments||[]).filter(Jn=>Jn.id!==U),$t={comments:it,commentCount:it.length};let ln=(Ne=z.approval)==null?void 0:Ne.status,Kt=(Ue=z.approval)==null?void 0:Ue.rejectionReason;Q.type==="request"&&ln==="needs_revision"&&(ln="pending",Kt=void 0,$t["approval.status"]="pending",$t["approval.rejectionReason"]=No(),t(" hon tc","Yu cu sa  b xa. Trng thi h s tr v 'Ch duyt'.","success")),Q.type==="response"&&it.some(sa=>sa.type==="request")&&ln==="pending"&&(ln="needs_revision",$t["approval.status"]="needs_revision",t(" hon tc","Phn hi  b xa. Bn c th phn hi li.","success")),await Qt(Ke,$t),he({...z,comments:it,commentCount:it.length,approval:{...z.approval,status:ln,rejectionReason:Kt}}),t(" xa gp ","Gp   c xa thnh cng.","success")}catch(Le){console.error("Error deleting comment:",Le),t("Li","Khng th xa gp .","error")}}}),Be&&i.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-in zoom-in-95 duration-200",children:i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(hn,{className:"h-6 w-6 text-red-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Xa gp ?"}),i.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Bn c chc chn mun xa gp  ny khng? Hnh ng ny khng th hon tc."}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsx("button",{onClick:()=>Pe(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hy b"}),i.jsx("button",{onClick:js,className:"px-4 py-2 text-sm font-bold text-white bg-red-600 rounded-lg hover:bg-red-700 shadow-md transition-colors",children:"Xa gp "})]})]})})}),w&&i.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-in zoom-in-95 duration-200",children:i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Yn,{className:"h-6 w-6 text-amber-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Hy yu cu sa?"}),i.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Bn c chc chn mun xa yu cu sa ny? ",i.jsx("br",{}),"H s s quay v trng thi ",i.jsx("span",{className:"font-bold text-blue-600",children:"'Ch duyt'"}),"."]}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Khng xa"}),i.jsx("button",{onClick:At,className:"px-4 py-2 text-sm font-bold text-white bg-amber-600 rounded-lg hover:bg-amber-700 shadow-md transition-colors",children:"ng  xa"})]})]})})})]})},RO=[{id:"choi",name:"LP CHI",teacher:"C L Th Mai",studentCount:30,newFiles:2},{id:"la1",name:"LP L 1",teacher:"C Nguyn Th Lan",studentCount:35,newFiles:5},{id:"la2",name:"LP L 2",teacher:"C Trn Th Cc",studentCount:32,newFiles:0},{id:"la3",name:"LP L 3",teacher:"C Phm Th Trc",studentCount:34,newFiles:1},{id:"la4",name:"LP L 4",teacher:"C Hong Th o",studentCount:33,newFiles:3}],kO=s=>{const e=s.split("-");let t=parseInt(e[0]),a=parseInt(e[1]);return(isNaN(t)||isNaN(a))&&(t=new Date().getFullYear(),a=t+1),[{id:"m9",name:`Thng 09/${t}`,fileCount:0,files:[]},{id:"m10",name:`Thng 10/${t}`,fileCount:0,files:[]},{id:"m11",name:`Thng 11/${t}`,fileCount:0,files:[]},{id:"m12",name:`Thng 12/${t}`,fileCount:0,files:[]},{id:"m01",name:`Thng 01/${a}`,fileCount:0,files:[]},{id:"m02",name:`Thng 02/${a}`,fileCount:0,files:[]},{id:"m03",name:`Thng 03/${a}`,fileCount:0,files:[]},{id:"m04",name:`Thng 04/${a}`,fileCount:0,files:[]},{id:"m05",name:`Thng 05/${a}`,fileCount:0,files:[]}]},V_=[{value:"09",label:"Thng 9"},{value:"10",label:"Thng 10"},{value:"11",label:"Thng 11"},{value:"12",label:"Thng 12"},{value:"01",label:"Thng 1"},{value:"02",label:"Thng 2"},{value:"03",label:"Thng 3"},{value:"04",label:"Thng 4"},{value:"05",label:"Thng 5"}],IO=[{value:"1",label:"Tun 1"},{value:"2",label:"Tun 2"},{value:"3",label:"Tun 3"},{value:"4",label:"Tun 4"}],DO=()=>{var Fn;const{classId:s}=qE(),e=ar(),[t,a]=t1(),{user:o}=vs(),u=na(),{addToast:d}=jr(),{currentSchoolYear:p}=Gu(),[x,g]=T.useState(null),b=(ne,pe,Ce)=>{if(!ne)return!1;const U=Ue=>Ue.toLowerCase().trim().replace(/\s+/g," "),Q=U(ne),we=U(pe),Ne=Ce?U(Ce):"";return Q===we||Q===Ne||Ne&&Q.includes(Ne)||Ne&&Ne.includes(Q)?!0:(console.log("[matchesClassScope] No match:",{scope:ne,classId:pe,className:Ce,normalizedScope:Q,normalizedName:Ne}),!1)},[w,N]=T.useState(null),[R,D]=T.useState({}),[q,L]=T.useState({}),[W,re]=T.useState([]),[$,z]=T.useState([]),[he,_e]=T.useState(!0),[S,C]=T.useState("students"),[k,M]=T.useState("week"),[I,O]=T.useState(()=>{const pe=new Date().getMonth()+1;return pe===9?"m9":pe>=10?`m${pe}`:`m0${pe}`}),[E,ve]=T.useState("all"),[Te,X]=T.useState(""),[Z,Se]=T.useState(null),[Be,Pe]=T.useState(!1),[V,oe]=T.useState("");T.useRef(null);const[de,ye]=T.useState(!1),[Y,be]=T.useState(null),[B,ce]=T.useState({area:"plan",planType:"week",month:"11",week:"1",name:"",note:""}),[K,Ee]=T.useState(!1),[F,je]=T.useState(null),[le,ke]=T.useState(!1),[Me,Xe]=T.useState(null),[nt,xt]=T.useState(""),[jt,zt]=T.useState(null),[ws,ir]=T.useState(!1),[In,Bt]=T.useState(null),_s=ne=>{if(!o)return!1;const pe=ne,Ce=pe.uploaderId&&pe.uploaderId===o.id,U=pe.uploader===o.fullName;return Ce||U},Ns=()=>{d("Lu thnh cng","Ti liu  c cp nht.","success")},Bs=ne=>{var Q;if(!o)return!1;const pe=ne,Ce=pe.uploaderRole;return!Ce||((Q=pe.approval)==null?void 0:Q.status)==="approved"?!1:o.role==="vice_principal"?["head_teacher","vice_head_teacher","teacher"].includes(Ce):["head_teacher","vice_head_teacher"].includes(o.role)?Ce==="teacher":!1},Bn=ne=>{var Le,Ke,tt;if(!o)return!1;const pe=ne,Ce=(Le=pe.approval)==null?void 0:Le.status;if(Ce==="approved")return!1;const U=pe.uploaderId===o.id,Q=((Ke=pe.uploader)==null?void 0:Ke.toLowerCase())===((tt=o.fullName)==null?void 0:tt.toLowerCase()),we=U||Q,Ne=Ce==="needs_revision",Ue=we&&Ne;return console.log("[canRespond]",{fileName:ne.name,uploaderId:pe.uploaderId,userId:o.id,isOwner:we,approvalStatus:Ce,needsRevision:Ne,result:Ue}),Ue},gt=ne=>{var U,Q;if(!o)return!1;const pe=ne.uploaderId===o.id,Ce=((U=ne.uploader)==null?void 0:U.toLowerCase())===((Q=o.fullName)==null?void 0:Q.toLowerCase());return pe||Ce},Qe=ne=>o?ne.userId===o.id:!1,Ct=async()=>{var ne,pe;if(!(!In||!Z||!o))try{const Ce=qe(Ae,"class_files",Z.id),Q=(Z.comments||[]).filter(Le=>Le.id!==In.id),we={comments:Q,commentCount:Q.length,hasNewComments:Q.length>0};let Ne=(ne=Z.approval)==null?void 0:ne.status,Ue=(pe=Z.approval)==null?void 0:pe.rejectionReason;In.type==="request"&&Ne==="needs_revision"&&(Ne="pending",Ue=void 0,we["approval.status"]="pending",we["approval.rejectionReason"]=No(),d(" hon tc","Yu cu sa  b xa. Trng thi h s tr v 'Ch duyt'.","info")),In.type==="response"&&Q.some(Ke=>Ke.type==="request")&&Ne==="pending"&&(Ne="needs_revision",we["approval.status"]="needs_revision",d(" hon tc","Phn hi  b xa. Bn c th phn hi li.","info")),await Qt(Ce,we),Se({...Z,comments:Q,commentCount:Q.length,hasNewComments:Q.length>0,approval:{...Z.approval,status:Ne,rejectionReason:Ue}}),ir(!1),Bt(null),d(" xa gp ","Gp   c xa thnh cng.","success")}catch(Ce){console.error("Error deleting comment:",Ce),d("Li","Khng th xa gp .","error")}},Zt=ne=>{if(!o)return!1;const pe=ne.uploaderId===o.id,Ce=ne.uploader===o.fullName;if(pe||!ne.uploaderId&&Ce)return!1;let U=ne.uploaderRole;return ne.uploaderId&&R[ne.uploaderId]?U=R[ne.uploaderId]:ne.uploader&&q[ne.uploader]&&(U=q[ne.uploader]),U?ne.planType==="year"?o.role==="admin":o.role==="vice_principal"?!!(ne.planType==="month"||["head_teacher","vice_head_teacher"].includes(U)):["head_teacher","vice_head_teacher"].includes(o.role)?ne.planType!=="week"?!1:U==="teacher":!1:!1},Dt=ne=>{let pe=[...ne];if(Te.trim()){const Ce=Te.toLowerCase().trim();pe=pe.filter(U=>{var Q,we;return((Q=U.name)==null?void 0:Q.toLowerCase().includes(Ce))||((we=U.uploader)==null?void 0:we.toLowerCase().includes(Ce))})}switch(E){case"new":const Ce=new Date;Ce.setDate(Ce.getDate()-7),pe=pe.filter(U=>new Date(U.date)>=Ce).sort((U,Q)=>new Date(Q.date).getTime()-new Date(U.date).getTime());break;case"unread":pe=pe.filter(U=>U.comments&&U.comments.length>0||U.hasNewComments);break;case"all":default:pe=pe.sort((U,Q)=>new Date(Q.date).getTime()-new Date(U.date).getTime());break}return pe},vt=async ne=>{if(o)try{const pe=qe(Ae,"class_files",ne.id);await Qt(pe,{approval:{status:"approved",reviewerId:o.id,reviewerName:o.fullName,reviewerRole:o.role,reviewedAt:new Date().toISOString()}}),d(" duyt h s",`H s "${ne.name}"  c ph duyt.`,"success");const Ce=`/class/${s}`;await br("system",o,{type:"class",name:` duyt: ${ne.name}`,targetPath:Ce,extraInfo:{uploaderId:ne.uploaderId}})}catch(pe){console.error("Error approving file:",pe),d("Li","Khng th duyt h s. Vui lng th li.","error")}},Xt=async()=>{if(!(!o||!Me))try{const ne=qe(Ae,"class_files",Me.id),pe={id:Date.now().toString(),userId:o.id,userName:o.fullName,userRole:o.role,content:nt||"Yu cu chnh sa li.",timestamp:new Date().toISOString(),type:"request"},Ce={status:"needs_revision",reviewerId:o.id,reviewerName:o.fullName,reviewerRole:o.role,reviewedAt:new Date().toISOString(),rejectionReason:nt};await Qt(ne,{approval:Ce,comments:Bo(pe),commentCount:(Me.commentCount||0)+1}),Z&&Z.id===Me.id&&Se({...Z,approval:Ce,comments:[...Z.comments||[],pe],commentCount:(Z.commentCount||0)+1}),d(" gi yu cu sa",` yu cu sa li h s "${Me.name}".`,"success");const U=`/class/${s}?fileId=${Me.id}&highlight=true`;await br("comment",o,{type:"class",name:`Yu cu sa: ${Me.name}`,targetPath:U,extraInfo:{uploaderId:Me.uploaderId,classId:s}}),ke(!1),Xe(null),xt("")}catch(ne){console.error("Error requesting revision:",ne),d("Li","Khng th gi yu cu sa. Vui lng th li.","error")}},wt=async ne=>{var Ce;if(!V.trim()||!Z||!o||!Bn(Z))return;const pe={id:Date.now().toString(),userId:o.id,userName:o.fullName,userRole:o.role,content:V,timestamp:new Date().toISOString(),type:"response"};try{const U=qe(Ae,"class_files",Z.id);await Qt(U,{approval:{...Z.approval,status:"pending",reviewedAt:new Date().toISOString()},comments:Bo(pe),commentCount:(Z.commentCount||0)+1}),Se({...Z,approval:{...Z.approval,status:"pending",reviewedAt:new Date().toISOString()},comments:[...Z.comments||[],pe],commentCount:(Z.commentCount||0)+1}),oe(""),d(" gi phn hi","Phn hi  c gi. H s chuyn sang trng thi ch duyt.","success");const Q=(Ce=Z.approval)==null?void 0:Ce.reviewerId;if(Q&&Q!==o.id){const we=`/class/${s}?fileId=${Z.id}&highlight=true`;await br("comment",o,{type:"class",name:`Phn hi t ${o.fullName}: ${Z.name}`,targetPath:we,extraInfo:{uploaderId:Q}})}}catch(U){console.error("Error adding response:",U),d("Li","Khng th gi phn hi.","error")}};T.useEffect(()=>{if(!s)return;(async()=>{try{const pe=qe(Ae,"classes",s),Ce=await vr(pe);let U=null,Q=[];if(Ce.exists())U=Ce.data();else{console.warn("Class not found in Firestore, checking Mock...");const we=RO.find(Ne=>Ne.id===s);we&&(U=we)}if(U){console.log("[ClassRecords] Class data loaded:",{classId:s,className:U.name,currentUser:o==null?void 0:o.fullName,userScope:o==null?void 0:o.accessScope,userRole:o==null?void 0:o.role});const we=Ne=>Ne.toLowerCase().trim().replace(/\s+/g," ");try{const Ne=mn(Tt(Ae,"users"),bs("role","in",["teacher","head_teacher","vice_head_teacher"])),Le=(await wr(Ne)).docs.map(Kt=>Kt.data()),Ke={},tt={};Le.forEach(Kt=>{Kt.id&&Kt.role&&(Ke[Kt.id]=Kt.role),Kt.fullName&&Kt.role&&(tt[Kt.fullName]=Kt.role)}),D(Ke),L(tt);const it=new Set,$t=we(s),ln=we(U.name);Le.forEach(Kt=>{if(!Kt.accessScope)return;const Jn=we(Kt.accessScope);(Jn===$t||Jn===ln||ln.includes(Jn)||Jn.includes(ln))&&it.add(Kt.fullName)}),Q=Array.from(it),console.log("[ClassRecords] Found teachers from DB:",Q),Q.length===0&&(console.warn("[ClassRecords] No teacher found for class:",s),Q=["Cha phn cng"])}catch(Ne){console.error("Error fetching teacher details:",Ne),Q=["Cha phn cng"]}N({id:s,...U,teachers:Q,teacher:Q.join(", ")})}}catch(pe){console.error("Error fetching class:",pe)}finally{_e(!1)}})()},[s]),T.useEffect(()=>{if(!s)return;const ne=mn(Tt(Ae,"class_files"),bs("classId","==",s)),pe=zs(ne,Ce=>{const U=Ce.docs.map(Ne=>({id:Ne.id,...Ne.data()}));z(U),console.log("[ClassRecords] Fetched files from Firestore:",U.length),U.forEach(Ne=>console.log(`  - ${Ne.name} | month: "${Ne.month}" | type: ${Ne.planType}`));const we=kO(p).map(Ne=>{const Ue=U.filter(Le=>{if((Le.schoolYear||"2025-2026")!==p||(Le.category||"plan")!=="plan")return!1;let it=!1;const $t=Ne.id.replace("m",""),ln=String(Le.month||"").replace("m","");return parseInt($t,10)===parseInt(ln,10)&&(it=!0),!!it});return{...Ne,files:Ue,fileCount:Ue.length}});console.log("[ClassRecords] Grouped files into folders:",we.map(Ne=>`${Ne.name}: ${Ne.fileCount} files`)),re(we)});return()=>pe()},[s]),T.useEffect(()=>{!o||he||o.role==="teacher"&&w&&!b(o.accessScope,s,w.name)&&(console.warn("[ClassRecords] Permission denied:",{userScope:o.accessScope,classId:s,className:w.name}),alert("Bn khng c quyn truy cp vo lp ny."),e("/"))},[o,s,e,w,he]);const an=T.useRef(null);if(T.useEffect(()=>{const ne=t.get("fileId"),pe=t.get("highlight");if(console.log("[ClassRecords] URL Params:",{fileId:ne,highlight:pe,allFilesCount:$.length}),!ne||pe!=="true"||$.length===0||an.current===ne)return;const Ce=$.find(U=>U.id===ne);if(Ce){console.log("[ClassRecords] Found target file:",Ce.name,"category:",Ce.category),an.current=ne;const U=Ce.category||"plan";if(U==="plan"){C("plan");const Ue=Ce.planType||"week";M(Ue)}else U==="assessment"?C("assessment"):U==="students"?C("students"):U==="steam"&&C("steam");const Q=W.find(Ue=>Ue.files.some(Le=>Le.id===ne));Q&&(console.log("[ClassRecords] Auto-expanding folder:",Q.id),O(Q.id)),g(ne),a({},{replace:!0});const we=setTimeout(()=>{Se(Ce),Pe(!0)},300),Ne=setTimeout(()=>{g(null),an.current=null},5e3);return()=>{clearTimeout(we),clearTimeout(Ne)}}else console.warn("[ClassRecords] File not found:",ne)},[t,a,W,$]),he)return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-500"})});if(!w)return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:i.jsxs("div",{className:"text-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Khng tm thy lp hc"}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 text-blue-600 hover:underline",children:"Quay li Dashboard"})]})});const as=((o==null?void 0:o.role)==="teacher"||(o==null?void 0:o.role)==="head_teacher"||(o==null?void 0:o.role)==="vice_head_teacher")&&b(o.accessScope,s,w==null?void 0:w.name);console.log("[ClassRecords] Upload permission:",{canUpload:as,userRole:o==null?void 0:o.role,userScope:o==null?void 0:o.accessScope,classId:s,className:w==null?void 0:w.name});const Ts=(ne,pe)=>{pe.stopPropagation(),Se(ne),Pe(!0)},Tn=(ne,pe,Ce)=>{Ce.stopPropagation(),je({file:ne,folderId:pe}),Ee(!0)},js=async()=>{if(F)try{console.log("[DELETE] Attempting to delete file:",{fileId:F.file.id,fileName:F.file.name,classId:s}),await Cl(qe(Ae,"class_files",F.file.id)),console.log("[DELETE] Successfully deleted file from Firestore"),d(" xa ti liu thnh cng","H s  c xa khi th mc lp.","success")}catch(ne){console.error("[DELETE] Error deleting file:",ne),console.error("[DELETE] Error code:",ne.code),console.error("[DELETE] Error message:",ne.message);let pe="Vui lng th li sau.";ne.code==="permission-denied"&&(pe="Bn khng c quyn xa ti liu ny. Vui lng lin h Ban Gim Hiu."),d("Li khi xa ti liu",pe,"error")}finally{Ee(!1),je(null)}},At=ne=>{O(I===ne?null:ne)},Hn=ne=>{switch(ne){case"word":return i.jsx(Ze,{className:"h-5 w-5 text-blue-600"});case"excel":return i.jsx(Ze,{className:"h-5 w-5 text-green-600"});case"pdf":return i.jsx(Ze,{className:"h-5 w-5 text-red-600"});default:return i.jsx(Ze,{className:"h-5 w-5 text-gray-400"})}},is=()=>{ce({area:S,planType:k,month:new Date().getMonth()+1>8||new Date().getMonth()+1<6?(new Date().getMonth()+1).toString().padStart(2,"0"):"09",week:"1",name:"",note:""}),be(null),ye(!0)},Wn=ne=>{if(ne.preventDefault(),ne.dataTransfer.files&&ne.dataTransfer.files[0]){const pe=ne.dataTransfer.files[0];be(pe),B.name||ce(Ce=>({...Ce,name:pe.name.split(".")[0]}))}},Hi=ne=>{if(ne.target.files&&ne.target.files[0]){const pe=ne.target.files[0];be(pe),B.name||ce(Ce=>({...Ce,name:pe.name.split(".")[0]}))}},Ba=async()=>{var ne,pe;if(!(!Y||!B.name||!o))try{const Ce=rr(Ls,`class-files/${s}/${Date.now()}_${Y.name}`);await nr(Ce,Y);const U=await sr(Ce),Q={name:B.name,type:((ne=Y.name.split(".").pop())==null?void 0:ne.toLowerCase())||"other",url:U,uploader:o.fullName,uploaderId:o.id,uploaderRole:o.role,schoolYear:p,date:new Date().toISOString(),classId:s,month:B.month,monthName:((pe=V_.find(we=>we.value===B.month))==null?void 0:pe.label)||"Thng khc",hasNewComments:!1,commentCount:0,comments:[],createdAt:Bg(),planType:B.planType,week:B.week,category:B.area,approval:{status:"pending"}};await Al(Tt(Ae,"class_files"),Q),d("Ti ln thnh cng!","D liu  c cp nht vo h thng.","success"),br("upload",o,{type:"class",name:B.name,targetPath:`/class/${s}`,extraInfo:{classId:s}}),ye(!1)}catch(Ce){console.error("Error uploading file:",Ce),d("Li khi ti ln","Vui lng th li sau.","error")}};return i.jsxs("div",{className:"min-h-screen bg-amber-50/30 font-sans pb-20",children:[i.jsxs("div",{className:"bg-white border-b border-amber-200 sticky top-0 z-30 shadow-sm",children:[i.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[!u&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-3",children:[i.jsx("span",{className:"cursor-pointer hover:text-amber-600",onClick:()=>e("/"),children:"Dashboard"}),i.jsx(ps,{className:"h-3 w-3"}),i.jsx("span",{className:"cursor-pointer hover:text-amber-600",children:"T Chuyn Mn"}),i.jsx(ps,{className:"h-3 w-3"}),i.jsx("span",{className:"font-semibold text-amber-700",children:"H s lp hc"})]}),i.jsxs("div",{className:"flex items-center justify-between gap-3",children:[i.jsxs("div",{className:"flex items-center gap-3 cursor-pointer hover:opacity-80 transition-opacity flex-1 min-w-0",onClick:()=>e("/"),children:[i.jsx("div",{className:`${u?"h-10 w-10":"h-16 w-16"} rounded-xl bg-gradient-to-br from-amber-100 to-orange-100 flex items-center justify-center border border-amber-200 shadow-sm flex-shrink-0`,children:i.jsx("span",{className:`${u?"text-lg":"text-2xl"} font-bold text-amber-600`,children:((Fn=w==null?void 0:w.name)==null?void 0:Fn.split(" ").pop())||"?"})}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("h1",{className:`${u?"text-lg":"text-2xl"} font-bold text-gray-900 truncate`,children:(w==null?void 0:w.name)||"Lp hc"}),!u&&i.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-gray-500",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(a1,{className:"h-4 w-4"})," GVCN:"]}),w!=null&&w.teachers&&w.teachers.length>1?i.jsx("div",{className:"flex flex-wrap gap-1.5",children:w.teachers.map((ne,pe)=>i.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-800 rounded-md font-semibold text-xs border border-amber-200",children:ne},pe))}):i.jsx("span",{className:"font-semibold text-gray-700",children:(w==null?void 0:w.teacher)||"Cha cp nht"})]}),u&&(w==null?void 0:w.teachers)&&i.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[w.teachers.length," gio vin"]})]})]}),as&&i.jsxs("button",{onClick:is,className:`${u?"p-3 rounded-full":"flex items-center gap-2 px-6 py-3 rounded-xl"} bg-amber-500 hover:bg-amber-600 text-white shadow-md shadow-amber-200 transition-all font-bold flex-shrink-0`,title:"Ti ln h s lp",children:[i.jsx(En,{className:"h-5 w-5"}),!u&&i.jsx("span",{children:"Ti ln h s lp"})]})]})]}),i.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 mt-4",children:u?i.jsxs("div",{className:"flex bg-gray-100 rounded-xl p-1 gap-0.5",children:[i.jsxs("button",{onClick:()=>C("students"),className:`flex-1 flex flex-col items-center gap-0.5 py-2.5 px-2 rounded-lg text-xs font-bold transition-all ${S==="students"?"bg-white text-amber-600 shadow-sm":"text-gray-500"}`,children:[i.jsx($p,{className:"h-4 w-4"}),i.jsx("span",{children:"Lp"})]}),i.jsxs("button",{onClick:()=>C("plan"),className:`flex-1 flex flex-col items-center gap-0.5 py-2.5 px-2 rounded-lg text-xs font-bold transition-all ${S==="plan"?"bg-white text-amber-600 shadow-sm":"text-gray-500"}`,children:[i.jsx(Ze,{className:"h-4 w-4"}),i.jsx("span",{children:"KH GD"})]}),i.jsxs("button",{onClick:()=>C("assessment"),className:`flex-1 flex flex-col items-center gap-0.5 py-2.5 px-2 rounded-lg text-xs font-bold transition-all ${S==="assessment"?"bg-white text-amber-600 shadow-sm":"text-gray-500"}`,children:[i.jsx(Hp,{className:"h-4 w-4"}),i.jsx("span",{children:"nh gi"})]}),i.jsxs("button",{onClick:()=>C("steam"),className:`flex-1 flex flex-col items-center gap-0.5 py-2.5 px-2 rounded-lg text-xs font-bold transition-all ${S==="steam"?"bg-white text-amber-600 shadow-sm":"text-gray-500"}`,children:[i.jsx(Fp,{className:"h-4 w-4"}),i.jsx("span",{children:"STEAM"})]})]}):i.jsxs("div",{className:"flex gap-1 overflow-x-auto no-scrollbar pb-0.5",children:[i.jsxs("button",{onClick:()=>C("students"),className:`flex items-center gap-2 px-6 py-3 rounded-t-xl font-bold text-sm transition-all relative ${S==="students"?"bg-white text-amber-600 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] border-t border-x border-amber-100 z-10":"bg-transparent text-gray-500 hover:bg-amber-50 hover:text-amber-700"}`,children:[i.jsx($p,{className:"h-4 w-4"}),"DANH SCH LP",S==="students"&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-white"})]}),i.jsxs("button",{onClick:()=>C("plan"),className:`flex items-center gap-2 px-6 py-3 rounded-t-xl font-bold text-sm transition-all relative ${S==="plan"?"bg-white text-amber-600 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] border-t border-x border-amber-100 z-10":"bg-transparent text-gray-500 hover:bg-amber-50 hover:text-amber-700"}`,children:[i.jsx(Ze,{className:"h-4 w-4"}),"K HOCH GIO DC",S==="plan"&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-white"})]}),i.jsxs("button",{onClick:()=>C("assessment"),className:`flex items-center gap-2 px-6 py-3 rounded-t-xl font-bold text-sm transition-all relative ${S==="assessment"?"bg-white text-amber-600 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] border-t border-x border-amber-100 z-10":"bg-transparent text-gray-500 hover:bg-amber-50 hover:text-amber-700"}`,children:[i.jsx(Hp,{className:"h-4 w-4"}),"NH GI TR",S==="assessment"&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-white"})]}),i.jsxs("button",{onClick:()=>C("steam"),className:`flex items-center gap-2 px-6 py-3 rounded-t-xl font-bold text-sm transition-all relative ${S==="steam"?"bg-white text-amber-600 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] border-t border-x border-amber-100 z-10":"bg-transparent text-gray-500 hover:bg-amber-50 hover:text-amber-700"}`,children:[i.jsx(Fp,{className:"h-4 w-4"}),"D N STEAM",S==="steam"&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-white"})]})]})})]}),i.jsxs("main",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>ve("all"),className:`px-3 py-1.5 text-xs font-bold rounded-full border transition-all ${E==="all"?"bg-gray-800 text-white border-gray-800":"bg-white text-gray-500 border-gray-200 hover:border-amber-300"}`,children:"Tt c"}),i.jsx("button",{onClick:()=>ve("new"),className:`px-3 py-1.5 text-xs font-bold rounded-full border transition-all ${E==="new"?"bg-amber-500 text-white border-amber-500":"bg-white text-gray-500 border-gray-200 hover:border-amber-300"}`,children:"Mi nht"}),i.jsxs("button",{onClick:()=>ve("unread"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-full border transition-all ${E==="unread"?"bg-red-500 text-white border-red-500":"bg-white text-gray-500 border-gray-200 hover:border-amber-300"}`,children:[i.jsx(Ea,{className:"h-3 w-3"})," C gp "]})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Tl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Tm nhanh k hoch...",value:Te,onChange:ne=>X(ne.target.value),className:"pl-9 pr-4 py-2 w-full sm:w-64 bg-white border border-amber-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-400"})]})]}),S==="plan"&&i.jsxs("div",{className:"flex items-center gap-2 mb-6 bg-white p-1 rounded-lg border border-amber-100 w-fit",children:[i.jsx("button",{onClick:()=>M("year"),className:`px-4 py-2 text-sm font-bold rounded-md transition-all ${k==="year"?"bg-amber-500 text-white shadow-sm":"text-gray-500 hover:bg-amber-50"}`,children:"K hoch Nm"}),i.jsx("button",{onClick:()=>M("month"),className:`px-4 py-2 text-sm font-bold rounded-md transition-all ${k==="month"?"bg-amber-500 text-white shadow-sm":"text-gray-500 hover:bg-amber-50"}`,children:"K hoch Thng"}),i.jsx("button",{onClick:()=>M("week"),className:`px-4 py-2 text-sm font-bold rounded-md transition-all ${k==="week"?"bg-amber-500 text-white shadow-sm":"text-gray-500 hover:bg-amber-50"}`,children:"K hoch Tun"})]}),i.jsxs("div",{className:"space-y-4",children:[S==="plan"&&i.jsxs(i.Fragment,{children:[k==="year"&&i.jsxs("div",{className:"bg-white rounded-xl border border-amber-100 p-6",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(Gv,{className:"h-5 w-5 text-amber-500"}),"K hoch Nm hc ",p]}),(()=>{let ne=W.flatMap(pe=>pe.files).filter(pe=>pe.planType==="year");return ne=Dt(ne),ne.length===0?i.jsx("p",{className:"text-gray-400 italic",children:"Cha c k hoch nm no c ti ln."}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ne.map(pe=>i.jsxs("div",{onClick:Ce=>Ts(pe,Ce),className:"flex items-center gap-3 p-4 bg-gray-50 rounded-xl border border-gray-100 hover:border-amber-300 hover:shadow-md cursor-pointer transition-all",children:[Hn(pe.type),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"font-bold text-gray-800 truncate",children:pe.name}),i.jsx("p",{className:"text-xs text-gray-500",children:new Date(pe.date).toLocaleDateString("vi-VN")})]}),i.jsx("button",{onClick:Ce=>Tn(pe,"year",Ce),className:"p-2 text-gray-400 hover:text-red-600 rounded-full hover:bg-red-50",children:i.jsx(hn,{className:"h-4 w-4"})})]},pe.id))})})()]}),(k==="month"||k==="week")&&i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:W.map(ne=>{let pe=ne.files.filter(Q=>k==="month"?Q.planType==="month":k==="week"?Q.planType==="week"||!Q.planType:!1);pe=Dt(pe);const Ce=pe.length,U=I===ne.id;return i.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-3",children:[i.jsxs("div",{onClick:()=>At(ne.id),className:`
                                          relative flex items-center justify-between p-4 rounded-xl cursor-pointer transition-all border
                                          ${U?"bg-amber-100 border-amber-300 shadow-sm":"bg-white border-amber-100 hover:bg-amber-50"}
                                       `,children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`p-3 rounded-lg ${U?"bg-amber-500 text-white":"bg-amber-100 text-amber-600"}`,children:i.jsx(Gv,{className:"h-6 w-6"})}),i.jsxs("div",{children:[i.jsx("h3",{className:`font-bold ${U?"text-amber-900":"text-gray-700"}`,children:ne.name}),i.jsxs("p",{className:"text-xs text-gray-500",children:[Ce," ",k==="month"?"K hoch thng":"K hoch tun"]})]})]}),i.jsx("div",{className:`p-1.5 rounded-full transition-transform duration-300 ${U?"rotate-90 bg-amber-200 text-amber-800":"text-gray-400"}`,children:i.jsx(ps,{className:"h-5 w-5"})})]}),U&&i.jsxs("div",{className:"mt-2 ml-4 pl-4 border-l-2 border-amber-200 space-y-2 animate-in slide-in-from-top-2 duration-300",children:[pe.map(Q=>{var we,Ne,Ue,Le,Ke,tt,it,$t,ln,Kt,Jn,sa;return i.jsxs("div",{onClick:Cn=>{x===Q.id&&g(null),Ts(Q,Cn)},className:`flex items-center justify-between p-3 bg-white rounded-lg border shadow-sm hover:border-amber-300 hover:shadow-md cursor-pointer group transition-all ${x===Q.id?"border-red-400 bg-red-50 animate-pulse ring-2 ring-red-300":"border-gray-100"}`,children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[Hn(Q.type),i.jsxs("div",{className:"flex-1 min-w-0",children:[u?i.jsxs(i.Fragment,{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-800 group-hover:text-amber-700 truncate",children:Q.name}),i.jsxs("div",{className:"flex items-center gap-1.5 mt-1 flex-wrap",children:[((we=Q.approval)==null?void 0:we.status)==="pending"&&i.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-amber-100 text-amber-700 whitespace-nowrap",children:[i.jsx(gr,{className:"h-2.5 w-2.5"})," Ch duyt"]}),((Ne=Q.approval)==null?void 0:Ne.status)==="approved"&&i.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-green-100 text-green-700 whitespace-nowrap",children:[i.jsx(pr,{className:"h-2.5 w-2.5"}),"  duyt"]}),((Ue=Q.approval)==null?void 0:Ue.status)==="needs_revision"&&i.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-amber-100 text-amber-700 animate-pulse whitespace-nowrap",children:[i.jsx(Qv,{className:"h-2.5 w-2.5"})," Cn sa"]}),((Le=Q.approval)==null?void 0:Le.status)==="responded"&&i.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-blue-100 text-blue-700 whitespace-nowrap",children:[i.jsx(Ea,{className:"h-2.5 w-2.5"}),"  phn hi"]}),((Ke=Q.approval)==null?void 0:Ke.status)==="rejected"&&i.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-red-100 text-red-700 whitespace-nowrap",title:Q.approval.rejectionReason,children:[i.jsx(Uh,{className:"h-2.5 w-2.5"})," T chi"]}),i.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[i.jsx(Da,{className:"h-2.5 w-2.5"})," ",new Date(Q.date).toLocaleDateString("vi-VN")]}),k==="week"&&Q.week&&i.jsxs("span",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px] text-gray-600 font-medium whitespace-nowrap",children:["T",Q.week]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-800 group-hover:text-amber-700",children:Q.name}),((tt=Q.approval)==null?void 0:tt.status)==="pending"&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-amber-100 text-amber-700",children:[i.jsx(gr,{className:"h-2.5 w-2.5"})," Ch duyt"]}),((it=Q.approval)==null?void 0:it.status)==="approved"&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-green-100 text-green-700",children:[i.jsx(pr,{className:"h-2.5 w-2.5"}),"  duyt"]}),(($t=Q.approval)==null?void 0:$t.status)==="needs_revision"&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-amber-100 text-amber-700 animate-pulse",children:[i.jsx(Qv,{className:"h-2.5 w-2.5"})," Cn sa"]}),((ln=Q.approval)==null?void 0:ln.status)==="responded"&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-blue-100 text-blue-700",children:[i.jsx(Ea,{className:"h-2.5 w-2.5"}),"  phn hi"]}),((Kt=Q.approval)==null?void 0:Kt.status)==="rejected"&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[9px] font-bold bg-red-100 text-red-700",title:Q.approval.rejectionReason,children:[i.jsx(Uh,{className:"h-2.5 w-2.5"})," T chi"]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[i.jsx(Da,{className:"h-3 w-3"})," ",new Date(Q.date).toLocaleDateString("vi-VN"),k==="week"&&Q.week&&i.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-gray-600 font-medium",children:["Tun ",Q.week]})]})]}),((Jn=Q.approval)==null?void 0:Jn.status)==="rejected"&&Q.approval.rejectionReason&&i.jsxs("div",{className:"mt-1 text-[10px] text-red-600",children:[i.jsx("span",{className:"font-semibold",children:"L do:"})," ",Q.approval.rejectionReason]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[Zt(Q)&&((sa=Q.approval)==null?void 0:sa.status)==="pending"&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsxs("button",{onClick:Cn=>{Cn.stopPropagation(),vt(Q)},className:"px-2 py-1 text-[9px] font-bold text-white bg-green-500 hover:bg-green-600 rounded transition-colors flex items-center gap-0.5",children:[i.jsx(pr,{className:"h-3 w-3"})," Duyt"]}),i.jsxs("button",{onClick:Cn=>{Cn.stopPropagation(),Xe(Q),xt(""),ke(!0)},className:"px-2 py-1 text-[9px] font-bold text-white bg-amber-500 hover:bg-amber-600 rounded transition-colors flex items-center gap-0.5",children:[i.jsx(Ms,{className:"h-3 w-3"})," Yu cu sa"]})]}),Q.hasNewComments&&i.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 rounded-full bg-red-100 text-red-600 text-[10px] font-bold animate-pulse",children:[i.jsx(Ea,{className:"h-3 w-3"}),"Gp  mi"]}),gt(Q)&&i.jsx("button",{onClick:Cn=>Tn(Q,ne.id,Cn),className:"p-2 text-gray-400 hover:text-red-600 rounded-full hover:bg-red-50",children:i.jsx(hn,{className:"h-4 w-4"})})]})]},Q.id)}),pe.length===0&&i.jsx("p",{className:"text-sm text-gray-400 italic p-2",children:"Cha c k hoch no c ti ln."})]})]},ne.id)})})]}),S==="students"&&i.jsxs("div",{className:"bg-white rounded-xl border border-amber-100 p-6",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx($p,{className:"h-5 w-5 text-amber-500"}),"Danh sch Lp"]}),(()=>{let ne=$.filter(pe=>pe.category==="students");return ne=Dt(ne),console.log("[Student List Tab] Total files:",$.length,"Student files:",ne.length),console.log("[Student List Tab] All file categories:",$.map(pe=>({name:pe.name,category:pe.category}))),ne.length===0?i.jsx("p",{className:"text-gray-400 italic",children:"Cha c danh sch no c ti ln."}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ne.map(pe=>i.jsxs("div",{onClick:Ce=>Ts(pe,Ce),className:"flex items-center gap-3 p-4 bg-gray-50 rounded-xl border border-gray-100 hover:border-amber-300 hover:shadow-md cursor-pointer transition-all",children:[Hn(pe.type),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"font-bold text-gray-800 truncate",children:pe.name}),i.jsx("p",{className:"text-xs text-gray-500",children:new Date(pe.date).toLocaleDateString("vi-VN")})]}),gt(pe)&&i.jsx("button",{onClick:Ce=>Tn(pe,"students",Ce),className:"p-2 text-gray-400 hover:text-red-600 rounded-full hover:bg-red-50",children:i.jsx(hn,{className:"h-4 w-4"})})]},pe.id))})})()]}),S==="assessment"&&i.jsxs("div",{className:"text-center py-20 bg-white rounded-2xl border border-dashed border-gray-300",children:[i.jsx(Hp,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),i.jsx("h3",{className:"text-gray-500 font-medium",children:"Khu vc nh gi tr"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"D liu s c cp nht trong hc k ti."})]}),S==="steam"&&i.jsxs("div",{className:"text-center py-20 bg-white rounded-2xl border border-dashed border-gray-300",children:[i.jsx(Fp,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),i.jsx("h3",{className:"text-gray-500 font-medium",children:"D n STEAM"}),i.jsx("p",{className:"text-gray-400 text-sm",children:"Cc d n hc tp ang c xy dng."})]})]})]}),K&&F&&i.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm overflow-hidden animate-in zoom-in-95 duration-200",children:i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Yn,{className:"h-8 w-8 text-red-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Xc nhn xa ti liu?"}),i.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Bn c chc chn mun xa file ",i.jsxs("span",{className:"font-semibold text-gray-800",children:['"',F.file.name,'"']})," khng? Hnh ng ny khng th hon tc."]}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsx("button",{onClick:()=>Ee(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hy b"}),i.jsx("button",{onClick:js,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 shadow-md transition-colors",children:"Xa vnh vin"})]})]})})}),le&&Me&&i.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden animate-in zoom-in-95 duration-200",children:i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Ms,{className:"h-8 w-8 text-amber-600"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2 text-center",children:"Yu cu gio vin sa li?"}),i.jsxs("p",{className:"text-sm text-gray-500 mb-4 text-center",children:["Bn sp yu cu chnh sa h s ",i.jsxs("span",{className:"font-semibold text-gray-800",children:['"',Me.name,'"']})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Ni dung cn chnh sa ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{className:"w-full border border-amber-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none transition-all resize-none",rows:4,placeholder:"Nhp chi tit cc im cn sa...",value:nt,onChange:ne=>xt(ne.target.value)})]}),i.jsxs("div",{className:"flex gap-3 justify-center",children:[i.jsx("button",{onClick:()=>{ke(!1),Xe(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hy b"}),i.jsxs("button",{onClick:Xt,disabled:!nt.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-amber-600 rounded-lg hover:bg-amber-700 shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(Cu,{className:"h-4 w-4 mr-1 inline"})," Gi yu cu"]})]})]})})}),de&&i.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-amber-100 flex justify-between items-center bg-white",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(En,{className:"h-5 w-5 text-amber-600"}),"Thm mi Ti liu Lp hc"]}),i.jsx("button",{onClick:()=>ye(!1),className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",children:i.jsx(fn,{className:"h-6 w-6"})})]}),i.jsxs("div",{className:"p-6 space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Khu vc lu tr"}),i.jsx("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg",children:[{id:"students",label:"Danh sch Lp"},{id:"plan",label:"K hoch"},{id:"assessment",label:"nh gi Tr"},{id:"steam",label:"D n STEAM"}].map(ne=>i.jsx("button",{onClick:()=>ce({...B,area:ne.id}),className:`flex-1 py-2 px-2 text-sm font-medium rounded-md transition-all ${B.area===ne.id?"bg-white text-amber-700 shadow-sm ring-1 ring-gray-200":"text-gray-500 hover:text-gray-700"}`,children:ne.label},ne.id))})]}),B.area==="plan"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loi k hoch"}),i.jsx("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg",children:[{id:"year",label:"K hoch Nm"},{id:"month",label:"K hoch Thng"},{id:"week",label:"K hoch Tun"}].map(ne=>i.jsx("button",{onClick:()=>ce({...B,planType:ne.id}),className:`flex-1 py-2 px-2 text-sm font-medium rounded-md transition-all ${B.planType===ne.id?"bg-white text-amber-700 shadow-sm ring-1 ring-gray-200":"text-gray-500 hover:text-gray-700"}`,children:ne.label},ne.id))})]}),B.area!=="students"&&(B.area!=="plan"||B.planType!=="year")&&i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chn Thng"}),i.jsx("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none transition-all bg-white text-sm",value:B.month,onChange:ne=>ce({...B,month:ne.target.value}),children:V_.map(ne=>i.jsx("option",{value:ne.value,children:ne.label},ne.value))})]}),(B.area!=="plan"||B.planType==="week")&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chn Tun"}),i.jsx("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none transition-all bg-white text-sm",value:B.week,onChange:ne=>ce({...B,week:ne.target.value}),children:IO.map(ne=>i.jsx("option",{value:ne.value,children:ne.label},ne.value))})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[B.area==="assessment"?"Tn phiu nh gi":"Tn ti liu"," ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{autoFocus:!0,type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none transition-all",placeholder:"VD: K hoch ch  Gia nh...",value:B.name,onChange:ne=>ce({...B,name:ne.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tp nh km"}),i.jsxs("div",{onDrop:Wn,onDragOver:ne=>ne.preventDefault(),className:`border-2 border-dashed rounded-xl p-6 flex flex-col items-center justify-center cursor-pointer transition-all group relative ${Y?"border-amber-500 bg-amber-50":"border-gray-300 hover:bg-gray-50 hover:border-amber-400"}`,children:[i.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:Hi}),Y?i.jsxs("div",{className:"flex flex-col items-center text-center animate-in zoom-in duration-300",children:[i.jsx(ys,{className:"h-10 w-10 text-amber-600 mb-2"}),i.jsx("p",{className:"text-sm font-bold text-amber-800 truncate max-w-[250px]",children:Y.name}),i.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[(Y.size/1024).toFixed(0)," KB -  sn sng"]})]}):i.jsxs("div",{className:"flex flex-col items-center text-center",children:[i.jsx("div",{className:"p-3 rounded-full mb-3 bg-amber-100 text-amber-600 transition-colors",children:i.jsx(uf,{className:"h-8 w-8"})}),i.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Ko th file vo y hoc ",i.jsx("span",{className:"text-amber-600 underline",children:"Bm  chn"})]}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"H tr PDF, Excel, Word, nh (Ti a 10MB)"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch (Ty chn)"}),i.jsx("textarea",{rows:2,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none transition-all text-sm",placeholder:"Ghi ch cho T trng/BGH (nu c)...",value:B.note,onChange:ne=>ce({...B,note:ne.target.value})})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>ye(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-white hover:shadow-sm rounded-lg border border-transparent hover:border-gray-300 transition-all",children:"Hy b"}),i.jsxs("button",{onClick:Ba,disabled:!Y||!B.name,className:"flex items-center gap-2 px-6 py-2 text-sm font-bold text-white bg-amber-500 hover:bg-amber-600 rounded-lg shadow-md transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(En,{className:"h-4 w-4"})," Lu h s"]})]})]})}),ws&&In&&i.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 p-4 animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 animate-in zoom-in-95 duration-200",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3",children:i.jsx(hn,{className:"h-6 w-6 text-red-500"})}),i.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Xa gp "}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Bn c chc chn mun xa gp  ny? Thao tc ny khng th hon tc."})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 text-sm text-gray-700 italic",children:['"',In.content.substring(0,100),In.content.length>100?"...":"",'"']}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>{ir(!1),Bt(null)},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors",children:"Hy"}),i.jsx("button",{onClick:Ct,className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors",children:"Xa"})]})]})}),Be&&Z&&i.jsx(jT,{file:{id:Z.id,name:Z.name,url:Z.url||"",type:Z.type,uploader:Z.uploader,uploaderId:Z.uploaderId,uploaderRole:Z.uploaderRole,date:Z.date,comments:Z.comments,approval:Z.approval},onClose:()=>{Pe(!1),Se(null)},onSaveSuccess:Ns,collectionName:"class_files",storageFolder:`class-files/${s}`,canEdit:_s(Z),canApprove:Zt&&Zt(Z),canComment:Bs(Z),canRespond:Bn(Z),onApprove:()=>vt(Z),onRequestRevision:ne=>{Xe(Z),xt(ne),Xt()},onPostComment:ne=>{oe(ne),wt()},canManageComment:Qe,onEditComment:async(ne,pe)=>{if(!(!Z||!o))try{const Ce=qe(Ae,"class_files",Z.id),Q=(Z.comments||[]).map(we=>we.id===ne?{...we,content:pe,editedAt:new Date().toISOString()}:we);await Qt(Ce,{comments:Q}),Se({...Z,comments:Q}),d(" cp nht gp ","Ni dung gp   c lu.","success")}catch(Ce){console.error("Error editing comment:",Ce),d("Li","Khng th cp nht gp .","error")}},onDeleteComment:async ne=>{var Ce,U,Q;if(!Z||!o)return;const pe=(Ce=Z.comments)==null?void 0:Ce.find(we=>we.id===ne);if(pe)try{const we=qe(Ae,"class_files",Z.id),Ue=(Z.comments||[]).filter(it=>it.id!==ne),Le={comments:Ue,commentCount:Ue.length,hasNewComments:Ue.length>0};let Ke=(U=Z.approval)==null?void 0:U.status,tt=(Q=Z.approval)==null?void 0:Q.rejectionReason;pe.type==="request"&&Ke==="needs_revision"&&(Ke="pending",tt=void 0,Le["approval.status"]="pending",Le["approval.rejectionReason"]=No(),d(" hon tc","Yu cu sa  b xa. Trng thi h s tr v 'Ch duyt'.","info")),pe.type==="response"&&Ue.some($t=>$t.type==="request")&&Ke==="pending"&&(Ke="needs_revision",Le["approval.status"]="needs_revision",d(" hon tc","Phn hi  b xa. Bn c th phn hi li.","info")),await Qt(we,Le),Se({...Z,comments:Ue,commentCount:Ue.length,hasNewComments:Ue.length>0,approval:{...Z.approval,status:Ke,rejectionReason:tt}}),d(" xa gp ","Gp   c xa thnh cng.","success")}catch(we){console.error("Error deleting comment:",we),d("Li","Khng th xa gp .","error")}}})]})},OO=()=>{const s=ar(),{login:e,isAuthenticated:t}=vs();T.useEffect(()=>{t&&s("/")},[t,s]),T.useEffect(()=>{(async()=>{try{const $=qe(Ae,"app_settings","login_background"),z=await vr($);z.exists()&&z.data().imageUrl&&L(z.data().imageUrl)}catch($){console.error("Error fetching background:",$)}})()},[]);const[a,o]=T.useState(""),[u,d]=T.useState("");T.useEffect(()=>{(async()=>{try{const $=qe(Ae,"app_settings","system_logo"),z=await vr($);z.exists()&&z.data().imageUrl&&o(z.data().imageUrl);const he=qe(Ae,"app_settings","certification_logo"),_e=await vr(he);_e.exists()&&_e.data().imageUrl&&d(_e.data().imageUrl)}catch($){console.error("Error fetching logo:",$)}})()},[]);const[p,x]=T.useState(!1),[g,b]=T.useState(!1),[w,N]=T.useState(""),[R,D]=T.useState({username:"",password:""}),[q,L]=T.useState("/login-background.jpg"),W=async re=>{re.preventDefault(),b(!0),N("");const $=await e(R.username,R.password);b(!1),$||N("Tn ng nhp hoc mt khu khng ng.")};return i.jsxs("div",{className:"min-h-screen relative flex items-center justify-end pr-8 sm:pr-16 lg:pr-24 font-sans overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 z-0",children:i.jsx("img",{src:q,alt:"Trng Mu Gio Vng Anh",className:"w-full h-full object-cover"})}),i.jsx("div",{className:"relative z-10 w-full max-w-md mx-4 sm:mx-0",children:i.jsxs("div",{className:"bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl p-8 sm:p-10 animate-in fade-in zoom-in-95 duration-500",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"inline-flex p-4 bg-blue-900/10 rounded-full mb-4",children:a?i.jsx("img",{src:a,alt:"Logo",className:"h-12 w-12 object-contain"}):i.jsx(n0,{className:"h-12 w-12 text-blue-900"})}),i.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-blue-900 mb-2",children:d1}),i.jsx("div",{className:"h-1 w-20 bg-amber-400 rounded-full mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"ng nhp"}),i.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Cho mng cc C quay tr li lm vic! "})]}),w&&i.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-600 flex items-center gap-2",children:[i.jsx("div",{className:"h-2 w-2 bg-red-500 rounded-full"}),w]}),i.jsxs("form",{onSubmit:W,className:"space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ng nhp"}),i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(xr,{className:"h-5 w-5 text-gray-400 group-focus-within:text-blue-600 transition-colors"})}),i.jsx("input",{id:"username",name:"username",type:"text",required:!0,className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-xl leading-5 bg-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent sm:text-sm transition-all",placeholder:"VD: admin, totruong, gv_la1...",value:R.username,onChange:re=>D({...R,username:re.target.value})})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu"}),i.jsxs("div",{className:"relative group",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ro,{className:"h-5 w-5 text-gray-400 group-focus-within:text-blue-600 transition-colors"})}),i.jsx("input",{id:"password",name:"password",type:p?"text":"password",required:!0,className:"block w-full pl-10 pr-10 py-3 border border-gray-300 rounded-xl leading-5 bg-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent sm:text-sm transition-all",placeholder:"",value:R.password,onChange:re=>D({...R,password:re.target.value})}),i.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer text-gray-400 hover:text-gray-600",onClick:()=>x(!p),children:p?i.jsx(mg,{className:"h-5 w-5"}):i.jsx(pg,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-700",children:"Ghi nh ng nhp"})]}),i.jsx("div",{className:"text-sm",children:i.jsx("a",{href:"#",className:"font-medium text-blue-600 hover:text-blue-500 hover:underline",children:"Qun mt khu?"})})]}),i.jsx("button",{type:"submit",disabled:g,className:"w-full flex justify-center items-center gap-2 py-3 px-4 border border-transparent rounded-xl shadow-lg text-sm font-bold text-white bg-blue-900 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-900 disabled:opacity-70 disabled:cursor-not-allowed transition-all transform hover:-translate-y-0.5",children:g?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"ang x l..."]}):i.jsxs(i.Fragment,{children:["ng nhp",i.jsx(Ph,{className:"h-4 w-4"})]})})]}),i.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-500",children:[i.jsx(c1,{className:"h-3 w-3"}),i.jsxs("span",{children:["H tr k thut: ",i.jsx("span",{className:"font-semibold text-gray-700",children:"0984.651.653 (Thy Thoi)"})]})]})})]})}),i.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 bg-gradient-to-t from-black/30 to-transparent backdrop-blur-sm py-4",children:i.jsx("div",{className:"text-center",children:i.jsxs("p",{className:"text-xs sm:text-sm text-white drop-shadow-lg",children:[" ",new Date().getFullYear()," Trng Mu Gio Vng Anh. All rights reserved."]})})}),u&&i.jsx("div",{className:"fixed top-6 left-6 z-20 animate-in fade-in slide-in-from-top-8 duration-700 delay-300",children:i.jsx("img",{src:u,alt:"Chng nhn t chun",className:"h-32 w-auto drop-shadow-2xl hover:scale-105 transition-transform duration-300 cursor-pointer",title:"Trng Mm non t chun Quc gia"})})]})},MO=()=>i.jsx(aO,{children:i.jsx(oO,{children:i.jsx(mO,{children:i.jsx(AS,{children:i.jsxs("div",{className:"flex flex-col min-h-screen font-sans text-gray-900 bg-gray-50",children:[i.jsx(dO,{}),i.jsx("main",{className:"flex-grow",children:i.jsxs(aS,{children:[i.jsx(Br,{path:"/",element:i.jsx(pO,{})}),i.jsx(Br,{path:"/login",element:i.jsx(OO,{})}),i.jsx(Br,{path:"/van-ban-chi-dao",element:i.jsx(xO,{})}),i.jsx(Br,{path:"/van-ban-truong",element:i.jsx(yO,{})}),i.jsx(Br,{path:"/quan-tri-he-thong",element:i.jsx(vO,{})}),i.jsx(Br,{path:"/to-van-phong-ke-hoach",element:i.jsx(EO,{})}),i.jsx(Br,{path:"/to-van-phong-thuc-don",element:i.jsx(CO,{})}),i.jsx(Br,{path:"/to-chuyen-mon-ke-hoach",element:i.jsx(AO,{})}),i.jsx(Br,{path:"/class/:classId",element:i.jsx(DO,{})})]})})]})})})})}),ET=document.getElementById("root");if(!ET)throw new Error("Could not find root element to mount to");const VO=fE.createRoot(ET);VO.render(i.jsx(vi.StrictMode,{children:i.jsx(MO,{})}));
